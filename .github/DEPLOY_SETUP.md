# üöÄ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ Cloudflare

## üìã –ß—Ç–æ —ç—Ç–æ –¥–µ–ª–∞–µ—Ç?

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç UK-CRM –Ω–∞ Cloudflare Workers –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main`.

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç frontend (React + Vite)
2. ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã –≤ `cloudflare/public`
3. ‚úÖ –î–µ–ø–ª–æ–∏—Ç –Ω–∞ Cloudflare Workers
4. ‚úÖ –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ D1 database
5. ‚úÖ –°–∞–π—Ç –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ https://app.myhelper.uz

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ (–û–î–ò–ù –†–ê–ó)

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç—å Cloudflare API Token

1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://dash.cloudflare.com/profile/api-tokens
2. –ù–∞–∂–º–∏—Ç–µ **"Create Token"**
3. –í—ã–±–µ—Ä–∏—Ç–µ —à–∞–±–ª–æ–Ω **"Edit Cloudflare Workers"**
4. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ Custom Token —Å –ø—Ä–∞–≤–∞–º–∏:
   - **Account** ‚Üí **Cloudflare Workers** ‚Üí **Edit**
   - **Account** ‚Üí **D1** ‚Üí **Edit**
   - **Zone** ‚Üí **Workers Routes** ‚Üí **Edit**

5. –ù–∞–∂–º–∏—Ç–µ **"Continue to summary"** ‚Üí **"Create Token"**
6. **–°–ö–û–ü–ò–†–£–ô–¢–ï TOKEN** (–æ–Ω –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!)

---

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ GitHub Secrets

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:
   https://github.com/PalachSHAXA/UK-CRM

2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions**

3. –ù–∞–∂–º–∏—Ç–µ **"New repository secret"**

4. –°–æ–∑–¥–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç:
   - **Name:** `CLOUDFLARE_API_TOKEN`
   - **Secret:** –≤–∞—à —Ç–æ–∫–µ–Ω –∏–∑ –®–∞–≥–∞ 1
   - –ù–∞–∂–º–∏—Ç–µ **"Add secret"**

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ `cloudflare/wrangler.toml` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```toml
name = "uk-crm"
main = "src/index.ts"
compatibility_date = "2024-01-01"

[[d1_databases]]
binding = "DB"
database_name = "uk-crm-db"
database_id = "–≤–∞—à-database-id"

[durable_objects]
bindings = [
  { name = "CONNECTION_MANAGER", class_name = "ConnectionManager" }
]

[[migrations]]
tag = "v1"
new_classes = ["ConnectionManager"]
```

---

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```bash
# –î–µ–ª–∞–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
git add .
git commit -m "Add new feature"
git push origin main

# GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# 1. –°–æ–±–µ—Ä—ë—Ç frontend
# 2. –ó–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–∞ Cloudflare
# 3. –£–≤–µ–¥–æ–º–∏—Ç –≤–∞—Å –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
```

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π —á–µ—Ä–µ–∑ GitHub UI:

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Actions** ‚Üí **Deploy to Cloudflare**
2. –ù–∞–∂–º–∏—Ç–µ **"Run workflow"**
3. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É `main`
4. –ù–∞–∂–º–∏—Ç–µ **"Run workflow"**

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ–µ–≤

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –¥–µ–ø–ª–æ—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤–æ –≤–∫–ª–∞–¥–∫—É **Actions**
3. –£–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–µ–ø–ª–æ–µ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å:
   - ‚úÖ –ó–µ–ª—ë–Ω–∞—è –≥–∞–ª–æ—á–∫–∞ = —É—Å–ø–µ—à–Ω–æ
   - ‚ùå –ö—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫ = –æ—à–∏–±–∫–∞
   - üü° –ñ—ë–ª—Ç—ã–π –∫—Ä—É–≥ = –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

### –õ–æ–≥–∏ –¥–µ–ø–ª–æ—è:

–ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±–æ–π workflow ‚Üí –æ—Ç–∫—Ä–æ—é—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞: "Invalid API Token"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ç–æ–∫–µ–Ω –¥–æ–±–∞–≤–ª–µ–Ω –≤ GitHub Secrets
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–∫–µ–Ω –∞–∫—Ç–∏–≤–µ–Ω (–∑–∞–π–¥–∏—Ç–µ –≤ Cloudflare)
3. –ü–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –µ—Å–ª–∏ –∏—Å—Ç—ë–∫

### –û—à–∏–±–∫–∞: "Database not found"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `database_id` –≤ `wrangler.toml`
2. –£–∑–Ω–∞—Ç—å ID: `wrangler d1 list`
3. –û–±–Ω–æ–≤–∏—Ç–µ ID –≤ –∫–æ–Ω—Ñ–∏–≥–µ

### –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ frontend:

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ `package.json`
2. –£–¥–∞–ª–∏—Ç–µ `package-lock.json` –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Node.js –≤–µ—Ä—Å–∏—é (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 18+)

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚úÖ **API Token —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ GitHub Secrets** (–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω)
‚úÖ **–¢–æ–∫–µ–Ω –≤–∏–¥–µ–Ω —Ç–æ–ª—å–∫–æ –≤ –ª–æ–≥–∞—Ö GitHub Actions** (–µ—Å–ª–∏ —è–≤–Ω–æ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—å)
‚úÖ **–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø—Ä–∞–≤–∞** (Workers + D1)

‚ö†Ô∏è **–ù–ï –ö–û–ú–ú–ò–¢–¨–¢–ï** —Ç–æ–∫–µ–Ω –≤ –∫–æ–¥ –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª—ã!

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

### –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–¥–µ–ø–ª–æ–π:

–£–¥–∞–ª–∏—Ç–µ —Ñ–∞–π–ª `.github/workflows/deploy.yml`

### –î–µ–ø–ª–æ–π —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤–µ—Ç–æ–∫:

–ò–∑–º–µ–Ω–∏—Ç–µ –≤ `deploy.yml`:
```yaml
on:
  push:
    branches:
      - main
      - production  # –¥–æ–±–∞–≤—å—Ç–µ –Ω—É–∂–Ω—ã–µ –≤–µ—Ç–∫–∏
```

### –î–µ–ø–ª–æ–π –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:

–î–æ–±–∞–≤—å—Ç–µ –≤ `deploy.yml`:
```yaml
on:
  schedule:
    - cron: '0 2 * * *'  # –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 2:00 UTC
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. –°–¥–µ–ª–∞–π—Ç–µ –ª—é–±–æ–π commit –∏ push
2. –û—Ç–∫—Ä–æ–π—Ç–µ **Actions** –Ω–∞ GitHub
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è workflow (‚âà2-3 –º–∏–Ω—É—Ç—ã)
4. –û—Ç–∫—Ä–æ–π—Ç–µ https://app.myhelper.uz
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å

---

**–ì–æ—Ç–æ–≤–æ!** üéâ –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π push –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è –Ω–∞ Cloudflare.
