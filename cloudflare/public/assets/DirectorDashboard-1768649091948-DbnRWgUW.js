import{q as ve,r as g,j as e,a5 as Ne,F as G,h as L,B as P,aw as ye,I as J,ax as be,ay as we,a1 as V,m as z,E as Ae,az as Re,a9 as Z,z as ke,o as Ce,av as ze,W as Be,V as De,M as Se,X as Me}from"./react-vendor-1768649091948-BtuSrqiZ.js";import{R as B,A as _e,C as Q,X as ee,Y as se,T as D,L as S,d as te,P as ae,b as le,c as re,B as Fe,a as ie}from"./LazyCharts-1768649091948-DNPF1nuj.js";import{u as Te,h as qe,i as Ee,d as Le,t as Pe,S as $}from"./index-1768649091948-BxbEkOZ1.js";import{f as $e}from"./formatAddress-1768649091948-OwpdX0o2.js";import"./vendor-1768649091948-aJDeeFcJ.js";import"./qr-scanner-1768649091948-cr32YHjo.js";import"./zustand-1768649091948-wNUYBKDB.js";import"./charts-1768649091948-CMs2ZSTq.js";const Oe={new:"Новая",assigned:"Назначена",accepted:"Принята",in_progress:"В работе",pending_approval:"На проверке",completed:"Выполнена",cancelled:"Отменена"};function M({isOpen:p,onClose:c,title:u,children:N}){return p?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:c,children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[80vh] overflow-hidden shadow-xl",onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:u}),e.jsx("button",{onClick:c,className:"p-1 hover:bg-gray-100 rounded-full",children:e.jsx(Me,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:N})]})}):null}function Je(){const p=ve(),{requests:c,executors:u,announcements:N,fetchRequests:b,fetchExecutors:_}=Te(),{buildings:w,residents:O,fetchBuildings:F}=qe(),{meetings:R,fetchMeetings:T}=Ee(),{language:a}=Le(),[I,H]=g.useState(!1),[k,h]=g.useState(null),[m,ne]=g.useState(null);g.useEffect(()=>{b(),_(),F(),T(),K()},[b,_,F,T]);const K=async()=>{try{const s=await Pe.getAll(),t=(s.managers?.length||0)+(s.departmentHeads?.length||0)+(s.executors?.length||0);ne({...s,total:t})}catch{}},l=g.useMemo(()=>{const s=new Date,t=new Date(s.getTime()-10080*60*1e3),n=new Date(s.getTime()-720*60*60*1e3),x=c.length,o=c.filter(i=>i.status==="new").length,d=c.filter(i=>["assigned","accepted","in_progress"].includes(i.status)).length,j=c.filter(i=>i.status==="completed").length,C=c.filter(i=>{if(i.status!=="completed")return!1;const v=i.completedAt?new Date(i.completedAt):null;return v&&v>=t}).length,f=c.filter(i=>{if(i.status!=="completed")return!1;const v=i.completedAt?new Date(i.completedAt):null;return v&&v>=n}).length,E=c.filter(i=>i.status==="pending_approval").length,A=x>0?j/x*100:0,U=m?.managers.length||0,Y=m?.departmentHeads.length||0,X=m?.executors.length||u.length,me=m?.total||0||U+Y+X,ue=u.filter(i=>i.status!=="offline").length,he=u.length>0?u.reduce((i,v)=>i+(v.rating||0),0)/u.length:0,ge=w.length,pe=O.length,je=R.filter(i=>["schedule_poll_open","schedule_confirmed","voting_open"].includes(i.status)).length,fe=N.filter(i=>i.isActive).length;return{totalRequests:x,newRequests:o,inProgress:d,completedTotal:j,completedThisWeek:C,completedThisMonth:f,pendingApproval:E,completionRate:A,totalStaff:me,totalManagers:U,totalDepartmentHeads:Y,totalExecutors:X,onlineExecutors:ue,avgRating:he,totalBuildings:ge,totalResidents:pe,activeMeetings:je,activeAnnouncements:fe}},[c,u,w,O,R,N,m]),ce=g.useMemo(()=>[...c].sort((s,t)=>new Date(t.createdAt).getTime()-new Date(s.createdAt).getTime()).slice(0,10),[c]),W=g.useMemo(()=>w.map(s=>{const t=c.filter(d=>{if(d.building_id===s.id||d.buildingId===s.id)return!0;if(d.address){const j=d.address.toLowerCase(),f=s.name.toLowerCase().replace(/дом\s*/i,"").trim().toLowerCase();if(f&&j.includes(f+"-")||f&&j.includes(f+" "))return!0}return!1}),n=t.filter(d=>d.status==="completed").length,x=t.filter(d=>d.status==="new").length,o=t.filter(d=>["assigned","accepted","in_progress"].includes(d.status)).length;return{id:s.id,name:s.name,address:s.address,totalRequests:t.length,completed:n,pending:x,inProgress:o,completionRate:t.length>0?n/t.length*100:0}}).sort((s,t)=>t.totalRequests-s.totalRequests),[w,c]),q=g.useMemo(()=>{const s=new Map;return u.forEach(t=>{const n=t.specialization||"other";s.has(n)||s.set(n,{total:0,completed:0,avgRating:0,executorCount:0});const x=s.get(n);x.executorCount++,x.avgRating=(x.avgRating*(x.executorCount-1)+(t.rating||0))/x.executorCount}),c.forEach(t=>{const n=t.category||"other";s.has(n)||s.set(n,{total:0,completed:0,avgRating:0,executorCount:0});const x=s.get(n);x.total++,t.status==="completed"&&x.completed++}),Array.from(s.entries()).map(([t,n])=>({specialization:t,label:$[t]||t,...n,completionRate:n.total>0?n.completed/n.total*100:0})).sort((t,n)=>n.total-t.total)},[u,c]),oe=g.useMemo(()=>[...u].sort((s,t)=>(t.rating||0)-(s.rating||0)).slice(0,5),[u]),de=async()=>{H(!0),await Promise.all([b(),_(),F(),T(),K()]),H(!1)},y=g.useMemo(()=>{const s=[];for(let o=6;o>=0;o--){const d=new Date;d.setDate(d.getDate()-o);const j=d.toISOString().split("T")[0],C=d.toLocaleDateString(a==="ru"?"ru-RU":"uz-UZ",{weekday:"short"}),f=c.filter(A=>A.createdAt.startsWith(j)).length,E=c.filter(A=>A.completedAt?.startsWith(j)).length;s.push({day:C,created:f,completed:E})}const t=[{name:a==="ru"?"Новые":"Yangi",value:l.newRequests,color:"#3B82F6"},{name:a==="ru"?"В работе":"Jarayonda",value:l.inProgress,color:"#F59E0B"},{name:a==="ru"?"На проверке":"Tekshiruvda",value:l.pendingApproval,color:"#8B5CF6"},{name:a==="ru"?"Выполнено":"Bajarildi",value:l.completedTotal,color:"#10B981"}].filter(o=>o.value>0),n=[{name:a==="ru"?"Менеджеры":"Menejerlar",value:l.totalManagers,color:"#8B5CF6"},{name:a==="ru"?"Главы отделов":"Bo'lim boshliklari",value:l.totalDepartmentHeads,color:"#3B82F6"},{name:a==="ru"?"Исполнители":"Ijrochilar",value:l.totalExecutors,color:"#10B981"}].filter(o=>o.value>0),x=q.slice(0,6).map(o=>({name:o.label.length>8?o.label.slice(0,8)+"...":o.label,fullName:o.label,completed:o.completed,pending:o.total-o.completed,rate:Math.round(o.completionRate)}));return{weeklyData:s,statusData:t,staffData:n,deptPerformance:x}},[c,l,q,a]),r=s=>({"director.title":{ru:"Обзор компании",uz:"Kompaniya sharhi"},"director.subtitle":{ru:"Ключевые показатели и статистика",uz:"Asosiy ko'rsatkichlar va statistika"},"director.refresh":{ru:"Обновить",uz:"Yangilash"},"director.requests":{ru:"Заявки",uz:"Arizalar"},"director.new":{ru:"Новые",uz:"Yangi"},"director.inProgress":{ru:"В работе",uz:"Jarayonda"},"director.completed":{ru:"Выполнено",uz:"Bajarildi"},"director.thisWeek":{ru:"за неделю",uz:"hafta uchun"},"director.staff":{ru:"Сотрудники",uz:"Xodimlar"},"director.online":{ru:"Онлайн",uz:"Onlayn"},"director.avgRating":{ru:"Средний рейтинг",uz:"O'rtacha reyting"},"director.buildings":{ru:"Здания",uz:"Binolar"},"director.residents":{ru:"Жители",uz:"Aholisi"},"director.meetings":{ru:"Собрания",uz:"Yig'ilishlar"},"director.active":{ru:"Активные",uz:"Faol"},"director.announcements":{ru:"Объявления",uz:"E'lonlar"},"director.byBuilding":{ru:"По зданиям",uz:"Binolar bo'yicha"},"director.byDepartment":{ru:"По отделам",uz:"Bo'limlar bo'yicha"},"director.topPerformers":{ru:"Лучшие сотрудники",uz:"Eng yaxshi xodimlar"},"director.completionRate":{ru:"Выполнение",uz:"Bajarish"},"director.pending":{ru:"Ожидает",uz:"Kutmoqda"},"director.viewAll":{ru:"Смотреть все",uz:"Hammasini ko'rish"},"director.recentRequests":{ru:"Последние заявки",uz:"So'nggi arizalar"},"director.staffList":{ru:"Список сотрудников",uz:"Xodimlar ro'yxati"},"director.buildingsList":{ru:"Список зданий",uz:"Binolar ro'yxati"},"director.activityDetails":{ru:"Активность",uz:"Faollik"}})[s]?.[a]||s,xe=s=>{switch(s){case"new":return"bg-blue-100 text-blue-700";case"assigned":return"bg-yellow-100 text-yellow-700";case"in_progress":return"bg-orange-100 text-orange-700";case"completed":return"bg-green-100 text-green-700";case"pending_approval":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-700"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r("director.title")}),e.jsx("p",{className:"text-gray-500",children:r("director.subtitle")})]}),e.jsxs("button",{onClick:de,disabled:I,className:"btn-secondary flex items-center gap-2",children:[e.jsx(Ne,{className:`w-4 h-4 ${I?"animate-spin":""}`}),r("director.refresh")]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"glass-card p-5 cursor-pointer hover:shadow-lg transition-shadow active:scale-[0.98]",onClick:()=>h("requests"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(G,{className:"w-8 h-8 text-blue-500"}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full ${l.newRequests>10?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[l.newRequests," ",r("director.new")]})]}),e.jsx("div",{className:"text-2xl font-bold",children:l.totalRequests}),e.jsx("div",{className:"text-sm text-gray-500",children:r("director.requests")}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs",children:[e.jsxs("span",{className:"text-yellow-600",children:[l.inProgress," ",r("director.inProgress")]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsxs("span",{className:"text-green-600",children:[l.completedThisWeek," ",r("director.thisWeek")]})]})]}),e.jsxs("div",{className:"glass-card p-5 cursor-pointer hover:shadow-lg transition-shadow active:scale-[0.98]",onClick:()=>h("staff"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(L,{className:"w-8 h-8 text-purple-500"}),e.jsxs("span",{className:"text-xs px-2 py-1 rounded-full bg-green-100 text-green-700",children:[l.onlineExecutors," ",r("director.online")]})]}),e.jsx("div",{className:"text-2xl font-bold",children:l.totalStaff}),e.jsx("div",{className:"text-sm text-gray-500",children:r("director.staff")}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-xs flex-wrap",children:[e.jsxs("span",{className:"text-purple-600",children:[l.totalManagers," ",a==="ru"?"мен.":"men."]}),e.jsxs("span",{className:"text-blue-600",children:[l.totalDepartmentHeads," ",a==="ru"?"гл.":"bosh."]}),e.jsxs("span",{className:"text-green-600",children:[l.totalExecutors," ",a==="ru"?"исп.":"ijr."]})]})]}),e.jsxs("div",{className:"glass-card p-5 cursor-pointer hover:shadow-lg transition-shadow active:scale-[0.98]",onClick:()=>h("buildings"),children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx(P,{className:"w-8 h-8 text-teal-500"})}),e.jsx("div",{className:"text-2xl font-bold",children:l.totalBuildings}),e.jsx("div",{className:"text-sm text-gray-500",children:r("director.buildings")}),e.jsxs("div",{className:"mt-2 text-xs text-gray-600",children:[l.totalResidents," ",r("director.residents")]})]}),e.jsxs("div",{className:"glass-card p-5 cursor-pointer hover:shadow-lg transition-shadow active:scale-[0.98]",onClick:()=>h("activity"),children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsx(ye,{className:"w-8 h-8 text-orange-500"})}),e.jsxs("div",{className:"flex items-baseline gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.activeMeetings}),e.jsx("div",{className:"text-xs text-gray-500",children:r("director.meetings")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold",children:l.activeAnnouncements}),e.jsx("div",{className:"text-xs text-gray-500",children:r("director.announcements")})]})]})]})]}),e.jsxs("div",{className:"glass-card p-5 bg-gradient-to-r from-blue-50 to-purple-50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:r("director.completionRate")}),e.jsxs("div",{className:"text-3xl font-bold text-gray-900",children:[l.completionRate.toFixed(1),"%"]})]}),e.jsx("div",{className:"flex items-center gap-2",children:l.completionRate>=80?e.jsx(J,{className:"w-8 h-8 text-green-500"}):l.completionRate>=50?e.jsx(be,{className:"w-8 h-8 text-yellow-500"}):e.jsx(we,{className:"w-8 h-8 text-red-500"})})]}),e.jsx("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${l.completionRate>=80?"bg-green-500":l.completionRate>=50?"bg-orange-500":"bg-red-500"}`,style:{width:`${Math.min(l.completionRate,100)}%`}})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-500"}),a==="ru"?"Динамика заявок за неделю":"Haftalik arizalar dinamikasi"]}),e.jsx(B,{width:"100%",height:240,children:e.jsxs(_e,{data:y.weeklyData,children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorCreated",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorCompleted",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})]}),e.jsx(Q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ee,{dataKey:"day",tick:{fontSize:12}}),e.jsx(se,{tick:{fontSize:12}}),e.jsx(D,{}),e.jsx(S,{}),e.jsx(te,{type:"monotone",dataKey:"created",stroke:"#3B82F6",strokeWidth:2,fill:"url(#colorCreated)",name:a==="ru"?"Создано":"Yaratilgan"}),e.jsx(te,{type:"monotone",dataKey:"completed",stroke:"#10B981",strokeWidth:2,fill:"url(#colorCompleted)",name:a==="ru"?"Выполнено":"Bajarilgan"})]})})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(G,{className:"w-5 h-5 text-purple-500"}),a==="ru"?"Статусы заявок":"Ariza holatlari"]}),e.jsx(B,{width:"100%",height:240,children:e.jsxs(ae,{children:[e.jsx(le,{data:y.statusData,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,dataKey:"value",label:({name:s,percent:t})=>`${s} ${(t*100).toFixed(0)}%`,children:y.statusData.map((s,t)=>e.jsx(re,{fill:s.color},`cell-${t}`))}),e.jsx(D,{}),e.jsx(S,{})]})})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-green-500"}),a==="ru"?"Состав персонала":"Xodimlar tarkibi"]}),e.jsx(B,{width:"100%",height:240,children:e.jsxs(ae,{children:[e.jsx(le,{data:y.staffData,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,dataKey:"value",label:({name:s,percent:t})=>`${s} ${(t*100).toFixed(0)}%`,children:y.staffData.map((s,t)=>e.jsx(re,{fill:s.color},`cell-${t}`))}),e.jsx(D,{}),e.jsx(S,{})]})})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-orange-500"}),a==="ru"?"Эффективность отделов":"Bo'limlar samaradorligi"]}),e.jsx(B,{width:"100%",height:240,children:e.jsxs(Fe,{data:y.deptPerformance,children:[e.jsx(Q,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),e.jsx(ee,{dataKey:"name",tick:{fontSize:10}}),e.jsx(se,{tick:{fontSize:12}}),e.jsx(D,{}),e.jsx(S,{}),e.jsx(ie,{dataKey:"completed",stackId:"a",fill:"#10B981",name:a==="ru"?"Выполнено":"Bajarildi"}),e.jsx(ie,{dataKey:"pending",stackId:"a",fill:"#F59E0B",name:a==="ru"?"В работе":"Jarayonda"})]})})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"w-5 h-5 text-teal-500"}),r("director.byBuilding")]}),e.jsxs("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:[W.slice(0,10).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:s.address})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium",children:s.totalRequests}),e.jsx("div",{className:"text-xs text-gray-500",children:r("director.requests")})]}),e.jsxs("div",{className:`w-12 text-center text-xs font-medium px-2 py-1 rounded ${s.completionRate>=80?"bg-green-100 text-green-700":s.completionRate>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[s.completionRate.toFixed(0),"%"]})]})]},s.id)),W.length===0&&e.jsx("div",{className:"text-center text-gray-400 py-8",children:a==="ru"?"Нет данных":"Ma'lumot yo'q"})]})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-purple-500"}),r("director.byDepartment")]}),e.jsx("div",{className:"space-y-3 max-h-80 overflow-y-auto",children:q.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm",children:s.label}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.executorCount," ",a==="ru"?"сотр.":"xod.",s.avgRating>0&&e.jsxs("span",{className:"ml-2 text-yellow-600",children:[e.jsx(z,{className:"w-3 h-3 inline"})," ",s.avgRating.toFixed(1)]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 ml-2",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium",children:[s.completed,"/",s.total]}),e.jsx("div",{className:"text-xs text-gray-500",children:r("director.completed")})]}),e.jsxs("div",{className:`w-12 text-center text-xs font-medium px-2 py-1 rounded ${s.completionRate>=80?"bg-green-100 text-green-700":s.completionRate>=50?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[s.completionRate.toFixed(0),"%"]})]})]},s.specialization))})]})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-yellow-500"}),r("director.topPerformers")]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:oe.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${t===0?"bg-orange-500":t===1?"bg-gray-400":t===2?"bg-orange-400":"bg-gray-300"}`,children:t+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-yellow-600",children:[e.jsx(z,{className:"w-3 h-3"}),(s.rating||0).toFixed(1)]})]})]},s.id))})]}),l.pendingApproval>0&&e.jsx("div",{className:"glass-card p-4 border-2 border-orange-400 bg-orange-50 cursor-pointer hover:bg-orange-100 transition-colors",onClick:()=>p("/requests"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ae,{className:"w-6 h-6 text-yellow-600"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"font-medium text-yellow-800",children:[l.pendingApproval," ",a==="ru"?"заявок ожидают подтверждения":"arizalar tasdiqlanishni kutmoqda"]})}),e.jsx(Re,{className:"w-5 h-5 text-yellow-600"})]})}),e.jsx(M,{isOpen:k==="requests",onClose:()=>h(null),title:r("director.recentRequests"),children:e.jsxs("div",{className:"space-y-3",children:[ce.map(s=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.title}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-2 mt-1",children:[e.jsx(Z,{className:"w-3 h-3"}),$e(s.address,s.apartment)]}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1 flex items-center gap-2",children:[e.jsx(ke,{className:"w-3 h-3"}),new Date(s.createdAt).toLocaleDateString()]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${xe(s.status)}`,children:Oe[s.status]})]}),s.executorName&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 flex items-center gap-2",children:[e.jsx(L,{className:"w-3 h-3"}),s.executorName]})]},s.id)),e.jsxs("button",{onClick:()=>{h(null),p("/requests")},className:"w-full py-2 text-center text-blue-600 font-medium hover:bg-blue-50 rounded-xl",children:[r("director.viewAll")," →"]})]})}),e.jsx(M,{isOpen:k==="staff",onClose:()=>h(null),title:r("director.staffList"),children:e.jsxs("div",{className:"space-y-4",children:[m&&m.managers.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-purple-700 mb-2 flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),a==="ru"?"Менеджеры":"Menejerlar"," (",m.managers.length,")"]}),e.jsx("div",{className:"space-y-2",children:m.managers.map(s=>e.jsxs("div",{className:"p-3 bg-purple-50 rounded-xl flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold bg-purple-500",children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.phone})]}),e.jsx("div",{className:"text-xs text-purple-600 bg-purple-100 px-2 py-1 rounded",children:a==="ru"?"Менеджер":"Menejer"})]},s.id))})]}),m&&m.departmentHeads.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-blue-700 mb-2 flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),a==="ru"?"Главы отделов":"Bo'lim boshliklari"," (",m.departmentHeads.length,")"]}),e.jsx("div",{className:"space-y-2",children:m.departmentHeads.map(s=>e.jsxs("div",{className:"p-3 bg-blue-50 rounded-xl flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold bg-blue-500",children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:$[s.specialization]||s.specialization||""})]}),e.jsx("div",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded",children:a==="ru"?"Глава":"Boshlik"})]},s.id))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-sm text-green-700 mb-2 flex items-center gap-2",children:[e.jsx(Be,{className:"w-4 h-4"}),a==="ru"?"Исполнители":"Ijrochilar"," (",m?.executors.length||u.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:(m?.executors||u).slice(0,10).map(s=>e.jsxs("div",{className:"p-3 bg-green-50 rounded-xl flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold ${s.status==="available"?"bg-green-500":s.status==="busy"?"bg-orange-500":"bg-gray-400"}`,children:s.name.charAt(0)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:$[s.specialization]||s.specialization||""})]}),e.jsxs("div",{className:"text-right",children:[(s.avg_rating||s.rating)&&e.jsxs("div",{className:"flex items-center gap-1 text-yellow-600",children:[e.jsx(z,{className:"w-4 h-4"}),(s.avg_rating||s.rating||0).toFixed(1)]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.completed_count||0," ",a==="ru"?"вып.":"baj."]})]})]},s.id))})]}),e.jsxs("button",{onClick:()=>{h(null),p("/team")},className:"w-full py-2 text-center text-blue-600 font-medium hover:bg-blue-50 rounded-xl",children:[r("director.viewAll")," →"]})]})}),e.jsx(M,{isOpen:k==="buildings",onClose:()=>h(null),title:r("director.buildingsList"),children:e.jsxs("div",{className:"space-y-3",children:[w.slice(0,15).map(s=>e.jsx("div",{className:"p-3 bg-gray-50 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(P,{className:"w-8 h-8 text-teal-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1 mt-1",children:[e.jsx(Z,{className:"w-3 h-3"}),s.address]}),s.totalApartments&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[s.totalApartments," ",a==="ru"?"квартир":"xonadon"]})]})]})},s.id)),e.jsxs("button",{onClick:()=>{h(null),p("/buildings")},className:"w-full py-2 text-center text-blue-600 font-medium hover:bg-blue-50 rounded-xl",children:[r("director.viewAll")," →"]})]})}),e.jsx(M,{isOpen:k==="activity",onClose:()=>h(null),title:r("director.activityDetails"),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2 mb-3",children:[e.jsx(De,{className:"w-5 h-5 text-purple-500"}),r("director.meetings")," (",l.activeMeetings,")"]}),e.jsxs("div",{className:"space-y-2",children:[R.filter(s=>["schedule_poll_open","schedule_confirmed","voting_open"].includes(s.status)).slice(0,5).map(s=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{className:"font-medium text-sm",children:["#",s.number]}),e.jsx("div",{className:"text-xs text-gray-500",children:s.buildingAddress}),e.jsx("div",{className:`text-xs mt-1 ${s.status==="voting_open"?"text-green-600":"text-blue-600"}`,children:s.status==="voting_open"?a==="ru"?"Голосование открыто":"Ovoz berish ochiq":s.status==="schedule_poll_open"?a==="ru"?"Опрос по дате":"Sana so'rovi":a==="ru"?"Дата подтверждена":"Sana tasdiqlandi"})]},s.id)),R.filter(s=>["schedule_poll_open","schedule_confirmed","voting_open"].includes(s.status)).length===0&&e.jsx("div",{className:"text-gray-400 text-sm text-center py-4",children:a==="ru"?"Нет активных собраний":"Faol yig'ilishlar yo'q"})]}),e.jsxs("button",{onClick:()=>{h(null),p("/meetings")},className:"w-full py-2 text-center text-blue-600 font-medium hover:bg-blue-50 rounded-xl mt-2",children:[r("director.viewAll")," →"]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2 mb-3",children:[e.jsx(Se,{className:"w-5 h-5 text-orange-500"}),r("director.announcements")," (",l.activeAnnouncements,")"]}),e.jsxs("div",{className:"space-y-2",children:[N.filter(s=>s.isActive).slice(0,5).map(s=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-xl",children:[e.jsx("div",{className:"font-medium text-sm",children:s.title}),e.jsx("div",{className:"text-xs text-gray-500 line-clamp-2 mt-1",children:s.content}),e.jsx("div",{className:`text-xs mt-1 px-2 py-0.5 rounded inline-block ${s.priority==="urgent"?"bg-red-100 text-red-700":s.priority==="important"?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-600"}`,children:s.priority==="urgent"?a==="ru"?"Срочно":"Shoshilinch":s.priority==="important"?a==="ru"?"Важно":"Muhim":a==="ru"?"Обычный":"Oddiy"})]},s.id)),N.filter(s=>s.isActive).length===0&&e.jsx("div",{className:"text-gray-400 text-sm text-center py-4",children:a==="ru"?"Нет активных объявлений":"Faol e'lonlar yo'q"})]}),e.jsxs("button",{onClick:()=>{h(null),p("/announcements")},className:"w-full py-2 text-center text-blue-600 font-medium hover:bg-blue-50 rounded-xl mt-2",children:[r("director.viewAll")," →"]})]})]})})]})}export{Je as DirectorDashboard};
//# sourceMappingURL=DirectorDashboard-1768649091948-DbnRWgUW.js.map
