import{r as c,j as e,M as b,a1 as k,A as C,as as $,N as B,I}from"./react-vendor-1768905939422-Et55y-vN.js";import{b as R,u as q,d as D}from"./index-1768905939422-vggQEZK_.js";import"./vendor-1768905939422-D3d_xxNa.js";import"./qr-scanner-1768905939422-cr32YHjo.js";import"./zustand-1768905939422-wNUYBKDB.js";function P(){const{user:r}=R(),{getAnnouncementsForResidents:p,markAnnouncementAsViewed:f,fetchAnnouncements:o}=q(),{language:t}=D(),[x,m]=c.useState(null),[a,u]=c.useState("all");c.useEffect(()=>{o()},[o]);const y=r?.login||"",j=r?.buildingId||"",N=r?.entrance||"",w=r?.floor||"",v=r?.branch||"",l=p(y,j,N,w,v),g=a==="unread"?l.filter(s=>!s.viewedBy.includes(r?.id||"")):l,d=l.filter(s=>!s.viewedBy.includes(r?.id||"")).length,A=s=>{x===s.id?m(null):(m(s.id),r?.id&&!s.viewedBy.includes(r.id)&&f(s.id,r.id))},E=s=>{switch(s){case"urgent":return{bg:"bg-red-50 border-red-200",badge:"bg-red-100 text-red-700",icon:e.jsx(I,{className:"w-5 h-5 text-red-500"}),label:t==="ru"?"Срочно":"Shoshilinch"};case"important":return{bg:"bg-amber-50 border-amber-200",badge:"bg-amber-100 text-amber-700",icon:e.jsx(B,{className:"w-5 h-5 text-amber-500"}),label:t==="ru"?"Важно":"Muhim"};default:return{bg:"bg-blue-50 border-blue-200",badge:"bg-blue-100 text-blue-700",icon:e.jsx($,{className:"w-5 h-5 text-blue-500"}),label:t==="ru"?"Информация":"Ma'lumot"}}},S=s=>new Date(s).toLocaleDateString(t==="ru"?"ru-RU":"uz-UZ",{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-4 md:space-y-6 pb-20 md:pb-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-xl md:text-2xl font-bold flex items-center gap-3",children:[e.jsx(b,{className:"w-7 h-7 text-primary-500"}),t==="ru"?"Объявления":"E'lonlar"]}),d>0&&e.jsxs("span",{className:"px-3 py-1 rounded-full bg-yellow-100 text-yellow-700 text-sm font-medium",children:[d," ",t==="ru"?"новых":"yangi"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>u("all"),className:`px-4 py-2 rounded-xl font-medium text-sm transition-colors ${a==="all"?"bg-primary-500 text-gray-900":"bg-white/60 text-gray-600 hover:bg-white/80"}`,children:[t==="ru"?"Все":"Hammasi"," (",l.length,")"]}),e.jsxs("button",{onClick:()=>u("unread"),className:`px-4 py-2 rounded-xl font-medium text-sm transition-colors ${a==="unread"?"bg-primary-500 text-gray-900":"bg-white/60 text-gray-600 hover:bg-white/80"}`,children:[t==="ru"?"Непрочитанные":"O'qilmagan"," (",d,")"]})]}),g.length===0?e.jsxs("div",{className:"glass-card p-8 text-center",children:[e.jsx(b,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:a==="unread"?t==="ru"?"Нет новых объявлений":"Yangi e'lonlar yo'q":t==="ru"?"Объявлений пока нет":"E'lonlar yo'q"})]}):e.jsx("div",{className:"space-y-3",children:g.map(s=>{const i=!s.viewedBy.includes(r?.id||""),h=x===s.id,n=E(s.priority);return e.jsx("div",{className:`glass-card p-4 border-2 cursor-pointer transition-all ${n.bg} ${i?"ring-2 ring-yellow-400 ring-offset-2":""}`,onClick:()=>A(s),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:n.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[i&&e.jsx("span",{className:"px-2 py-0.5 rounded-full bg-yellow-400 text-yellow-900 text-xs font-medium",children:t==="ru"?"Новое":"Yangi"}),e.jsx("span",{className:`px-2 py-0.5 rounded-lg text-xs font-medium ${n.badge}`,children:n.label})]}),e.jsx("h3",{className:"font-semibold text-base text-gray-900 mb-1",children:s.title}),e.jsx("p",{className:`text-gray-600 text-sm ${h?"":"line-clamp-2"}`,children:s.content}),e.jsxs("div",{className:"flex items-center gap-3 mt-3 text-xs text-gray-500",children:[e.jsx("span",{children:S(s.createdAt)}),e.jsx("span",{children:s.authorName}),!i&&e.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(k,{className:"w-3 h-3"}),t==="ru"?"Прочитано":"O'qilgan"]})]})]}),e.jsx(C,{className:`w-5 h-5 text-gray-400 flex-shrink-0 transition-transform ${h?"rotate-90":""}`})]})},s.id)})})]})}export{P as ResidentAnnouncementsPage};
//# sourceMappingURL=ResidentAnnouncementsPage-1768905939422-XZ5Qqwqz.js.map
