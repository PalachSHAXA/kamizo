{"version":3,"file":"RequestsPage-1767960438672-D7akHkav.js","sources":["../../src/pages/shared/RequestsPage.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { Search, MapPin, Loader2, Plus, X, ChevronRight, User, Building2, GitBranch } from 'lucide-react';\nimport { useDataStore } from '../../stores/dataStore';\nimport { useAuthStore } from '../../stores/authStore';\nimport { SPECIALIZATION_LABELS } from '../../types';\nimport { branchesApi, buildingsApi, usersApi } from '../../services/api';\nimport { formatAddress } from '../../utils/formatAddress';\nimport type { ExecutorSpecialization, RequestPriority } from '../../types';\n\nexport function RequestsPage() {\n  const { user } = useAuthStore();\n  const { requests, executors, assignRequest, addRequest, fetchRequests, fetchExecutors, isLoadingRequests } = useDataStore();\n  const [searchParams] = useSearchParams();\n  const statusFilter = searchParams.get('status') || 'all';\n  const [filter, setFilter] = useState(statusFilter);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [showAssignModal, setShowAssignModal] = useState<string | null>(null);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n\n  // Check if user can create requests (manager, admin, director)\n  const canCreateRequest = ['manager', 'admin', 'director'].includes(user?.role || '');\n\n  // Update filter when URL changes\n  useEffect(() => {\n    setFilter(statusFilter);\n  }, [statusFilter]);\n\n  // Check if user is department head - they can only see their department's requests\n  const isDepartmentHead = user?.role === 'department_head';\n  const userSpecialization = user?.specialization;\n\n  // Filter requests by department if user is department head\n  const departmentRequests = useMemo(() => {\n    if (isDepartmentHead && userSpecialization) {\n      return requests.filter(r => r.category === userSpecialization);\n    }\n    return requests;\n  }, [requests, isDepartmentHead, userSpecialization]);\n\n  // Filter executors by department if user is department head\n  const departmentExecutors = useMemo(() => {\n    if (isDepartmentHead && userSpecialization) {\n      return executors.filter(e => e.specialization === userSpecialization);\n    }\n    return executors;\n  }, [executors, isDepartmentHead, userSpecialization]);\n\n  // Fetch requests and executors from D1 database on mount\n  useEffect(() => {\n    fetchRequests();\n    fetchExecutors();\n  }, [fetchRequests, fetchExecutors]);\n\n  // Refetch executors when assignment modal opens to ensure fresh data\n  useEffect(() => {\n    if (showAssignModal) {\n      fetchExecutors();\n    }\n  }, [showAssignModal, fetchExecutors]);\n\n  const getStatusBadge = (status: string) => {\n    switch (status) {\n      case 'new': return <span className=\"badge badge-new\">Новая</span>;\n      case 'assigned': return <span className=\"badge bg-indigo-100 text-indigo-700\">Назначена</span>;\n      case 'accepted': return <span className=\"badge bg-cyan-100 text-cyan-700\">Принята</span>;\n      case 'in_progress': return <span className=\"badge badge-progress\">В работе</span>;\n      case 'pending_approval': return <span className=\"badge bg-purple-100 text-purple-700\">Ожидает подтверждения</span>;\n      case 'completed': return <span className=\"badge badge-done\">Выполнена</span>;\n      default: return <span className=\"badge\">{status}</span>;\n    }\n  };\n\n  // Filter by status and search query\n  const filteredRequests = departmentRequests.filter(r => {\n    let matchesStatus = false;\n\n    if (filter === 'all') {\n      matchesStatus = true;\n    } else if (filter === 'in_progress') {\n      // \"В работе\" includes assigned, accepted, and in_progress statuses\n      matchesStatus = ['assigned', 'accepted', 'in_progress'].includes(r.status);\n    } else {\n      matchesStatus = r.status === filter;\n    }\n\n    const matchesSearch = searchQuery === '' ||\n      r.title.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      r.residentName?.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      r.number.toString().includes(searchQuery) ||\n      r.address?.toLowerCase().includes(searchQuery.toLowerCase());\n    return matchesStatus && matchesSearch;\n  });\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">\n            {isDepartmentHead ? 'Заявки отдела' : 'Заявки'}\n          </h1>\n          {isDepartmentHead && userSpecialization && (\n            <p className=\"text-gray-500 text-sm mt-1\">\n              Отдел: {SPECIALIZATION_LABELS[userSpecialization as ExecutorSpecialization]}\n            </p>\n          )}\n        </div>\n        {canCreateRequest && (\n          <button\n            onClick={() => setShowCreateModal(true)}\n            className=\"btn-primary flex items-center gap-2\"\n          >\n            <Plus className=\"w-5 h-5\" />\n            <span className=\"hidden sm:inline\">Создать заявку</span>\n          </button>\n        )}\n      </div>\n\n      {/* Filters */}\n      <div className=\"glass-card p-4 flex items-center gap-4\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400\" />\n          <input\n            type=\"text\"\n            placeholder=\"Поиск по номеру, названию, адресу...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"glass-input pl-10\"\n          />\n        </div>\n        <select\n          value={filter}\n          onChange={(e) => setFilter(e.target.value)}\n          className=\"glass-input w-48\"\n        >\n          <option value=\"all\">Все статусы</option>\n          <option value=\"new\">Новые</option>\n          <option value=\"assigned\">Назначенные</option>\n          <option value=\"accepted\">Принятые</option>\n          <option value=\"in_progress\">В работе</option>\n          <option value=\"pending_approval\">Ожидают подтверждения</option>\n          <option value=\"completed\">Выполненные</option>\n        </select>\n      </div>\n\n      {/* Requests List */}\n      {isLoadingRequests ? (\n        <div className=\"flex justify-center items-center py-12\">\n          <Loader2 className=\"w-8 h-8 animate-spin text-primary-600\" />\n          <span className=\"ml-3 text-gray-600\">Загрузка заявок...</span>\n        </div>\n      ) : filteredRequests.length === 0 ? (\n        <div className=\"glass-card p-8 text-center text-gray-500\">\n          Заявки не найдены\n        </div>\n      ) : (\n      <div className=\"space-y-3\">\n        {filteredRequests.map((req) => (\n          <div key={req.id} className=\"glass-card p-5\">\n            <div className=\"flex items-start justify-between\">\n              <div className=\"flex gap-4\">\n                <div className={`w-3 h-3 mt-1.5 rounded-full ${req.priority === 'urgent' ? 'bg-red-500' : req.priority === 'high' ? 'bg-orange-500' : req.priority === 'medium' ? 'bg-amber-500' : 'bg-gray-400'}`}></div>\n                <div>\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-sm text-gray-500\">#{req.number}</span>\n                    <h3 className=\"font-semibold text-lg\">{req.title}</h3>\n                    {getStatusBadge(req.status)}\n                  </div>\n                  <div className=\"text-sm text-gray-600 mt-1\">\n                    <span className=\"font-medium\">{SPECIALIZATION_LABELS[req.category]}</span> • {req.residentName}\n                  </div>\n                  <div className=\"flex items-center gap-4 mt-2 text-sm text-gray-500\">\n                    <span className=\"flex items-center gap-1\">\n                      <MapPin className=\"w-4 h-4\" />\n                      {formatAddress(req.address, req.apartment)}\n                    </span>\n                  </div>\n                  {req.executorName && (\n                    <div className=\"mt-2 text-sm text-primary-600\">\n                      Исполнитель: {req.executorName}\n                    </div>\n                  )}\n                </div>\n              </div>\n              <div className=\"flex gap-2\">\n                {req.status === 'new' && (\n                  <button\n                    onClick={() => setShowAssignModal(req.id)}\n                    className=\"btn-primary text-sm py-2 px-4\"\n                  >\n                    Назначить\n                  </button>\n                )}\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n      )}\n\n      {/* Assign Modal */}\n      {showAssignModal && (\n        <div className=\"modal-backdrop\">\n          <div className=\"modal-content p-6 w-full max-w-md mx-4\">\n            <h2 className=\"text-xl font-bold mb-4\">Назначить исполнителя</h2>\n            <div className=\"space-y-3\">\n              {departmentExecutors.length === 0 ? (\n                <p className=\"text-gray-500 text-center py-4\">Загрузка исполнителей...</p>\n              ) : (\n                departmentExecutors.map((executor) => (\n                  <button\n                    key={executor.id}\n                    onClick={() => {\n                      assignRequest(showAssignModal, executor.id);\n                      setShowAssignModal(null);\n                    }}\n                    className=\"w-full p-4 bg-white/30 hover:bg-white/50 rounded-xl text-left transition-colors\"\n                  >\n                    <div className=\"font-medium\">{executor.name}</div>\n                    <div className=\"text-sm text-gray-500\">\n                      {SPECIALIZATION_LABELS[executor.specialization]} • {executor.activeRequests} активных заявок\n                    </div>\n                  </button>\n                ))\n              )}\n            </div>\n            <button\n              onClick={() => setShowAssignModal(null)}\n              className=\"btn-secondary w-full mt-4\"\n            >\n              Отмена\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Create Request Modal */}\n      {showCreateModal && (\n        <CreateRequestModal\n          onClose={() => setShowCreateModal(false)}\n          onSubmit={async (data) => {\n            await addRequest(data);\n            setShowCreateModal(false);\n          }}\n        />\n      )}\n    </div>\n  );\n}\n\n// Types for resident selection\ninterface Branch {\n  id: string;\n  code: string;\n  name: string;\n}\n\ninterface Building {\n  id: string;\n  name: string;\n  address: string;\n  branch_code: string;\n}\n\ninterface Resident {\n  id: string;\n  name: string;\n  phone: string;\n  address: string;\n  apartment: string;\n  building_id: string;\n}\n\n// Create Request Modal for managers/admins\nfunction CreateRequestModal({\n  onClose,\n  onSubmit\n}: {\n  onClose: () => void;\n  onSubmit: (data: {\n    title: string;\n    description: string;\n    category: ExecutorSpecialization;\n    priority: RequestPriority;\n    residentId: string;\n    residentName: string;\n    residentPhone: string;\n    address: string;\n    apartment: string;\n    scheduledDate?: string;\n    scheduledTime?: string;\n  }) => void;\n}) {\n  const [title, setTitle] = useState('');\n  const [description, setDescription] = useState('');\n  const [category, setCategory] = useState<ExecutorSpecialization>('plumber');\n  const [priority, setPriority] = useState<RequestPriority>('medium');\n  const [scheduledDate, setScheduledDate] = useState('');\n  const [scheduledTime, setScheduledTime] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Cascading selection state\n  const [branches, setBranches] = useState<Branch[]>([]);\n  const [buildings, setBuildings] = useState<Building[]>([]);\n  const [residents, setResidents] = useState<Resident[]>([]);\n\n  const [selectedBranch, setSelectedBranch] = useState<string>('');\n  const [selectedBuilding, setSelectedBuilding] = useState<string>('');\n  const [selectedResident, setSelectedResident] = useState<Resident | null>(null);\n\n  const [loadingBranches, setLoadingBranches] = useState(false);\n  const [loadingBuildings, setLoadingBuildings] = useState(false);\n  const [loadingResidents, setLoadingResidents] = useState(false);\n\n  // Load branches on mount\n  useEffect(() => {\n    const loadBranches = async () => {\n      setLoadingBranches(true);\n      try {\n        const data = await branchesApi.getAll();\n        setBranches(data.branches || []);\n      } catch (error) {\n        console.error('Failed to load branches:', error);\n      } finally {\n        setLoadingBranches(false);\n      }\n    };\n    loadBranches();\n  }, []);\n\n  // Load buildings when branch changes\n  useEffect(() => {\n    if (!selectedBranch) {\n      setBuildings([]);\n      setSelectedBuilding('');\n      setResidents([]);\n      setSelectedResident(null);\n      return;\n    }\n\n    const loadBuildings = async () => {\n      setLoadingBuildings(true);\n      setSelectedBuilding('');\n      setResidents([]);\n      setSelectedResident(null);\n      try {\n        const data = await buildingsApi.getAll();\n        const filteredBuildings = (data.buildings || []).filter(\n          (b: Building) => b.branch_code === selectedBranch\n        );\n        setBuildings(filteredBuildings);\n      } catch (error) {\n        console.error('Failed to load buildings:', error);\n      } finally {\n        setLoadingBuildings(false);\n      }\n    };\n    loadBuildings();\n  }, [selectedBranch]);\n\n  // Load residents when building changes\n  useEffect(() => {\n    if (!selectedBuilding) {\n      setResidents([]);\n      setSelectedResident(null);\n      return;\n    }\n\n    const loadResidents = async () => {\n      setLoadingResidents(true);\n      setSelectedResident(null);\n      try {\n        const data = await usersApi.getAll({ role: 'resident', building_id: selectedBuilding, limit: 500 });\n        setResidents(data.users || []);\n      } catch (error) {\n        console.error('Failed to load residents:', error);\n      } finally {\n        setLoadingResidents(false);\n      }\n    };\n    loadResidents();\n  }, [selectedBuilding]);\n\n  const categories: { value: ExecutorSpecialization; label: string }[] = [\n    { value: 'plumber', label: 'Сантехник' },\n    { value: 'electrician', label: 'Электрик' },\n    { value: 'security', label: 'Охрана' },\n    { value: 'cleaning', label: 'Уборка' },\n    { value: 'elevator', label: 'Лифт' },\n    { value: 'intercom', label: 'Домофон' },\n    { value: 'carpenter', label: 'Плотник' },\n    { value: 'boiler', label: 'Котёл' },\n    { value: 'other', label: 'Другое' },\n  ];\n\n  const timeSlots = [\n    { value: '09:00-11:00', label: '09:00 - 11:00' },\n    { value: '11:00-13:00', label: '11:00 - 13:00' },\n    { value: '13:00-15:00', label: '13:00 - 15:00' },\n    { value: '15:00-17:00', label: '15:00 - 17:00' },\n    { value: '17:00-19:00', label: '17:00 - 19:00' },\n  ];\n\n  const getMinDate = () => {\n    const today = new Date();\n    return today.toISOString().split('T')[0];\n  };\n\n  const getMaxDate = () => {\n    const maxDate = new Date();\n    maxDate.setDate(maxDate.getDate() + 30);\n    return maxDate.toISOString().split('T')[0];\n  };\n\n  const handleResidentSelect = (residentId: string) => {\n    const resident = residents.find(r => r.id === residentId);\n    setSelectedResident(resident || null);\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!title.trim() || !description.trim() || !selectedResident) return;\n\n    setIsSubmitting(true);\n    try {\n      await onSubmit({\n        title,\n        description,\n        category,\n        priority,\n        residentId: selectedResident.id,\n        residentName: selectedResident.name,\n        residentPhone: selectedResident.phone || 'Не указан',\n        address: selectedResident.address || buildings.find(b => b.id === selectedBuilding)?.address || '',\n        apartment: selectedResident.apartment || '0',\n        scheduledDate: scheduledDate || undefined,\n        scheduledTime: scheduledTime || undefined,\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const selectedBranchName = branches.find(b => b.code === selectedBranch)?.name;\n  const selectedBuildingData = buildings.find(b => b.id === selectedBuilding);\n\n  return (\n    <div className=\"modal-backdrop\">\n      <div className=\"modal-content p-6 w-full max-w-lg mx-4 max-h-[90vh] overflow-y-auto\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <h2 className=\"text-xl font-bold\">Создать заявку</h2>\n          <button onClick={onClose} className=\"p-2 hover:bg-gray-100 rounded-lg\">\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          {/* Category */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Категория *\n            </label>\n            <select\n              value={category}\n              onChange={(e) => setCategory(e.target.value as ExecutorSpecialization)}\n              className=\"glass-input w-full\"\n              required\n            >\n              {categories.map(cat => (\n                <option key={cat.value} value={cat.value}>{cat.label}</option>\n              ))}\n            </select>\n          </div>\n\n          {/* Title */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Заголовок *\n            </label>\n            <input\n              type=\"text\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              className=\"glass-input w-full\"\n              placeholder=\"Кратко опишите проблему\"\n              required\n            />\n          </div>\n\n          {/* Description */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Описание *\n            </label>\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              className=\"glass-input w-full min-h-[100px] resize-none\"\n              placeholder=\"Подробное описание проблемы\"\n              required\n            />\n          </div>\n\n          {/* Priority */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Приоритет\n            </label>\n            <div className=\"grid grid-cols-4 gap-2\">\n              {(['low', 'medium', 'high', 'urgent'] as RequestPriority[]).map((p) => (\n                <button\n                  key={p}\n                  type=\"button\"\n                  onClick={() => setPriority(p)}\n                  className={`py-2 px-3 rounded-lg text-sm font-medium transition-all ${\n                    priority === p\n                      ? p === 'urgent' ? 'bg-red-500 text-white' :\n                        p === 'high' ? 'bg-orange-500 text-white' :\n                        p === 'medium' ? 'bg-amber-500 text-white' :\n                        'bg-gray-500 text-white'\n                      : 'bg-gray-100 text-gray-600 hover:bg-gray-200'\n                  }`}\n                >\n                  {p === 'low' ? 'Низкий' : p === 'medium' ? 'Средний' : p === 'high' ? 'Высокий' : 'Срочный'}\n                </button>\n              ))}\n            </div>\n          </div>\n\n          {/* Resident Selection - Cascading */}\n          <div className=\"border-t pt-4 mt-4\">\n            <h3 className=\"font-medium text-gray-900 mb-3 flex items-center gap-2\">\n              <User className=\"w-5 h-5\" />\n              Выбор жителя\n            </h3>\n\n            {/* Branch Selection */}\n            <div className=\"mb-3\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-1\">\n                <GitBranch className=\"w-4 h-4\" />\n                Филиал *\n              </label>\n              <select\n                value={selectedBranch}\n                onChange={(e) => setSelectedBranch(e.target.value)}\n                className=\"glass-input w-full\"\n                disabled={loadingBranches}\n              >\n                <option value=\"\">\n                  {loadingBranches ? 'Загрузка...' : 'Выберите филиал'}\n                </option>\n                {branches.map(branch => (\n                  <option key={branch.code} value={branch.code}>{branch.name}</option>\n                ))}\n              </select>\n            </div>\n\n            {/* Building Selection */}\n            <div className=\"mb-3\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-1\">\n                <Building2 className=\"w-4 h-4\" />\n                Дом *\n              </label>\n              <select\n                value={selectedBuilding}\n                onChange={(e) => setSelectedBuilding(e.target.value)}\n                className=\"glass-input w-full\"\n                disabled={!selectedBranch || loadingBuildings}\n              >\n                <option value=\"\">\n                  {loadingBuildings ? 'Загрузка...' : !selectedBranch ? 'Сначала выберите филиал' : 'Выберите дом'}\n                </option>\n                {buildings.map(building => (\n                  <option key={building.id} value={building.id}>\n                    {building.name} - {building.address}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Resident Selection */}\n            <div className=\"mb-3\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-1\">\n                <User className=\"w-4 h-4\" />\n                Житель *\n              </label>\n              <select\n                value={selectedResident?.id || ''}\n                onChange={(e) => handleResidentSelect(e.target.value)}\n                className=\"glass-input w-full\"\n                disabled={!selectedBuilding || loadingResidents}\n              >\n                <option value=\"\">\n                  {loadingResidents ? 'Загрузка...' : !selectedBuilding ? 'Сначала выберите дом' : 'Выберите жителя'}\n                </option>\n                {residents.map(resident => (\n                  <option key={resident.id} value={resident.id}>\n                    {resident.name} {resident.apartment ? `- кв. ${resident.apartment}` : ''}\n                  </option>\n                ))}\n              </select>\n            </div>\n\n            {/* Selected Resident Info */}\n            {selectedResident && (\n              <div className=\"bg-primary-50 border border-primary-200 rounded-xl p-4 mt-3\">\n                <div className=\"flex items-start gap-3\">\n                  <div className=\"w-10 h-10 rounded-full bg-primary-100 flex items-center justify-center\">\n                    <User className=\"w-5 h-5 text-primary-600\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"font-semibold text-gray-900\">{selectedResident.name}</p>\n                    <p className=\"text-sm text-gray-600\">\n                      {selectedResident.phone || 'Телефон не указан'}\n                    </p>\n                    <p className=\"text-sm text-gray-500 flex items-center gap-1 mt-1\">\n                      <MapPin className=\"w-3 h-3\" />\n                      {selectedBuildingData?.address || selectedResident.address}\n                      {selectedResident.apartment && `, кв. ${selectedResident.apartment}`}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Selection Path Display */}\n            {(selectedBranchName || selectedBuildingData) && (\n              <div className=\"flex items-center gap-1 text-xs text-gray-500 mt-2 flex-wrap\">\n                {selectedBranchName && (\n                  <>\n                    <span className=\"bg-gray-100 px-2 py-1 rounded\">{selectedBranchName}</span>\n                    {selectedBuildingData && <ChevronRight className=\"w-3 h-3\" />}\n                  </>\n                )}\n                {selectedBuildingData && (\n                  <>\n                    <span className=\"bg-gray-100 px-2 py-1 rounded\">{selectedBuildingData.name}</span>\n                    {selectedResident && <ChevronRight className=\"w-3 h-3\" />}\n                  </>\n                )}\n                {selectedResident && (\n                  <span className=\"bg-primary-100 text-primary-700 px-2 py-1 rounded\">\n                    {selectedResident.name}\n                  </span>\n                )}\n              </div>\n            )}\n          </div>\n\n          {/* Schedule */}\n          <div className=\"border-t pt-4 mt-4\">\n            <h3 className=\"font-medium text-gray-900 mb-3\">Желаемое время (опционально)</h3>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Дата\n                </label>\n                <input\n                  type=\"date\"\n                  value={scheduledDate}\n                  onChange={(e) => setScheduledDate(e.target.value)}\n                  className=\"glass-input w-full\"\n                  min={getMinDate()}\n                  max={getMaxDate()}\n                />\n              </div>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Время\n                </label>\n                <select\n                  value={scheduledTime}\n                  onChange={(e) => setScheduledTime(e.target.value)}\n                  className=\"glass-input w-full\"\n                >\n                  <option value=\"\">Любое время</option>\n                  {timeSlots.map(slot => (\n                    <option key={slot.value} value={slot.value}>{slot.label}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {/* Actions */}\n          <div className=\"flex gap-3 pt-4 border-t\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"btn-secondary flex-1\"\n            >\n              Отмена\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isSubmitting || !title.trim() || !description.trim() || !selectedResident}\n              className=\"btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {isSubmitting ? 'Создание...' : 'Создать заявку'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n"],"names":["RequestsPage","user","useAuthStore","requests","executors","assignRequest","addRequest","fetchRequests","fetchExecutors","isLoadingRequests","useDataStore","searchParams","useSearchParams","statusFilter","filter","setFilter","useState","searchQuery","setSearchQuery","showAssignModal","setShowAssignModal","showCreateModal","setShowCreateModal","canCreateRequest","useEffect","isDepartmentHead","userSpecialization","departmentRequests","useMemo","r","departmentExecutors","e","getStatusBadge","status","jsx","filteredRequests","matchesStatus","matchesSearch","jsxs","SPECIALIZATION_LABELS","Plus","Search","Loader2","req","MapPin","formatAddress","executor","CreateRequestModal","data","onClose","onSubmit","title","setTitle","description","setDescription","category","setCategory","priority","setPriority","scheduledDate","setScheduledDate","scheduledTime","setScheduledTime","isSubmitting","setIsSubmitting","branches","setBranches","buildings","setBuildings","residents","setResidents","selectedBranch","setSelectedBranch","selectedBuilding","setSelectedBuilding","selectedResident","setSelectedResident","loadingBranches","setLoadingBranches","loadingBuildings","setLoadingBuildings","loadingResidents","setLoadingResidents","branchesApi","filteredBuildings","buildingsApi","b","usersApi","categories","timeSlots","getMinDate","getMaxDate","maxDate","handleResidentSelect","residentId","resident","handleSubmit","selectedBranchName","selectedBuildingData","X","cat","p","User","GitBranch","branch","Building2","building","Fragment","ChevronRight","slot"],"mappings":"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"}