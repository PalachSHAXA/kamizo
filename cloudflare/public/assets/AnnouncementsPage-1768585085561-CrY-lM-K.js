const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-1768585085561-DY3gV71t.js","assets/react-vendor-1768585085561-CM8YoXKY.js","assets/vendor-1768585085561-eDq9GBqE.js","assets/qr-scanner-1768585085561-cr32YHjo.js","assets/zustand-1768585085561-wNUYBKDB.js","assets/index-1768585085561-CLg_B8um.css"])))=>i.map(i=>d[i]);
import{b as Be,u as Me,d as De,j as Ee,_ as ce,k as Te}from"./index-1768585085561-DY3gV71t.js";import{r as o,j as e,au as Pe,h as J,a1 as re,aH as _e,M as Ie,X as P,aq as O,B as ne,aI as le,aJ as ie,aK as Le,aL as de,F as me,aM as xe,aa as ze,z as Re,$ as oe,a8 as Ue,as as qe,J as Ve,E as He}from"./react-vendor-1768585085561-CM8YoXKY.js";import"./zustand-1768585085561-wNUYBKDB.js";import"./vendor-1768585085561-eDq9GBqE.js";import"./qr-scanner-1768585085561-cr32YHjo.js";function Ze(){const{user:s}=Be(),{announcements:N,addAnnouncement:_,deleteAnnouncement:I,updateAnnouncement:L,fetchAnnouncements:F}=Me(),{t:r,language:a}=De(),b=s?.role==="admin"||s?.role==="manager"||s?.role==="director",[d,$]=o.useState("residents"),[A,f]=o.useState(!1),[z,v]=o.useState(!1),[m,x]=o.useState(null),[l,u]=o.useState({title:"",content:"",type:"residents",priority:"normal",expiresAt:""}),[y,i]=o.useState("all"),[p,h]=o.useState(""),[w,C]=o.useState(""),[j,R]=o.useState([]),[ue,U]=o.useState(""),B=o.useRef(null),[M,q]=o.useState([]),[X,W]=o.useState(!1),D=o.useRef(null),[E,he]=o.useState([]);o.useEffect(()=>{(async()=>{try{const n=await Ee.getAll();he(n.buildings||[])}catch{}})(),F()},[F]);const Y=o.useMemo(()=>{const t=new Map;return E.forEach(n=>{const c=n.branch_code||n.branchCode||"default";t.has(c)||t.set(c,{id:c,name:c==="default"?a==="ru"?"Основной филиал":"Asosiy filial":c,buildingCount:0});const g=t.get(c);g.buildingCount++}),Array.from(t.values())},[E,a]),[S,ge]=o.useState("all"),Z=t=>{if(S==="all")return t;const n=new Date,c=new Date(n.getFullYear(),n.getMonth(),n.getDate()),g=new Date(c.getTime()-10080*60*1e3),K=new Date(c.getTime()-720*60*60*1e3);return t.filter(T=>{const k=new Date(T.createdAt);switch(S){case"today":return k>=c;case"week":return k>=g;case"month":return k>=K;default:return!0}})},V=o.useMemo(()=>Z(N.filter(t=>t.type==="residents"&&t.isActive)),[N,S]),H=o.useMemo(()=>Z(N.filter(t=>t.type==="employees"&&t.isActive)),[N,S]),Q=d==="residents"?V:H,pe=async t=>{const n=t.target.files?.[0];if(!n)return;U(n.name);const c=await ce(()=>import("./xlsx-1768585085561-Ca2gZxVo.js"),[]),g=new FileReader;g.onload=K=>{try{const T=K.target?.result,k=c.read(T,{type:"binary"}),Se=k.SheetNames[0],Fe=k.Sheets[Se],$e=c.utils.sheet_to_json(Fe,{header:1}),te=[];$e.slice(1).forEach(se=>{if(se[0]){const ae=String(se[0]).trim();ae&&te.push(ae)}}),R(te)}catch{alert(a==="ru"?"Ошибка чтения файла":"Faylni o'qishda xato")}},g.readAsBinaryString(n)},be=()=>{if(l.type==="residents")switch(y){case"all":return{type:"all"};case"branch":return p?{type:"branch",branchId:p}:void 0;case"building":return w?{type:"building",buildingId:w}:void 0;case"custom":return j.length>0?{type:"custom",customLogins:j}:void 0;default:return{type:"all"}}},G=()=>{if(l.type!=="residents")return"";switch(y){case"all":return a==="ru"?"Все жители":"Barcha aholiga";case"branch":const t=Y.find(c=>c.id===p);return t?t.name:"";case"building":const n=E.find(c=>c.id===w);return n?n.name:"";case"custom":return j.length>0?`${j.length} ${a==="ru"?"получателей":"qabul qiluvchi"}`:"";default:return""}},ye=()=>{i("all"),h(""),C(""),R([]),U(""),B.current&&(B.current.value="")},fe=async t=>{const n=t.target.files;if(!(!n||n.length===0)){W(!0);try{const c=await Te.uploadFiles(Array.from(n));q(g=>[...g,...c])}catch{alert(a==="ru"?"Ошибка загрузки файла":"Fayl yuklashda xato")}finally{W(!1),D.current&&(D.current.value="")}}},je=t=>{q(n=>n.filter((c,g)=>g!==t))},Ne=t=>t.startsWith("image/")?e.jsx(de,{className:"w-4 h-4"}):t.includes("pdf")||t.includes("word")||t.includes("document")?e.jsx(me,{className:"w-4 h-4"}):e.jsx(xe,{className:"w-4 h-4"}),ve=t=>t<1024?`${t} B`:t<1024*1024?`${(t/1024).toFixed(1)} KB`:`${(t/(1024*1024)).toFixed(1)} MB`,we=async()=>{if(!l.title.trim()||!l.content.trim()||!s)return;const t=be();await _({title:l.title,content:l.content,type:l.type,priority:l.priority,authorId:s.id,authorName:s.name,authorRole:s.role,expiresAt:l.expiresAt||void 0,target:t,attachments:M.length>0?M:void 0}),u({title:"",content:"",type:"residents",priority:"normal",expiresAt:""}),ye(),q([]),f(!1)},ke=async t=>{confirm(a==="ru"?"Удалить объявление?":"E'lonni o'chirishni tasdiqlaysizmi?")&&await I(t)},Ae=t=>{switch(t){case"urgent":return e.jsx(He,{className:"w-4 h-4 text-red-500"});case"important":return e.jsx(Ve,{className:"w-4 h-4 text-amber-500"});default:return e.jsx(qe,{className:"w-4 h-4 text-blue-500"})}},ee=t=>{switch(t){case"urgent":return"bg-red-100 text-red-700 border-red-200";case"important":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-blue-100 text-blue-700 border-blue-200"}},Ce=t=>new Date(t).toLocaleDateString(a==="ru"?"ru-RU":"uz-UZ",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:r("announcements.title")}),e.jsx("p",{className:"text-gray-500",children:a==="ru"?b?"Создавайте объявления для жителей и сотрудников":"Объявления от управляющей компании":b?"Aholi va xodimlar uchun e'lonlar yarating":"Boshqaruv kompaniyasidan e'lonlar"})]}),b&&e.jsxs("button",{onClick:()=>f(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5"}),r("announcements.add")]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>$("residents"),className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-colors ${d==="residents"?"bg-orange-400 text-gray-900":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(J,{className:"w-5 h-5"}),r("announcements.forResidents"),V.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full bg-gray-900/10 text-xs",children:V.length})]}),e.jsxs("button",{onClick:()=>$("employees"),className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-colors ${d==="employees"?"bg-orange-400 text-gray-900":"bg-white text-gray-600 hover:bg-gray-100"}`,children:[e.jsx(re,{className:"w-5 h-5"}),r("announcements.forStaff"),H.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 rounded-full bg-gray-900/10 text-xs",children:H.length})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-gray-400"}),e.jsxs("select",{value:S,onChange:t=>ge(t.target.value),className:"px-3 py-1.5 rounded-lg bg-white border border-gray-200 text-sm text-gray-600 focus:outline-none focus:ring-2 focus:ring-orange-400",children:[e.jsx("option",{value:"all",children:a==="ru"?"Все время":"Barcha vaqt"}),e.jsx("option",{value:"today",children:a==="ru"?"Сегодня":"Bugun"}),e.jsx("option",{value:"week",children:a==="ru"?"Неделя":"Hafta"}),e.jsx("option",{value:"month",children:a==="ru"?"Месяц":"Oy"})]})]})]}),e.jsx("div",{className:"space-y-4",children:Q.length===0?e.jsxs("div",{className:"glass-card p-12 text-center",children:[e.jsx(Ie,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-600 mb-2",children:r("announcements.noAnnouncements")}),e.jsx("p",{className:"text-gray-400",children:r("announcements.addFirst")})]}):Q.map(t=>e.jsx(Ke,{announcement:t,onDelete:()=>ke(t.id),onEdit:()=>{x(t),v(!0)},formatDate:Ce,getPriorityIcon:Ae,getPriorityBadge:ee,t:r,canDelete:b&&(s?.id===t.authorId||s?.role==="admin"),canEdit:b,language:a},t.id))}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:r("announcements.add")}),e.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.type")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>u({...l,type:"residents"}),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-medium transition-colors ${l.type==="residents"?"bg-green-100 text-green-700 border-2 border-green-400":"bg-gray-100 text-gray-600 border-2 border-transparent"}`,children:[e.jsx(J,{className:"w-5 h-5"}),r("announcements.forResidents")]}),e.jsxs("button",{onClick:()=>u({...l,type:"employees"}),className:`flex-1 flex items-center justify-center gap-2 py-3 rounded-xl font-medium transition-colors ${l.type==="employees"?"bg-purple-100 text-purple-700 border-2 border-purple-400":"bg-gray-100 text-gray-600 border-2 border-transparent"}`,children:[e.jsx(re,{className:"w-5 h-5"}),r("announcements.forStaff")]})]})]}),l.type==="residents"&&e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(O,{className:"w-4 h-4"}),a==="ru"?"Таргетирование":"Maqsadli auditoriya"]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[{type:"all",label:a==="ru"?"Все":"Hammasi",icon:J},{type:"branch",label:a==="ru"?"Филиал":"Filial",icon:ne},{type:"building",label:a==="ru"?"ЖК":"TJM",icon:ne},{type:"custom",label:a==="ru"?"Список":"Ro'yxat",icon:le}].map(({type:t,label:n,icon:c})=>e.jsxs("button",{onClick:()=>{i(t),t!=="branch"&&h(""),t!=="building"&&C(""),t!=="custom"&&(R([]),U(""))},className:`flex flex-col items-center gap-1 py-2 px-2 rounded-xl text-xs font-medium transition-colors ${y===t?"bg-primary-100 text-primary-700 border-2 border-primary-400":"bg-gray-50 text-gray-600 border-2 border-transparent hover:bg-gray-100"}`,children:[e.jsx(c,{className:"w-4 h-4"}),n]},t))}),y==="branch"&&e.jsxs("select",{value:p,onChange:t=>h(t.target.value),className:"glass-input",children:[e.jsx("option",{value:"",children:a==="ru"?"Выберите филиал...":"Filialni tanlang..."}),Y.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.buildingCount," ",a==="ru"?"домов":"uy",")"]},t.id))]}),y==="building"&&e.jsxs("select",{value:w,onChange:t=>C(t.target.value),className:"glass-input",children:[e.jsx("option",{value:"",children:a==="ru"?"Выберите ЖК...":"TJM tanlang..."}),E.map(t=>e.jsxs("option",{value:t.id,children:[t.name," - ",t.address]},t.id))]}),y==="custom"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{ref:B,type:"file",accept:".xlsx,.xls,.csv",onChange:pe,className:"hidden"}),e.jsxs("button",{onClick:()=>B.current?.click(),className:"w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-300 rounded-xl hover:border-primary-400 hover:bg-primary-50 transition-colors",children:[e.jsx(ie,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:ue||(a==="ru"?"Загрузить Excel файл":"Excel fayl yuklang")})]}),j.length>0&&e.jsxs("div",{className:"text-sm text-green-600 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4"}),a==="ru"?`Загружено ${j.length} лицевых счетов`:`${j.length} ta shaxsiy hisob yuklandi`]}),e.jsx("p",{className:"text-xs text-gray-400",children:a==="ru"?"Файл должен содержать лицевые счета (логины) в первой колонке":"Fayl birinchi ustunda shaxsiy hisoblarni (loginlarni) o'z ichiga olishi kerak"})]}),G()&&e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-lg text-sm text-green-700",children:[e.jsx(O,{className:"w-4 h-4"}),G()]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.priority")}),e.jsx("div",{className:"flex gap-2",children:["normal","important","urgent"].map(t=>e.jsx("button",{onClick:()=>u({...l,priority:t}),className:`flex-1 py-2 px-3 rounded-xl font-medium text-sm transition-colors ${l.priority===t?ee(t)+" border-2":"bg-gray-100 text-gray-600 border-2 border-transparent"}`,children:r(`announcements.priority${t.charAt(0).toUpperCase()+t.slice(1)}`)},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.titleLabel")}),e.jsx("input",{type:"text",value:l.title,onChange:t=>u({...l,title:t.target.value}),className:"glass-input",placeholder:a==="ru"?"Введите заголовок...":"Sarlavhani kiriting..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.content")}),e.jsx("textarea",{value:l.content,onChange:t=>u({...l,content:t.target.value}),className:"glass-input min-h-[120px] resize-none",placeholder:a==="ru"?"Введите содержание объявления...":"E'lon mazmunini kiriting..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.expiresAt")}),e.jsx("input",{type:"datetime-local",value:l.expiresAt,onChange:t=>u({...l,expiresAt:t.target.value}),className:"glass-input"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Le,{className:"w-4 h-4 inline mr-1"}),a==="ru"?"Вложения":"Ilovalar"]}),e.jsx("input",{ref:D,type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt",onChange:fe,className:"hidden"}),e.jsx("button",{type:"button",onClick:()=>D.current?.click(),disabled:X,className:"w-full flex items-center justify-center gap-2 py-3 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-400 hover:bg-blue-50 transition-colors disabled:opacity-50",children:X?e.jsx("span",{className:"text-sm text-gray-500",children:a==="ru"?"Загрузка...":"Yuklanmoqda..."}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:a==="ru"?"Добавить файлы (до 5 МБ)":"Fayl qo'shish (5 MB gacha)"})]})}),M.length>0&&e.jsx("div",{className:"mt-3 space-y-2",children:M.map((t,n)=>e.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[Ne(t.type),e.jsx("span",{className:"flex-1 text-sm text-gray-700 truncate",children:t.name}),e.jsx("span",{className:"text-xs text-gray-400",children:ve(t.size)}),e.jsx("button",{type:"button",onClick:()=>je(n),className:"p-1 text-red-500 hover:bg-red-50 rounded",children:e.jsx(P,{className:"w-4 h-4"})})]},n))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>f(!1),className:"flex-1 py-3 rounded-xl font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:r("form.cancel")}),e.jsx("button",{onClick:we,disabled:!l.title.trim()||!l.content.trim(),className:"flex-1 py-3 rounded-xl font-medium bg-orange-400 text-gray-900 hover:bg-orange-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:r("form.add")})]})]})]})}),z&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:a==="ru"?"Редактировать объявление":"E'lonni tahrirlash"}),e.jsx("button",{onClick:()=>{v(!1),x(null)},className:"p-2 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("announcements.titleLabel")}),e.jsx("input",{type:"text",value:m.title,onChange:t=>x({...m,title:t.target.value}),className:"glass-input",placeholder:r("announcements.titlePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:r("announcements.contentLabel")}),e.jsx("textarea",{value:m.content,onChange:t=>x({...m,content:t.target.value}),className:"glass-input min-h-32",placeholder:r("announcements.contentPlaceholder"),rows:4})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:r("announcements.priority")}),e.jsx("div",{className:"flex gap-2",children:["normal","important","urgent"].map(t=>e.jsx("button",{onClick:()=>x({...m,priority:t}),className:`flex-1 py-2 px-3 rounded-xl text-sm font-medium transition-colors ${m.priority===t?t==="urgent"?"bg-red-100 text-red-700 ring-2 ring-red-500":t==="important"?"bg-amber-100 text-amber-700 ring-2 ring-amber-500":"bg-blue-100 text-blue-700 ring-2 ring-blue-500":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:r(`announcements.priority${t.charAt(0).toUpperCase()+t.slice(1)}`)},t))})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{v(!1),x(null)},className:"flex-1 py-3 rounded-xl font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors",children:r("form.cancel")}),e.jsx("button",{onClick:async()=>{m&&(await L(m.id,{title:m.title,content:m.content,priority:m.priority}),v(!1),x(null))},disabled:!m.title.trim()||!m.content.trim(),className:"flex-1 py-3 rounded-xl font-medium bg-orange-400 text-gray-900 hover:bg-orange-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:a==="ru"?"Сохранить":"Saqlash"})]})]})]})})]})}function Ke({announcement:s,onDelete:N,onEdit:_,formatDate:I,getPriorityIcon:L,getPriorityBadge:F,t:r,canDelete:a,canEdit:b,language:d}){const[$,A]=o.useState(!1),[f,z]=o.useState([]),[v,m]=o.useState(!1),[x,l]=o.useState(null),u=s.viewCount??s.viewedBy.length,y=async i=>{i.stopPropagation(),A(!0),m(!0);try{const{announcementsApi:p}=await ce(async()=>{const{announcementsApi:w}=await import("./index-1768585085561-DY3gV71t.js").then(C=>C.I);return{announcementsApi:w}},__vite__mapDeps([0,1,2,3,4,5])),h=await p.getViews(s.id);z(h.viewers||[]),l({count:h.count,targetAudienceSize:h.targetAudienceSize,viewPercentage:h.viewPercentage})}catch{}finally{m(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"glass-card p-5 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 rounded-lg text-xs font-medium border ${F(s.priority)}`,children:[L(s.priority),r(`announcements.priority${s.priority.charAt(0).toUpperCase()+s.priority.slice(1)}`)]}),e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-medium ${s.type==="residents"?"bg-green-100 text-green-700":s.type==="employees"?"bg-purple-100 text-purple-700":"bg-blue-100 text-blue-700"}`,children:s.type==="residents"?r("announcements.forResidents"):s.type==="employees"?r("announcements.forStaff"):d==="ru"?"Для всех":"Hammasi uchun"}),s.target&&s.target.type!=="all"&&e.jsxs("span",{className:"px-2 py-1 rounded-lg text-xs font-medium bg-gray-100 text-gray-600",children:[e.jsx(O,{className:"w-3 h-3 inline mr-1"}),s.target.type==="building"&&(d==="ru"?"ЖК":"TJM"),s.target.type==="entrance"&&(d==="ru"?"Подъезд":"Kirish"),s.target.type==="floor"&&(d==="ru"?"Этаж":"Qavat"),s.target.type==="custom"&&(d==="ru"?"Список":"Ro'yxat")]})]}),e.jsx("h3",{className:"font-semibold text-lg text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-gray-600 whitespace-pre-wrap",children:s.content}),s.attachments&&s.attachments.length>0&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:s.attachments.map((i,p)=>e.jsxs("a",{href:i.url,download:i.name,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 rounded-lg text-sm text-gray-700 transition-colors",onClick:h=>h.stopPropagation(),children:[i.type.startsWith("image/")?e.jsx(de,{className:"w-4 h-4 text-blue-500"}):i.type.includes("pdf")?e.jsx(me,{className:"w-4 h-4 text-red-500"}):e.jsx(xe,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"truncate max-w-[150px]",children:i.name}),e.jsx(ze,{className:"w-4 h-4 text-gray-400"})]},p))}),e.jsxs("div",{className:"flex items-center gap-4 mt-4 text-sm text-gray-500 flex-wrap",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Re,{className:"w-4 h-4"}),I(s.createdAt)]}),s.authorName&&e.jsxs("span",{children:[r("announcements.author"),": ",s.authorName]}),e.jsxs("button",{onClick:y,className:`flex items-center gap-1 ${u>0?"text-blue-600 hover:text-blue-800 cursor-pointer hover:underline":"text-gray-400 cursor-default"}`,disabled:u===0,children:[e.jsx(oe,{className:"w-4 h-4"}),u," ",r("announcements.views")]})]})]}),(b||a)&&e.jsxs("div",{className:"flex flex-col gap-1",children:[b&&e.jsx("button",{onClick:i=>{i.stopPropagation(),_()},className:"p-2 text-blue-500 hover:bg-blue-50 rounded-xl transition-colors",title:d==="ru"?"Редактировать":"Tahrirlash",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),a&&e.jsx("button",{onClick:i=>{i.stopPropagation(),N()},className:"p-2 text-red-500 hover:bg-red-50 rounded-xl transition-colors",title:d==="ru"?"Удалить":"O'chirish",children:e.jsx(Ue,{className:"w-5 h-5"})})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>A(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md max-h-[80vh] overflow-hidden",onClick:i=>i.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center justify-between",children:[e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(oe,{className:"w-5 h-5 text-blue-500"}),d==="ru"?"Статистика просмотров":"Ko'rishlar statistikasi"]}),e.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-gray-100 rounded-xl",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-4",children:v?e.jsx("div",{className:"text-center py-8 text-gray-500",children:d==="ru"?"Загрузка...":"Yuklanmoqda..."}):e.jsxs(e.Fragment,{children:[x&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-blue-700",children:d==="ru"?"Просмотрели":"Ko'rganlar"}),e.jsxs("span",{className:"font-bold text-blue-900",children:[x.count," / ",x.targetAudienceSize]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-3",children:e.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all duration-500",style:{width:`${Math.min(x.viewPercentage,100)}%`}})}),e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-2xl font-bold text-blue-900",children:[x.viewPercentage,"%"]}),e.jsx("span",{className:"text-sm text-blue-600 ml-2",children:d==="ru"?"от целевой аудитории":"maqsadli auditoriyadan"})]})]}),f.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:d==="ru"?"Пока никто не просмотрел":"Hali hech kim ko'rmagan"}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600",children:d==="ru"?"Кто просмотрел:":"Kim ko'rgan:"}),f.map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-xl",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:i.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[i.apartment&&`${d==="ru"?"Кв.":"Xon."} ${i.apartment}`,i.address&&` • ${i.address}`]})]}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(i.viewed_at).toLocaleDateString(d==="ru"?"ru-RU":"uz-UZ",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})})]},i.id))]})]})})]})})]})}export{Ze as AnnouncementsPage};
//# sourceMappingURL=AnnouncementsPage-1768585085561-CrY-lM-K.js.map
