{"version":3,"file":"MarketplacePage-1768595343090-R1-TFI7T.js","sources":["../../src/pages/MarketplacePage.tsx"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\r\nimport {\r\n  ShoppingCart, Search, Heart, Package, Plus, Minus, X,\r\n  CheckCircle, ShoppingBag, Trash2, Truck, ChefHat\r\n} from 'lucide-react';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport { useLanguageStore } from '../stores/languageStore';\r\nimport { apiRequest } from '../services/api';\r\n\r\n// Types for API responses (snake_case from backend)\r\ninterface MarketplaceCategoryAPI {\r\n  id: string;\r\n  name_ru: string;\r\n  name_uz: string;\r\n  icon?: string;\r\n  sort_order: number;\r\n  is_active: boolean;\r\n  created_at: string;\r\n}\r\n\r\ninterface MarketplaceProductAPI {\r\n  id: string;\r\n  category_id: string;\r\n  name_ru: string;\r\n  name_uz: string;\r\n  description_ru?: string;\r\n  description_uz?: string;\r\n  price: number;\r\n  old_price?: number;\r\n  unit: string;\r\n  stock_quantity: number;\r\n  image_url?: string;\r\n  is_active: boolean;\r\n  is_featured: boolean;\r\n  created_at: string;\r\n}\r\n\r\ninterface MarketplaceCartItemAPI {\r\n  id: string;\r\n  product_id: string;\r\n  quantity: number;\r\n  added_at: string;\r\n}\r\n\r\ninterface MarketplaceOrderAPI {\r\n  id: string;\r\n  order_number: string;\r\n  resident_id: string;\r\n  resident_name?: string;\r\n  resident_phone?: string;\r\n  resident_address?: string;\r\n  resident_apartment?: string;\r\n  status: MarketplaceOrderStatus;\r\n  items: MarketplaceOrderItemAPI[];\r\n  total_amount: number;\r\n  items_count: number;\r\n  delivery_note?: string;\r\n  created_at: string;\r\n}\r\n\r\ninterface MarketplaceOrderItemAPI {\r\n  id: string;\r\n  order_id: string;\r\n  product_id: string;\r\n  product_name_ru?: string;\r\n  product_name_uz?: string;\r\n  product_image?: string;\r\n  quantity: number;\r\n  price: number;\r\n}\r\n\r\ntype MarketplaceOrderStatus = 'new' | 'confirmed' | 'preparing' | 'ready' | 'delivering' | 'delivered' | 'cancelled';\r\n\r\n// –≠—Ç–∞–ø—ã –∑–∞–∫–∞–∑–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–∫–µ—Ä–∞\r\nconst ORDER_STAGES = [\r\n  {\r\n    id: 'created',\r\n    statuses: ['new'],\r\n    labelRu: '–°–æ–∑–¥–∞–Ω',\r\n    labelUz: 'Yaratildi',\r\n    icon: ShoppingBag,\r\n    descRu: '–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω',\r\n    descUz: 'Buyurtma yaratildi',\r\n  },\r\n  {\r\n    id: 'confirmed',\r\n    statuses: ['confirmed'],\r\n    labelRu: '–ü—Ä–∏–Ω—è—Ç',\r\n    labelUz: 'Qabul qilindi',\r\n    icon: CheckCircle,\r\n    descRu: '–ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω',\r\n    descUz: 'Buyurtma tasdiqlandi',\r\n  },\r\n  {\r\n    id: 'preparing',\r\n    statuses: ['preparing'],\r\n    labelRu: '–ì–æ—Ç–æ–≤–∏—Ç—Å—è',\r\n    labelUz: 'Tayyorlanmoqda',\r\n    icon: ChefHat,\r\n    descRu: '–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑',\r\n    descUz: 'Buyurtma yig\\'ilmoqda',\r\n  },\r\n  {\r\n    id: 'delivering',\r\n    statuses: ['ready', 'delivering'],\r\n    labelRu: '–î–æ—Å—Ç–∞–≤–∫–∞',\r\n    labelUz: 'Yetkazish',\r\n    icon: Truck,\r\n    descRu: '–í –ø—É—Ç–∏ –∫ –≤–∞–º',\r\n    descUz: 'Sizga yo\\'lda',\r\n  },\r\n  {\r\n    id: 'delivered',\r\n    statuses: ['delivered'],\r\n    labelRu: '–ü–æ–ª—É—á–µ–Ω',\r\n    labelUz: 'Qabul qilindi',\r\n    icon: CheckCircle,\r\n    descRu: '–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω',\r\n    descUz: 'Buyurtma yetkazildi',\r\n  },\r\n];\r\n\r\nfunction getOrderStageIndex(status: MarketplaceOrderStatus): number {\r\n  if (status === 'cancelled') return -1;\r\n  for (let i = 0; i < ORDER_STAGES.length; i++) {\r\n    if (ORDER_STAGES[i].statuses.includes(status)) {\r\n      return i;\r\n    }\r\n  }\r\n  return 0;\r\n}\r\n\r\nfunction getOrderStatusMessage(status: MarketplaceOrderStatus, language: 'ru' | 'uz'): { title: string; subtitle: string } {\r\n  switch (status) {\r\n    case 'new':\r\n      return {\r\n        title: language === 'ru' ? '–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω' : 'Buyurtma yaratildi',\r\n        subtitle: language === 'ru' ? '–û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è' : 'Tasdiqlanishini kutmoqdamiz'\r\n      };\r\n    case 'confirmed':\r\n      return {\r\n        title: language === 'ru' ? '–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç' : 'Buyurtma qabul qilindi',\r\n        subtitle: language === 'ru' ? '–ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä–∫—É' : 'Yig\\'ishni boshlaymiz'\r\n      };\r\n    case 'preparing':\r\n      return {\r\n        title: language === 'ru' ? '–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑' : 'Buyurtma yig\\'ilmoqda',\r\n        subtitle: language === 'ru' ? '–°–∫–æ—Ä–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤' : 'Tez orada tayyor bo\\'ladi'\r\n      };\r\n    case 'ready':\r\n      return {\r\n        title: language === 'ru' ? '–ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤' : 'Buyurtma tayyor',\r\n        subtitle: language === 'ru' ? '–ü–µ—Ä–µ–¥–∞—ë–º –∫—É—Ä—å–µ—Ä—É' : 'Kuryerga topshirilmoqda'\r\n      };\r\n    case 'delivering':\r\n      return {\r\n        title: language === 'ru' ? '–ö—É—Ä—å–µ—Ä –≤ –ø—É—Ç–∏' : 'Kuryer yo\\'lda',\r\n        subtitle: language === 'ru' ? '–°–∫–æ—Ä–æ –±—É–¥–µ—Ç —É –≤–∞—Å' : 'Tez orada sizda bo\\'ladi'\r\n      };\r\n    case 'delivered':\r\n      return {\r\n        title: language === 'ru' ? '–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω' : 'Buyurtma yetkazildi',\r\n        subtitle: language === 'ru' ? '–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∞–ø–ø–µ—Ç–∏—Ç–∞!' : 'Yoqimli ishtaha!'\r\n      };\r\n    case 'cancelled':\r\n      return {\r\n        title: language === 'ru' ? '–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω' : 'Buyurtma bekor qilindi',\r\n        subtitle: language === 'ru' ? '' : ''\r\n      };\r\n    default:\r\n      return { title: '', subtitle: '' };\r\n  }\r\n}\r\n\r\nconst CATEGORY_ICONS: Record<string, string> = {\r\n  cat_groceries: 'üõí',\r\n  cat_dairy: 'ü•õ',\r\n  cat_meat: 'ü•©',\r\n  cat_bakery: 'üçû',\r\n  cat_fruits: 'üçé',\r\n  cat_beverages: 'ü•§',\r\n  cat_household: 'üßπ',\r\n  cat_personal: 'üß¥',\r\n  cat_baby: 'üë∂',\r\n  cat_pets: 'üêæ',\r\n  cat_frozen: '‚ùÑÔ∏è',\r\n  cat_snacks: 'üçø',\r\n};\r\n\r\nexport function MarketplacePage() {\r\n  const { user } = useAuthStore();\r\n  const { language } = useLanguageStore();\r\n\r\n  const [activeTab, setActiveTab] = useState<'shop' | 'cart' | 'orders' | 'favorites'>('shop');\r\n  const [categories, setCategories] = useState<MarketplaceCategoryAPI[]>([]);\r\n  const [products, setProducts] = useState<MarketplaceProductAPI[]>([]);\r\n  const [cart, setCart] = useState<MarketplaceCartItemAPI[]>([]);\r\n  const [orders, setOrders] = useState<MarketplaceOrderAPI[]>([]);\r\n  const [favorites, setFavorites] = useState<string[]>([]);\r\n  const [selectedCategory, setSelectedCategory] = useState<string | null>(null);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedProduct, setSelectedProduct] = useState<MarketplaceProductAPI | null>(null);\r\n  const [showOrderModal, setShowOrderModal] = useState(false);\r\n  const [deliveryNote, setDeliveryNote] = useState('');\r\n  const [orderSuccess, setOrderSuccess] = useState(false);\r\n\r\n  // Fetch data\r\n  const fetchData = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n\r\n      // Fetch public data first (no auth required)\r\n      const [categoriesRes, productsRes] = await Promise.all([\r\n        apiRequest<{ categories: MarketplaceCategoryAPI[] }>('/api/marketplace/categories'),\r\n        apiRequest<{ products: MarketplaceProductAPI[], total: number }>('/api/marketplace/products'),\r\n      ]);\r\n\r\n      setCategories(categoriesRes?.categories || []);\r\n      setProducts(productsRes?.products || []);\r\n\r\n      // Fetch user-specific data only if logged in\r\n      if (user) {\r\n        try {\r\n          const [cartRes, ordersRes, favoritesRes] = await Promise.all([\r\n            apiRequest<{ cart: MarketplaceCartItemAPI[], total: number, itemsCount: number }>('/api/marketplace/cart'),\r\n            apiRequest<{ orders: MarketplaceOrderAPI[] }>('/api/marketplace/orders'),\r\n            apiRequest<{ favorites: { id: string }[] }>('/api/marketplace/favorites'),\r\n          ]);\r\n          setCart(cartRes?.cart || []);\r\n          setOrders(ordersRes?.orders || []);\r\n          setFavorites((favoritesRes?.favorites || []).map(f => f.id));\r\n        } catch (err) {\r\n          console.error('Error fetching user marketplace data:', err);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching marketplace data:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [user]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  // Add to cart\r\n  const addToCart = async (productId: string, quantity: number = 1) => {\r\n    try {\r\n      await apiRequest('/api/marketplace/cart', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ product_id: productId, quantity }),\r\n      });\r\n      const cartRes = await apiRequest<{ cart: MarketplaceCartItemAPI[] }>('/api/marketplace/cart');\r\n      setCart(cartRes?.cart || []);\r\n    } catch (error) {\r\n      console.error('Error adding to cart:', error);\r\n    }\r\n  };\r\n\r\n  // Update cart quantity\r\n  const updateCartQuantity = async (productId: string, quantity: number) => {\r\n    if (quantity <= 0) {\r\n      await removeFromCart(productId);\r\n      return;\r\n    }\r\n    try {\r\n      await apiRequest('/api/marketplace/cart', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ product_id: productId, quantity }),\r\n      });\r\n      const cartRes = await apiRequest<{ cart: MarketplaceCartItemAPI[] }>('/api/marketplace/cart');\r\n      setCart(cartRes?.cart || []);\r\n    } catch (error) {\r\n      console.error('Error updating cart:', error);\r\n    }\r\n  };\r\n\r\n  // Remove from cart\r\n  const removeFromCart = async (productId: string) => {\r\n    try {\r\n      await apiRequest(`/api/marketplace/cart/${productId}`, { method: 'DELETE' });\r\n      const cartRes = await apiRequest<{ cart: MarketplaceCartItemAPI[] }>('/api/marketplace/cart');\r\n      setCart(cartRes?.cart || []);\r\n    } catch (error) {\r\n      console.error('Error removing from cart:', error);\r\n    }\r\n  };\r\n\r\n  // Toggle favorite\r\n  const toggleFavorite = async (productId: string) => {\r\n    // Optimistic update for instant UI feedback\r\n    const isFavorite = favorites.includes(productId);\r\n    if (isFavorite) {\r\n      setFavorites(favorites.filter(id => id !== productId));\r\n    } else {\r\n      setFavorites([...favorites, productId]);\r\n    }\r\n\r\n    try {\r\n      await apiRequest(`/api/marketplace/favorites/${productId}`, { method: 'POST' });\r\n    } catch (error) {\r\n      console.error('Error toggling favorite:', error);\r\n      // Revert on error\r\n      if (isFavorite) {\r\n        setFavorites([...favorites, productId]);\r\n      } else {\r\n        setFavorites(favorites.filter(id => id !== productId));\r\n      }\r\n    }\r\n  };\r\n\r\n  // Create order\r\n  const createOrder = async () => {\r\n    try {\r\n      await apiRequest('/api/marketplace/orders', {\r\n        method: 'POST',\r\n        body: JSON.stringify({ delivery_notes: deliveryNote }),\r\n      });\r\n      setOrderSuccess(true);\r\n      setShowOrderModal(false);\r\n      setDeliveryNote('');\r\n      // Refresh cart and orders\r\n      const [cartRes, ordersRes] = await Promise.all([\r\n        apiRequest<{ cart: MarketplaceCartItemAPI[] }>('/api/marketplace/cart'),\r\n        apiRequest<{ orders: MarketplaceOrderAPI[] }>('/api/marketplace/orders'),\r\n      ]);\r\n      setCart(cartRes?.cart || []);\r\n      setOrders(ordersRes?.orders || []);\r\n      setTimeout(() => {\r\n        setOrderSuccess(false);\r\n        setActiveTab('orders');\r\n      }, 2000);\r\n    } catch (error) {\r\n      console.error('Error creating order:', error);\r\n    }\r\n  };\r\n\r\n  // Filter products\r\n  const filteredProducts = products.filter(p => {\r\n    const matchesCategory = !selectedCategory || p.category_id === selectedCategory;\r\n    const matchesSearch = !searchQuery ||\r\n      (language === 'ru' ? p.name_ru : p.name_uz).toLowerCase().includes(searchQuery.toLowerCase());\r\n    return matchesCategory && matchesSearch;\r\n  });\r\n\r\n  // Get cart item quantity for a product\r\n  const getCartQuantity = (productId: string) => {\r\n    const item = cart.find(c => c.product_id === productId);\r\n    return item?.quantity || 0;\r\n  };\r\n\r\n  // Calculate cart total\r\n  const cartTotal = cart.reduce((sum, item) => {\r\n    const product = products.find(p => p.id === item.product_id);\r\n    return sum + (product?.price || 0) * item.quantity;\r\n  }, 0);\r\n\r\n  const formatPrice = (price: number) => {\r\n    return new Intl.NumberFormat('ru-RU').format(price) + ' —Å—É–º';\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'shop' as const, label: language === 'ru' ? '–ú–∞–≥–∞–∑–∏–Ω' : 'Do\\'kon', icon: ShoppingBag },\r\n    { id: 'cart' as const, label: language === 'ru' ? '–ö–æ—Ä–∑–∏–Ω–∞' : 'Savat', icon: ShoppingCart, count: cart.length },\r\n    { id: 'orders' as const, label: language === 'ru' ? '–ó–∞–∫–∞–∑—ã' : 'Buyurtmalar', icon: Package, count: orders.filter(o => o.status !== 'delivered' && o.status !== 'cancelled').length },\r\n    { id: 'favorites' as const, label: language === 'ru' ? '–ò–∑–±—Ä–∞–Ω–Ω–æ–µ' : 'Sevimlilar', icon: Heart, count: favorites.length },\r\n  ];\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 bg-orange-50/50\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-4 md:space-y-6 pb-20 md:pb-0\">\r\n      {/* Success Toast */}\r\n      {orderSuccess && (\r\n        <div className=\"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2\">\r\n          <CheckCircle className=\"w-5 h-5\" />\r\n          <span>{language === 'ru' ? '–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!' : 'Buyurtma muvaffaqiyatli yaratildi!'}</span>\r\n        </div>\r\n      )}\r\n\r\n      {/* Tabs */}\r\n      <div className=\"glass-card sticky top-0 z-40\">\r\n        <div className=\"flex overflow-x-auto\">\r\n          {tabs.map(tab => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id)}\r\n              className={`flex-1 min-w-0 py-3 px-4 flex items-center justify-center gap-2 border-b-2 transition-colors ${\r\n                activeTab === tab.id\r\n                  ? 'border-orange-500 text-orange-600 bg-orange-50/50'\r\n                  : 'border-transparent text-gray-500 hover:text-gray-700'\r\n              }`}\r\n            >\r\n              <tab.icon className=\"w-5 h-5\" />\r\n              <span className=\"text-sm font-medium truncate\">{tab.label}</span>\r\n              {tab.count !== undefined && tab.count > 0 && (\r\n                <span className=\"bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full\">\r\n                  {tab.count}\r\n                </span>\r\n              )}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"p-4 pb-20\">\r\n        {/* Shop Tab */}\r\n        {activeTab === 'shop' && (\r\n          <div>\r\n            {/* Search */}\r\n            <div className=\"relative mb-4\">\r\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\r\n              <input\r\n                type=\"text\"\r\n                placeholder={language === 'ru' ? '–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...' : 'Mahsulot qidirish...'}\r\n                value={searchQuery}\r\n                onChange={(e) => setSearchQuery(e.target.value)}\r\n                className=\"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-orange-500\"\r\n              />\r\n            </div>\r\n\r\n            {/* Categories Grid */}\r\n            <div className=\"grid grid-cols-4 gap-2 mb-4\">\r\n              <button\r\n                onClick={() => setSelectedCategory(null)}\r\n                className={`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${\r\n                  !selectedCategory\r\n                    ? 'bg-orange-500 text-white shadow-md'\r\n                    : 'glass-card text-gray-700 hover:bg-white/60'\r\n                }`}\r\n              >\r\n                <span className=\"text-2xl mb-1\">üè™</span>\r\n                <span className=\"text-xs font-medium text-center\">{language === 'ru' ? '–í—Å–µ' : 'Hammasi'}</span>\r\n              </button>\r\n              {categories.map(cat => (\r\n                <button\r\n                  key={cat.id}\r\n                  onClick={() => setSelectedCategory(cat.id)}\r\n                  className={`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${\r\n                    selectedCategory === cat.id\r\n                      ? 'bg-orange-500 text-white shadow-md'\r\n                      : 'glass-card text-gray-700 hover:bg-white/60'\r\n                  }`}\r\n                >\r\n                  <span className=\"text-2xl mb-1\">{CATEGORY_ICONS[cat.id] || 'üì¶'}</span>\r\n                  <span className=\"text-xs font-medium text-center line-clamp-1\">{language === 'ru' ? cat.name_ru : cat.name_uz}</span>\r\n                </button>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Products Grid */}\r\n            <div className=\"grid grid-cols-2 gap-3\">\r\n              {filteredProducts.map(product => {\r\n                const cartQty = getCartQuantity(product.id);\r\n                const isFavorite = favorites.includes(product.id);\r\n\r\n                return (\r\n                  <div\r\n                    key={product.id}\r\n                    className=\"glass-card overflow-hidden\"\r\n                  >\r\n                    {/* Product Image */}\r\n                    <div\r\n                      className=\"relative aspect-square bg-gray-100 flex items-center justify-center cursor-pointer\"\r\n                      onClick={() => setSelectedProduct(product)}\r\n                    >\r\n                      {product.image_url ? (\r\n                        <img\r\n                          src={product.image_url}\r\n                          alt={language === 'ru' ? product.name_ru : product.name_uz}\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                      ) : (\r\n                        <span className=\"text-4xl\">\r\n                          {CATEGORY_ICONS[product.category_id] || 'üì¶'}\r\n                        </span>\r\n                      )}\r\n                      {/* Favorite Button */}\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          toggleFavorite(product.id);\r\n                        }}\r\n                        className=\"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm\"\r\n                      >\r\n                        <Heart\r\n                          className={`w-4 h-4 ${isFavorite ? 'fill-red-500 text-red-500' : 'text-gray-400'}`}\r\n                        />\r\n                      </button>\r\n                      {/* Featured Badge */}\r\n                      {product.is_featured && (\r\n                        <div className=\"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full\">\r\n                          {language === 'ru' ? '–•–∏—Ç' : 'Hit'}\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Product Info */}\r\n                    <div className=\"p-3\">\r\n                      <h3 className=\"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]\">\r\n                        {language === 'ru' ? product.name_ru : product.name_uz}\r\n                      </h3>\r\n                      <p className=\"text-xs text-gray-500 mt-1\">{product.unit}</p>\r\n                      <div className=\"flex items-center justify-between mt-2\">\r\n                        <div>\r\n                          <p className=\"font-bold text-orange-600\">\r\n                            {formatPrice(product.price)}\r\n                          </p>\r\n                          {product.old_price && (\r\n                            <p className=\"text-xs text-gray-400 line-through\">\r\n                              {formatPrice(product.old_price)}\r\n                            </p>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Add to Cart */}\r\n                      {cartQty > 0 ? (\r\n                        <div className=\"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1\">\r\n                          <button\r\n                            onClick={() => updateCartQuantity(product.id, cartQty - 1)}\r\n                            className=\"p-1.5 rounded-md bg-white shadow-sm\"\r\n                          >\r\n                            <Minus className=\"w-4 h-4 text-orange-600\" />\r\n                          </button>\r\n                          <span className=\"font-medium text-orange-600\">{cartQty}</span>\r\n                          <button\r\n                            onClick={() => updateCartQuantity(product.id, cartQty + 1)}\r\n                            className=\"p-1.5 rounded-md bg-white shadow-sm\"\r\n                          >\r\n                            <Plus className=\"w-4 h-4 text-orange-600\" />\r\n                          </button>\r\n                        </div>\r\n                      ) : (\r\n                        <button\r\n                          onClick={() => addToCart(product.id)}\r\n                          className=\"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors flex items-center justify-center gap-1\"\r\n                        >\r\n                          <Plus className=\"w-4 h-4\" />\r\n                          <span>{language === 'ru' ? '–í –∫–æ—Ä–∑–∏–Ω—É' : 'Savatga'}</span>\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n\r\n            {filteredProducts.length === 0 && (\r\n              <div className=\"text-center py-12\">\r\n                <Package className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n                <p className=\"text-gray-500\">\r\n                  {language === 'ru' ? '–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã' : 'Mahsulotlar topilmadi'}\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Cart Tab */}\r\n        {activeTab === 'cart' && (\r\n          <div>\r\n            {cart.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <ShoppingCart className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n                <p className=\"text-gray-500 mb-4\">\r\n                  {language === 'ru' ? '–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞' : 'Savat bo\\'sh'}\r\n                </p>\r\n                <button\r\n                  onClick={() => setActiveTab('shop')}\r\n                  className=\"text-orange-600 font-medium\"\r\n                >\r\n                  {language === 'ru' ? '–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º' : 'Xaridga o\\'tish'}\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <div className=\"space-y-3 mb-4\">\r\n                  {cart.map(item => {\r\n                    const product = products.find(p => p.id === item.product_id);\r\n                    if (!product) return null;\r\n\r\n                    return (\r\n                      <div key={item.id} className=\"glass-card p-4 flex gap-3\">\r\n                        <div className=\"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n                          {product.image_url ? (\r\n                            <img\r\n                              src={product.image_url}\r\n                              alt=\"\"\r\n                              className=\"w-full h-full object-cover rounded-lg\"\r\n                            />\r\n                          ) : (\r\n                            <span className=\"text-2xl\">\r\n                              {CATEGORY_ICONS[product.category_id] || 'üì¶'}\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <h3 className=\"font-medium text-gray-900 line-clamp-2\">\r\n                            {language === 'ru' ? product.name_ru : product.name_uz}\r\n                          </h3>\r\n                          <p className=\"text-sm text-gray-500\">{product.unit}</p>\r\n                          <p className=\"font-bold text-orange-600 mt-1\">\r\n                            {formatPrice(product.price * item.quantity)}\r\n                          </p>\r\n                        </div>\r\n                        <div className=\"flex flex-col items-end justify-between\">\r\n                          <button\r\n                            onClick={() => removeFromCart(product.id)}\r\n                            className=\"p-1 text-gray-400 hover:text-red-500\"\r\n                          >\r\n                            <Trash2 className=\"w-4 h-4\" />\r\n                          </button>\r\n                          <div className=\"flex items-center gap-2 bg-gray-100 rounded-lg p-1\">\r\n                            <button\r\n                              onClick={() => updateCartQuantity(product.id, item.quantity - 1)}\r\n                              className=\"p-1 rounded bg-white shadow-sm\"\r\n                            >\r\n                              <Minus className=\"w-3 h-3\" />\r\n                            </button>\r\n                            <span className=\"w-6 text-center text-sm font-medium\">{item.quantity}</span>\r\n                            <button\r\n                              onClick={() => updateCartQuantity(product.id, item.quantity + 1)}\r\n                              className=\"p-1 rounded bg-white shadow-sm\"\r\n                            >\r\n                              <Plus className=\"w-3 h-3\" />\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n\r\n                {/* Cart Total */}\r\n                <div className=\"glass-card p-4 mb-4\">\r\n                  <div className=\"flex items-center justify-between mb-3\">\r\n                    <span className=\"text-gray-600\">\r\n                      {language === 'ru' ? '–¢–æ–≤–∞—Ä–æ–≤:' : 'Mahsulotlar:'}\r\n                    </span>\r\n                    <span className=\"font-medium\">{cart.reduce((sum, i) => sum + i.quantity, 0)} —à—Ç</span>\r\n                  </div>\r\n                  <div className=\"flex items-center justify-between text-lg font-bold\">\r\n                    <span>{language === 'ru' ? '–ò—Ç–æ–≥–æ:' : 'Jami:'}</span>\r\n                    <span className=\"text-orange-600\">{formatPrice(cartTotal)}</span>\r\n                  </div>\r\n                </div>\r\n\r\n                <button\r\n                  onClick={() => setShowOrderModal(true)}\r\n                  className=\"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors\"\r\n                >\r\n                  {language === 'ru' ? '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑' : 'Buyurtma berish'}\r\n                </button>\r\n              </>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Orders Tab */}\r\n        {activeTab === 'orders' && (\r\n          <div>\r\n            {orders.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <Package className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n                <p className=\"text-gray-500 mb-4\">\r\n                  {language === 'ru' ? '–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤' : 'Sizda hali buyurtmalar yo\\'q'}\r\n                </p>\r\n                <button\r\n                  onClick={() => setActiveTab('shop')}\r\n                  className=\"text-orange-600 font-medium\"\r\n                >\r\n                  {language === 'ru' ? '–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º' : 'Xaridga o\\'tish'}\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"space-y-4\">\r\n                {orders.map(order => {\r\n                  const currentStageIndex = getOrderStageIndex(order.status);\r\n                  const isCancelled = order.status === 'cancelled';\r\n                  const statusMessage = getOrderStatusMessage(order.status, language);\r\n\r\n                  return (\r\n                    <div key={order.id} className=\"glass-card overflow-hidden\">\r\n                      {/* Header */}\r\n                      <div className=\"p-4 bg-gradient-to-r from-orange-500/10 to-amber-400/10 border-b border-orange-100\">\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div>\r\n                            <p className=\"font-bold text-gray-900\">\r\n                              {language === 'ru' ? '–ó–∞–∫–∞–∑' : 'Buyurtma'} #{order.order_number}\r\n                            </p>\r\n                            <p className=\"text-sm text-gray-500\">\r\n                              {new Date(order.created_at).toLocaleDateString('ru-RU', {\r\n                                day: 'numeric',\r\n                                month: 'long',\r\n                                hour: '2-digit',\r\n                                minute: '2-digit'\r\n                              })}\r\n                            </p>\r\n                          </div>\r\n                          <span className=\"font-bold text-orange-600\">\r\n                            {formatPrice(order.total_amount)}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Status Message */}\r\n                      <div className=\"px-4 pt-4 pb-2 text-center\">\r\n                        <h3 className=\"text-lg font-bold text-gray-900\">\r\n                          {statusMessage.title}\r\n                        </h3>\r\n                        <p className=\"text-sm text-gray-500\">\r\n                          {statusMessage.subtitle}\r\n                        </p>\r\n                      </div>\r\n\r\n                      {/* Status Progress Chain */}\r\n                      <div className=\"px-4 py-4\">\r\n                        <div className=\"flex items-center justify-between relative\">\r\n                          {/* Progress Line Background */}\r\n                          <div className=\"absolute top-4 left-4 right-4 h-1 bg-gray-200 rounded-full\" />\r\n                          {/* Progress Line Active */}\r\n                          <div\r\n                            className=\"absolute top-4 left-4 h-1 bg-orange-500 rounded-full transition-all duration-500\"\r\n                            style={{\r\n                              width: isCancelled ? '0%' : `calc(${Math.min((currentStageIndex / (ORDER_STAGES.length - 1)) * 100, 100)}% - 32px)`\r\n                            }}\r\n                          />\r\n\r\n                          {/* Stage Icons */}\r\n                          {ORDER_STAGES.map((stage, index) => {\r\n                            const isCompleted = !isCancelled && currentStageIndex >= index;\r\n                            const isCurrent = !isCancelled && currentStageIndex === index;\r\n                            const StageIcon = stage.icon;\r\n\r\n                            return (\r\n                              <div key={stage.id} className=\"relative z-10 flex flex-col items-center\">\r\n                                <div\r\n                                  className={`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${\r\n                                    isCancelled\r\n                                      ? 'bg-gray-200 text-gray-400'\r\n                                      : isCompleted\r\n                                        ? isCurrent\r\n                                          ? 'bg-orange-500 text-white ring-4 ring-orange-200 shadow-lg'\r\n                                          : 'bg-orange-500 text-white'\r\n                                        : 'bg-gray-200 text-gray-400'\r\n                                  }`}\r\n                                >\r\n                                  <StageIcon className=\"w-4 h-4\" />\r\n                                </div>\r\n                                <span className={`text-[10px] mt-1.5 font-medium text-center max-w-[50px] leading-tight ${\r\n                                  isCompleted && !isCancelled ? 'text-gray-900' : 'text-gray-400'\r\n                                }`}>\r\n                                  {language === 'ru' ? stage.labelRu : stage.labelUz}\r\n                                </span>\r\n                              </div>\r\n                            );\r\n                          })}\r\n                        </div>\r\n\r\n                        {/* Cancelled State */}\r\n                        {isCancelled && (\r\n                          <div className=\"mt-4 p-3 bg-red-50 rounded-xl flex items-center gap-2\">\r\n                            <div className=\"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center\">\r\n                              <X className=\"w-4 h-4 text-red-500\" />\r\n                            </div>\r\n                            <div className=\"text-sm font-medium text-red-700\">\r\n                              {language === 'ru' ? '–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω' : 'Buyurtma bekor qilindi'}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {/* Order Items Preview */}\r\n                      <div className=\"px-4 pb-4 border-t border-gray-100 pt-3\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <div className=\"flex -space-x-2\">\r\n                            {(order.items || []).slice(0, 3).map((item, idx) => (\r\n                              <div key={idx} className=\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border-2 border-white\">\r\n                                {item.product_image ? (\r\n                                  <img src={item.product_image} alt=\"\" className=\"w-full h-full object-cover rounded-lg\" />\r\n                                ) : (\r\n                                  <span className=\"text-sm\">üì¶</span>\r\n                                )}\r\n                              </div>\r\n                            ))}\r\n                            {(order.items || []).length > 3 && (\r\n                              <div className=\"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border-2 border-white text-xs text-gray-500 font-medium\">\r\n                                +{(order.items || []).length - 3}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                          <span className=\"text-sm text-gray-500 ml-2\">\r\n                            {(order.items || []).reduce((sum, i) => sum + i.quantity, 0)} {language === 'ru' ? '—Ç–æ–≤–∞—Ä–æ–≤' : 'mahsulot'}\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n        {/* Favorites Tab */}\r\n        {activeTab === 'favorites' && (\r\n          <div>\r\n            {favorites.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <Heart className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n                <p className=\"text-gray-500 mb-4\">\r\n                  {language === 'ru' ? '–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç' : 'Sevimli mahsulotlar yo\\'q'}\r\n                </p>\r\n                <button\r\n                  onClick={() => setActiveTab('shop')}\r\n                  className=\"text-orange-600 font-medium\"\r\n                >\r\n                  {language === 'ru' ? '–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º' : 'Xaridga o\\'tish'}\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <div className=\"grid grid-cols-2 gap-3\">\r\n                {products.filter(p => favorites.includes(p.id)).map(product => {\r\n                  const cartQty = getCartQuantity(product.id);\r\n\r\n                  return (\r\n                    <div key={product.id} className=\"glass-card overflow-hidden\">\r\n                      <div className=\"relative aspect-square bg-gray-100 flex items-center justify-center\">\r\n                        {product.image_url ? (\r\n                          <img\r\n                            src={product.image_url}\r\n                            alt={language === 'ru' ? product.name_ru : product.name_uz}\r\n                            className=\"w-full h-full object-cover\"\r\n                          />\r\n                        ) : (\r\n                          <span className=\"text-4xl\">\r\n                            {CATEGORY_ICONS[product.category_id] || 'üì¶'}\r\n                          </span>\r\n                        )}\r\n                        <button\r\n                          onClick={() => toggleFavorite(product.id)}\r\n                          className=\"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm\"\r\n                        >\r\n                          <Heart className=\"w-4 h-4 fill-red-500 text-red-500\" />\r\n                        </button>\r\n                      </div>\r\n                      <div className=\"p-3\">\r\n                        <h3 className=\"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]\">\r\n                          {language === 'ru' ? product.name_ru : product.name_uz}\r\n                        </h3>\r\n                        <p className=\"font-bold text-orange-600 mt-2\">\r\n                          {formatPrice(product.price)}\r\n                        </p>\r\n                        {cartQty > 0 ? (\r\n                          <div className=\"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1\">\r\n                            <button\r\n                              onClick={() => updateCartQuantity(product.id, cartQty - 1)}\r\n                              className=\"p-1.5 rounded-md bg-white shadow-sm\"\r\n                            >\r\n                              <Minus className=\"w-4 h-4 text-orange-600\" />\r\n                            </button>\r\n                            <span className=\"font-medium text-orange-600\">{cartQty}</span>\r\n                            <button\r\n                              onClick={() => updateCartQuantity(product.id, cartQty + 1)}\r\n                              className=\"p-1.5 rounded-md bg-white shadow-sm\"\r\n                            >\r\n                              <Plus className=\"w-4 h-4 text-orange-600\" />\r\n                            </button>\r\n                          </div>\r\n                        ) : (\r\n                          <button\r\n                            onClick={() => addToCart(product.id)}\r\n                            className=\"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors flex items-center justify-center gap-1\"\r\n                          >\r\n                            <Plus className=\"w-4 h-4\" />\r\n                            <span>{language === 'ru' ? '–í –∫–æ—Ä–∑–∏–Ω—É' : 'Savatga'}</span>\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Product Detail Modal */}\r\n      {selectedProduct && (\r\n        <div className=\"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end\">\r\n          <div className=\"bg-white/95 backdrop-blur-md w-full rounded-t-3xl max-h-[90vh] overflow-y-auto animate-slide-up\">\r\n            <div className=\"sticky top-0 bg-white/90 backdrop-blur-md p-4 border-b flex items-center justify-between z-10\">\r\n              <h2 className=\"font-bold text-lg\">\r\n                {language === 'ru' ? selectedProduct.name_ru : selectedProduct.name_uz}\r\n              </h2>\r\n              <button\r\n                onClick={() => setSelectedProduct(null)}\r\n                className=\"p-2 hover:bg-gray-100 rounded-full\"\r\n              >\r\n                <X className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"p-4\">\r\n              <div className=\"aspect-square bg-gray-100 rounded-xl flex items-center justify-center mb-4\">\r\n                {selectedProduct.image_url ? (\r\n                  <img\r\n                    src={selectedProduct.image_url}\r\n                    alt=\"\"\r\n                    className=\"w-full h-full object-cover rounded-xl\"\r\n                  />\r\n                ) : (\r\n                  <span className=\"text-6xl\">\r\n                    {CATEGORY_ICONS[selectedProduct.category_id] || 'üì¶'}\r\n                  </span>\r\n                )}\r\n              </div>\r\n\r\n              <p className=\"text-gray-600 mb-4\">\r\n                {language === 'ru' ? selectedProduct.description_ru : selectedProduct.description_uz}\r\n              </p>\r\n\r\n              <div className=\"flex items-center justify-between mb-4\">\r\n                <div>\r\n                  <p className=\"text-2xl font-bold text-orange-600\">\r\n                    {formatPrice(selectedProduct.price)}\r\n                  </p>\r\n                  {selectedProduct.old_price && (\r\n                    <p className=\"text-gray-400 line-through\">\r\n                      {formatPrice(selectedProduct.old_price)}\r\n                    </p>\r\n                  )}\r\n                </div>\r\n                <p className=\"text-gray-500\">{selectedProduct.unit}</p>\r\n              </div>\r\n\r\n              {selectedProduct.stock_quantity > 0 ? (\r\n                <p className=\"text-green-600 text-sm mb-4\">\r\n                  {language === 'ru' ? '–í –Ω–∞–ª–∏—á–∏–∏' : 'Mavjud'}\r\n                </p>\r\n              ) : (\r\n                <p className=\"text-red-600 text-sm mb-4\">\r\n                  {language === 'ru' ? '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏' : 'Mavjud emas'}\r\n                </p>\r\n              )}\r\n\r\n              <div className=\"flex gap-3\">\r\n                <button\r\n                  onClick={() => toggleFavorite(selectedProduct.id)}\r\n                  className=\"p-3 border rounded-xl\"\r\n                >\r\n                  <Heart\r\n                    className={`w-6 h-6 ${\r\n                      favorites.includes(selectedProduct.id)\r\n                        ? 'fill-red-500 text-red-500'\r\n                        : 'text-gray-400'\r\n                    }`}\r\n                  />\r\n                </button>\r\n                <button\r\n                  onClick={() => {\r\n                    addToCart(selectedProduct.id);\r\n                    setSelectedProduct(null);\r\n                  }}\r\n                  disabled={selectedProduct.stock_quantity === 0}\r\n                  className=\"flex-1 py-3 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\r\n                >\r\n                  <ShoppingCart className=\"w-5 h-5\" />\r\n                  <span>{language === 'ru' ? '–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É' : 'Savatga qo\\'shish'}</span>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Order Confirmation Modal */}\r\n      {showOrderModal && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4\">\r\n          <div className=\"bg-white w-full max-w-md rounded-2xl overflow-hidden\">\r\n            <div className=\"p-4 border-b flex items-center justify-between\">\r\n              <h2 className=\"font-bold text-lg\">\r\n                {language === 'ru' ? '–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞' : 'Buyurtmani rasmiylashtirish'}\r\n              </h2>\r\n              <button\r\n                onClick={() => setShowOrderModal(false)}\r\n                className=\"p-2 hover:bg-gray-100 rounded-full\"\r\n              >\r\n                <X className=\"w-5 h-5\" />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"p-4\">\r\n              <div className=\"bg-gray-50 rounded-xl p-4 mb-4\">\r\n                <p className=\"text-sm text-gray-600 mb-2\">\r\n                  {language === 'ru' ? '–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:' : 'Yetkazish manzili:'}\r\n                </p>\r\n                <p className=\"font-medium\">\r\n                  {user?.address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω'}, {language === 'ru' ? '–∫–≤.' : 'xonadon'} {user?.apartment || '-'}\r\n                </p>\r\n              </div>\r\n\r\n              <div className=\"mb-4\">\r\n                <label className=\"block text-sm text-gray-600 mb-2\">\r\n                  {language === 'ru' ? '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É:' : 'Buyurtmaga izoh:'}\r\n                </label>\r\n                <textarea\r\n                  value={deliveryNote}\r\n                  onChange={(e) => setDeliveryNote(e.target.value)}\r\n                  placeholder={language === 'ru' ? '–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏' : 'Masalan: yetkazishdan 10 daqiqa oldin qo\\'ng\\'iroq qiling'}\r\n                  className=\"w-full p-3 border rounded-xl resize-none\"\r\n                  rows={3}\r\n                />\r\n              </div>\r\n\r\n              <div className=\"bg-orange-50 rounded-xl p-4 mb-4\">\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-gray-700\">\r\n                    {language === 'ru' ? '–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:' : 'To\\'lanishi kerak:'}\r\n                  </span>\r\n                  <span className=\"text-xl font-bold text-orange-600\">\r\n                    {formatPrice(cartTotal)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              <button\r\n                onClick={createOrder}\r\n                className=\"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors\"\r\n              >\r\n                {language === 'ru' ? '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑' : 'Buyurtmani tasdiqlash'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["ORDER_STAGES","ShoppingBag","CheckCircle","ChefHat","Truck","getOrderStageIndex","status","i","getOrderStatusMessage","language","CATEGORY_ICONS","MarketplacePage","user","useAuthStore","useLanguageStore","activeTab","setActiveTab","useState","categories","setCategories","products","setProducts","cart","setCart","orders","setOrders","favorites","setFavorites","selectedCategory","setSelectedCategory","searchQuery","setSearchQuery","loading","setLoading","selectedProduct","setSelectedProduct","showOrderModal","setShowOrderModal","deliveryNote","setDeliveryNote","orderSuccess","setOrderSuccess","fetchData","useCallback","categoriesRes","productsRes","apiRequest","cartRes","ordersRes","favoritesRes","f","useEffect","addToCart","productId","quantity","updateCartQuantity","removeFromCart","toggleFavorite","isFavorite","id","createOrder","filteredProducts","p","matchesCategory","matchesSearch","getCartQuantity","c","cartTotal","sum","item","product","formatPrice","price","tabs","ShoppingCart","Package","o","Heart","jsx","jsxs","tab","Search","e","cat","cartQty","Minus","Plus","Fragment","Trash2","order","currentStageIndex","isCancelled","statusMessage","stage","index","isCompleted","isCurrent","StageIcon","X","idx"],"mappings":"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"}