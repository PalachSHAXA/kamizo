const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ManagerDashboard-1768932757711-DSjr5U0w.js","assets/react-vendor-1768932757711-f98vhKqL.js","assets/vendor-1768932757711-DGkvFKDM.js","assets/qr-scanner-1768932757711-cr32YHjo.js","assets/zustand-1768932757711-wNUYBKDB.js","assets/LazyCharts-1768932757711-_lrJ8Ei6.js","assets/charts-1768932757711-DPdOW-L9.js","assets/formatAddress-1768932757711-OwpdX0o2.js","assets/DepartmentHeadDashboard-1768932757711-D0-eCE3W.js","assets/ExecutorDashboard-1768932757711-Cy9ROWZH.js","assets/ExecutorSchedulePage-1768932757711-BrvuSqYt.js","assets/ExecutorStatsPage-1768932757711-RSMifDbB.js","assets/ExecutorAnnouncementsPage-1768932757711-DTdNWky1.js","assets/ResidentDashboard-1768932757711-BZe1JmRA.js","assets/AdminDashboard-1768932757711-64VgSxW1.js","assets/DirectorDashboard-1768932757711-B5rnPIC7.js","assets/BuildingsPage-1768932757711-QkUXHkeS.js","assets/AnnouncementsPage-1768932757711-Dba57RfE.js","assets/MeetingsPage-1768932757711-CGccnF0z.js","assets/ResidentAnnouncementsPage-1768932757711-DKYbHZS3.js","assets/ResidentMeetingsPage-1768932757711-CXPhkWgP.js","assets/LazyQRCode-1768932757711-DUeUph5l.js","assets/ResidentRateEmployeesPage-1768932757711-BtG2mAxe.js","assets/WorkOrdersPage-1768932757711-DsQqNjuR.js","assets/TrainingsPage-1768932757711-BN5wiTSR.js","assets/ColleaguesSection-1768932757711-CxTai_k0.js","assets/ResidentVehiclesPage-1768932757711-Bdb0iGmF.js","assets/VehicleSearchPage-1768932757711-BBlAhQNG.js","assets/ResidentGuestAccessPage-1768932757711-BQtSyw63.js","assets/GuardQRScannerPage-1768932757711-BzVMWyw9.js","assets/ManagerGuestAccessPage-1768932757711-U9qAiKUA.js","assets/ResidentsPage-1768932757711-CrFfuX0_.js","assets/ChatPage-1768932757711-fKnKiPBJ.js","assets/ResidentProfilePage-1768932757711-B-dh1Lbz.js","assets/ContractPreview-1768932757711-D-288Bq0.js","assets/ResidentContractPage-1768932757711-BMvoaDFm.js","assets/ResidentUsefulContactsPage-1768932757711-C1F1oMiI.js","assets/AdvertiserDashboard-1768932757711-6j9mc1XA.js","assets/CouponCheckerDashboard-1768932757711-mY7_yOFC.js","assets/NotepadPage-1768932757711-YFdZwGgM.js","assets/TenantDashboard-1768932757711-oNWZzJfM.js","assets/ExecutorsPage-1768932757711-ChQaiWbn.js","assets/RequestsPage-1768932757711-jxDhP2a4.js","assets/RentalsPage-1768932757711-BZX1dhAJ.js","assets/TeamPage-1768932757711-D4y-8bW_.js","assets/ReportsPage-1768932757711-BtgGAc1T.js","assets/SettingsPage-1768932757711-lYA971fi.js","assets/MonitoringPage-1768932757711-BApz3j5k.js","assets/MarketplacePage-1768932757711-dJSQ2SpJ.js","assets/MarketplaceManagerDashboard-1768932757711-jKcwjfWN.js","assets/MarketplaceOrdersPage-1768932757711-Ci24qOHw.js"])))=>i.map(i=>d[i]);
var Zt=Object.defineProperty;var en=(e,s,t)=>s in e?Zt(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var ae=(e,s,t)=>en(e,typeof s!="symbol"?s+"":s,t);import{c as we,j as i,u as qt,r as p,X as He,L as xt,U as tn,d as nn,e as je,T as rn,S as ke,F as ne,C as sn,f as ee,g as Re,M as J,G as Te,h as M,i as qe,H as Ot,k as Oe,Q as Ie,V as Pe,l as ht,m as an,n as on,K as Me,o as cn,B as We,W as be,p as Xe,q as ln,t as It,a as ot,v as dn,x as ge,y as Je,z as wt,A as Pt,D as un,E as mn,I as gn,J as zt,Z as Ze,N as pn,O as ct,Y as hn,_ as q,$ as Et,a0 as yn,a1 as fn,a2 as bn,a3 as vn,a4 as xn,a5 as wn,a6 as _n,a7 as _t,a8 as An,a9 as Sn}from"./react-vendor-1768932757711-f98vhKqL.js";import{p as _e}from"./zustand-1768932757711-wNUYBKDB.js";import"./vendor-1768932757711-DGkvFKDM.js";import"./qr-scanner-1768932757711-cr32YHjo.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const Ct="",Nn=()=>localStorage.getItem("auth_token"),me=new Map,ze=new Map,H={SHORT:10*1e3,MEDIUM:60*1e3,LONG:120*1e3};function jn(e){const s=me.get(e);return s?Date.now()-s.timestamp>s.ttl?(me.delete(e),null):s.data:null}function kn(e,s,t){me.set(e,{data:s,timestamp:Date.now(),ttl:t})}function z(e){if(!e){me.clear();return}for(const s of me.keys())s.includes(e)&&me.delete(s)}const Rn=3e4;async function u(e,s={},t=Rn){const n=Nn(),r={"Content-Type":"application/json",...n?{Authorization:`Bearer ${n}`}:{},...s.headers},a=new AbortController,o=setTimeout(()=>a.abort(),t);try{const c=await fetch(`${Ct}${e}`,{...s,headers:r,signal:a.signal}),l=await c.json();if(!c.ok)throw new Error(l.error||"API Error");return l}catch(c){throw c instanceof Error&&c.name==="AbortError"?new Error("Превышено время ожидания запроса. Проверьте соединение."):c}finally{clearTimeout(o)}}async function Y(e,s=H.SHORT){const t=e,n=jn(t);if(n)return n;const r=ze.get(t);if(r)return r;const a=u(e).then(o=>(kn(t,o,s),ze.delete(t),o)).catch(o=>{throw ze.delete(t),o});return ze.set(t,a),a}async function k(e,s={}){try{return{success:!0,data:await u(e,s)}}catch(t){return{success:!1,error:t.message||"API Error"}}}function lt(e){return e&&{...e,passwordChangedAt:e.password_changed_at||e.passwordChangedAt,contractSignedAt:e.contract_signed_at||e.contractSignedAt,buildingId:e.building_id||e.buildingId,totalArea:e.total_area||e.totalArea,signatureKey:e.signature_key||e.signatureKey}}const ce={login:async(e,s)=>{const t=await u("/api/auth/login",{method:"POST",body:JSON.stringify({login:e,password:s})});return localStorage.setItem("auth_token",t.token),{...t,user:lt(t.user)}},logout:()=>{localStorage.removeItem("auth_token")},register:async e=>u("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),registerBulk:async e=>u("/api/auth/register-bulk",{method:"POST",body:JSON.stringify({users:e})})},le={getMe:async()=>{const e=await u("/api/users/me");return{user:lt(e.user)}},updateMe:async e=>{const s=await u("/api/users/me",{method:"PATCH",body:JSON.stringify(e)});return{user:lt(s.user)}},changePassword:async(e,s)=>u("/api/users/me/password",{method:"POST",body:JSON.stringify({current_password:e,new_password:s})}),markContractSigned:async()=>u("/api/users/me/contract-signed",{method:"POST"}),adminChangePassword:async(e,s)=>u(`/api/users/${e}/password`,{method:"POST",body:JSON.stringify({new_password:s})}),getAll:async e=>{const s=new URLSearchParams;e?.role&&s.append("role",e.role),e?.building_id&&s.append("building_id",e.building_id),e?.limit&&s.append("limit",e.limit.toString());const t=s.toString();return u(`/api/users${t?"?"+t:""}`)},delete:async e=>u(`/api/users/${e}`,{method:"DELETE"})},W={getMyVehicles:async()=>Y("/api/vehicles",H.MEDIUM),getAll:async e=>{const s=new URLSearchParams;e?.page&&s.append("page",String(e.page)),e?.limit&&s.append("limit",String(e.limit)),e?.search&&s.append("search",e.search);const t=s.toString();return u(`/api/vehicles/all${t?"?"+t:""}`)},getForResident:async e=>Y(`/api/vehicles?resident_id=${e}`,H.MEDIUM),create:async e=>u("/api/vehicles",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/vehicles/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/vehicles/${e}`,{method:"DELETE"}),search:async e=>u(`/api/vehicles/search?plate=${encodeURIComponent(e)}`)},F={getApartments:async()=>u("/api/rentals/apartments"),getMyApartments:async()=>u("/api/rentals/my-apartments"),createApartment:async e=>u("/api/rentals/apartments",{method:"POST",body:JSON.stringify(e)}),updateApartment:async(e,s)=>u(`/api/rentals/apartments/${e}`,{method:"PATCH",body:JSON.stringify(s)}),deleteApartment:async e=>u(`/api/rentals/apartments/${e}`,{method:"DELETE"}),getRecords:async e=>{const s=e?`/api/rentals/records?apartmentId=${e}`:"/api/rentals/records";return u(s)},createRecord:async e=>u("/api/rentals/records",{method:"POST",body:JSON.stringify(e)}),updateRecord:async(e,s)=>u(`/api/rentals/records/${e}`,{method:"PATCH",body:JSON.stringify(s)}),deleteRecord:async e=>u(`/api/rentals/records/${e}`,{method:"DELETE"})},Ue={getAll:async()=>Y("/api/guest-codes",H.SHORT),getById:async e=>Y(`/api/guest-codes/${e}`,H.SHORT),create:async e=>u("/api/guest-codes",{method:"POST",body:JSON.stringify(e)}),revoke:async(e,s)=>u(`/api/guest-codes/${e}/revoke`,{method:"POST",body:JSON.stringify({reason:s})}),delete:async e=>u(`/api/guest-codes/${e}`,{method:"DELETE"}),validate:async e=>u("/api/guest-codes/validate",{method:"POST",body:JSON.stringify({qr_token:e})}),use:async e=>u(`/api/guest-codes/${e}/use`,{method:"POST"}),getLogs:async e=>u(`/api/guest-codes/${e}/logs`)},Lt={getChannels:async()=>u("/api/chat/channels"),createChannel:async e=>u("/api/chat/channels",{method:"POST",body:JSON.stringify(e)}),getMessages:async(e,s=50,t)=>{const n=new URLSearchParams({limit:String(s)});return t&&n.append("before",t),u(`/api/chat/channels/${e}/messages?${n}`)},sendMessage:async(e,s)=>u(`/api/chat/channels/${e}/messages`,{method:"POST",body:JSON.stringify({content:s})}),markRead:async e=>u(`/api/chat/channels/${e}/read`,{method:"POST"}),markMessageRead:async(e,s)=>u(`/api/chat/channels/${e}/messages/${s}/read`,{method:"POST"}),getOrCreateSupportChannel:async()=>u("/api/chat/channels/support",{method:"POST"}),getAllSupportChannels:async()=>u("/api/chat/channels?type=private_support"),getUnreadCount:async()=>u("/api/chat/unread-count")},Tn={getAll:async()=>Y("/api/announcements",H.SHORT),create:async e=>{const s=await u("/api/announcements",{method:"POST",body:JSON.stringify(e)});return z("/api/announcements"),s},delete:async e=>{const s=await u(`/api/announcements/${e}`,{method:"DELETE"});return z("/api/announcements"),s},update:async(e,s)=>{const t=await u(`/api/announcements/${e}`,{method:"PUT",body:JSON.stringify(s)});return z("/api/announcements"),t},markAsViewed:async e=>u(`/api/announcements/${e}/view`,{method:"POST"}),getViews:async e=>u(`/api/announcements/${e}/views`)},$t={uploadFile:async e=>{const s=new FormData;s.append("file",e);const t=localStorage.getItem("auth_token"),n=await fetch(`${Ct}/api/upload`,{method:"POST",headers:t?{Authorization:`Bearer ${t}`}:{},body:s});if(!n.ok){const a=await n.json();throw new Error(a.error||"Upload failed")}return(await n.json()).file},uploadFiles:async e=>await Promise.all(e.map(t=>$t.uploadFile(t)))},qn={getAll:async()=>Y("/api/branches",H.LONG),getById:async e=>u(`/api/branches/${e}`)},de={getAll:async()=>Y("/api/buildings",H.LONG),getById:async e=>Y(`/api/buildings/${e}`,H.LONG),create:async e=>{const s=await u("/api/buildings",{method:"POST",body:JSON.stringify(e)});return z("/api/buildings"),s},update:async(e,s)=>{const t=await u(`/api/buildings/${e}`,{method:"PATCH",body:JSON.stringify(s)});return z("/api/buildings"),t},delete:async e=>{const s=await u(`/api/buildings/${e}`,{method:"DELETE"});return z("/api/buildings"),s}},ve={getByBuilding:async e=>u(`/api/buildings/${e}/entrances`),create:async(e,s)=>u(`/api/buildings/${e}/entrances`,{method:"POST",body:JSON.stringify(s)}),update:async(e,s)=>u(`/api/entrances/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/entrances/${e}`,{method:"DELETE"})},dt={getByBuilding:async e=>u(`/api/buildings/${e}/documents`),create:async(e,s)=>u(`/api/buildings/${e}/documents`,{method:"POST",body:JSON.stringify(s)}),delete:async e=>u(`/api/building-documents/${e}`,{method:"DELETE"})},ue={getByBuilding:async(e,s)=>{const t=new URLSearchParams;s?.entranceId&&t.append("entrance_id",s.entranceId),s?.status&&t.append("status",s.status),s?.page&&t.append("page",s.page.toString()),s?.limit&&t.append("limit",s.limit.toString());const n=t.toString()?`?${t.toString()}`:"";return u(`/api/buildings/${e}/apartments${n}`)},getById:async e=>u(`/api/apartments/${e}`),create:async(e,s)=>u(`/api/buildings/${e}/apartments`,{method:"POST",body:JSON.stringify(s)}),update:async(e,s)=>u(`/api/apartments/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/apartments/${e}`,{method:"DELETE"})},X={getAll:async e=>{const s=new URLSearchParams;e?.type&&s.append("type",e.type),e?.search&&s.append("search",e.search),e?.page&&s.append("page",e.page.toString()),e?.limit&&s.append("limit",e.limit.toString());const t=s.toString()?`?${s.toString()}`:"";return u(`/api/owners${t}`)},getById:async e=>u(`/api/owners/${e}`),create:async e=>u("/api/owners",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/owners/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/owners/${e}`,{method:"DELETE"}),linkToApartment:async(e,s,t)=>u(`/api/owners/${e}/apartments/${s}`,{method:"POST",body:JSON.stringify(t||{})}),unlinkFromApartment:async(e,s)=>u(`/api/owners/${e}/apartments/${s}`,{method:"DELETE"})},xe={getByBuilding:async(e,s)=>{const t=new URLSearchParams;s?.status&&t.append("status",s.status),s?.hasDebt&&t.append("has_debt","true"),s?.page&&t.append("page",s.page.toString()),s?.limit&&t.append("limit",s.limit.toString());const n=t.toString()?`?${t.toString()}`:"";return u(`/api/buildings/${e}/accounts${n}`)},getById:async e=>u(`/api/accounts/${e}`),create:async e=>u("/api/accounts",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/accounts/${e}`,{method:"PATCH",body:JSON.stringify(s)}),getDebtors:async e=>{const s=new URLSearchParams;e?.minDebt&&s.append("min_debt",e.minDebt.toString()),e?.buildingId&&s.append("building_id",e.buildingId);const t=s.toString()?`?${s.toString()}`:"";return u(`/api/accounts/debtors${t}`)}},oe={getByApartment:async(e,s)=>{const t=new URLSearchParams;s?.isActive!==void 0&&t.append("is_active",s.isActive.toString());const n=t.toString()?`?${t.toString()}`:"";return u(`/api/apartments/${e}/residents${n}`)},getById:async e=>u(`/api/residents/${e}`),create:async(e,s)=>u(`/api/apartments/${e}/residents`,{method:"POST",body:JSON.stringify(s)}),update:async(e,s)=>u(`/api/residents/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/residents/${e}`,{method:"DELETE"}),moveOut:async(e,s)=>u(`/api/residents/${e}/move-out`,{method:"POST",body:JSON.stringify(s)})},Z={getByApartment:async(e,s)=>{const t=new URLSearchParams;s?.type&&t.append("type",s.type),s?.isActive!==void 0&&t.append("is_active",s.isActive.toString());const n=t.toString()?`?${t.toString()}`:"";return u(`/api/apartments/${e}/meters${n}`)},getByBuilding:async(e,s)=>{const t=new URLSearchParams;s?.type&&t.append("type",s.type),s?.isCommon!==void 0&&t.append("is_common",s.isCommon.toString());const n=t.toString()?`?${t.toString()}`:"";return u(`/api/buildings/${e}/meters${n}`)},getById:async e=>u(`/api/meters/${e}`),create:async e=>u("/api/meters",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/meters/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/meters/${e}`,{method:"DELETE"}),decommission:async(e,s)=>u(`/api/meters/${e}/decommission`,{method:"POST",body:JSON.stringify({reason:s})})},Be={getByMeter:async(e,s)=>{const t=new URLSearchParams;s?.limit&&t.append("limit",s.limit.toString()),s?.offset&&t.append("offset",s.offset.toString()),s?.status&&t.append("status",s.status);const n=t.toString()?`?${t.toString()}`:"";return u(`/api/meters/${e}/readings${n}`)},getLastReading:async e=>u(`/api/meters/${e}/last-reading`),submit:async(e,s)=>u(`/api/meters/${e}/readings`,{method:"POST",body:JSON.stringify(s)}),verify:async(e,s)=>u(`/api/meter-readings/${e}/verify`,{method:"POST",body:JSON.stringify(s)})},On={getAll:async()=>u("/api/team",{cache:"no-store"}),getById:async e=>u(`/api/team/${e}`,{cache:"no-store"}),create:async e=>u("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/team/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/team/${e}`,{method:"DELETE"}),resetAllPasswords:async()=>u("/api/team/reset-all-passwords",{method:"POST"})},Mt={getAll:async(e=!1)=>u(e?"/api/executors?all=true":"/api/executors",{cache:"no-store"}),getById:async e=>u(`/api/executors/${e}`,{cache:"no-store"}),updateStatus:async(e,s)=>u(`/api/executors/${e}/status`,{method:"PATCH",body:JSON.stringify({status:s})}),getStats:async e=>u(`/api/executors/${e}/stats`)},B={getAll:async(e,s)=>{const t=new URLSearchParams;e&&t.append("status",e),s&&t.append("category",s);const n=t.toString();return Y(`/api/requests${n?"?"+n:""}`,H.SHORT)},create:async e=>{const s=await u("/api/requests",{method:"POST",body:JSON.stringify(e)});return z("/api/requests"),s},update:async(e,s)=>{const t=await u(`/api/requests/${e}`,{method:"PATCH",body:JSON.stringify(s)});return z("/api/requests"),t},assign:async(e,s)=>{const t=await u(`/api/requests/${e}/assign`,{method:"POST",body:JSON.stringify({executor_id:s})});return z("/api/requests"),t},accept:async e=>{const s=await u(`/api/requests/${e}/accept`,{method:"POST"});return z("/api/requests"),s},start:async e=>{const s=await u(`/api/requests/${e}/start`,{method:"POST"});return z("/api/requests"),s},complete:async e=>(z("/api/requests"),u(`/api/requests/${e}/complete`,{method:"POST"})),pause:async e=>{const s=await u(`/api/requests/${e}/pause`,{method:"POST"});return z("/api/requests"),s},resume:async e=>{const s=await u(`/api/requests/${e}/resume`,{method:"POST"});return z("/api/requests"),s},approve:async(e,s,t)=>{const n=await u(`/api/requests/${e}/approve`,{method:"POST",body:JSON.stringify({rating:s,feedback:t})});return z("/api/requests"),n},reject:async(e,s)=>{const t=await u(`/api/requests/${e}/reject`,{method:"POST",body:JSON.stringify({reason:s})});return z("/api/requests"),t},rate:async(e,s,t)=>u(`/api/requests/${e}/rate`,{method:"POST",body:JSON.stringify({rating:s,feedback:t})}),cancel:async(e,s)=>{const t=await u(`/api/requests/${e}/cancel`,{method:"POST",body:JSON.stringify({reason:s})});return z("/api/requests"),t},decline:async(e,s)=>{const t=await u(`/api/requests/${e}/decline`,{method:"POST",body:JSON.stringify({reason:s})});return z("/api/requests"),t},createReschedule:async(e,s)=>u(`/api/requests/${e}/reschedule`,{method:"POST",body:JSON.stringify(s)}),getReschedules:async e=>u(`/api/requests/${e}/reschedule`)},In={getPending:async()=>u("/api/reschedule-requests"),respond:async(e,s,t)=>u(`/api/reschedule-requests/${e}/respond`,{method:"POST",body:JSON.stringify({accepted:s,response_note:t})})},Pn={getAll:async e=>u(`/api/training/partners${e?"?active=true":""}`),getById:async e=>u(`/api/training/partners/${e}`),create:async e=>u("/api/training/partners",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/training/partners/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/training/partners/${e}`,{method:"DELETE"})},zn={getAll:async e=>{const s=new URLSearchParams;e?.status&&s.append("status",e.status),e?.partnerId&&s.append("partner_id",e.partnerId),e?.authorId&&s.append("author_id",e.authorId),e?.page&&s.append("page",e.page.toString()),e?.limit&&s.append("limit",e.limit.toString());const t=s.toString()?`?${s.toString()}`:"";return u(`/api/training/proposals${t}`)},getById:async e=>u(`/api/training/proposals/${e}`),create:async e=>u("/api/training/proposals",{method:"POST",body:JSON.stringify(e)}),update:async(e,s)=>u(`/api/training/proposals/${e}`,{method:"PATCH",body:JSON.stringify(s)}),delete:async e=>u(`/api/training/proposals/${e}`,{method:"DELETE"}),schedule:async(e,s)=>u(`/api/training/proposals/${e}/schedule`,{method:"POST",body:JSON.stringify(s)}),complete:async(e,s)=>u(`/api/training/proposals/${e}/complete`,{method:"POST",body:JSON.stringify(s||{})})},En={getForProposal:async e=>u(`/api/training/proposals/${e}/votes`),vote:async(e,s)=>u(`/api/training/proposals/${e}/votes`,{method:"POST",body:JSON.stringify(s)}),removeVote:async e=>u(`/api/training/proposals/${e}/votes`,{method:"DELETE"})},Cn={register:async e=>u(`/api/training/proposals/${e}/register`,{method:"POST"}),unregister:async e=>u(`/api/training/proposals/${e}/register`,{method:"DELETE"}),confirmAttendance:async(e,s)=>u(`/api/training/proposals/${e}/attendance/${s}`,{method:"POST"})},Ln={getForProposal:async e=>u(`/api/training/proposals/${e}/feedback`),submit:async(e,s)=>u(`/api/training/proposals/${e}/feedback`,{method:"POST",body:JSON.stringify(s)})},$n={getAll:async e=>u(`/api/training/notifications${e?"?unread=true":""}`),markAsRead:async e=>u(`/api/training/notifications/${e}/read`,{method:"POST"}),markAllAsRead:async()=>u("/api/training/notifications/read-all",{method:"POST"})},Mn={getAll:async()=>u("/api/training/settings"),update:async e=>u("/api/training/settings",{method:"PATCH",body:JSON.stringify(e)})},L={getAll:async e=>{const s=new URLSearchParams;e?.buildingId&&s.append("building_id",e.buildingId),e?.status&&s.append("status",e.status),e?.organizerId&&s.append("organizer_id",e.organizerId),e?.onlyActive&&s.append("only_active","true");const t=s.toString()?`?${s.toString()}`:"";return k(`/api/meetings${t}`).then(n=>({success:n.success,data:n.data?.meetings||n.data,error:n.error}))},getById:async e=>k(`/api/meetings/${e}`).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),create:async e=>k("/api/meetings",{method:"POST",body:JSON.stringify(e)}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),update:async(e,s)=>k(`/api/meetings/${e}`,{method:"PATCH",body:JSON.stringify(s)}).then(t=>({success:t.success,data:t.data?.meeting||t.data,error:t.error})),delete:async e=>k(`/api/meetings/${e}`,{method:"DELETE"}),submit:async e=>k(`/api/meetings/${e}/submit`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),approve:async e=>k(`/api/meetings/${e}/approve`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),reject:async(e,s)=>k(`/api/meetings/${e}/reject`,{method:"POST",body:JSON.stringify({reason:s})}).then(t=>({success:t.success,data:t.data?.meeting||t.data,error:t.error})),openSchedulePoll:async e=>k(`/api/meetings/${e}/open-schedule-poll`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),confirmSchedule:async(e,s)=>k(`/api/meetings/${e}/confirm-schedule`,{method:"POST",body:JSON.stringify({optionId:s})}).then(t=>({success:t.success,data:t.data?.meeting||t.data,error:t.error})),openVoting:async e=>k(`/api/meetings/${e}/open-voting`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),closeVoting:async e=>k(`/api/meetings/${e}/close-voting`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),publishResults:async e=>k(`/api/meetings/${e}/publish-results`,{method:"POST"}).then(s=>({success:s.success,data:s.data?.meeting||s.data,error:s.error})),generateProtocol:async e=>k(`/api/meetings/${e}/generate-protocol`,{method:"POST"}).then(s=>({success:s.success,data:s.data,error:s.error})),approveProtocol:async(e,s)=>k(`/api/meetings/${e}/approve-protocol`,{method:"POST",body:s?JSON.stringify(s):void 0}).then(t=>({success:t.success,data:t.data,error:t.error})),cancel:async(e,s)=>k(`/api/meetings/${e}/cancel`,{method:"POST",body:JSON.stringify({reason:s})}).then(t=>({success:t.success,data:t.data?.meeting||t.data,error:t.error})),getProtocol:async e=>k(`/api/meetings/${e}/protocol`).then(s=>({success:s.success,data:s.data?.protocol||s.data,error:s.error})),getProtocolHtml:async e=>{const s=localStorage.getItem("auth_token");return(await fetch(`/api/meetings/${e}/protocol/html`,{headers:s?{Authorization:`Bearer ${s}`}:{}})).text()},openProtocolForPrint:e=>{window.open(`/api/meetings/${e}/protocol/html`,"_blank")},downloadProtocolPdf:async e=>{const s=await L.getProtocolHtml(e),t=document.createElement("iframe");t.style.display="none",document.body.appendChild(t);const n=t.contentDocument||t.contentWindow?.document;n&&(n.open(),n.write(s),n.close(),setTimeout(()=>{t.contentWindow?.print(),setTimeout(()=>{document.body.removeChild(t)},1e3)},500))}},ut={vote:async(e,s)=>(z("/api/meetings"),k(`/api/meetings/${e}/schedule-votes`,{method:"POST",body:JSON.stringify({option_id:s})}).then(t=>({success:t.success,data:t.data?.meeting||t.data,error:t.error}))),getMyVote:async e=>k(`/api/meetings/${e}/schedule-votes/me`)},De={vote:async(e,s,t)=>k(`/api/meetings/${e}/agenda/${s}/vote`,{method:"POST",body:JSON.stringify(t)}).then(n=>({success:n.success,data:n.data,error:n.error})),getMyVotes:async(e,s)=>{const t=s?`?voter_id=${s}`:"";return k(`/api/meetings/${e}/votes/me${t}`).then(n=>({success:n.success,data:n.data?.votes||n.data||[],error:n.error}))},getVoteRecords:async e=>k(`/api/meetings/${e}/vote-records`).then(s=>({success:s.success,data:s.data?.voteRecords||s.data||[],error:s.error}))},mt={request:async e=>k("/api/meetings/otp/request",{method:"POST",body:JSON.stringify(e)}).then(s=>({success:s.success,data:s.data,error:s.error})),verify:async(e,s)=>k("/api/meetings/otp/verify",{method:"POST",body:JSON.stringify({otpId:e,code:s})}).then(t=>({success:t.success,data:t.data,error:t.error}))},gt={get:async e=>k(`/api/meetings/building-settings/${e}`).then(s=>({success:s.success,data:s.data?.settings||s.data,error:s.error})),update:async(e,s)=>k(`/api/meetings/building-settings/${e}`,{method:"PATCH",body:JSON.stringify(s)}).then(t=>({success:t.success,data:t.data?.settings||t.data,error:t.error}))},Ve={getByBuilding:async e=>k(`/api/meetings/voting-units?building_id=${e}`).then(s=>({success:s.success,data:s.data?.votingUnits||s.data||[],error:s.error})),create:async e=>k("/api/meetings/voting-units",{method:"POST",body:JSON.stringify({building_id:e.buildingId,apartment_id:e.apartmentId,apartment_number:e.apartmentNumber,owner_id:e.ownerId,owner_name:e.ownerName,co_owner_ids:e.coOwnerIds?JSON.stringify(e.coOwnerIds):"[]",ownership_share:e.ownershipShare||100,total_area:e.totalArea||0})}).then(s=>({success:s.success,data:s.data?.votingUnit||s.data,error:s.error})),verify:async(e,s)=>k(`/api/meetings/voting-units/${e}/verify`,{method:"POST",body:JSON.stringify({verified_by:s})}).then(t=>({success:t.success,data:t.data?.votingUnit||t.data,error:t.error}))},Ut={set:async(e,s,t)=>k(`/api/meetings/${e}/eligible-voters`,{method:"POST",body:JSON.stringify({voterIds:s,totalCount:t})}).then(n=>({success:n.success,data:n.data?.meeting||n.data,error:n.error}))},Un={getAll:async()=>k("/api/settings").then(e=>({success:e.success,data:e.data,error:e.error})),get:async e=>k(`/api/settings/${e}`).then(s=>({success:s.success,data:s.data,error:s.error})),update:async(e,s)=>k(`/api/settings/${e}`,{method:"PUT",body:JSON.stringify({value:s})}),updateMany:async e=>k("/api/settings",{method:"POST",body:JSON.stringify(e)})},V=Object.freeze(Object.defineProperty({__proto__:null,announcementsApi:Tn,apartmentsApi:ue,apiRequest:u,authApi:ce,branchesApi:qn,buildingDocumentsApi:dt,buildingsApi:de,chatApi:Lt,crmResidentsApi:oe,entrancesApi:ve,executorsApi:Mt,guestCodesApi:Ue,invalidateCache:z,meetingAgendaVotesApi:De,meetingBuildingSettingsApi:gt,meetingEligibleVotersApi:Ut,meetingOtpApi:mt,meetingScheduleVotesApi:ut,meetingVotingUnitsApi:Ve,meetingsFullApi:L,meterReadingsApi:Be,metersApi:Z,ownersApi:X,personalAccountsApi:xe,rentalsApi:F,requestsApi:B,rescheduleApi:In,settingsApi:Un,teamApi:On,trainingFeedbackApi:Ln,trainingNotificationsApi:$n,trainingPartnersApi:Pn,trainingProposalsApi:zn,trainingRegistrationsApi:Cn,trainingSettingsApi:Mn,trainingVotesApi:En,uploadApi:$t,usersApi:le,vehiclesApi:W},Symbol.toStringTag,{value:"Module"})),U=we()(_e((e,s)=>({user:null,token:null,isLoading:!1,error:null,additionalUsers:{},login:async(t,n)=>{const r=t.trim(),a=n.trim();e({isLoading:!0,error:null});try{const o=await ce.login(r,a);return e({user:o.user,token:o.token,isLoading:!1,error:null}),!0}catch(o){const c=o instanceof Error?o.message:"Неверный логин или пароль";return e({isLoading:!1,error:c}),!1}},logout:()=>{ce.logout(),e({user:null,token:null,error:null})},register:async t=>{e({isLoading:!0,error:null});try{return await ce.register(t),e({isLoading:!1}),!0}catch(n){return e({isLoading:!1,error:n.message}),!1}},registerBulk:async t=>{e({isLoading:!0,error:null});try{const n=await ce.registerBulk(t);return e({isLoading:!1}),n}catch(n){return e({isLoading:!1,error:n.message}),{created:[],updated:[]}}},updateProfile:async t=>{e({isLoading:!0,error:null});try{const n=await le.updateMe(t);return e({user:n.user,isLoading:!1}),!0}catch(n){return e({isLoading:!1,error:n.message}),!1}},changePassword:async(t,n)=>{e({isLoading:!0,error:null});try{const r=await le.changePassword(t,n),a=s().user;return a&&r.password_changed_at?e({user:{...a,passwordChangedAt:r.password_changed_at},isLoading:!1}):e({isLoading:!1}),!0}catch(r){return e({isLoading:!1,error:r.message}),!1}},adminChangePassword:async(t,n)=>{e({isLoading:!0,error:null});try{return await le.adminChangePassword(t,n),e({isLoading:!1}),!0}catch(r){return e({isLoading:!1,error:r.message}),!1}},markContractSigned:async()=>{try{const t=await le.markContractSigned(),n=s().user;return n&&t.contract_signed_at&&e({user:{...n,contractSignedAt:t.contract_signed_at}}),!0}catch{return!1}},refreshUser:async()=>{if(s().token)try{const n=await le.getMe();e({user:n.user})}catch{s().logout()}},addMockUser:(t,n,r)=>{ce.register({login:t,password:n,name:r.name,role:r.role,phone:r.phone,address:r.address,apartment:r.apartment,building_id:r.buildingId,entrance:r.entrance,floor:r.floor,branch:r.branch,building:r.building}).then(()=>{}).catch(a=>{}),e(a=>({additionalUsers:{...a.additionalUsers,[t]:{password:n,user:r}}}))},removeUser:t=>{e(n=>{const r={...n.additionalUsers};return delete r[t],{additionalUsers:r}})},updateUserPassword:(t,n)=>{e(r=>r.additionalUsers[t]?{additionalUsers:{...r.additionalUsers,[t]:{...r.additionalUsers[t],password:n}}}:r)},updateUserProfile:(t,n)=>{e(r=>r.additionalUsers[t]?{additionalUsers:{...r.additionalUsers,[t]:{...r.additionalUsers[t],user:{...r.additionalUsers[t].user,...n}}}}:r.user?.login===t?{user:{...r.user,...n}}:r)},getUserPassword:t=>s().additionalUsers[t]?.password||null}),{name:"uk-auth-storage",version:3,partialize:e=>({user:e.user,token:e.token}),onRehydrateStorage:()=>(e,s)=>{if(!s)if(e?.user?.id){const t=e.user.id;e.token!==t&&(e.token=t),localStorage.setItem("auth_token",t)}else e?.token&&(localStorage.removeItem("auth_token"),e.token=null)}})),et=e=>({id:e.id,name:e.name,address:e.address,zone:e.zone,cadastralNumber:e.cadastral_number,branchCode:e.branch_code,buildingNumber:e.building_number,floors:e.floors||0,entrances:e.entrances_count||0,totalApartments:e.apartments_count||0,totalArea:e.total_area||0,livingArea:e.living_area||0,commonArea:e.common_area||0,landArea:e.land_area,yearBuilt:e.year_built||0,yearRenovated:e.year_renovated,buildingType:e.building_type||"monolith",roofType:e.roof_type||"flat",wallMaterial:e.wall_material||"",foundationType:e.foundation_type||"",hasElevator:!!e.has_elevator,elevatorCount:e.elevator_count||0,hasGas:!!e.has_gas,heatingType:e.heating_type||"central",hasHotWater:!!e.has_hot_water,waterSupplyType:e.water_supply_type||"central",sewerageType:e.sewerage_type||"central",hasIntercom:!!e.has_intercom,hasVideoSurveillance:!!e.has_video_surveillance,hasConcierge:!!e.has_concierge,hasParkingLot:!!e.has_parking_lot,parkingSpaces:e.parking_spaces||0,hasPlayground:!!e.has_playground,managerId:e.manager_id,managerName:e.manager_name,managementStartDate:e.management_start_date,contractNumber:e.contract_number,contractEndDate:e.contract_end_date,monthlyBudget:e.monthly_budget||0,reserveFund:e.reserve_fund||0,totalDebt:e.total_debt||0,collectionRate:e.collection_rate||0,residentsCount:e.residents_count||0,ownersCount:e.owners_count||0,tenantsCount:e.tenants_count||0,vacantApartments:e.vacant_apartments||0,activeRequestsCount:e.active_requests_count||0,documents:[],createdAt:e.created_at,updatedAt:e.updated_at}),tt=e=>({id:e.id,buildingId:e.building_id,number:e.number,floorsFrom:e.floors_from||1,floorsTo:e.floors_to,apartmentsFrom:e.apartments_from,apartmentsTo:e.apartments_to,hasElevator:!!e.has_elevator,elevatorId:e.elevator_id,intercomType:e.intercom_type,intercomCode:e.intercom_code,cleaningSchedule:e.cleaning_schedule,responsibleId:e.responsible_id,lastInspection:e.last_inspection,notes:e.notes}),Ee=e=>({id:e.id,buildingId:e.building_id,entranceId:e.entrance_id,number:e.number,floor:e.floor||1,rooms:e.rooms||1,totalArea:e.total_area||0,livingArea:e.living_area||0,kitchenArea:e.kitchen_area,balconyArea:e.balcony_area,loggiaArea:e.loggia_area,ceilingHeight:e.ceiling_height,hasBalcony:!!e.has_balcony,hasLoggia:!!e.has_loggia,hasStorage:!!e.has_storage,hasParking:!!e.has_parking,parkingNumber:e.parking_number,ownershipType:e.ownership_type||"private",ownershipShare:e.ownership_share,registrationNumber:e.registration_number,registrationDate:e.registration_date,status:e.status||"occupied",isCommercial:!!e.is_commercial,commercialType:e.commercial_type,meters:[],personalAccountId:e.personal_account_id,primaryOwnerId:e.primary_owner_id,notes:e.notes,createdAt:e.created_at,updatedAt:e.updated_at}),Ce=e=>({id:e.id,type:e.type||"individual",lastName:e.last_name,firstName:e.first_name,middleName:e.middle_name,fullName:e.full_name,companyName:e.company_name,inn:e.inn,kpp:e.kpp,ogrn:e.ogrn,legalAddress:e.legal_address,directorName:e.director_name,passportSeries:e.passport_series,passportNumber:e.passport_number,passportIssuedBy:e.passport_issued_by,passportIssuedDate:e.passport_issued_date,birthDate:e.birth_date,birthPlace:e.birth_place,registrationAddress:e.registration_address,actualAddress:e.actual_address,phone:e.phone,additionalPhone:e.additional_phone,email:e.email,preferredContact:e.preferred_contact||"phone",ownershipType:e.ownership_type||"owner",ownershipShare:e.ownership_share||100,ownershipDocument:e.ownership_document,ownershipDocumentDate:e.ownership_document_date,apartmentIds:e.apartment_ids?JSON.parse(e.apartment_ids):[],personalAccountIds:e.personal_account_ids?JSON.parse(e.personal_account_ids):[],isActive:e.is_active!==!1&&e.is_active!==0,isVerified:!!e.is_verified,verifiedAt:e.verified_at,verifiedBy:e.verified_by,bankName:e.bank_name,bankBik:e.bank_bik,bankAccount:e.bank_account,tags:e.tags?JSON.parse(e.tags):[],notes:e.notes,createdAt:e.created_at,updatedAt:e.updated_at}),Le=e=>({id:e.id,number:e.number,apartmentId:e.apartment_id,buildingId:e.building_id,primaryOwnerId:e.primary_owner_id,ownerName:e.owner_name,apartmentNumber:e.apartment_number,address:e.address,totalArea:e.total_area||0,residentsCount:e.residents_count||0,registeredCount:e.registered_count||0,balance:e.balance||0,currentDebt:e.current_debt||0,penaltyAmount:e.penalty_amount||0,lastPaymentDate:e.last_payment_date,lastPaymentAmount:e.last_payment_amount,lastChargeDate:e.last_charge_date,lastChargeAmount:e.last_charge_amount,tariffPlanId:e.tariff_plan_id,hasSubsidy:!!e.has_subsidy,subsidyPercent:e.subsidy_percent,subsidyEndDate:e.subsidy_end_date,hasDiscount:!!e.has_discount,discountPercent:e.discount_percent,discountReason:e.discount_reason,status:e.status||"active",closedAt:e.closed_at,closedReason:e.closed_reason,notes:e.notes,createdAt:e.created_at,updatedAt:e.updated_at}),$e=e=>({id:e.id,apartmentId:e.apartment_id,buildingId:e.building_id,type:e.type,serialNumber:e.serial_number,model:e.model,brand:e.brand,installDate:e.install_date,verificationDate:e.verification_date,nextVerificationDate:e.next_verification_date,sealNumber:e.seal_number,location:e.install_location,initialValue:e.initial_value||0,currentValue:e.current_value||0,lastReadingDate:e.last_reading_date,isActive:e.is_active!==!1&&e.is_active!==0,isCommon:!!e.is_common,tariffZone:e.tariff_zone,notes:e.notes,createdAt:e.created_at,updatedAt:e.updated_at}),nt=e=>({id:e.id,meterId:e.meter_id,value:e.value,previousValue:e.previous_value,consumption:e.consumption,readingDate:e.reading_date,source:e.source,submittedBy:e.submitted_by,submittedAt:e.submitted_at,isVerified:!!e.is_verified,verifiedBy:e.verified_by,verifiedAt:e.verified_at,photoUrl:e.photo_url,status:e.status,rejectionReason:e.rejection_reason,notes:e.notes,createdAt:e.created_at}),rt=e=>({id:e.id,apartmentId:e.apartment_id,ownerId:e.owner_id,lastName:e.last_name,firstName:e.first_name,middleName:e.middle_name,fullName:e.full_name,birthDate:e.birth_date,residentType:e.resident_type||"owner",relationToOwner:e.relation_to_owner,registrationType:e.registration_type||"permanent",registrationDate:e.registration_date,registrationEndDate:e.registration_end_date,phone:e.phone,additionalPhone:e.additional_phone,email:e.email,isActive:e.is_active!==!1&&e.is_active!==0,movedInDate:e.moved_in_date,movedOutDate:e.moved_out_date,movedOutReason:e.moved_out_reason,passportSeries:e.passport_series,passportNumber:e.passport_number,notes:e.notes,createdAt:e.created_at,updatedAt:e.updated_at}),Bn=we()(_e((e,s)=>({buildings:[],entrances:[],apartments:[],meters:[],meterReadings:[],owners:[],residents:[],personalAccounts:[],isLoadingBuildings:!1,isLoadingEntrances:!1,isLoadingApartments:!1,isLoadingOwners:!1,isLoadingAccounts:!1,isLoadingResidents:!1,isLoadingMeters:!1,fetchBuildings:async()=>{e({isLoadingBuildings:!0});try{const n=((await de.getAll()).buildings||[]).map(et);e({buildings:n,isLoadingBuildings:!1})}catch{e({isLoadingBuildings:!1})}},fetchBuildingById:async t=>{try{const n=await de.getById(t);if(!n.building)return null;const r=et(n.building),a=(n.entrances||[]).map(tt),o=n.documents||[];return e(c=>{const l=c.buildings.some(m=>m.id===t)?c.buildings.map(m=>m.id===t?{...r,documents:o}:m):[...c.buildings,{...r,documents:o}],g=[...c.entrances.filter(m=>m.buildingId!==t),...a];return{buildings:l,entrances:g}}),{building:{...r,documents:o},entrances:a,documents:o}}catch{return null}},addBuilding:async t=>{try{const n=await de.create(t);if(n.building){const r=et(n.building);return e(a=>({buildings:[...a.buildings,r]})),r}return null}catch{return null}},updateBuilding:async(t,n)=>{try{await de.update(t,n),e(r=>({buildings:r.buildings.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},deleteBuilding:async t=>{try{await de.delete(t),e(n=>({buildings:n.buildings.filter(r=>r.id!==t),entrances:n.entrances.filter(r=>r.buildingId!==t),apartments:n.apartments.filter(r=>r.buildingId!==t),personalAccounts:n.personalAccounts.filter(r=>r.buildingId!==t)}))}catch(n){throw new Error(n.message||"Ошибка при удалении здания")}},getBuildingById:t=>s().buildings.find(n=>n.id===t),getBuildingWithStats:t=>{const n=s().buildings.find(c=>c.id===t);if(!n)return;const r=s().apartments.filter(c=>c.buildingId===t),a=s().personalAccounts.filter(c=>c.buildingId===t),o=s().residents.filter(c=>r.some(l=>l.id===c.apartmentId));return{...n,totalApartments:r.length||n.totalApartments,residentsCount:o.length||n.residentsCount,ownersCount:s().owners.filter(c=>c.apartmentIds.some(l=>r.some(d=>d.id===l))).length||n.ownersCount,totalDebt:a.reduce((c,l)=>c+l.currentDebt,0)||n.totalDebt,vacantApartments:r.filter(c=>c.status==="vacant").length||n.vacantApartments}},addBuildingDocument:async(t,n)=>{try{const r=await dt.create(t,{name:n.name,type:n.type,fileUrl:n.fileUrl,fileSize:n.fileSize,expiresAt:n.expiresAt});if(r.document){const a={...n,id:r.document.id,buildingId:t,uploadedAt:r.document.uploaded_at||new Date().toISOString()};e(o=>({buildings:o.buildings.map(c=>c.id===t?{...c,documents:[...c.documents||[],a]}:c)}))}}catch{}},deleteBuildingDocument:async(t,n)=>{try{await dt.delete(n),e(r=>({buildings:r.buildings.map(a=>a.id===t?{...a,documents:(a.documents||[]).filter(o=>o.id!==n)}:a)}))}catch{}},fetchEntrancesByBuilding:async t=>{e({isLoadingEntrances:!0});try{const r=((await ve.getByBuilding(t)).entrances||[]).map(tt);return e(a=>({entrances:[...a.entrances.filter(c=>c.buildingId!==t),...r],isLoadingEntrances:!1})),r}catch{return e({isLoadingEntrances:!1}),[]}},addEntrance:async t=>{try{const n=await ve.create(t.buildingId,{number:t.number,floorsFrom:t.floorsFrom,floorsTo:t.floorsTo,apartmentsFrom:t.apartmentsFrom,apartmentsTo:t.apartmentsTo,hasElevator:t.hasElevator,elevatorId:t.elevatorId,intercomType:t.intercomType,intercomCode:t.intercomCode,cleaningSchedule:t.cleaningSchedule,responsibleId:t.responsibleId,notes:t.notes});if(n.entrance){const r=tt(n.entrance);return e(a=>({entrances:[...a.entrances,r]})),r}return null}catch{return null}},updateEntrance:async(t,n)=>{try{await ve.update(t,n),e(r=>({entrances:r.entrances.map(a=>a.id===t?{...a,...n}:a)}))}catch{}},deleteEntrance:async t=>{try{await ve.delete(t),e(n=>({entrances:n.entrances.filter(r=>r.id!==t),apartments:n.apartments.filter(r=>r.entranceId!==t)}))}catch{}},getEntrancesByBuilding:t=>s().entrances.filter(n=>n.buildingId===t),fetchApartmentsByBuilding:async(t,n)=>{e({isLoadingApartments:!0});try{const a=((await ue.getByBuilding(t,n)).apartments||[]).map(Ee);return e(o=>({apartments:[...o.apartments.filter(l=>l.buildingId!==t),...a],isLoadingApartments:!1})),a}catch{return e({isLoadingApartments:!1}),[]}},fetchApartmentById:async t=>{try{const n=await ue.getById(t);if(!n.apartment)return null;const r=Ee(n.apartment),a=(n.owners||[]).map(Ce),o=n.personalAccount?Le(n.personalAccount):null;return e(c=>({apartments:c.apartments.some(d=>d.id===t)?c.apartments.map(d=>d.id===t?r:d):[...c.apartments,r]})),{apartment:r,owners:a,account:o}}catch{return null}},addApartment:async t=>{try{const n=await ue.create(t.buildingId,{number:t.number,entranceId:t.entranceId,floor:t.floor,totalArea:t.totalArea,livingArea:t.livingArea,kitchenArea:t.kitchenArea,rooms:t.rooms,hasBalcony:t.hasBalcony,hasLoggia:t.hasLoggia,status:t.status});if(n.apartment){const r=Ee(n.apartment);return e(a=>({apartments:[...a.apartments,r]})),r}return null}catch{return null}},updateApartment:async(t,n)=>{try{await ue.update(t,n),e(r=>({apartments:r.apartments.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},deleteApartment:async t=>{try{await ue.delete(t),e(n=>({apartments:n.apartments.filter(r=>r.id!==t),meters:n.meters.filter(r=>r.apartmentId!==t),residents:n.residents.filter(r=>r.apartmentId!==t),personalAccounts:n.personalAccounts.filter(r=>r.apartmentId!==t)}))}catch{}},getApartmentsByBuilding:t=>s().apartments.filter(n=>n.buildingId===t),getApartmentsByEntrance:t=>s().apartments.filter(n=>n.entranceId===t),getApartmentById:t=>s().apartments.find(n=>n.id===t),fetchMetersByApartment:async(t,n)=>{e({isLoadingMeters:!0});try{const a=((await Z.getByApartment(t,n)).meters||[]).map($e);return e(o=>({meters:[...o.meters.filter(l=>l.apartmentId!==t),...a],isLoadingMeters:!1})),a}catch{return e({isLoadingMeters:!1}),[]}},fetchMetersByBuilding:async(t,n)=>{e({isLoadingMeters:!0});try{const a=((await Z.getByBuilding(t,n)).meters||[]).map($e);return e(o=>({meters:[...o.meters.filter(l=>l.buildingId!==t),...a],isLoadingMeters:!1})),a}catch{return e({isLoadingMeters:!1}),[]}},fetchMeterById:async t=>{try{const n=await Z.getById(t);if(!n.meter)return null;const r=$e(n.meter),a=(n.readings||[]).map(nt);return e(o=>{const c=o.meters.some(d=>d.id===t)?o.meters.map(d=>d.id===t?r:d):[...o.meters,r],l=o.meterReadings.filter(d=>d.meterId!==t);return{meters:c,meterReadings:[...l,...a]}}),{meter:r,readings:a}}catch{return null}},addMeter:async t=>{try{const n=await Z.create({apartmentId:t.apartmentId,buildingId:t.buildingId,type:t.type,isCommon:t.isCommon,serialNumber:t.serialNumber,model:t.model,brand:t.brand,installDate:t.installDate,location:t.location,initialValue:t.initialValue,verificationDate:t.verificationDate,nextVerificationDate:t.nextVerificationDate,sealNumber:t.sealNumber});if(n.meter){const r=$e(n.meter);return e(a=>({meters:[...a.meters,r]})),r}return null}catch{return null}},updateMeter:async(t,n)=>{try{await Z.update(t,n),e(r=>({meters:r.meters.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},deleteMeter:async t=>{try{await Z.delete(t),e(n=>({meters:n.meters.filter(r=>r.id!==t),meterReadings:n.meterReadings.filter(r=>r.meterId!==t)}))}catch{}},decommissionMeter:async(t,n)=>{try{await Z.decommission(t,n),e(r=>({meters:r.meters.map(a=>a.id===t?{...a,isActive:!1}:a)}))}catch{}},getMetersByApartment:t=>s().meters.filter(n=>n.apartmentId===t),getCommonMetersByBuilding:t=>s().meters.filter(n=>n.buildingId===t&&n.isCommon),fetchMeterReadings:async(t,n)=>{try{const a=((await Be.getByMeter(t,n)).readings||[]).map(nt);return e(o=>({meterReadings:[...o.meterReadings.filter(l=>l.meterId!==t),...a]})),a}catch{return[]}},submitMeterReading:async(t,n)=>{try{const r=await Be.submit(t,n);if(r.reading){const a=nt(r.reading);return e(o=>({meterReadings:[...o.meterReadings,a],meters:o.meters.map(c=>c.id===t?{...c,currentValue:n.value,lastReadingDate:n.readingDate||new Date().toISOString().split("T")[0]}:c)})),a}return null}catch{return null}},verifyMeterReading:async(t,n,r)=>{try{await Be.verify(t,{approved:n,rejectionReason:r}),e(a=>({meterReadings:a.meterReadings.map(o=>o.id===t?{...o,isVerified:n,status:n?"approved":"rejected",rejectionReason:r}:o)}))}catch{}},getMeterReadings:t=>s().meterReadings.filter(n=>n.meterId===t).sort((n,r)=>new Date(r.readingDate).getTime()-new Date(n.readingDate).getTime()),getLastReading:t=>{const n=s().getMeterReadings(t);return n.length>0?n[0]:void 0},fetchOwners:async t=>{e({isLoadingOwners:!0});try{const r=((await X.getAll(t)).owners||[]).map(Ce);return e({owners:r,isLoadingOwners:!1}),r}catch{return e({isLoadingOwners:!1}),[]}},fetchOwnerById:async t=>{try{const n=await X.getById(t);if(!n.owner)return null;const r=Ce(n.owner),a=(n.apartments||[]).map(Ee);return e(o=>({owners:o.owners.some(l=>l.id===t)?o.owners.map(l=>l.id===t?r:l):[...o.owners,r]})),{owner:r,apartments:a}}catch{return null}},addOwner:async t=>{try{const n=await X.create({type:t.type,lastName:t.lastName,firstName:t.firstName,middleName:t.middleName,fullName:t.fullName,phone:t.phone,email:t.email,ownershipType:t.ownershipType,ownershipShare:t.ownershipShare});if(n.owner){const r=Ce(n.owner);return e(a=>({owners:[...a.owners,r]})),r}return null}catch{return null}},updateOwner:async(t,n)=>{try{await X.update(t,n),e(r=>({owners:r.owners.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},deleteOwner:async t=>{try{await X.delete(t),e(n=>({owners:n.owners.filter(r=>r.id!==t)}))}catch{}},linkOwnerToApartment:async(t,n,r)=>{try{await X.linkToApartment(t,n,r),e(a=>({owners:a.owners.map(o=>o.id===t?{...o,apartmentIds:[...o.apartmentIds||[],n]}:o)}))}catch{}},unlinkOwnerFromApartment:async(t,n)=>{try{await X.unlinkFromApartment(t,n),e(r=>({owners:r.owners.map(a=>a.id===t?{...a,apartmentIds:(a.apartmentIds||[]).filter(o=>o!==n)}:a)}))}catch{}},getOwnerById:t=>s().owners.find(n=>n.id===t),getOwnersByApartment:t=>s().owners.filter(n=>n.apartmentIds?.includes(t)),searchOwners:t=>{const n=t.toLowerCase();return s().owners.filter(r=>r.fullName?.toLowerCase().includes(n)||r.phone?.includes(t)||r.email?.toLowerCase().includes(n))},fetchResidentsByApartment:async(t,n)=>{e({isLoadingResidents:!0});try{const a=((await oe.getByApartment(t,n)).residents||[]).map(rt);return e(o=>({residents:[...o.residents.filter(l=>l.apartmentId!==t),...a],isLoadingResidents:!1})),a}catch{return e({isLoadingResidents:!1}),[]}},fetchResidentById:async t=>{try{const n=await oe.getById(t);if(!n.resident)return null;const r=rt(n.resident);return e(a=>({residents:a.residents.some(c=>c.id===t)?a.residents.map(c=>c.id===t?r:c):[...a.residents,r]})),r}catch{return null}},addResident:async(t,n)=>{try{const r=await oe.create(t,{lastName:n.lastName,firstName:n.firstName,middleName:n.middleName,fullName:n.fullName,birthDate:n.birthDate,residentType:n.residentType,relationToOwner:n.relationToOwner,registrationType:n.registrationType,registrationDate:n.registrationDate,phone:n.phone,email:n.email,movedInDate:n.movedInDate,ownerId:n.ownerId});if(r.resident){const a=rt(r.resident);return e(o=>({residents:[...o.residents,a]})),a}return null}catch{return null}},updateResident:async(t,n)=>{try{await oe.update(t,n),e(r=>({residents:r.residents.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},deleteResident:async t=>{try{await oe.delete(t),e(n=>({residents:n.residents.filter(r=>r.id!==t)}))}catch{}},moveOutResident:async(t,n)=>{try{await oe.moveOut(t,n),e(r=>({residents:r.residents.map(a=>a.id===t?{...a,isActive:!1,movedOutDate:n.movedOutDate,movedOutReason:n.reason}:a)}))}catch{}},getResidentsByApartment:t=>s().residents.filter(n=>n.apartmentId===t),fetchAccountsByBuilding:async(t,n)=>{e({isLoadingAccounts:!0});try{const a=((await xe.getByBuilding(t,n)).accounts||[]).map(Le);return e(o=>({personalAccounts:[...o.personalAccounts.filter(l=>l.buildingId!==t),...a],isLoadingAccounts:!1})),a}catch{return e({isLoadingAccounts:!1}),[]}},addPersonalAccount:async t=>{try{const n=await xe.create({apartmentId:t.apartmentId,buildingId:t.buildingId,primaryOwnerId:t.primaryOwnerId,ownerName:t.ownerName,apartmentNumber:t.apartmentNumber,totalArea:t.totalArea,residentsCount:t.residentsCount,balance:t.balance,currentDebt:t.currentDebt});if(n.account){const r=Le(n.account);return e(a=>({personalAccounts:[...a.personalAccounts,r]})),r}return null}catch{return null}},updatePersonalAccount:async(t,n)=>{try{await xe.update(t,n),e(r=>({personalAccounts:r.personalAccounts.map(a=>a.id===t?{...a,...n,updatedAt:new Date().toISOString()}:a)}))}catch{}},getPersonalAccountById:t=>s().personalAccounts.find(n=>n.id===t),getPersonalAccountByApartment:t=>s().personalAccounts.find(n=>n.apartmentId===t),getPersonalAccountsByBuilding:t=>s().personalAccounts.filter(n=>n.buildingId===t),fetchDebtors:async t=>{try{return((await xe.getDebtors(t)).debtors||[]).map(Le)}catch{return[]}},getDebtors:(t=0)=>s().personalAccounts.filter(n=>n.currentDebt>t).sort((n,r)=>r.currentDebt-n.currentDebt),getBuildingStats:()=>{const{buildings:t,apartments:n,residents:r,owners:a,personalAccounts:o}=s(),c=o.reduce((d,g)=>d+g.currentDebt,0),l=t.reduce((d,g)=>d+g.collectionRate,0);return{totalBuildings:t.length,totalApartments:n.length,totalResidents:r.length,totalOwners:a.length,totalDebt:c,avgCollectionRate:t.length>0?l/t.length:0}}}),{name:"uk-crm-storage",version:4,partialize:()=>({}),migrate:(e,s)=>{const t=e,n=r=>{if(!r)return"";const a=r.match(/(\d+[А-Яа-яA-Za-z]?)-уй|уй\s*(\d+[А-Яа-яA-Za-z]?)/i);if(a)return(a[1]||a[2]).toUpperCase().replace(/Б/gi,"B").replace(/А/gi,"A");const o=r.match(/(?:дом|д\.?)\s*(\d+[А-Яа-яA-Za-z]?)/i);return o?o[1].toUpperCase().replace(/Б/gi,"B").replace(/А/gi,"A"):""};if(t.buildings){const r=new Set;t.buildings=t.buildings.map((a,o)=>{let c={...a};if((!c.id||r.has(c.id))&&(c.id=`building_${Date.now()}_${o}`),r.add(c.id),c.branchCode||(c.branchCode=c.name?.includes("Юнусабад")?"YS":c.name?.includes("Чиланзар")?"CH":c.name?.includes("Сергели")?"SR":"YS"),!c.buildingNumber){const l=n(c.address||"");c.buildingNumber=l||`${o+1}A`}return c})}return t}})),Dn="modulepreload",Vn=function(e){return"/"+e},At={},S=function(s,t,n){let r=Promise.resolve();if(t&&t.length>0){let l=function(d){return Promise.all(d.map(g=>Promise.resolve(g).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");r=l(t.map(d=>{if(d=Vn(d),d in At)return;At[d]=!0;const g=d.endsWith(".css"),m=g?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${m}`))return;const f=document.createElement("link");if(f.rel=g?"stylesheet":Dn,g||(f.as="script"),f.crossOrigin="",f.href=d,c&&f.setAttribute("nonce",c),document.head.appendChild(f),g)return new Promise((h,b)=>{f.addEventListener("load",h),f.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return r.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return s().catch(a)})},Fn="BMTJw9s4vAY9Bzb05L8--r0XUDirigcJ0_yTTGuCLZL2uk8693U82ef7LLlWyLf9T-3PucveTAjYS_I36uv7RY4";function Jn(e){const s="=".repeat((4-e.length%4)%4),t=(e+s).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(t),r=new Uint8Array(n.length);for(let a=0;a<n.length;++a)r[a]=n.charCodeAt(a);return r.buffer}class Hn{constructor(){ae(this,"permission","default");ae(this,"swRegistration",null);ae(this,"pushSubscription",null);"Notification"in window&&(this.permission=Notification.permission),this.initServiceWorker()}async initServiceWorker(){if("serviceWorker"in navigator)try{this.swRegistration=await navigator.serviceWorker.ready,this.pushSubscription=await this.swRegistration.pushManager.getSubscription(),this.pushSubscription}catch{}}isSupported(){return"Notification"in window&&"serviceWorker"in navigator&&"PushManager"in window}isBrowserNotificationsSupported(){return"Notification"in window}getPermission(){return this.permission}isSubscribed(){return this.pushSubscription!==null}async requestPermission(){if(!this.isBrowserNotificationsSupported())return!1;try{const s=await Notification.requestPermission();return this.permission=s,s==="granted"}catch{return!1}}async subscribe(){if(!this.isSupported()||this.permission!=="granted"&&!await this.requestPermission()||(this.swRegistration||await this.initServiceWorker(),!this.swRegistration))return null;try{const s=await this.swRegistration.pushManager.getSubscription();return s?this.pushSubscription=s:this.pushSubscription=await this.swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Jn(Fn)}),await this.sendSubscriptionToServer(this.pushSubscription),this.pushSubscription}catch{return null}}async unsubscribe(){if(!this.pushSubscription)return!0;try{return await this.pushSubscription.unsubscribe(),await this.removeSubscriptionFromServer(),this.pushSubscription=null,!0}catch{return!1}}async sendSubscriptionToServer(s){try{const t=s.toJSON(),n=await u("/api/push/subscribe",{method:"POST",body:JSON.stringify({endpoint:t.endpoint,keys:t.keys})})}catch(t){throw t}}async removeSubscriptionFromServer(){try{await u("/api/push/unsubscribe",{method:"POST"})}catch{}}getSubscription(){return this.pushSubscription}async show(s){if(!this.isSupported()||this.permission!=="granted"&&!await this.requestPermission())return null;try{const t=new Notification(s.title,{body:s.body,icon:s.icon||"/favicon.ico",tag:s.tag,requireInteraction:s.requireInteraction??!0,data:s.data});return t.onclick=n=>{n.preventDefault(),window.focus(),s.data?.url&&(window.location.href=s.data.url),t.close()},t}catch{return null}}async notifyRequestCompleted(s,t,n){await this.show({title:"✅ Работа завершена!",body:`Заявка ${s}: ${t} завершил работу. Пожалуйста, подтвердите выполнение и оцените работу.`,tag:`request-completed-${n}`,requireInteraction:!0,data:{requestId:n,url:"/"}})}async notifyUrgentAnnouncement(s,t,n){await this.show({title:`🚨 ${s}`,body:t,tag:`announcement-${n}`,requireInteraction:!0,data:{announcementId:n,url:"/"}})}async notifyMeeting(s,t,n,r){await this.show({title:"📢 Собрание жильцов",body:`${s}
${t} в ${n}`,tag:`meeting-${r}`,requireInteraction:!0,data:{announcementId:r,url:"/meetings"}})}async notifyNewMeeting(s,t){await this.show({title:"📢 Новое собрание объявлено",body:`Назначено собрание жильцов дома ${t}. Примите участие в выборе даты!`,tag:`new-meeting-${s}`,requireInteraction:!0,data:{url:"/meetings"}})}async notifyVotingOpen(s,t){await this.show({title:"🗳️ Голосование открыто!",body:`Голосование на собрании жильцов дома ${t} началось. Примите участие!`,tag:`voting-open-${s}`,requireInteraction:!0,data:{url:"/meetings"}})}async notifyVotingReminder(s,t){await this.show({title:"⏰ Голосование скоро завершится",body:`Осталось ${t} часов до окончания голосования. Не забудьте проголосовать!`,tag:`voting-reminder-${s}`,requireInteraction:!0,data:{url:"/meetings"}})}async notifyProtocolReady(s,t){await this.show({title:"📄 Протокол собрания готов",body:`Протокол собрания жильцов дома ${t} опубликован.`,tag:`protocol-ready-${s}`,requireInteraction:!1,data:{url:"/meetings"}})}async notifyAnnouncement(s,t,n,r="normal"){const a=r==="urgent"?"🚨":"📢";await this.show({title:`${a} ${s}`,body:t.length>200?t.substring(0,200)+"...":t,tag:`announcement-${n}`,requireInteraction:r==="urgent",data:{announcementId:n,priority:r,url:"/announcements",type:"announcement"}})}async notifyRequestAssigned(s,t,n){await this.show({title:"📋 Новая заявка назначена",body:`Заявка ${s}: ${t}`,tag:`request-assigned-${n}`,requireInteraction:!0,data:{requestId:n,url:"/"}})}async notifyRequestStarted(s,t,n){await this.show({title:"🔧 Работа началась",body:`Заявка ${s}: ${t} начал работу`,tag:`request-started-${n}`,requireInteraction:!1,data:{requestId:n,url:"/"}})}}const te=new Hn,ie=()=>Math.random().toString(36).substr(2,9),St=()=>{const e=new Date,s=new Date(e.getTime()+10080*60*1e3);return{id:"demo-code-1",residentId:"resident1",residentName:"Иванов Иван Иванович",residentPhone:"+998901234567",residentApartment:"42",residentAddress:"ул. Мустакиллик, 15",visitorType:"guest",visitorName:"Демо Гость",visitorPhone:"+998901111111",accessType:"week",qrToken:"GA-demo-test-code123",status:"active",validFrom:e.toISOString(),validUntil:s.toISOString(),maxUses:999,currentUses:0,createdAt:e.toISOString(),updatedAt:e.toISOString()}},Kn={companyName:"ТСЖ Юнусабад",companyInn:"305123456",companyAddress:"г. Ташкент, Юнусабадский район",companyPhone:"+998 71 123 45 67",routingMode:"hybrid",workingHoursStart:"08:00",workingHoursEnd:"20:00",autoAssign:!0,notifyOnNew:!0,notifyOnComplete:!0,notifyOnRating:!0,smsNotifications:!1,emailNotifications:!0,pushNotifications:!0},G=we()(_e((e,s)=>({executors:[],requests:[],notifications:[],activityLogs:[],settings:Kn,rentalApartments:[],rentalRecords:[],announcements:[],vehicles:[],guestAccessCodes:[St()],guestAccessLogs:[],rescheduleRequests:[],isLoadingRequests:!1,isLoadingExecutors:!1,isLoadingVehicles:!1,isLoadingGuestCodes:!1,fetchRequests:async(t,n)=>{e({isLoadingRequests:!0});try{const o=((await B.getAll(t,n)).requests||[]).map(c=>({id:c.id,number:c.request_number||c.number||`#${c.id?.substring(0,6).toUpperCase()||"000000"}`,title:c.title,description:c.description||"",category:c.category_id,status:c.status,priority:c.priority||"medium",residentId:c.resident_id,residentName:c.resident_name||"Неизвестный",residentPhone:c.resident_phone||"",address:c.address||"",apartment:c.apartment||"",executorId:c.executor_id,executorName:c.executor_name,executorPhone:c.executor_phone,accessInfo:c.access_info,scheduledDate:c.scheduled_at?c.scheduled_at.split("T")[0]:void 0,scheduledTime:c.scheduled_at?c.scheduled_at.split("T")[1]?.substring(0,5):void 0,createdAt:c.created_at,assignedAt:c.assigned_at,acceptedAt:c.accepted_at,startedAt:c.started_at,completedAt:c.completed_at,approvedAt:c.approved_at,rating:c.rating,feedback:c.feedback,workDuration:c.work_duration,buildingId:c.building_id,buildingName:c.building_name,isPaused:c.is_paused===1||c.is_paused===!0,pausedAt:c.paused_at,totalPausedTime:c.total_paused_time||0}));e(c=>{const l=c.requests.filter(g=>g.id.startsWith("temp-"));return{requests:[...l,...o.filter(g=>!l.some(m=>m.id===g.id))],isLoadingRequests:!1}})}catch{e({isLoadingRequests:!1})}},fetchExecutors:async(t=!1)=>{e({isLoadingExecutors:!0});try{const r=(await Mt.getAll(t)).executors.map(a=>({id:a.id,name:a.name,phone:a.phone,login:a.login,specialization:a.specialization,status:a.status||"offline",rating:a.rating||5,completedCount:a.completed_count||0,activeRequests:a.active_requests||0,totalEarnings:a.total_earnings||0,avgCompletionTime:a.avg_completion_time||0,createdAt:a.created_at}));e({executors:r,isLoadingExecutors:!1})}catch{e({isLoadingExecutors:!1})}},fetchVehicles:async(t=!1)=>{e({isLoadingVehicles:!0});try{const r=(t?await W.getAll():await W.getMyVehicles()).vehicles.map(a=>({id:a.id,ownerId:a.user_id,ownerName:a.owner_name||"",ownerPhone:a.owner_phone||"",apartment:a.apartment||"",address:a.address||"",plateNumber:a.plate_number,brand:a.brand||"",model:a.model||"",color:a.color||"",year:a.year||void 0,type:a.vehicle_type||"car",ownerType:a.owner_type||"individual",companyName:a.company_name||void 0,parkingSpot:a.parking_spot||void 0,notes:a.notes||void 0,createdAt:a.created_at,updatedAt:a.updated_at||void 0}));e({vehicles:r,isLoadingVehicles:!1})}catch{e({isLoadingVehicles:!1})}},fetchGuestCodes:async()=>{e({isLoadingGuestCodes:!0});try{const r=((await Ue.getAll()).codes||[]).map(a=>({id:a.id,residentId:a.user_id,residentName:a.resident_name||"",residentPhone:a.resident_phone||"",residentApartment:a.resident_apartment||"",residentAddress:a.resident_address||"",visitorType:a.visitor_type,visitorName:a.visitor_name||void 0,visitorPhone:a.visitor_phone||void 0,visitorVehiclePlate:a.visitor_vehicle_plate||void 0,accessType:a.access_type,validFrom:a.valid_from,validUntil:a.valid_until,maxUses:a.max_uses,currentUses:a.current_uses||0,qrToken:a.qr_token,status:a.status,notes:a.notes||void 0,createdAt:a.created_at,updatedAt:a.updated_at||void 0,revokedAt:a.revoked_at||void 0,revokedBy:a.revoked_by||void 0,revocationReason:a.revoked_reason||void 0}));e({guestAccessCodes:r,isLoadingGuestCodes:!1})}catch{e({isLoadingGuestCodes:!1})}},createGuestAccessCode:async t=>{try{const r=(await Ue.create({visitor_type:t.visitorType,visitor_name:t.visitorName,visitor_phone:t.visitorPhone,visitor_vehicle_plate:t.visitorVehiclePlate,access_type:t.accessType,valid_from:t.validFrom,valid_until:t.validUntil,resident_name:t.residentName,resident_phone:t.residentPhone,resident_apartment:t.residentApartment,resident_address:t.residentAddress,notes:t.notes})).code,a={id:r.id,residentId:r.user_id||t.residentId,residentName:r.resident_name||t.residentName,residentPhone:r.resident_phone||t.residentPhone,residentApartment:r.resident_apartment||t.residentApartment,residentAddress:r.resident_address||t.residentAddress,visitorType:r.visitor_type,visitorName:r.visitor_name||void 0,visitorPhone:r.visitor_phone||void 0,visitorVehiclePlate:r.visitor_vehicle_plate||void 0,accessType:r.access_type,validFrom:r.valid_from,validUntil:r.valid_until,maxUses:r.max_uses,currentUses:r.current_uses||0,qrToken:r.qr_token,status:r.status,notes:r.notes||void 0,createdAt:r.created_at};return e(o=>({guestAccessCodes:[a,...o.guestAccessCodes]})),a}catch{return null}},revokeGuestAccessCode:async(t,n,r,a,o)=>{try{await Ue.revoke(t,o),e(c=>({guestAccessCodes:c.guestAccessCodes.map(l=>l.id===t?{...l,status:"revoked",revokedAt:new Date().toISOString(),revokedBy:n,revokedByName:r,revokedByRole:a,revocationReason:o,updatedAt:new Date().toISOString()}:l)}))}catch{}},useGuestAccessCode:(t,n)=>{let a=s().guestAccessCodes.find(d=>d.id===t);if(!a&&n&&(a={...n,currentUses:0,status:"active"},e(d=>({guestAccessCodes:[a,...d.guestAccessCodes]}))),!a||a.status!=="active")return!1;const o=new Date;if(o>new Date(a.validUntil))return e(d=>({guestAccessCodes:d.guestAccessCodes.map(g=>g.id===t?{...g,status:"expired",updatedAt:o.toISOString()}:g)})),!1;const c=a.currentUses+1,l=c>=a.maxUses?"used":"active";return e(d=>({guestAccessCodes:d.guestAccessCodes.map(g=>g.id===t?{...g,currentUses:c,status:l,lastUsedAt:o.toISOString(),updatedAt:o.toISOString()}:g)})),!0},validateGuestAccessCode:t=>{const n=new Date;if(t.startsWith("GAPASS:"))try{const o=t.substring(7),c=atob(o),l=new Uint8Array(c.length);for(let w=0;w<c.length;w++)l[w]=c.charCodeAt(w);const g=new TextDecoder("utf-8").decode(l),m=JSON.parse(g),f={id:m.i,residentId:"from-token",residentName:m.rn,residentPhone:m.rp,residentApartment:m.ra,residentAddress:m.rd,visitorType:m.vt,visitorName:m.vn||void 0,visitorPhone:m.vp||void 0,visitorVehiclePlate:m.vv||void 0,accessType:m.at,validFrom:new Date(m.vf).toISOString(),validUntil:new Date(m.vu).toISOString(),maxUses:m.mx,currentUses:0,qrToken:t,status:"active",createdAt:new Date(m.vf).toISOString()};if(n.getTime()>m.vu)return{valid:!1,code:f,error:"expired"};if(n.getTime()<m.vf)return{valid:!1,code:f,error:"not_yet_valid"};const b=s().guestAccessCodes.filter(w=>w.id===m.i),y=b.length>0?b[0]:null;if(y){if(y.status==="revoked")return{valid:!1,code:{...f,...y},error:"revoked"};if(y.status==="used"||y.currentUses>=m.mx)return{valid:!1,code:{...f,...y},error:"already_used"};f.currentUses=y.currentUses,f.status=y.status}return{valid:!0,code:f}}catch{return{valid:!1,error:"invalid"}}const a=s().guestAccessCodes.find(o=>o.qrToken===t);return a?n>new Date(a.validUntil)?(a.status==="active"&&e(o=>({guestAccessCodes:o.guestAccessCodes.map(c=>c.id===a.id?{...c,status:"expired",updatedAt:n.toISOString()}:c)})),{valid:!1,code:a,error:"expired"}):n<new Date(a.validFrom)?{valid:!1,code:a,error:"not_yet_valid"}:a.status==="revoked"?{valid:!1,code:a,error:"revoked"}:a.status==="used"?{valid:!1,code:a,error:"already_used"}:a.status==="expired"?{valid:!1,code:a,error:"expired"}:a.currentUses>=a.maxUses?{valid:!1,code:a,error:"max_uses_reached"}:{valid:!0,code:a}:{valid:!1,error:"invalid"}},getGuestAccessCodesByResident:t=>{const n=new Date;return s().guestAccessCodes.some(o=>o.residentId===t&&o.status==="active"&&n>new Date(o.validUntil))&&e(o=>({guestAccessCodes:o.guestAccessCodes.map(c=>c.residentId===t&&c.status==="active"&&n>new Date(c.validUntil)?{...c,status:"expired",updatedAt:n.toISOString()}:c)})),s().guestAccessCodes.filter(o=>o.residentId===t)},getAllGuestAccessCodes:()=>{const t=new Date;return s().guestAccessCodes.some(a=>a.status==="active"&&t>new Date(a.validUntil))&&e(a=>({guestAccessCodes:a.guestAccessCodes.map(o=>o.status==="active"&&t>new Date(o.validUntil)?{...o,status:"expired",updatedAt:t.toISOString()}:o)})),s().guestAccessCodes},addGuestAccessLog:t=>{const n={...t,id:ie(),timestamp:new Date().toISOString()};e(r=>({guestAccessLogs:[n,...r.guestAccessLogs].slice(0,500)}))},getGuestAccessLogs:t=>{const n=s().guestAccessLogs;return t?n.filter(r=>r.accessCodeId===t):n},getGuestAccessStats:()=>{const t=s(),n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()),a=t.guestAccessCodes.map(m=>m.status==="active"&&n>new Date(m.validUntil)?{...m,status:"expired"}:m),o=a.filter(m=>m.status==="active"),c=t.guestAccessLogs.filter(m=>new Date(m.timestamp)>=r&&m.action==="entry_allowed").length,l=a.filter(m=>new Date(m.createdAt)>=r).length,d={courier:o.filter(m=>m.visitorType==="courier").length,guest:o.filter(m=>m.visitorType==="guest").length,taxi:o.filter(m=>m.visitorType==="taxi").length,other:o.filter(m=>m.visitorType==="other").length},g=t.guestAccessLogs.slice(0,10);return{totalActive:o.length,totalUsedToday:c,totalCreatedToday:l,byVisitorType:d,recentScans:g}},addVehicle:async t=>{const n=`temp-${ie()}`,r=new Date().toISOString(),a={id:n,ownerId:t.ownerId,ownerName:t.ownerName,ownerPhone:t.ownerPhone,apartment:t.apartment,address:t.address,plateNumber:t.plateNumber,brand:t.brand||"",model:t.model||"",color:t.color||"",year:t.year,type:t.type||"car",ownerType:t.ownerType||"individual",companyName:t.companyName,parkingSpot:t.parkingSpot,notes:t.notes,createdAt:r};e(o=>({vehicles:[...o.vehicles,a]}));try{const c=(await W.create({plate_number:t.plateNumber,brand:t.brand,model:t.model,color:t.color,year:t.year,vehicle_type:t.type,owner_type:t.ownerType,company_name:t.companyName,parking_spot:t.parkingSpot,notes:t.notes,is_primary:!1})).vehicle,l={id:c.id,ownerId:c.user_id,ownerName:c.owner_name||t.ownerName,ownerPhone:c.owner_phone||t.ownerPhone,apartment:c.apartment||t.apartment,address:c.address||t.address,plateNumber:c.plate_number,brand:c.brand||"",model:c.model||"",color:c.color||"",year:c.year||void 0,type:c.vehicle_type||"car",ownerType:c.owner_type||"individual",companyName:c.company_name||void 0,parkingSpot:c.parking_spot||void 0,notes:c.notes||void 0,createdAt:c.created_at||r,updatedAt:c.updated_at||void 0};return e(d=>({vehicles:d.vehicles.map(g=>g.id===n?l:g)})),l}catch{return e(c=>({vehicles:c.vehicles.filter(l=>l.id!==n)})),null}},updateVehicle:async(t,n)=>{const r=s().vehicles.find(a=>a.id===t);if(r){e(a=>({vehicles:a.vehicles.map(o=>o.id===t?{...o,...n,updatedAt:new Date().toISOString()}:o)}));try{await W.update(t,{plate_number:n.plateNumber,brand:n.brand,model:n.model,color:n.color,year:n.year,vehicle_type:n.type,owner_type:n.ownerType,company_name:n.companyName,parking_spot:n.parkingSpot,notes:n.notes})}catch{e(o=>({vehicles:o.vehicles.map(c=>c.id===t?r:c)}))}}},deleteVehicle:async t=>{const n=s().vehicles.find(r=>r.id===t);e(r=>({vehicles:r.vehicles.filter(a=>a.id!==t)}));try{await W.delete(t)}catch{n&&e(a=>({vehicles:[...a.vehicles,n]}))}},getVehiclesByOwner:t=>s().vehicles.filter(n=>n.ownerId===t),searchVehicleByPlate:async t=>{try{const n=await W.search(t);if(n.vehicles&&n.vehicles.length>0){const r=n.vehicles[0];return{id:r.id,ownerId:r.user_id,ownerName:r.owner_name||"",ownerPhone:r.owner_phone||"",apartment:r.apartment||"",address:r.address||"",plateNumber:r.plate_number,brand:r.brand||"",model:r.model||"",color:r.color||"",year:r.year||void 0,type:r.vehicle_type||"car",ownerType:r.owner_type||"individual",companyName:r.company_name||void 0,parkingSpot:r.parking_spot||void 0,notes:r.notes||void 0,createdAt:r.created_at,updatedAt:r.updated_at||void 0}}return}catch{const r=t.toUpperCase().replace(/\s+/g,"");return s().vehicles.find(a=>a.plateNumber.toUpperCase().replace(/\s+/g,"")===r)}},searchVehiclesByPlate:async t=>{try{const n=await W.search(t);return n.vehicles&&n.vehicles.length>0?n.vehicles.map(r=>({id:r.id,ownerId:r.user_id,ownerName:r.owner_name||"",ownerPhone:r.owner_phone||"",apartment:r.apartment||"",address:r.address||"",plateNumber:r.plate_number,brand:r.brand||"",model:r.model||"",color:r.color||"",year:r.year||void 0,type:r.vehicle_type||"car",ownerType:r.owner_type||"individual",companyName:r.company_name||void 0,parkingSpot:r.parking_spot||void 0,notes:r.notes||void 0,createdAt:r.created_at,updatedAt:r.updated_at||void 0})):[]}catch{return[]}},addAnnouncement:async t=>{try{const{announcementsApi:n}=await S(async()=>{const{announcementsApi:l}=await Promise.resolve().then(()=>V);return{announcementsApi:l}},void 0),r=t.target,a={title:t.title,content:t.content,type:t.type,priority:t.priority,expires_at:t.expiresAt,target_type:r?.type,target_branch:r?.branchId,target_building_id:r?.buildingId,target_entrance:r?.entrance,target_floor:r?.floor,target_logins:r?.customLogins?.join(","),attachments:t.attachments},o=await n.create(a);return await s().fetchAnnouncements(),{...t,id:o.id||ie(),createdAt:new Date().toISOString(),isActive:!0,viewedBy:[]}}catch{const r={...t,id:ie(),createdAt:new Date().toISOString(),isActive:!0,viewedBy:[]};return e(a=>({announcements:[r,...a.announcements]})),r}},updateAnnouncement:async(t,n)=>{e(r=>({announcements:r.announcements.map(a=>a.id===t?{...a,...n}:a)}));try{const{announcementsApi:r}=await S(async()=>{const{announcementsApi:a}=await Promise.resolve().then(()=>V);return{announcementsApi:a}},void 0);await r.update(t,{title:n.title,content:n.content,type:n.type,priority:n.priority,target_type:n.target?.type,target_building_id:n.target?.buildingId,target_entrance:n.target?.entrance,target_floor:n.target?.floor,target_logins:n.target?.customLogins?.join(","),expires_at:n.expiresAt})}catch{}},deleteAnnouncement:async t=>{try{const{announcementsApi:n}=await S(async()=>{const{announcementsApi:r}=await Promise.resolve().then(()=>V);return{announcementsApi:r}},void 0);await n.delete(t)}catch{}e(n=>({announcements:n.announcements.filter(r=>r.id!==t)}))},markAnnouncementAsViewed:async(t,n)=>{const r=`read_announcements_${n}`,a=JSON.parse(localStorage.getItem(r)||"[]");a.includes(t)||(a.push(t),localStorage.setItem(r,JSON.stringify(a))),e(o=>({announcements:o.announcements.map(c=>c.id===t&&!c.viewedBy.includes(n)?{...c,viewedBy:[...c.viewedBy,n]}:c)}));try{const{announcementsApi:o}=await S(async()=>{const{announcementsApi:c}=await Promise.resolve().then(()=>V);return{announcementsApi:c}},void 0);await o.markAsViewed(t)}catch{}},getAnnouncementsForResidents:(t,n,r,a,o)=>{const c=new Date;return s().announcements.filter(l=>{if(l.type!=="residents"&&l.type!=="all"||!l.isActive||l.expiresAt&&new Date(l.expiresAt)<=c)return!1;if(!l.target||l.target.type==="all")return!0;switch(l.target.type){case"building":return n&&l.target.buildingId===n;case"entrance":return n===l.target.buildingId&&r===l.target.entrance;case"floor":return n===l.target.buildingId&&r===l.target.entrance&&a===l.target.floor;case"custom":return l.target.customLogins?.includes(t)||!1;case"branch":return!o||l.target.branchId===o;default:return!0}})},getAnnouncementsForEmployees:()=>{const t=new Date;return s().announcements.filter(n=>(n.type==="employees"||n.type==="all")&&n.isActive&&(!n.expiresAt||new Date(n.expiresAt)>t))},getAnnouncementsByAuthor:t=>s().announcements.filter(n=>n.authorId===t),fetchAnnouncements:async()=>{try{const{announcementsApi:t}=await S(async()=>{const{announcementsApi:c}=await Promise.resolve().then(()=>V);return{announcementsApi:c}},void 0),n=await t.getAll(),a=JSON.parse(localStorage.getItem("uk-auth-storage")||"{}")?.state?.user?.id,o=(n.announcements||[]).map(c=>{const l=c.viewed_by_user===!0||c.viewed_by_user===1,d=[];if(l&&a&&d.push(a),a){const f=`read_announcements_${a}`;JSON.parse(localStorage.getItem(f)||"[]").includes(c.id)&&!d.includes(a)&&d.push(a)}let g;if(c.attachments)try{g=typeof c.attachments=="string"?JSON.parse(c.attachments):c.attachments}catch{g=void 0}const m=c.type==="staff"?"employees":c.type;return{id:c.id,title:c.title,content:c.content,type:m,priority:c.priority||"normal",authorId:c.created_by||"",authorName:c.author_name||"",authorRole:"manager",createdAt:c.created_at,expiresAt:c.expires_at,isActive:c.is_active===1,viewedBy:d,viewCount:c.view_count||0,attachments:g,target:c.target_type?{type:c.target_type,branchId:c.target_branch,buildingId:c.target_building_id,entrance:c.target_entrance,floor:c.target_floor,customLogins:c.target_logins?.split(",").filter(Boolean)}:void 0}});e({announcements:o})}catch{}},fetchRentals:async()=>{try{const[t,n]=await Promise.all([F.getApartments(),F.getRecords()]);e({rentalApartments:t.apartments||[],rentalRecords:n.records||[]})}catch{}},fetchMyRentals:async()=>{try{const t=await F.getMyApartments();e({rentalApartments:t.apartments||[],rentalRecords:t.records||[]})}catch{}},addRentalApartment:async t=>{try{const n=await F.createApartment({name:t.name,address:t.address,apartment:t.apartment,ownerName:t.ownerName,ownerPhone:t.ownerPhone,ownerLogin:t.ownerLogin,ownerPassword:t.password,ownerType:t.ownerType||"tenant"});return n.apartment?(e(r=>({rentalApartments:[...r.rentalApartments,n.apartment]})),n.apartment):null}catch(n){throw n}},updateRentalApartment:async(t,n)=>{try{await F.updateApartment(t,n),e(r=>({rentalApartments:r.rentalApartments.map(a=>a.id===t?{...a,...n}:a)}))}catch{}},deleteRentalApartment:async t=>{try{await F.deleteApartment(t),e(n=>({rentalApartments:n.rentalApartments.filter(r=>r.id!==t),rentalRecords:n.rentalRecords.filter(r=>r.apartmentId!==t)}))}catch{}},getRentalApartmentsByOwner:t=>s().rentalApartments.filter(n=>n.ownerId===t),addRentalRecord:async t=>{try{const n=await F.createRecord({apartmentId:t.apartmentId,guestNames:t.guestNames,passportInfo:t.passportInfo,checkInDate:t.checkInDate,checkOutDate:t.checkOutDate,amount:t.amount,currency:t.currency,notes:t.notes});return n.record?(e(r=>({rentalRecords:[n.record,...r.rentalRecords]})),n.record):null}catch{return null}},updateRentalRecord:async(t,n)=>{try{await F.updateRecord(t,n),e(r=>({rentalRecords:r.rentalRecords.map(a=>a.id===t?{...a,...n}:a)}))}catch{}},deleteRentalRecord:async t=>{try{await F.deleteRecord(t),e(n=>({rentalRecords:n.rentalRecords.filter(r=>r.id!==t)}))}catch{}},getRentalRecordsByApartment:t=>s().rentalRecords.filter(n=>n.apartmentId===t),addExecutor:async t=>{try{const n=await ce.register({login:t.login,password:t.password,name:t.name,role:t.role||"executor",phone:t.phone,specialization:t.specialization});if(n.user){const r={id:n.user.id,name:n.user.name,phone:n.user.phone||t.phone,login:n.user.login,specialization:n.user.specialization||t.specialization,createdAt:new Date().toISOString(),rating:5,completedCount:0,activeRequests:0,totalEarnings:0,avgCompletionTime:0,status:"offline"};return e(a=>({executors:[...a.executors,r]})),s().fetchExecutors(),r}return null}catch(n){throw n}},updateExecutor:(t,n)=>{e(r=>({executors:r.executors.map(a=>a.id===t?{...a,...n}:a)}))},deleteExecutor:async t=>{try{await le.delete(t),e(n=>({executors:n.executors.filter(r=>r.id!==t)}))}catch(n){throw n}},getExecutorStats:t=>{const{requests:n}=s(),r=n.filter(y=>y.executorId===t),a=r.filter(y=>y.status==="completed"),o=new Date,c=new Date(o.getTime()-10080*60*1e3),l=new Date(o.getTime()-720*60*60*1e3),d=a.filter(y=>y.approvedAt&&new Date(y.approvedAt)>=c).length,g=a.filter(y=>y.approvedAt&&new Date(y.approvedAt)>=l).length,m=a.filter(y=>y.rating).map(y=>y.rating),f=m.length>0?m.reduce((y,w)=>y+w,0)/m.length:5,h=a.filter(y=>y.workDuration).map(y=>y.workDuration),b=h.length>0?Math.round(h.reduce((y,w)=>y+w,0)/h.length/60):0;return{totalRequests:r.length,completedRequests:a.length,avgRating:Math.round(f*10)/10,avgTime:b,thisWeek:d,thisMonth:g}},addRequest:async t=>{const n=`temp-${ie()}`,r=`#${n.substring(5,11).toUpperCase()}`,a=new Date().toISOString(),o={id:n,number:r,title:t.title,description:t.description||"",category:t.category,status:"new",priority:t.priority||"medium",residentId:t.residentId,residentName:t.residentName,residentPhone:t.residentPhone,address:t.address,apartment:t.apartment,accessInfo:t.accessInfo,scheduledDate:t.scheduledDate,scheduledTime:t.scheduledTime,createdAt:a};e(c=>({requests:[o,...c.requests]})),s().addNotification({userId:"manager",type:"request_created",title:"Новая заявка",message:`Заявка ${r}: ${t.title}`,requestId:n});try{const l=(await B.create({category_id:t.category,title:t.title,description:t.description,priority:t.priority,access_info:t.accessInfo,scheduled_at:t.scheduledDate&&t.scheduledTime?`${t.scheduledDate}T${t.scheduledTime}:00`:void 0,resident_id:t.residentId})).request,d={id:l.id,number:l.request_number||l.number,title:l.title,description:l.description,category:l.category_id,status:l.status,priority:l.priority||"medium",residentId:l.resident_id,residentName:l.resident_name,residentPhone:l.resident_phone,address:l.address,apartment:l.apartment,createdAt:l.created_at};return e(g=>({requests:g.requests.map(m=>m.id===n?d:m)})),s().addActivityLog({userId:t.residentId,userName:t.residentName,userRole:"resident",action:"Создал заявку",details:`Заявка #${d.number}: ${d.title}`,requestId:d.id}),d}catch{return e(l=>({requests:l.requests.filter(d=>d.id!==n)})),null}},assignRequest:async(t,n)=>{const r=s(),a=r.executors.find(h=>h.id===n),o=r.requests.find(h=>h.id===t);if(!o)return;const{user:c}=U.getState(),l=c?.role==="executor"&&c?.id===n,d=a?.name||"Исполнитель",g=a?.phone||"",m={...o},f=a?{...a}:null;e(h=>({requests:h.requests.map(b=>b.id===t?{...b,status:"assigned",executorId:n,executorName:d,executorPhone:g,executorRating:a?.rating||5,assignedAt:new Date().toISOString()}:b),executors:h.executors.map(b=>b.id===n?{...b,status:"busy",activeRequests:(b.activeRequests||0)+1}:b)})),l?(s().addNotification({userId:"manager1",type:"request_assigned",title:"Исполнитель взял заявку",message:`${d} взял заявку #${o.number}: ${o.title}`,requestId:t}),s().addActivityLog({userId:n,userName:d,userRole:"executor",action:"Взял заявку",details:`Заявка #${o.number}: ${o.title}`,requestId:t})):(s().addNotification({userId:n,type:"request_assigned",title:"Новая заявка назначена",message:`Вам назначена заявка #${o.number}: ${o.title}`,requestId:t}),s().addActivityLog({userId:c?.id||"system",userName:c?.name||"Система",userRole:c?.role||"manager",action:"Назначил исполнителя",details:`Заявка #${o.number} назначена ${d}`,requestId:t}));try{await B.assign(t,n)}catch{e(b=>({requests:b.requests.map(y=>y.id===t?m:y),executors:f?b.executors.map(y=>y.id===n?f:y):b.executors}))}},acceptRequest:async t=>{const r=s().requests.find(o=>o.id===t);if(!r)return;const a={...r};e(o=>({requests:o.requests.map(c=>c.id===t?{...c,status:"accepted",acceptedAt:new Date().toISOString()}:c)})),s().addNotification({userId:r.residentId,type:"request_accepted",title:"Заявка принята",message:`Исполнитель ${r.executorName} принял вашу заявку #${r.number}`,requestId:t}),s().addNotification({userId:"manager",type:"request_accepted",title:"Заявка принята исполнителем",message:`${r.executorName} принял заявку #${r.number}`,requestId:t}),s().addActivityLog({userId:r.executorId,userName:r.executorName,userRole:"executor",action:"Принял заявку",details:`Заявка #${r.number}`,requestId:t});try{await B.accept(t)}catch{e(c=>({requests:c.requests.map(l=>l.id===t?a:l)}))}},startWork:async t=>{const n=s(),r=n.requests.find(c=>c.id===t);if(!r)return;const a=r.executorId;if(a&&n.requests.some(l=>l.executorId===a&&l.status==="in_progress"&&l.id!==t))return;const o={...r};e(c=>({requests:c.requests.map(l=>l.id===t?{...l,status:"in_progress",startedAt:new Date().toISOString()}:l)})),s().addNotification({userId:r.residentId,type:"request_started",title:"Работа начата",message:`Исполнитель ${r.executorName} начал работу по заявке #${r.number}`,requestId:t}),s().addActivityLog({userId:r.executorId,userName:r.executorName,userRole:"executor",action:"Начал работу",details:`Заявка #${r.number}`,requestId:t});try{await B.start(t)}catch{e(l=>({requests:l.requests.map(d=>d.id===t?o:d)}))}},pauseWork:async t=>{const r=s().requests.find(a=>a.id===t);if(!(!r||r.status!=="in_progress"||r.isPaused))try{await B.pause(t),e(a=>({requests:a.requests.map(o=>o.id===t?{...o,isPaused:!0,pausedAt:new Date().toISOString()}:o)})),s().addActivityLog({userId:r.executorId,userName:r.executorName,userRole:"executor",action:"Приостановил работу",details:`Заявка #${r.number}`,requestId:t})}catch{}},resumeWork:async t=>{const r=s().requests.find(a=>a.id===t);if(!(!r||r.status!=="in_progress"||!r.isPaused))try{const o=(await B.resume(t)).totalPausedTime||r.totalPausedTime||0;e(c=>({requests:c.requests.map(l=>l.id===t?{...l,isPaused:!1,pausedAt:void 0,totalPausedTime:o}:l)})),s().addActivityLog({userId:r.executorId,userName:r.executorName,userRole:"executor",action:"Возобновил работу",details:`Заявка #${r.number}`,requestId:t})}catch{}},completeWork:async(t,n)=>{const a=s().requests.find(c=>c.id===t);if(!a)return;const o=!!a.rejectionReason;try{await B.complete(t),e(d=>({requests:d.requests.map(g=>g.id===t?{...g,status:"pending_approval",completedAt:new Date().toISOString(),workDuration:n,isPaused:void 0,pausedAt:void 0,rejectedAt:void 0,rejectionReason:void 0}:g)}));const c=o?`Исполнитель переделал работу по заявке #${a.number}. Пожалуйста, проверьте и подтвердите.`:`Исполнитель завершил работу по заявке #${a.number}. Пожалуйста, подтвердите выполнение.`;s().addNotification({userId:a.residentId,type:"request_completed",title:o?"Работа переделана":"Работа завершена",message:c,requestId:t});const{user:l}=U.getState();l?.id===a.residentId&&te.notifyRequestCompleted(a.number,a.executorName||"Исполнитель",t),s().addNotification({userId:"manager",type:"request_completed",title:"Работа завершена",message:`${a.executorName} завершил заявку #${a.number}. Ожидается подтверждение жителя.`,requestId:t}),s().addActivityLog({userId:a.executorId,userName:a.executorName,userRole:"executor",action:"Завершил работу",details:`Заявка #${a.number}, время работы: ${Math.round(n/60)} мин`,requestId:t})}catch{}},approveRequest:async(t,n,r)=>{const a=s(),o=a.requests.find(c=>c.id===t);if(o)try{if(await B.approve(t,n,r),e(c=>({requests:c.requests.map(l=>l.id===t?{...l,status:"completed",approvedAt:new Date().toISOString(),rating:n,feedback:r}:l)})),o.executorId&&a.executors.find(l=>l.id===o.executorId)){const d=[...a.requests.filter(m=>m.executorId===o.executorId&&m.status==="completed").map(m=>m.rating||5),n],g=d.reduce((m,f)=>m+f,0)/d.length;e(m=>({executors:m.executors.map(f=>f.id===o.executorId?{...f,completedCount:f.completedCount+1,rating:Math.round(g*10)/10,totalEarnings:f.totalEarnings+1e5}:f)}))}s().addNotification({userId:o.executorId,type:"request_approved",title:"Работа подтверждена",message:`Заявка #${o.number} подтверждена. Оценка: ${n}/5`,requestId:t}),s().addActivityLog({userId:o.residentId,userName:o.residentName,userRole:"resident",action:"Подтвердил выполнение",details:`Заявка #${o.number}, оценка: ${n}/5`,requestId:t})}catch{}},rejectRequest:async(t,n)=>{const a=s().requests.find(o=>o.id===t);if(a)try{await B.reject(t,n);const o=(a.rejectionCount||0)+1;e(c=>({requests:c.requests.map(l=>l.id===t?{...l,status:"in_progress",completedAt:void 0,workDuration:void 0,rejectedAt:new Date().toISOString(),rejectionReason:n,rejectionCount:o}:l)})),s().addActivityLog({userId:a.residentId,userName:a.residentName,userRole:"resident",action:"Отклонил выполнение",details:`Заявка #${a.number}, причина: ${n}`,requestId:t})}catch{}},cancelRequest:async(t,n,r)=>{const a=s(),o=a.requests.find(h=>h.id===t);if(!o)return;const{user:c}=U.getState(),l=c?.name||"Система",d=["new","assigned","accepted"].includes(o.status),g=o.status!=="completed";if(n==="resident"&&!d||(n==="manager"||n==="admin")&&!g)return;const m=o.executorId;try{await B.cancel(t,r)}catch{}if(e(h=>({requests:h.requests.map(b=>b.id===t?{...b,status:"cancelled",cancelledAt:new Date().toISOString(),cancelledBy:n,cancellationReason:r}:b)})),m){const h=a.requests.filter(b=>b.executorId===m&&["assigned","accepted","in_progress"].includes(b.status)&&b.id!==t).length;e(b=>({executors:b.executors.map(y=>y.id===m?{...y,activeRequests:h,status:h>0?"busy":"available"}:y)}))}const f={resident:"Житель",executor:"Исполнитель",manager:"Менеджер",admin:"Администратор"};n!=="resident"&&s().addNotification({userId:o.residentId,type:"request_cancelled",title:"Заявка отменена",message:`Заявка #${o.number} была отменена. Причина: ${r}`,requestId:t}),m&&n!=="executor"&&s().addNotification({userId:m,type:"request_cancelled",title:"Заявка отменена",message:`Заявка #${o.number} была отменена ${f[n]}. Причина: ${r}`,requestId:t}),(n==="resident"||n==="executor")&&s().addNotification({userId:"manager1",type:"request_cancelled",title:"Заявка отменена",message:`${f[n]} отменил заявку #${o.number}. Причина: ${r}`,requestId:t}),s().addActivityLog({userId:c?.id||"system",userName:l,userRole:n,action:"Отменил заявку",details:`Заявка #${o.number}: ${r}`,requestId:t})},declineRequest:async(t,n)=>{const r=s(),a=r.requests.find(d=>d.id===t);if(!a||!["assigned","accepted","in_progress"].includes(a.status))return;const o=a.executorId,c=a.executorName,l={...a};if(e(d=>({requests:d.requests.map(g=>g.id===t?{...g,status:"new",executorId:void 0,executorName:void 0,executorPhone:void 0,executorRating:void 0,assignedAt:void 0,acceptedAt:void 0,startedAt:void 0}:g)})),o){const d=r.requests.filter(g=>g.executorId===o&&["assigned","accepted","in_progress"].includes(g.status)&&g.id!==t).length;e(g=>({executors:g.executors.map(m=>m.id===o?{...m,activeRequests:d,status:d>0?"busy":"available"}:m)}))}s().addNotification({userId:a.residentId,type:"request_declined",title:"Исполнитель отказался",message:`Исполнитель ${c} отказался от заявки #${a.number}. Заявка возвращена в очередь.`,requestId:t}),s().addNotification({userId:"manager1",type:"request_declined",title:"Исполнитель отказался от заявки",message:`${c} отказался от заявки #${a.number}. Причина: ${n}. Заявка требует нового назначения.`,requestId:t}),s().addActivityLog({userId:o||"system",userName:c||"Исполнитель",userRole:"executor",action:"Отказался от заявки",details:`Заявка #${a.number}: ${n}`,requestId:t});try{await B.decline(t,n)}catch(d){throw e(g=>({requests:g.requests.map(m=>m.id===t?l:m)})),d}},getRequestsByResident:t=>s().requests.filter(n=>n.residentId===t),getRequestsByExecutor:t=>s().requests.filter(n=>n.executorId===t),addNotification:t=>{const n={...t,id:ie(),read:!1,createdAt:new Date().toISOString()};e(r=>({notifications:[n,...r.notifications].slice(0,200)}))},markNotificationAsRead:t=>{e(n=>({notifications:n.notifications.map(r=>r.id===t?{...r,read:!0}:r)}))},markAllNotificationsAsRead:t=>{e(n=>({notifications:n.notifications.map(r=>r.userId===t?{...r,read:!0}:r)}))},getUnreadCount:t=>s().notifications.filter(n=>n.userId===t&&!n.read).length,addActivityLog:t=>{const n={...t,id:ie(),timestamp:new Date().toISOString()};e(r=>({activityLogs:[n,...r.activityLogs].slice(0,100)}))},getStats:()=>{const{requests:t,executors:n}=s(),r=new Date,a=new Date(r.getFullYear(),r.getMonth(),r.getDate()),o=new Date(a.getTime()-10080*60*1e3),c=t.filter(h=>h.status==="completed"&&h.approvedAt),l=c.filter(h=>new Date(h.approvedAt)>=a).length,d=c.filter(h=>new Date(h.approvedAt)>=o).length;let g=0,m=0;c.forEach(h=>{h.workDuration&&(g+=h.workDuration,m++)});const f=m>0?Math.round(g/m/60):0;return{totalRequests:t.length,newRequests:t.filter(h=>h.status==="new").length,inProgress:t.filter(h=>["assigned","accepted","in_progress"].includes(h.status)).length,pendingApproval:t.filter(h=>h.status==="pending_approval").length,completedToday:l,completedWeek:d,avgCompletionTime:f,executorsOnline:n.filter(h=>h.status!=="offline").length,executorsTotal:n.length}},getChartData:()=>{const{requests:t}=s(),n=new Date,r=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],a=[];for(let o=6;o>=0;o--){const c=new Date(n);c.setDate(c.getDate()-o);const l=new Date(c.getFullYear(),c.getMonth(),c.getDate()),d=new Date(l.getTime()+1440*60*1e3),g=t.filter(f=>{const h=new Date(f.createdAt);return h>=l&&h<d}).length,m=t.filter(f=>{if(!f.approvedAt)return!1;const h=new Date(f.approvedAt);return h>=l&&h<d}).length;a.push({date:l.toISOString(),name:r[c.getDay()===0?6:c.getDay()-1],created:g,completed:m})}return a},fetchSettings:async()=>{try{const{settingsApi:t}=await S(async()=>{const{settingsApi:r}=await Promise.resolve().then(()=>V);return{settingsApi:r}},void 0),n=await t.getAll();if(n.success&&n.data?.settings){const r=n.data.settings;e(a=>({settings:{...a.settings,companyName:r.companyName??a.settings.companyName,companyInn:r.companyInn??a.settings.companyInn,companyAddress:r.companyAddress??a.settings.companyAddress,companyPhone:r.companyPhone??a.settings.companyPhone,routingMode:r.routingMode??a.settings.routingMode,workingHoursStart:r.workingHoursStart??a.settings.workingHoursStart,workingHoursEnd:r.workingHoursEnd??a.settings.workingHoursEnd,autoAssign:r.autoAssign??a.settings.autoAssign,notifyOnNew:r.notifyOnNew??a.settings.notifyOnNew,notifyOnComplete:r.notifyOnComplete??a.settings.notifyOnComplete,notifyOnRating:r.notifyOnRating??a.settings.notifyOnRating,smsNotifications:r.smsNotifications??a.settings.smsNotifications,emailNotifications:r.emailNotifications??a.settings.emailNotifications,pushNotifications:r.pushNotifications??a.settings.pushNotifications}}))}}catch{}},updateSettings:async t=>{e(n=>({settings:{...n.settings,...t}}));try{const{settingsApi:n}=await S(async()=>{const{settingsApi:r}=await Promise.resolve().then(()=>V);return{settingsApi:r}},void 0);await n.updateMany(t)}catch{}},fetchPendingReschedules:async()=>{try{const{rescheduleApi:t}=await S(async()=>{const{rescheduleApi:o}=await Promise.resolve().then(()=>V);return{rescheduleApi:o}},void 0),a=((await t.getPending()).reschedules||[]).map(o=>({id:o.id,requestId:o.request_id,requestNumber:o.request_number||o.request_title||`#${o.request_id?.substring(0,6)}`,initiator:o.initiator,initiatorId:o.initiator_id,initiatorName:o.initiator_name,recipientId:o.recipient_id,recipientName:o.recipient_name,recipientRole:o.recipient_role,currentDate:o.current_date,currentTime:o.current_time,proposedDate:o.proposed_date,proposedTime:o.proposed_time,reason:o.reason,reasonText:o.reason_text,status:o.status,responseNote:o.response_note,createdAt:o.created_at,respondedAt:o.responded_at,expiresAt:o.expires_at}));e({rescheduleRequests:a})}catch{}},createRescheduleRequest:async t=>{const r=s().requests.find(o=>o.id===t.requestId);if(!r)return null;const{user:a}=U.getState();if(!a)return null;try{const{requestsApi:o}=await S(async()=>{const{requestsApi:l}=await Promise.resolve().then(()=>V);return{requestsApi:l}},void 0),c=await o.createReschedule(t.requestId,{proposed_date:t.proposedDate,proposed_time:t.proposedTime,reason:t.reason,reason_text:t.reasonText});if(c.reschedule){const l=c.reschedule,d={id:l.id,requestId:l.request_id,requestNumber:r.number,initiator:l.initiator,initiatorId:l.initiator_id,initiatorName:l.initiator_name,recipientId:l.recipient_id,recipientName:l.recipient_name,recipientRole:l.recipient_role,currentDate:l.current_date,currentTime:l.current_time,proposedDate:l.proposed_date,proposedTime:l.proposed_time,reason:l.reason,reasonText:l.reason_text,status:"pending",createdAt:l.created_at,expiresAt:l.expires_at};return e(g=>({rescheduleRequests:[d,...g.rescheduleRequests]})),d}return null}catch{return null}},respondToRescheduleRequest:async(t,n,r)=>{const o=s().rescheduleRequests.find(c=>c.id===t);if(!(!o||o.status!=="pending"))try{const{rescheduleApi:c}=await S(async()=>{const{rescheduleApi:d}=await Promise.resolve().then(()=>V);return{rescheduleApi:d}},void 0);(await c.respond(t,n,r)).reschedule&&(e(d=>({rescheduleRequests:d.rescheduleRequests.map(g=>g.id===t?{...g,status:n?"accepted":"rejected",respondedAt:new Date().toISOString(),responseNote:r}:g)})),n&&(e(d=>({requests:d.requests.map(g=>g.id===o.requestId?{...g,scheduledDate:o.proposedDate,scheduledTime:o.proposedTime}:g)})),s().fetchRequests()))}catch{}},getRescheduleRequestsByRequest:t=>s().rescheduleRequests.filter(n=>n.requestId===t),getPendingRescheduleForUser:t=>s().rescheduleRequests.filter(n=>n.recipientId===t&&n.status==="pending"),getActiveRescheduleForRequest:t=>s().rescheduleRequests.find(n=>n.requestId===t&&n.status==="pending"),getConfirmedRescheduleForRequest:t=>{const n=Date.now()-864e5;return s().rescheduleRequests.find(r=>r.requestId===t&&r.status==="accepted"&&r.respondedAt&&new Date(r.respondedAt).getTime()>n)}}),{name:"uk-data-storage",partialize:e=>({settings:e.settings,notifications:e.notifications.slice(0,100)}),merge:(e,s)=>{const t=e,n=St();return{...s,settings:t.settings||s.settings,notifications:t.notifications||[],vehicles:[],announcements:[],requests:[],guestAccessCodes:[n],executors:[],rescheduleRequests:[],rentalApartments:[],rentalRecords:[]}}}));typeof window<"u"&&window.addEventListener("storage",e=>{if(e.key==="uk-data-storage"&&e.newValue)try{const s=JSON.parse(e.newValue);s.state?.guestAccessCodes&&G.setState({guestAccessCodes:s.state.guestAccessCodes})}catch{}});const Yn={ru:{"app.name":"Kamizo","app.subtitle":"CRM Система","auth.title":"Вход в систему","auth.login":"Логин","auth.password":"Пароль","auth.enter":"Войти","auth.error":"Неверный логин или пароль","auth.logout":"Выйти","nav.dashboard":"Дашборд","nav.requests":"Заявки","nav.executors":"Исполнители","nav.residents":"Жители","nav.buildings":"Здания","nav.activity":"Журнал действий","nav.reports":"Отчёты","nav.settings":"Настройки","nav.monitoring":"Мониторинг","nav.myRequests":"Мои заявки","nav.services":"Услуги","nav.profile":"Профиль","nav.more":"Ещё","nav.rentals":"Аренда квартир","nav.myApartments":"Мои квартиры","nav.accounts":"Лицевые счета","nav.owners":"Собственники","nav.workOrders":"Наряды на работы","nav.trainings":"Тренинги","dashboard.manager":"Панель менеджера","dashboard.admin":"Панель администратора","dashboard.newRequests":"Новые заявки","dashboard.inProgress":"В работе","dashboard.pendingApproval":"Ожидают подтверждения","dashboard.completedWeek":"Выполнено за неделю","dashboard.weeklyRequests":"Заявки за неделю","dashboard.byCategory":"По категориям","dashboard.recentRequests":"Последние заявки","dashboard.viewAll":"Все","request.assign":"Назначить","request.reassign":"Переназначить","request.executor":"Исполнитель","request.search":"Поиск...","request.allStatuses":"Все статусы","request.notFound":"Заявок не найдено","request.changeFilters":"Попробуйте изменить фильтры","executor.available":"Доступно","executor.busy":"Заняты","executor.offline":"Оффлайн","executor.all":"Все исполнители","executor.add":"Добавить исполнителя","executor.completed":"выполнено","executor.active":"активных","resident.add":"Добавить жителя","resident.total":"всего","resident.noResidents":"Жителей пока нет","resident.willAppear":"Жители появятся после создания заявок","status.new":"Новая","status.assigned":"Назначена","status.accepted":"Принята","status.in_progress":"В работе","status.pending_approval":"Ожидает подтверждения","status.completed":"Выполнена","status.cancelled":"Отменена","priority.low":"Низкий","priority.medium":"Средний","priority.high":"Высокий","priority.urgent":"Срочный","form.name":"ФИО","form.phone":"Телефон","form.address":"Адрес","form.apartment":"Квартира","form.login":"Логин","form.password":"Пароль","form.specialization":"Специализация","form.generate":"Сгенерировать","form.cancel":"Отмена","form.add":"Добавить","form.save":"Сохранить","form.done":"Готово","form.copy":"Копировать","form.copied":"Скопировано!","form.fillAll":"Заполните все поля","form.credentials":"Данные для входа","timer.start":"Начать работу","timer.pause":"Пауза","timer.resume":"Продолжить","timer.finish":"Завершить","timer.elapsed":"Прошло времени","settings.general":"Общие","settings.notifications":"Уведомления","settings.integrations":"Интеграции","settings.users":"Пользователи","settings.language":"Язык","common.all":"Все","common.delete":"Удалить","common.edit":"Редактировать","common.view":"Просмотр","common.refresh":"Обновить","common.loading":"Загрузка...","common.noData":"Нет данных","rental.title":"Аренда квартир","rental.addApartment":"Добавить квартиру","rental.noApartments":"Квартир пока нет","rental.addFirst":"Добавьте первую квартиру для управления арендой","rental.occupied":"Занята","rental.available":"Свободна","rental.records":"записей","rental.currentGuest":"Текущий гость","rental.until":"до","rental.deleteApartment":"Удалить квартиру","rental.owner":"Владелец","rental.addRecord":"Добавить запись","rental.rentalHistory":"История аренды","rental.noRecords":"Записей пока нет","rental.active":"Активно","rental.apartmentName":"Название","rental.ownerData":"Данные владельца (тенанта)","rental.guestNames":"Имена гостей","rental.passportInfo":"Паспортные данные","rental.checkIn":"Дата заезда","rental.checkOut":"Дата выезда","rental.amount":"Сумма","rental.currency":"Валюта","rental.notes":"Заметки (опционально)","rental.apartmentAdded":"Квартира добавлена!","rental.ownerCredentials":"Данные для входа владельца:","rental.generateCredentials":"Сгенерировать логин/пароль","rental.confirmDelete":"Подтвердите удаление","rental.enterOwnerPassword":"Введите пароль владельца квартиры для подтверждения удаления","rental.wrongPassword":"Неверный пароль","tenant.myApartments":"Мои квартиры","tenant.welcome":"Добро пожаловать","tenant.apartments":"Квартир","tenant.records":"Записей","tenant.totalGuests":"Гостей всего","tenant.income":"Доход (сум)","tenant.noAssigned":"Нет назначенных квартир","tenant.contactManager":"Обратитесь к менеджеру для добавления квартиры","tenant.now":"Сейчас","tenant.completed":"Завершено","tenant.moreRecords":"И ещё записей...","tenant.guest":"гость","tenant.guests":"гостя","tenant.guestsMany":"гостей","tenant.checkInLabel":"Заезд","tenant.checkOutLabel":"Выезд","announcements.title":"Объявления","announcements.forResidents":"Для жителей","announcements.forStaff":"Для сотрудников","announcements.add":"Добавить объявление","announcements.noAnnouncements":"Объявлений пока нет","announcements.addFirst":"Добавьте первое объявление","announcements.titleLabel":"Заголовок","announcements.content":"Содержание","announcements.type":"Тип","announcements.priority":"Приоритет","announcements.expiresAt":"Срок действия (опционально)","announcements.priorityNormal":"Обычный","announcements.priorityImportant":"Важный","announcements.priorityUrgent":"Срочный","announcements.views":"просмотров","announcements.author":"Автор","announcements.createdAt":"Создано","announcements.myAnnouncements":"Мои объявления","announcements.allAnnouncements":"Все объявления","announcements.noNew":"Нет новых объявлений","announcements.new":"Новое","meetings.title":"Собрания жильцов","meetings.subtitle":"Организация и проведение собраний","meetings.create":"Созвать собрание","meetings.noMeetings":"Собраний пока нет","meetings.createFirst":"Создайте первое собрание","meetings.status.draft":"Черновик","meetings.status.pending_moderation":"На модерации","meetings.status.schedule_poll_open":"Выбор даты","meetings.status.schedule_confirmed":"Дата утверждена","meetings.status.voting_open":"Голосование","meetings.status.voting_closed":"Голосование закрыто","meetings.status.results_published":"Итоги опубликованы","meetings.status.protocol_generated":"Протокол готов","meetings.status.protocol_approved":"Протокол утвержден","meetings.status.cancelled":"Отменено","meetings.format.online":"Онлайн","meetings.format.offline":"Очное","meetings.format.hybrid":"Смешанное","meetings.wizard.step1":"Тип собрания","meetings.wizard.step2":"Повестка дня","meetings.wizard.step3":"Дата и время","meetings.wizard.step4":"Публикация","meetings.wizard.organizerType":"Организатор","meetings.wizard.organizerResident":"Житель (инициатива)","meetings.wizard.organizerManagement":"Управляющая компания","meetings.wizard.selectFormat":"Формат проведения","meetings.wizard.selectAgenda":"Выберите вопросы повестки","meetings.wizard.addCustomQuestion":"Добавить свой вопрос","meetings.wizard.questionTitle":"Заголовок вопроса","meetings.wizard.questionDescription":"Описание","meetings.wizard.attachMaterials":"Прикрепить материалы","meetings.wizard.threshold":"Порог принятия","meetings.wizard.scheduleDatetime":"Предложите 3 варианта даты и времени","meetings.wizard.autoGenerate":"Сгенерировать автоматически","meetings.wizard.location":"Место проведения (для очного/смешанного)","meetings.wizard.publish":"Опубликовать инициативу","meetings.wizard.saveDraft":"Сохранить черновик","meetings.schedule.title":"Выберите удобную дату","meetings.schedule.voteFor":"Голосовать","meetings.schedule.yourVote":"Ваш голос","meetings.schedule.votes":"голосов","meetings.schedule.endsAt":"Голосование заканчивается","meetings.schedule.confirmed":"Дата подтверждена","meetings.voting.title":"Голосование по вопросам","meetings.voting.for":"За","meetings.voting.against":"Против","meetings.voting.abstain":"Воздержаться","meetings.voting.voted":"Вы проголосовали","meetings.voting.notVoted":"Вы еще не голосовали","meetings.voting.changeVote":"Изменить голос","meetings.voting.confirmVote":"Подтвердить голос","meetings.voting.verifyIdentity":"Подтвердите личность","meetings.voting.enterOTP":"Введите код из SMS","meetings.voting.sendOTP":"Отправить код","meetings.voting.resendOTP":"Отправить повторно","meetings.voting.otpSent":"Код отправлен на","meetings.voting.otpInvalid":"Неверный код","meetings.voting.otpExpired":"Код истек, запросите новый","meetings.results.title":"Результаты голосования","meetings.results.approved":"Принято","meetings.results.rejected":"Не принято","meetings.results.quorum":"Кворум","meetings.results.quorumReached":"Кворум достигнут","meetings.results.quorumNotReached":"Кворум не достигнут","meetings.results.participation":"Участие","meetings.results.votesFor":"За","meetings.results.votesAgainst":"Против","meetings.results.votesAbstain":"Воздержались","meetings.results.threshold":"Требуется","meetings.protocol.title":"Протокол собрания","meetings.protocol.generate":"Сформировать протокол","meetings.protocol.download":"Скачать PDF","meetings.protocol.sign":"Подписать протокол","meetings.protocol.signed":"Протокол подписан","meetings.protocol.signedBy":"Подписано","meetings.actions.approve":"Одобрить","meetings.actions.reject":"Отклонить","meetings.actions.openVoting":"Открыть голосование","meetings.actions.closeVoting":"Закрыть голосование","meetings.actions.publishResults":"Опубликовать итоги","meetings.actions.cancel":"Отменить собрание","meetings.actions.viewDetails":"Подробнее","meetings.actions.viewAgenda":"Повестка дня","meetings.actions.viewMaterials":"Материалы","meetings.notify.created":"Инициировано новое собрание","meetings.notify.scheduleVote":"Выберите удобную дату","meetings.notify.scheduleConfirmed":"Дата собрания подтверждена","meetings.notify.votingOpen":"Голосование открыто","meetings.notify.votingReminder":"Не забудьте проголосовать","meetings.notify.resultsPublished":"Итоги собрания опубликованы","meetings.notify.protocolReady":"Протокол собрания готов","meetings.settings.title":"Настройки собраний","meetings.settings.votingUnit":"Единица голоса","meetings.settings.votingUnitApartment":"1 квартира = 1 голос","meetings.settings.votingUnitOwner":"1 собственник = 1 голос","meetings.settings.votingUnitShare":"По долям собственности","meetings.settings.quorum":"Кворум (%)","meetings.settings.allowResidentInitiative":"Разрешить инициативу жильцов","meetings.settings.requireModeration":"Требовать модерацию УК","meetings.settings.requireOTP":"Подтверждение по SMS","meetings.settings.showIntermediateResults":"Показывать промежуточные результаты","meetings.evidence.title":"Отчет доказательств","meetings.evidence.download":"Скачать отчет","meetings.evidence.totalVotes":"Всего голосов","meetings.evidence.otpVerified":"Подтверждено по SMS","meetings.evidence.uniqueVoters":"Уникальных голосующих","login.enterLogin":"Введите логин","login.enterPassword":"Введите пароль","login.mustAcceptTerms":"Необходимо принять условия публичной оферты","login.wrongCredentials":"Неверный логин или пароль","login.loginError":"Ошибка при входе","login.loading":"Вход...","login.agreeWith":"Я согласен с условиями","login.publicOffer":"публичной оферты","login.acceptFirst":"Сначала примите условия публичной оферты","login.offerTitle":"Публичная оферта","login.scrollToAccept":"Прокрутите до конца документа, чтобы принять условия оферты","login.documentRead":"Вы прочитали документ","login.scrollDown":"Прокрутите вниз для прочтения","login.close":"Закрыть","login.accept":"Принять","role.admin":"Администратор","role.manager":"Менеджер","role.department_head":"Глава отдела","role.executor":"Исполнитель","role.resident":"Житель","role.plumber":"Сантехник","role.electrician":"Электрик","role.security":"Охрана","building.title":"Здания","building.add":"Добавить здание","building.edit":"Редактировать здание","building.delete":"Удалить здание","building.address":"Адрес","building.name":"Название","building.floors":"Этажей","building.entrances":"Подъездов","building.apartments":"Квартир","building.residents":"Жителей","building.noBuildings":"Зданий пока нет","building.addFirst":"Добавьте первое здание","owner.title":"Собственники","owner.add":"Добавить собственника","owner.edit":"Редактировать","owner.delete":"Удалить","owner.name":"ФИО собственника","owner.phone":"Телефон","owner.email":"Email","owner.share":"Доля собственности","owner.noOwners":"Собственников пока нет","account.title":"Лицевые счета","account.number":"Номер счёта","account.balance":"Баланс","account.debt":"Задолженность","account.lastPayment":"Последний платёж","account.noAccounts":"Счетов пока нет","workorder.title":"Наряды на работы","workorder.create":"Создать наряд","workorder.number":"Номер наряда","workorder.status":"Статус","workorder.executor":"Исполнитель","workorder.deadline":"Срок выполнения","workorder.noWorkOrders":"Нарядов пока нет","activity.title":"Журнал действий","activity.created":"Создано","activity.updated":"Обновлено","activity.deleted":"Удалено","activity.login":"Вход в систему","activity.logout":"Выход из системы","activity.noActivity":"Нет записей","activity.user":"Пользователь","activity.action":"Действие","activity.timestamp":"Время","activity.details":"Детали","monitoring.title":"Мониторинг системы","monitoring.health":"Состояние системы","monitoring.uptime":"Время работы","monitoring.requests":"Запросов","monitoring.errors":"Ошибок","monitoring.latency":"Задержка","monitoring.healthy":"Работает","monitoring.degraded":"Замедление","monitoring.down":"Недоступно","stats.title":"Статистика","stats.completed":"Выполнено","stats.thisWeek":"За неделю","stats.thisMonth":"За месяц","stats.rating":"Рейтинг","stats.avgTime":"Среднее время","stats.noStats":"Нет данных для отображения","schedule.title":"Расписание","schedule.today":"Сегодня","schedule.tomorrow":"Завтра","schedule.thisWeek":"На этой неделе","schedule.noSchedule":"Нет запланированных работ","schedule.addEvent":"Добавить событие","chat.title":"Чат","chat.support":"Поддержка","chat.newMessage":"Новое сообщение","chat.typeMessage":"Введите сообщение...","chat.send":"Отправить","chat.noMessages":"Нет сообщений","chat.startConversation":"Начните общение","guest.title":"Гостевой доступ","guest.createCode":"Создать код","guest.validUntil":"Действует до","guest.usages":"Использований","guest.active":"Активен","guest.expired":"Истёк","guest.used":"Использован","guest.noGuests":"Нет гостевых кодов","guest.generate":"Сгенерировать QR-код","guest.copyCode":"Скопировать код","guest.shareCode":"Поделиться кодом","scanner.title":"Сканер QR-кодов","scanner.scan":"Сканировать","scanner.scanning":"Сканирование...","scanner.valid":"Код действителен","scanner.invalid":"Код недействителен","scanner.expired":"Код истёк","scanner.allow":"Разрешить проход","scanner.deny":"Запретить проход","vehicle.title":"Транспорт","vehicle.add":"Добавить транспорт","vehicle.plate":"Номер","vehicle.brand":"Марка","vehicle.model":"Модель","vehicle.color":"Цвет","vehicle.owner":"Владелец","vehicle.noVehicles":"Транспорт не зарегистрирован","vehicle.search":"Поиск по номеру","contract.title":"Договор","contract.number":"Номер договора","contract.status":"Статус","contract.signed":"Подписан","contract.pending":"Ожидает подписания","contract.startDate":"Дата начала","contract.endDate":"Дата окончания","contract.download":"Скачать PDF","contract.sign":"Подписать","profile.title":"Мой профиль","profile.personalData":"Ваши личные данные","profile.personalAccount":"Лицевой счёт","profile.loginHint":"Логин для входа","profile.cannotChange":"Нельзя изменить","profile.phone":"Телефон","profile.notSpecified":"Не указан","profile.password":"Пароль","profile.currentPassword":"Текущий пароль","profile.newPassword":"Новый пароль","profile.confirmPassword":"Подтвердите пароль","profile.passwordChanged":"Пароль успешно изменён","profile.phoneSaved":"Телефон сохранён","error.generic":"Произошла ошибка","error.network":"Ошибка сети","error.unauthorized":"Необходима авторизация","error.forbidden":"Доступ запрещён","error.notFound":"Не найдено","error.tryAgain":"Попробуйте позже","confirm.delete":"Подтвердите удаление","confirm.cancel":"Отменить","confirm.yes":"Да","confirm.no":"Нет","confirm.sure":"Вы уверены?","time.today":"Сегодня","time.yesterday":"Вчера","time.daysAgo":"дней назад","time.hoursAgo":"часов назад","time.minutesAgo":"минут назад","time.justNow":"Только что"},uz:{"app.name":"Kamizo","app.subtitle":"CRM Tizimi","auth.title":"Tizimga kirish","auth.login":"Login","auth.password":"Parol","auth.enter":"Kirish","auth.error":"Login yoki parol noto'g'ri","auth.logout":"Chiqish","nav.dashboard":"Boshqaruv paneli","nav.requests":"Arizalar","nav.executors":"Ijrochilar","nav.residents":"Aholi","nav.buildings":"Binolar","nav.activity":"Faoliyat jurnali","nav.reports":"Hisobotlar","nav.settings":"Sozlamalar","nav.monitoring":"Monitoring","nav.myRequests":"Mening arizalarim","nav.services":"Xizmatlar","nav.profile":"Profil","nav.more":"Ko'proq","nav.rentals":"Kvartira ijarasi","nav.myApartments":"Mening kvartiram","nav.accounts":"Shaxsiy hisoblar","nav.owners":"Mulkdorlar","nav.workOrders":"Ish buyruqlari","nav.trainings":"Treninglar","dashboard.manager":"Menejer paneli","dashboard.admin":"Administrator paneli","dashboard.newRequests":"Yangi arizalar","dashboard.inProgress":"Jarayonda","dashboard.pendingApproval":"Tasdiqlash kutilmoqda","dashboard.completedWeek":"Hafta davomida bajarilgan","dashboard.weeklyRequests":"Haftalik arizalar","dashboard.byCategory":"Kategoriya bo'yicha","dashboard.recentRequests":"So'nggi arizalar","dashboard.viewAll":"Hammasi","request.assign":"Tayinlash","request.reassign":"Qayta tayinlash","request.executor":"Ijrochi","request.search":"Qidirish...","request.allStatuses":"Barcha holatlar","request.notFound":"Arizalar topilmadi","request.changeFilters":"Filtrlarni o'zgartirib ko'ring","executor.available":"Mavjud","executor.busy":"Band","executor.offline":"Oflayn","executor.all":"Barcha ijrochilar","executor.add":"Ijrochi qo'shish","executor.completed":"bajarilgan","executor.active":"faol","resident.add":"Aholi qo'shish","resident.total":"jami","resident.noResidents":"Aholi hali yo'q","resident.willAppear":"Arizalar yaratilgandan keyin aholi paydo bo'ladi","status.new":"Yangi","status.assigned":"Tayinlangan","status.accepted":"Qabul qilingan","status.in_progress":"Jarayonda","status.pending_approval":"Tasdiqlash kutilmoqda","status.completed":"Bajarilgan","status.cancelled":"Bekor qilingan","priority.low":"Past","priority.medium":"O'rta","priority.high":"Yuqori","priority.urgent":"Shoshilinch","form.name":"F.I.O.","form.phone":"Telefon","form.address":"Manzil","form.apartment":"Kvartira","form.login":"Login","form.password":"Parol","form.specialization":"Mutaxassislik","form.generate":"Yaratish","form.cancel":"Bekor qilish","form.add":"Qo'shish","form.save":"Saqlash","form.done":"Tayyor","form.copy":"Nusxalash","form.copied":"Nusxalandi!","form.fillAll":"Barcha maydonlarni to'ldiring","form.credentials":"Kirish ma'lumotlari","timer.start":"Ishni boshlash","timer.pause":"Pauza","timer.resume":"Davom ettirish","timer.finish":"Tugatish","timer.elapsed":"O'tgan vaqt","settings.general":"Umumiy","settings.notifications":"Bildirishnomalar","settings.integrations":"Integratsiyalar","settings.users":"Foydalanuvchilar","settings.language":"Til","common.all":"Hammasi","common.delete":"O'chirish","common.edit":"Tahrirlash","common.view":"Ko'rish","common.refresh":"Yangilash","common.loading":"Yuklanmoqda...","common.noData":"Ma'lumot yo'q","rental.title":"Kvartira ijarasi","rental.addApartment":"Kvartira qo'shish","rental.noApartments":"Kvartiralar hali yo'q","rental.addFirst":"Ijarani boshqarish uchun birinchi kvartirani qo'shing","rental.occupied":"Band","rental.available":"Bo'sh","rental.records":"yozuvlar","rental.currentGuest":"Hozirgi mehmon","rental.until":"gacha","rental.deleteApartment":"Kvartirani o'chirish","rental.owner":"Egasi","rental.addRecord":"Yozuv qo'shish","rental.rentalHistory":"Ijara tarixi","rental.noRecords":"Yozuvlar hali yo'q","rental.active":"Faol","rental.apartmentName":"Nomi","rental.ownerData":"Egasi ma'lumotlari (tenant)","rental.guestNames":"Mehmonlar ismi","rental.passportInfo":"Pasport ma'lumotlari","rental.checkIn":"Kirish sanasi","rental.checkOut":"Chiqish sanasi","rental.amount":"Summa","rental.currency":"Valyuta","rental.notes":"Izohlar (ixtiyoriy)","rental.apartmentAdded":"Kvartira qo'shildi!","rental.ownerCredentials":"Egasi kirish ma'lumotlari:","rental.generateCredentials":"Login/parol yaratish","rental.confirmDelete":"O'chirishni tasdiqlang","rental.enterOwnerPassword":"O'chirishni tasdiqlash uchun kvartira egasining parolini kiriting","rental.wrongPassword":"Parol noto'g'ri","tenant.myApartments":"Mening kvartiram","tenant.welcome":"Xush kelibsiz","tenant.apartments":"Kvartiralar","tenant.records":"Yozuvlar","tenant.totalGuests":"Jami mehmonlar","tenant.income":"Daromad (so'm)","tenant.noAssigned":"Tayinlangan kvartiralar yo'q","tenant.contactManager":"Kvartira qo'shish uchun menejer bilan bog'laning","tenant.now":"Hozir","tenant.completed":"Tugallangan","tenant.moreRecords":"Va yana yozuvlar...","tenant.guest":"mehmon","tenant.guests":"mehmon","tenant.guestsMany":"mehmon","tenant.checkInLabel":"Kirish","tenant.checkOutLabel":"Chiqish","announcements.title":"E'lonlar","announcements.forResidents":"Aholiga","announcements.forStaff":"Xodimlarga","announcements.add":"E'lon qo'shish","announcements.noAnnouncements":"E'lonlar hali yo'q","announcements.addFirst":"Birinchi e'lonni qo'shing","announcements.titleLabel":"Sarlavha","announcements.content":"Mazmuni","announcements.type":"Turi","announcements.priority":"Muhimlik","announcements.expiresAt":"Amal qilish muddati (ixtiyoriy)","announcements.priorityNormal":"Oddiy","announcements.priorityImportant":"Muhim","announcements.priorityUrgent":"Shoshilinch","announcements.views":"ko'rishlar","announcements.author":"Muallif","announcements.createdAt":"Yaratilgan","announcements.myAnnouncements":"Mening e'lonlarim","announcements.allAnnouncements":"Barcha e'lonlar","announcements.noNew":"Yangi e'lonlar yo'q","announcements.new":"Yangi","meetings.title":"Aholining yig'ilishlari","meetings.subtitle":"Yig'ilishlarni tashkil etish va o'tkazish","meetings.create":"Yig'ilish chaqirish","meetings.noMeetings":"Yig'ilishlar hali yo'q","meetings.createFirst":"Birinchi yig'ilishni yarating","meetings.status.draft":"Qoralama","meetings.status.pending_moderation":"Moderatsiyada","meetings.status.schedule_poll_open":"Sana tanlash","meetings.status.schedule_confirmed":"Sana tasdiqlangan","meetings.status.voting_open":"Ovoz berish","meetings.status.voting_closed":"Ovoz berish yopildi","meetings.status.results_published":"Natijalar e'lon qilindi","meetings.status.protocol_generated":"Bayonnoma tayyor","meetings.status.protocol_approved":"Bayonnoma tasdiqlangan","meetings.status.cancelled":"Bekor qilindi","meetings.format.online":"Onlayn","meetings.format.offline":"Yuzma-yuz","meetings.format.hybrid":"Aralash","meetings.wizard.step1":"Yig'ilish turi","meetings.wizard.step2":"Kun tartibi","meetings.wizard.step3":"Sana va vaqt","meetings.wizard.step4":"Nashr","meetings.wizard.organizerType":"Tashkilotchi","meetings.wizard.organizerResident":"Aholi (tashabbusi)","meetings.wizard.organizerManagement":"Boshqaruv kompaniyasi","meetings.wizard.selectFormat":"O'tkazish formati","meetings.wizard.selectAgenda":"Kun tartibi savollarini tanlang","meetings.wizard.addCustomQuestion":"O'z savolingizni qo'shing","meetings.wizard.questionTitle":"Savol sarlavhasi","meetings.wizard.questionDescription":"Tavsif","meetings.wizard.attachMaterials":"Materiallarni biriktiring","meetings.wizard.threshold":"Qabul qilish chegarasi","meetings.wizard.scheduleDatetime":"Sana va vaqtning 3 variantini taklif qiling","meetings.wizard.autoGenerate":"Avtomatik yaratish","meetings.wizard.location":"O'tkazish joyi (yuzma-yuz/aralash uchun)","meetings.wizard.publish":"Tashabbusni e'lon qilish","meetings.wizard.saveDraft":"Qoralama saqlash","meetings.schedule.title":"Qulay sanani tanlang","meetings.schedule.voteFor":"Ovoz berish","meetings.schedule.yourVote":"Sizning ovozingiz","meetings.schedule.votes":"ovoz","meetings.schedule.endsAt":"Ovoz berish tugaydi","meetings.schedule.confirmed":"Sana tasdiqlangan","meetings.voting.title":"Savollarga ovoz berish","meetings.voting.for":"Yoqlab","meetings.voting.against":"Qarshi","meetings.voting.abstain":"Betaraf","meetings.voting.voted":"Siz ovoz berdingiz","meetings.voting.notVoted":"Siz hali ovoz bermadingiz","meetings.voting.changeVote":"Ovozni o'zgartirish","meetings.voting.confirmVote":"Ovozni tasdiqlash","meetings.voting.verifyIdentity":"Shaxsingizni tasdiqlang","meetings.voting.enterOTP":"SMS kodini kiriting","meetings.voting.sendOTP":"Kod yuborish","meetings.voting.resendOTP":"Qayta yuborish","meetings.voting.otpSent":"Kod yuborildi","meetings.voting.otpInvalid":"Kod noto'g'ri","meetings.voting.otpExpired":"Kod muddati tugadi, yangi so'rang","meetings.results.title":"Ovoz berish natijalari","meetings.results.approved":"Qabul qilindi","meetings.results.rejected":"Qabul qilinmadi","meetings.results.quorum":"Kvorum","meetings.results.quorumReached":"Kvorum yetdi","meetings.results.quorumNotReached":"Kvorum yetmadi","meetings.results.participation":"Ishtirok","meetings.results.votesFor":"Yoqlab","meetings.results.votesAgainst":"Qarshi","meetings.results.votesAbstain":"Betaraf","meetings.results.threshold":"Kerak","meetings.protocol.title":"Yig'ilish bayonnomasi","meetings.protocol.generate":"Bayonnoma yaratish","meetings.protocol.download":"PDF yuklash","meetings.protocol.sign":"Bayonnomani imzolash","meetings.protocol.signed":"Bayonnoma imzolangan","meetings.protocol.signedBy":"Imzolagan","meetings.actions.approve":"Tasdiqlash","meetings.actions.reject":"Rad etish","meetings.actions.openVoting":"Ovoz berishni ochish","meetings.actions.closeVoting":"Ovoz berishni yopish","meetings.actions.publishResults":"Natijalarni e'lon qilish","meetings.actions.cancel":"Yig'ilishni bekor qilish","meetings.actions.viewDetails":"Batafsil","meetings.actions.viewAgenda":"Kun tartibi","meetings.actions.viewMaterials":"Materiallar","meetings.notify.created":"Yangi yig'ilish boshlandi","meetings.notify.scheduleVote":"Qulay sanani tanlang","meetings.notify.scheduleConfirmed":"Yig'ilish sanasi tasdiqlandi","meetings.notify.votingOpen":"Ovoz berish ochildi","meetings.notify.votingReminder":"Ovoz berishni unutmang","meetings.notify.resultsPublished":"Yig'ilish natijalari e'lon qilindi","meetings.notify.protocolReady":"Yig'ilish bayonnomasi tayyor","meetings.settings.title":"Yig'ilish sozlamalari","meetings.settings.votingUnit":"Ovoz birligi","meetings.settings.votingUnitApartment":"1 kvartira = 1 ovoz","meetings.settings.votingUnitOwner":"1 egasi = 1 ovoz","meetings.settings.votingUnitShare":"Ulush bo'yicha","meetings.settings.quorum":"Kvorum (%)","meetings.settings.allowResidentInitiative":"Aholi tashabbusiga ruxsat","meetings.settings.requireModeration":"UK moderatsiyasi kerak","meetings.settings.requireOTP":"SMS orqali tasdiqlash","meetings.settings.showIntermediateResults":"Oraliq natijalarni ko'rsatish","meetings.evidence.title":"Dalillar hisoboti","meetings.evidence.download":"Hisobotni yuklash","meetings.evidence.totalVotes":"Jami ovozlar","meetings.evidence.otpVerified":"SMS orqali tasdiqlangan","meetings.evidence.uniqueVoters":"Noyob ovoz beruvchilar","login.enterLogin":"Login kiriting","login.enterPassword":"Parol kiriting","login.mustAcceptTerms":"Ommaviy oferta shartlarini qabul qilish kerak","login.wrongCredentials":"Login yoki parol noto'g'ri","login.loginError":"Kirishda xatolik","login.loading":"Kirish...","login.agreeWith":"Men shartlarga roziman","login.publicOffer":"ommaviy oferta","login.acceptFirst":"Avval ommaviy oferta shartlarini qabul qiling","login.offerTitle":"Ommaviy oferta","login.scrollToAccept":"Oferta shartlarini qabul qilish uchun hujjat oxirigacha aylantiring","login.documentRead":"Siz hujjatni o'qidingiz","login.scrollDown":"O'qish uchun pastga aylantiring","login.close":"Yopish","login.accept":"Qabul qilish","role.admin":"Administrator","role.manager":"Menejer","role.department_head":"Bo'lim boshlig'i","role.executor":"Ijrochi","role.resident":"Aholi","role.plumber":"Santexnik","role.electrician":"Elektrik","role.security":"Qorovul","building.title":"Binolar","building.add":"Bino qo'shish","building.edit":"Binoni tahrirlash","building.delete":"Binoni o'chirish","building.address":"Manzil","building.name":"Nomi","building.floors":"Qavatlar","building.entrances":"Kirishlar","building.apartments":"Kvartiralar","building.residents":"Aholisi","building.noBuildings":"Binolar hali yo'q","building.addFirst":"Birinchi binoni qo'shing","owner.title":"Mulkdorlar","owner.add":"Mulkdor qo'shish","owner.edit":"Tahrirlash","owner.delete":"O'chirish","owner.name":"Mulkdor ismi","owner.phone":"Telefon","owner.email":"Email","owner.share":"Mulk ulushi","owner.noOwners":"Mulkdorlar hali yo'q","account.title":"Shaxsiy hisoblar","account.number":"Hisob raqami","account.balance":"Balans","account.debt":"Qarz","account.lastPayment":"Oxirgi to'lov","account.noAccounts":"Hisoblar hali yo'q","workorder.title":"Ish buyruqlari","workorder.create":"Buyruq yaratish","workorder.number":"Buyruq raqami","workorder.status":"Holat","workorder.executor":"Ijrochi","workorder.deadline":"Muddat","workorder.noWorkOrders":"Buyruqlar hali yo'q","activity.title":"Faoliyat jurnali","activity.created":"Yaratildi","activity.updated":"Yangilandi","activity.deleted":"O'chirildi","activity.login":"Tizimga kirish","activity.logout":"Tizimdan chiqish","activity.noActivity":"Yozuvlar yo'q","activity.user":"Foydalanuvchi","activity.action":"Harakat","activity.timestamp":"Vaqt","activity.details":"Tafsilotlar","monitoring.title":"Tizim monitoringi","monitoring.health":"Tizim holati","monitoring.uptime":"Ishlash vaqti","monitoring.requests":"So'rovlar","monitoring.errors":"Xatolar","monitoring.latency":"Kechikish","monitoring.healthy":"Ishlayapti","monitoring.degraded":"Sekinlashish","monitoring.down":"Mavjud emas","stats.title":"Statistika","stats.completed":"Bajarilgan","stats.thisWeek":"Bu hafta","stats.thisMonth":"Bu oy","stats.rating":"Reyting","stats.avgTime":"O'rtacha vaqt","stats.noStats":"Ko'rsatish uchun ma'lumot yo'q","schedule.title":"Jadval","schedule.today":"Bugun","schedule.tomorrow":"Ertaga","schedule.thisWeek":"Bu hafta","schedule.noSchedule":"Rejalashtirilgan ishlar yo'q","schedule.addEvent":"Voqea qo'shish","chat.title":"Chat","chat.support":"Yordam","chat.newMessage":"Yangi xabar","chat.typeMessage":"Xabar yozing...","chat.send":"Yuborish","chat.noMessages":"Xabarlar yo'q","chat.startConversation":"Suhbatni boshlang","guest.title":"Mehmon kirishi","guest.createCode":"Kod yaratish","guest.validUntil":"Amal qiladi","guest.usages":"Foydalanishlar","guest.active":"Faol","guest.expired":"Muddati tugagan","guest.used":"Ishlatilgan","guest.noGuests":"Mehmon kodlari yo'q","guest.generate":"QR-kod yaratish","guest.copyCode":"Kodni nusxalash","guest.shareCode":"Kodni ulashish","scanner.title":"QR-kod skaneri","scanner.scan":"Skanerlash","scanner.scanning":"Skanerlanmoqda...","scanner.valid":"Kod to'g'ri","scanner.invalid":"Kod noto'g'ri","scanner.expired":"Kod muddati tugagan","scanner.allow":"O'tishga ruxsat","scanner.deny":"O'tishni taqiqlash","vehicle.title":"Transport","vehicle.add":"Transport qo'shish","vehicle.plate":"Raqam","vehicle.brand":"Marka","vehicle.model":"Model","vehicle.color":"Rang","vehicle.owner":"Egasi","vehicle.noVehicles":"Transport ro'yxatdan o'tmagan","vehicle.search":"Raqam bo'yicha qidirish","contract.title":"Shartnoma","contract.number":"Shartnoma raqami","contract.status":"Holat","contract.signed":"Imzolangan","contract.pending":"Imzo kutilmoqda","contract.startDate":"Boshlanish sanasi","contract.endDate":"Tugash sanasi","contract.download":"PDF yuklash","contract.sign":"Imzolash","profile.title":"Mening profilim","profile.personalData":"Shaxsiy ma'lumotlaringiz","profile.personalAccount":"Shaxsiy hisob","profile.loginHint":"Kirish logini","profile.cannotChange":"O'zgartirib bo'lmaydi","profile.phone":"Telefon","profile.notSpecified":"Ko'rsatilmagan","profile.password":"Parol","profile.currentPassword":"Joriy parol","profile.newPassword":"Yangi parol","profile.confirmPassword":"Parolni tasdiqlang","profile.passwordChanged":"Parol muvaffaqiyatli o'zgartirildi","profile.phoneSaved":"Telefon saqlandi","error.generic":"Xatolik yuz berdi","error.network":"Tarmoq xatosi","error.unauthorized":"Avtorizatsiya talab qilinadi","error.forbidden":"Kirish taqiqlangan","error.notFound":"Topilmadi","error.tryAgain":"Keyinroq urinib ko'ring","confirm.delete":"O'chirishni tasdiqlang","confirm.cancel":"Bekor qilish","confirm.yes":"Ha","confirm.no":"Yo'q","confirm.sure":"Ishonchingiz komilmi?","time.today":"Bugun","time.yesterday":"Kecha","time.daysAgo":"kun oldin","time.hoursAgo":"soat oldin","time.minutesAgo":"daqiqa oldin","time.justNow":"Hozirgina"}},Bt=we()(_e((e,s)=>({language:"ru",setLanguage:t=>e({language:t}),t:t=>{const{language:n}=s();return Yn[n][t]||t}}),{name:"language-storage"})),$=e=>{const s=(r,a=[])=>{if(r==null)return a;if(typeof r=="string")try{return JSON.parse(r)}catch{return a}return r},t=r=>({id:r.id,type:r.type,title:r.title,description:r.description,threshold:r.threshold,votesFor:r.votes_for_area||r.votesFor||0,votesAgainst:r.votes_against_area||r.votesAgainst||0,votesAbstain:r.votes_abstain_area||r.votesAbstain||0,order:r.item_order||r.order||0,isApproved:r.is_approved,decision:r.decision,materials:s(r.materials,[])}),n=r=>({id:r.id,dateTime:r.date_time||r.dateTime,votesByShare:r.vote_weight||r.voteWeight||r.votes_by_share||r.votesByShare||0,voteWeight:r.vote_weight||r.voteWeight||0,voteCount:r.vote_count||r.voteCount||(r.votes?.length??0),voters:r.voters||[],votes:r.votes||r.voters||[]});return{id:e.id,number:e.number,buildingId:e.building_id||e.buildingId,buildingAddress:e.building_address||e.buildingAddress,organizerType:e.organizer_type||e.organizerType,organizerId:e.organizer_id||e.organizerId,organizerName:e.organizer_name||e.organizerName,format:e.format,status:e.status,scheduleOptions:s(e.schedule_options||e.scheduleOptions,[]).map(n),schedulePollEndsAt:e.schedule_poll_ends_at||e.schedulePollEndsAt,confirmedDateTime:e.confirmed_date_time||e.confirmedDateTime,location:e.location,agendaItems:(e.agendaItems||s(e.agenda_items,[])).map(t),materials:s(e.materials,[]),votingSettings:s(e.voting_settings||e.votingSettings,{}),eligibleVoters:s(e.eligible_voters||e.eligibleVoters,[]),totalEligibleCount:e.total_eligible_count||e.totalEligibleCount||0,participatedVoters:s(e.participated_voters||e.participatedVoters,[]),quorumReached:!!(e.quorum_reached||e.quorumReached),participationPercent:e.participation_percent||e.participationPercent||0,moderatedAt:e.moderated_at||e.moderatedAt,moderationComment:e.moderation_comment||e.moderationComment,schedulePollOpenedAt:e.schedule_poll_opened_at||e.schedulePollOpenedAt,scheduleConfirmedAt:e.schedule_confirmed_at||e.scheduleConfirmedAt,votingOpenedAt:e.voting_opened_at||e.votingOpenedAt,votingClosedAt:e.voting_closed_at||e.votingClosedAt,resultsPublishedAt:e.results_published_at||e.resultsPublishedAt,protocolId:e.protocol_id||e.protocolId,protocolGeneratedAt:e.protocol_generated_at||e.protocolGeneratedAt,protocolApprovedAt:e.protocol_approved_at||e.protocolApprovedAt,cancelledAt:e.cancelled_at||e.cancelledAt,cancellationReason:e.cancellation_reason||e.cancellationReason,remindersSent:s(e.reminders_sent||e.remindersSent,[]),notificationLogs:s(e.notification_logs||e.notificationLogs,[]),createdAt:e.created_at||e.createdAt}},Nt=e=>({id:e.id,meetingId:e.meeting_id,agendaItemId:e.agenda_item_id,voterId:e.voter_id,voterName:e.voter_name,apartmentId:e.apartment_id,apartmentNumber:e.apartment_number,ownershipShare:e.ownership_share,choice:e.choice,verificationMethod:e.verification_method,otpVerified:!!e.otp_verified,votedAt:e.voted_at,voteHash:e.vote_hash,isRevote:!!e.is_revote,previousVoteId:e.previous_vote_id}),Gn=e=>({id:e.id,meetingId:e.meeting_id,number:e.number,generatedAt:e.generated_at,content:e.content,protocolHash:e.protocol_hash,signedByUK:e.signed_by_uk_user_id?{userId:e.signed_by_uk_user_id,name:e.signed_by_uk_name||"",role:e.signed_by_uk_role||"",signedAt:e.signed_by_uk_at||"",signatureHash:e.signed_by_uk_hash||""}:void 0,attachments:JSON.parse(e.attachments||"[]")}),Qn=e=>({id:e.id,userId:e.user_id,phone:e.phone,code:e.code,purpose:e.purpose,meetingId:e.meeting_id,agendaItemId:e.agenda_item_id,attempts:e.attempts,maxAttempts:e.max_attempts,createdAt:e.created_at,expiresAt:e.expires_at,isUsed:!!e.is_used,verifiedAt:e.verified_at}),st=e=>({id:e.id,buildingId:e.building_id,apartmentId:e.apartment_id,apartmentNumber:e.apartment_number,totalArea:e.total_area,ownershipShare:e.ownership_share,ownerId:e.owner_id,ownerName:e.owner_name,coOwnerIds:JSON.parse(e.co_owner_ids||"[]"),isVerified:!!e.is_verified,verifiedAt:e.verified_at,verifiedBy:e.verified_by}),jt=e=>({buildingId:e.building_id,votingUnit:e.voting_unit,defaultQuorumPercent:e.default_quorum_percent,schedulePollDurationDays:e.schedule_poll_duration_days,votingDurationHours:e.voting_duration_hours,allowResidentInitiative:!!e.allow_resident_initiative,requireModeration:!!e.require_moderation,defaultMeetingTime:e.default_meeting_time,reminderHoursBefore:JSON.parse(e.reminder_hours_before||"[48, 2]"),notificationChannels:JSON.parse(e.notification_channels||'["in_app", "push"]')}),at={votingUnit:"apartment",defaultQuorumPercent:50,schedulePollDurationDays:3,votingDurationHours:48,allowResidentInitiative:!0,requireModeration:!0,defaultMeetingTime:"19:00",reminderHoursBefore:[48,2],notificationChannels:["in_app","push"]},Ke=we()(_e((e,s)=>({meetings:[],voteRecords:[],protocols:[],otpRecords:[],votingUnits:[],buildingSettings:[],loading:!1,error:null,fetchMeetings:async()=>{e({loading:!0,error:null});try{const t=await L.getAll({onlyActive:!0});if(t.success&&t.data){const n=Array.isArray(t.data)?t.data.map($):[];e({meetings:n,loading:!1})}else e({error:t.error||"Failed to fetch meetings",loading:!1})}catch{e({error:"Network error",loading:!1})}},fetchMeetingsByBuilding:async t=>{e({loading:!0,error:null});try{const n=await L.getAll({buildingId:t});if(n.success&&n.data){const r=Array.isArray(n.data)?n.data.map($):[];e(a=>({meetings:[...a.meetings.filter(c=>c.buildingId!==t),...r],loading:!1}))}else e({error:n.error||"Failed to fetch meetings",loading:!1})}catch{e({error:"Network error",loading:!1})}},fetchVotingUnitsByBuilding:async t=>{try{const n=await Ve.getByBuilding(t);if(n.success&&n.data){const r=Array.isArray(n.data)?n.data.map(st):[];e(a=>({votingUnits:[...a.votingUnits.filter(c=>c.buildingId!==t),...r]}))}}catch{}},createMeeting:async t=>{e({loading:!0,error:null});try{const n=await L.create({buildingId:t.buildingId,buildingAddress:t.buildingAddress,organizerType:t.organizerType==="management"?"uk":t.organizerType,format:t.format,location:t.location,description:t.description,agendaItems:t.agendaItems.map(r=>({title:r.title,description:r.description,threshold:r.threshold}))});if(n.success&&n.data){const r=$(n.data);return e(a=>({meetings:[...a.meetings,r],loading:!1})),r}else throw e({error:n.error||"Failed to create meeting",loading:!1}),new Error(n.error||"Failed to create meeting")}catch(n){throw e({error:"Network error",loading:!1}),n}},updateMeeting:async(t,n)=>{e({loading:!0,error:null});try{const r={};n.location!==void 0&&(r.location=n.location),n.agendaItems!==void 0&&(r.agenda_items=JSON.stringify(n.agendaItems)),n.materials!==void 0&&(r.materials=JSON.stringify(n.materials)),n.votingSettings!==void 0&&(r.voting_settings=JSON.stringify(n.votingSettings));const a=await L.update(t,r);if(a.success&&a.data){const o=$(a.data);e(c=>({meetings:c.meetings.map(l=>l.id===t?o:l),loading:!1}))}else e({error:a.error||"Failed to update meeting",loading:!1})}catch{e({error:"Network error",loading:!1})}},deleteMeeting:async t=>{e({loading:!0,error:null});try{await L.delete(t),e(n=>({meetings:n.meetings.filter(r=>r.id!==t),voteRecords:n.voteRecords.filter(r=>r.meetingId!==t),loading:!1}))}catch{e({error:"Network error",loading:!1})}},getMeeting:t=>s().meetings.find(n=>n.id===t),getMeetingsByBuilding:t=>s().meetings.filter(n=>n.buildingId===t),getMeetingsByOrganizer:t=>s().meetings.filter(n=>n.organizerId===t),getActiveMeetingsForResident:t=>s().meetings.filter(n=>["schedule_poll_open","schedule_confirmed","voting_open"].includes(n.status)?n.eligibleVoters.length===0?!0:n.eligibleVoters.includes(t):!1),submitForModeration:async t=>{try{const n=await L.submit(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},approveMeeting:async t=>{try{const n=await L.approve(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},rejectMeeting:async(t,n)=>{try{const r=await L.reject(t,n);if(r.success&&r.data){const a=$(r.data);e(o=>({meetings:o.meetings.map(c=>c.id===t?a:c)}))}}catch{}},openSchedulePoll:async t=>{try{const n=await L.openSchedulePoll(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},confirmSchedule:async(t,n)=>{try{const r=await L.confirmSchedule(t,n);if(r.success&&r.data){const a=$(r.data);e(o=>({meetings:o.meetings.map(c=>c.id===t?a:c)}))}}catch{}},openVoting:async t=>{try{const n=await L.openVoting(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},closeVoting:async t=>{try{const n=await L.closeVoting(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},publishResults:async t=>{try{const n=await L.publishResults(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},generateProtocol:async t=>{try{const n=await L.generateProtocol(t);if(n.success&&n.data){const r=Gn(n.data);return e(a=>({protocols:[...a.protocols,r]})),r}throw new Error("Failed to generate protocol")}catch(n){throw n}},approveProtocol:async t=>{try{const n=await L.approveProtocol(t);if(n.success&&n.data){const r=$(n.data);e(a=>({meetings:a.meetings.map(o=>o.id===t?r:o)}))}}catch{}},cancelMeeting:async(t,n)=>{try{const r=await L.cancel(t,n);if(r.success&&r.data){const a=$(r.data);e(o=>({meetings:o.meetings.map(c=>c.id===t?a:c)}))}}catch{}},voteForSchedule:async(t,n)=>{try{return(await ut.vote(t,n)).success&&await s().fetchMeetings(),{success:!0}}catch(r){return{success:!1,error:r?.message||"Не удалось проголосовать. Проверьте что указана площадь квартиры."}}},getScheduleVoteByUser:async t=>{try{const n=await ut.getMyVote(t);return n.success&&n.data&&n.data.optionId||null}catch{return null}},voteOnAgendaItem:async(t,n,r,a,o,c,l)=>{try{if(o==="not_voted")throw new Error('Cannot submit "not_voted" as a vote choice');const d=c.method==="otp"?"otp":c.method==="in_person"?"in_person":c.method==="proxy"?"proxy":"login",g=await De.vote(t,n,{voterId:r,voterName:a,choice:o,verificationMethod:d,otpVerified:c.otpVerified,apartmentId:c.apartmentId,apartmentNumber:c.apartmentNumber,ownershipShare:c.ownershipShare,comment:l}),m={id:crypto.randomUUID(),meetingId:t,agendaItemId:n,voterId:r,voterName:a,choice:o,verificationMethod:d,otpVerified:c.otpVerified,apartmentId:c.apartmentId,apartmentNumber:c.apartmentNumber,ownershipShare:c.ownershipShare,votedAt:new Date().toISOString(),voteHash:g.data?.voteHash||"",isRevote:!1};return e(f=>({voteRecords:[...f.voteRecords,m],meetings:f.meetings.map(h=>h.id===t&&!h.participatedVoters.includes(r)?{...h,participatedVoters:[...h.participatedVoters,r]}:h)})),m}catch(d){throw d}},getVoteByUser:(t,n,r)=>s().voteRecords.filter(a=>a.meetingId===t&&a.agendaItemId===n&&a.voterId===r).sort((a,o)=>new Date(o.votedAt).getTime()-new Date(a.votedAt).getTime())[0],getUserVotesForMeeting:async t=>{try{const n=await De.getMyVotes(t);if(n.success&&n.data){const r=n.data.map(Nt);return e(a=>{const o=new Set(a.voteRecords.map(l=>l.id)),c=r.filter(l=>!o.has(l.id));return{voteRecords:[...a.voteRecords,...c]}}),r}return[]}catch{return[]}},requestOTP:async(t,n,r,a,o)=>{try{const c=r==="meeting_vote"?"agenda_vote":r,l=await mt.request({userId:t,phone:n,purpose:c,meetingId:a,agendaItemId:o});if(l.success&&l.data){const d=Qn(l.data);return e(g=>({otpRecords:[...g.otpRecords,d]})),d}throw new Error("Failed to request OTP")}catch(c){throw c}},verifyOTP:async(t,n)=>{try{const r=await mt.verify(t,n);return r.success&&r.data?.verified?(e(a=>({otpRecords:a.otpRecords.map(o=>o.id===t?{...o,isUsed:!0,verifiedAt:new Date().toISOString()}:o)})),!0):(e(a=>({otpRecords:a.otpRecords.map(o=>o.id===t?{...o,attempts:o.attempts+1}:o)})),!1)}catch{return!1}},getActiveOTP:(t,n)=>{const r=new Date;return s().otpRecords.find(a=>a.userId===t&&a.purpose===n&&!a.isUsed&&new Date(a.expiresAt)>r&&a.attempts<a.maxAttempts)},calculateAgendaItemResult:(t,n)=>{const r=s().getMeeting(t);if(!r)return{votesFor:0,votesAgainst:0,votesAbstain:0,totalVotes:0,percentFor:0,isApproved:!1,thresholdMet:!1};const a=r.agendaItems.find(b=>b.id===n);if(!a)return{votesFor:0,votesAgainst:0,votesAbstain:0,totalVotes:0,percentFor:0,isApproved:!1,thresholdMet:!1};const o=typeof a.votesFor=="number"?a.votesFor:a.votesFor?.length||0,c=typeof a.votesAgainst=="number"?a.votesAgainst:a.votesAgainst?.length||0,l=typeof a.votesAbstain=="number"?a.votesAbstain:a.votesAbstain?.length||0,d=o+c+l,g=d>0?o/d*100:0,m={simple_majority:50,qualified_majority:60,two_thirds:66.67,three_quarters:75,unanimous:100}[a.threshold],f=g>m,h=f&&r.quorumReached;return{votesFor:o,votesAgainst:c,votesAbstain:l,totalVotes:d,percentFor:g,isApproved:h,thresholdMet:f}},calculateMeetingQuorum:t=>{const n=s().getMeeting(t);if(!n)return{participated:0,total:0,percent:0,quorumReached:!1};const r=n.participatedVoters?.length||0,a=n.totalEligibleCount||n.eligibleVoters?.length||0,o=a>0?r/a*100:0,c=n.votingSettings?.quorumPercent||50,l=n.quorumReached??o>=c;return{participated:r,total:a,percent:o,quorumReached:l}},getBuildingSettings:t=>{const n=s().buildingSettings.find(r=>r.buildingId===t);return n||{...at,buildingId:t}},fetchBuildingSettings:async t=>{try{const n=await gt.get(t);if(n.success&&n.data){const r=jt(n.data);return e(a=>a.buildingSettings.find(c=>c.buildingId===t)?{buildingSettings:a.buildingSettings.map(c=>c.buildingId===t?r:c)}:{buildingSettings:[...a.buildingSettings,r]}),r}return{...at,buildingId:t}}catch{return{...at,buildingId:t}}},updateBuildingSettings:async(t,n)=>{try{const r={};n.votingUnit!==void 0&&(r.voting_unit=n.votingUnit),n.defaultQuorumPercent!==void 0&&(r.default_quorum_percent=n.defaultQuorumPercent),n.schedulePollDurationDays!==void 0&&(r.schedule_poll_duration_days=n.schedulePollDurationDays),n.votingDurationHours!==void 0&&(r.voting_duration_hours=n.votingDurationHours),n.allowResidentInitiative!==void 0&&(r.allow_resident_initiative=n.allowResidentInitiative),n.requireModeration!==void 0&&(r.require_moderation=n.requireModeration),n.defaultMeetingTime!==void 0&&(r.default_meeting_time=n.defaultMeetingTime),n.reminderHoursBefore!==void 0&&(r.reminder_hours_before=JSON.stringify(n.reminderHoursBefore)),n.notificationChannels!==void 0&&(r.notification_channels=JSON.stringify(n.notificationChannels));const a=await gt.update(t,r);if(a.success&&a.data){const o=jt(a.data);e(c=>c.buildingSettings.find(d=>d.buildingId===t)?{buildingSettings:c.buildingSettings.map(d=>d.buildingId===t?o:d)}:{buildingSettings:[...c.buildingSettings,o]})}}catch{}},addVotingUnit:async t=>{try{const n=await Ve.create({buildingId:t.buildingId,apartmentId:t.apartmentId,apartmentNumber:t.apartmentNumber,totalArea:t.totalArea,ownershipShare:t.ownershipShare,ownerId:t.ownerId,ownerName:t.ownerName,coOwnerIds:t.coOwnerIds||[]});if(n.success&&n.data){const r=st(n.data);return e(a=>({votingUnits:[...a.votingUnits,r]})),r}throw new Error("Failed to create voting unit")}catch(n){throw n}},updateVotingUnit:async(t,n)=>{e(r=>({votingUnits:r.votingUnits.map(a=>a.id===t?{...a,...n}:a)}))},getVotingUnitsByBuilding:t=>s().votingUnits.filter(n=>n.buildingId===t),getVotingUnitByOwner:t=>s().votingUnits.find(n=>n.ownerId===t||n.coOwnerIds?.includes(t)),verifyVotingUnit:async(t,n)=>{try{const r=await Ve.verify(t,n);if(r.success&&r.data){const a=st(r.data);e(o=>({votingUnits:o.votingUnits.map(c=>c.id===t?a:c)}))}}catch{}},setEligibleVoters:async(t,n,r)=>{try{const a=await Ut.set(t,n,r);if(a.success&&a.data){const o=$(a.data);e(c=>({meetings:c.meetings.map(l=>l.id===t?o:l)}))}}catch{}},getVoteRecordsForMeeting:t=>s().voteRecords.filter(n=>n.meetingId===t),fetchVoteRecordsForMeeting:async t=>{try{const n=await De.getVoteRecords(t);if(n.success&&n.data){const a=(Array.isArray(n.data)?n.data:[]).map(Nt);return e(o=>({voteRecords:[...o.voteRecords.filter(l=>l.meetingId!==t),...a]})),a}return[]}catch{return[]}},generateEvidenceReport:t=>{const n=s().getMeeting(t);if(!n)throw new Error("Meeting not found");const r=s().getVoteRecordsForMeeting(t),a=s().protocols.find(l=>l.meetingId===t),o=new Set(r.map(l=>l.voterId)).size,c=r.filter(l=>l.otpVerified).length;return{meeting:n,votes:r,protocol:a,verificationSummary:{totalVotes:r.length,otpVerified:c,uniqueVoters:o}}}}),{name:"uk-meeting-storage",partialize:e=>({otpRecords:e.otpRecords,buildingSettings:e.buildingSettings})}));function yt({size:e="md"}){const s={sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12",xl:"w-16 h-16 md:w-20 md:h-20"};return i.jsx("img",{src:"/favicon.svg",alt:"Kamizo",className:`${s[e]} object-contain`})}function Wn({onLogout:e,isOpen:s,onClose:t}){const n=qt(),{user:r}=U(),{t:a,language:o}=Bt(),{requests:c,announcements:l,executors:d,getAnnouncementsForEmployees:g}=G(),{meetings:m}=Ke(),[f,h]=p.useState(0),b=p.useCallback(async()=>{if(r&&["admin","manager","resident"].includes(r.role))try{const N=await Lt.getUnreadCount();h(N.unread_count||0)}catch{}},[r]);p.useEffect(()=>{b();const N=setInterval(b,1e4);return()=>clearInterval(N)},[b]);const y=p.useMemo(()=>{if(!r)return null;const N=new Date,R=new Date(N.getTime()+10080*60*1e3),T=m.filter(_=>{if(_.status==="cancelled")return!1;if(_.status==="schedule_poll_open"||_.status==="voting_open")return!0;if(!_.confirmedDateTime)return!1;const A=new Date(_.confirmedDateTime);return A>=N&&A<=R});if(T.length===0)return null;const P=T.some(_=>_.status==="voting_open"||_.status==="schedule_poll_open"),x=T.some(_=>_.status==="voting_closed"||_.status==="results_published"||_.status==="protocol_generated"||_.status==="protocol_approved");return P?"voting":x?"confirmed":"upcoming"},[r,m]),w=p.useMemo(()=>{if(!r)return{};if(r.role==="executor"){const N=d.find(A=>A.login===r.login),R=N?.specialization||r.specialization,T=c.filter(A=>A.status==="new"&&A.category===R).length,P=c.filter(A=>A.executorId===N?.id&&(A.status==="assigned"||A.status==="accepted")).length,_=g().filter(A=>!A.viewedBy?.includes(r.id)).length;return{"/":T+P,"/announcements":_}}if(r.role==="resident"){const N=c.filter(_=>_.residentId===r.id&&!["completed","closed","cancelled"].includes(_.status)).length,R=l.filter(_=>_.isActive&&!_.viewedBy?.includes(r.id)&&(_.type==="residents"||_.type==="all")).length,T=new Date,P=new Date(T.getTime()+10080*60*1e3),x=m.filter(_=>{if(_.status==="cancelled"||!_.confirmedDateTime)return!1;const A=new Date(_.confirmedDateTime);return A>=T&&A<=P}).length;return{"/":N,"/announcements":R,"/meetings":x,"/chat":f}}if(r.role==="manager"||r.role==="admin"||r.role==="department_head"||r.role==="director"){const N=c.filter(x=>x.status==="new").length,R=new Date,T=new Date(R.getTime()+10080*60*1e3),P=m.filter(x=>{if(x.status==="cancelled"||!x.confirmedDateTime)return!1;const _=new Date(x.confirmedDateTime);return _>=R&&_<=T}).length;return{"/requests":N,"/meetings":P,"/chat":f}}return{}},[r,c,l,d,g,f,m]),O=(()=>{if(r?.account_type==="advertiser"||r?.role==="advertiser")return[{path:"/",icon:je,label:o==="ru"?"Мои объявления":"Mening e'lonlarim"}];if(r?.account_type==="coupon_checker"||r?.role==="coupon_checker")return[{path:"/",icon:rn,label:o==="ru"?"Проверка купонов":"Kuponlarni tekshirish"}];if(r?.role==="marketplace_manager")return[{path:"/",icon:ke,label:o==="ru"?"Управление магазином":"Do'konni boshqarish"},{path:"/marketplace-orders",icon:ke,label:o==="ru"?"Заказы магазина":"Do'kon buyurtmalari"}];if(r?.role==="executor"){const N=[{path:"/",icon:ne,label:o==="ru"?r?.specialization==="courier"?"Заказы":"Заявки":r?.specialization==="courier"?"Buyurtmalar":"Arizalar"},{path:"/schedule",icon:sn,label:o==="ru"?"Расписание":"Jadval"},{path:"/vehicle-search",icon:ee,label:o==="ru"?"Поиск авто":"Avto qidirish"}];return r?.specialization==="security"&&N.push({path:"/qr-scanner",icon:Ie,label:o==="ru"?"Сканер QR":"QR skaner"}),[...N,{path:"/stats",icon:Re,label:o==="ru"?"Статистика":"Statistika"},{path:"/announcements",icon:J,label:o==="ru"?"Объявления":"E'lonlar"},{path:"/trainings",icon:Te,label:o==="ru"?"Тренинги":"Treninglar"},{path:"/colleagues",icon:M,label:o==="ru"?"Коллеги":"Hamkasblar"},{path:"/notepad",icon:qe,label:o==="ru"?"Заметки":"Eslatmalar"}]}return r?.role==="resident"?[{path:"/",icon:Ot,label:a("nav.services")},{path:"/marketplace",icon:ke,label:o==="ru"?"Магазин":"Do'kon"},{path:"/chat",icon:Oe,label:o==="ru"?"Написать в УК":"UK ga yozish"},{path:"/vehicles",icon:ee,label:o==="ru"?"Мои авто":"Mening avtomobillarim"},{path:"/guest-access",icon:Ie,label:o==="ru"?"Гостевой доступ":"Mehmon kirishi"},{path:"/announcements",icon:J,label:a("announcements.title")},{path:"/meetings",icon:Pe,label:a("meetings.title")},{path:"/useful-contacts",icon:ht,label:o==="ru"?"Полезные контакты":"Foydali kontaktlar"},{path:"/rate-employees",icon:an,label:o==="ru"?"Оценить":"Baholash"},{path:"/contract",icon:on,label:o==="ru"?"Договор":"Shartnoma"}]:r?.role==="tenant"||r?.role==="commercial_owner"?[{path:"/",icon:Me,label:a("nav.myApartments")}]:r?.role==="admin"?[{path:"/",icon:cn,label:a("nav.monitoring")},{path:"/requests",icon:ne,label:a("nav.requests")},{path:"/chat",icon:Oe,label:o==="ru"?"Чаты":"Chatlar"},{path:"/team",icon:M,label:o==="ru"?"Персонал":"Xodimlar"},{path:"/residents",icon:M,label:a("nav.residents")},{path:"/vehicle-search",icon:ee,label:o==="ru"?"Поиск авто":"Avto qidirish"},{path:"/buildings",icon:We,label:a("nav.buildings")},{path:"/work-orders",icon:be,label:a("nav.workOrders")},{path:"/meetings",icon:Pe,label:a("meetings.title")},{path:"/announcements",icon:J,label:a("announcements.title")},{path:"/trainings",icon:Te,label:a("nav.trainings")},{path:"/reports",icon:Re,label:a("nav.reports")},{path:"/settings",icon:Xe,label:a("nav.settings")}]:r?.role==="director"?[{path:"/",icon:je,label:o==="ru"?"Обзор компании":"Kompaniya sharhi"},{path:"/requests",icon:ne,label:a("nav.requests")},{path:"/chat",icon:Oe,label:o==="ru"?"Чаты":"Chatlar"},{path:"/team",icon:M,label:o==="ru"?"Сотрудники":"Xodimlar"},{path:"/residents",icon:M,label:a("nav.residents")},{path:"/buildings",icon:We,label:a("nav.buildings")},{path:"/vehicle-search",icon:ee,label:o==="ru"?"Поиск авто":"Avto qidirish"},{path:"/guest-access",icon:Ie,label:o==="ru"?"Гостевые пропуска":"Mehmon ruxsatnomalari"},{path:"/rentals",icon:Me,label:o==="ru"?"Аренда":"Ijara"},{path:"/meetings",icon:Pe,label:a("meetings.title")},{path:"/announcements",icon:J,label:a("announcements.title")},{path:"/notepad",icon:qe,label:o==="ru"?"Блокнот":"Bloknot"},{path:"/reports",icon:Re,label:a("nav.reports")},{path:"/settings",icon:Xe,label:a("nav.settings")}]:r?.role==="department_head"?[{path:"/",icon:je,label:o==="ru"?"Мой отдел":"Mening bo'limim"},{path:"/requests",icon:ne,label:o==="ru"?"Заявки":"Arizalar"},{path:"/executors",icon:be,label:o==="ru"?"Сотрудники":"Xodimlar"},{path:"/vehicle-search",icon:ee,label:o==="ru"?"Поиск авто":"Avto qidirish"},{path:"/announcements",icon:J,label:a("announcements.title")},{path:"/trainings",icon:Te,label:a("nav.trainings")},{path:"/colleagues",icon:M,label:o==="ru"?"Коллеги":"Hamkasblar"},{path:"/notepad",icon:qe,label:o==="ru"?"Блокнот":"Bloknot"}]:[{path:"/",icon:je,label:a("nav.dashboard")},{path:"/requests",icon:ne,label:a("nav.requests")},{path:"/marketplace-orders",icon:ke,label:o==="ru"?"Заказы магазина":"Do'kon buyurtmalari"},{path:"/marketplace-products",icon:ln,label:o==="ru"?"Товары и склад":"Mahsulotlar va ombor"},{path:"/chat",icon:Oe,label:o==="ru"?"Чаты":"Chatlar"},{path:"/executors",icon:be,label:a("nav.executors")},{path:"/residents",icon:M,label:a("nav.residents")},{path:"/vehicle-search",icon:ee,label:o==="ru"?"Поиск авто":"Avto qidirish"},{path:"/guest-access",icon:Ie,label:o==="ru"?"Гостевые пропуска":"Mehmon ruxsatnomalari"},{path:"/rentals",icon:Me,label:a("nav.rentals")},{path:"/buildings",icon:We,label:a("nav.buildings")},{path:"/work-orders",icon:be,label:a("nav.workOrders")},{path:"/meetings",icon:Pe,label:a("meetings.title")},{path:"/announcements",icon:J,label:a("announcements.title")},{path:"/trainings",icon:Te,label:a("nav.trainings")},{path:"/colleagues",icon:M,label:o==="ru"?"Мои коллеги":"Hamkasblar"},{path:"/notepad",icon:qe,label:o==="ru"?"Заметки":"Eslatmalar"},{path:"/reports",icon:Re,label:a("nav.reports")},{path:"/settings",icon:Xe,label:a("nav.settings")}]})(),I=()=>{window.innerWidth<768&&t()};return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:`sidebar-overlay ${s?"open":""}`,onClick:t}),i.jsxs("div",{className:`sidebar ${s?"open":""}`,children:[i.jsx("div",{className:"p-4 md:p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(yt,{size:"md"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-bold text-gray-900",children:"Kamizo"}),i.jsx("div",{className:"text-xs text-gray-500",children:"CRM"})]})]}),i.jsx("button",{onClick:t,className:"md:hidden p-2 hover:bg-white/30 rounded-lg",children:i.jsx(He,{className:"w-5 h-5"})})]})}),i.jsx("nav",{className:"flex-1 py-4 overflow-y-auto",children:O.map(N=>{const R=w[N.path]||0,T=N.path==="/meetings",P=T&&y?y==="voting"?"bg-blue-500":y==="confirmed"?"bg-green-500":"bg-red-500":"bg-red-500",x=!T||y==="voting";return i.jsxs("div",{children:[N.separator&&i.jsx("div",{className:"my-3 mx-4 border-t border-white/20"}),i.jsxs(xt,{to:N.path,onClick:I,className:`sidebar-item ${n.pathname===N.path?"active":""}`,children:[i.jsxs("div",{className:"relative",children:[i.jsx(N.icon,{className:"w-5 h-5"}),R>0&&i.jsx("span",{className:`absolute -top-2 -right-2 min-w-[18px] h-[18px] flex items-center justify-center px-1 text-[10px] font-bold text-white ${P} rounded-full ${x?"animate-pulse":""}`,children:R>99?"99+":R})]}),i.jsx("span",{className:"flex-1",children:N.label}),R>0&&i.jsx("span",{className:`ml-auto px-2 py-0.5 text-xs font-bold text-white ${P} rounded-full`,children:R>99?"99+":R})]})]},N.path)})}),i.jsxs("div",{className:"p-4 border-t border-white/20 space-y-1",children:[(r?.role==="resident"||r?.role==="tenant"||r?.role==="commercial_owner")&&i.jsxs(xt,{to:"/profile",onClick:I,className:`sidebar-item ${n.pathname==="/profile"?"active":""}`,children:[i.jsx(tn,{className:"w-5 h-5"}),i.jsx("span",{children:o==="ru"?"Мой профиль":"Mening profilim"})]}),i.jsxs("button",{onClick:e,className:"sidebar-item w-full text-red-500 hover:bg-red-50",children:[i.jsx(nn,{className:"w-5 h-5"}),i.jsx("span",{children:o==="ru"?"Выйти":"Chiqish"})]})]})]})]})}function Xn({onMenuClick:e,unreadCount:s}){const{user:t}=U(),n=It(),[r,a]=p.useState(!1),{notifications:o,markNotificationAsRead:c,markAllNotificationsAsRead:l,getAnnouncementsForResidents:d,getAnnouncementsForEmployees:g,vehicles:m}=G(),{meetings:f}=Ke(),h=t?.role?.toLowerCase()==="resident"||t?.role?.toLowerCase()==="tenant",b=p.useMemo(()=>t?h?d(t.login||"",t.buildingId||"",t.entrance||"",t.floor||"",t.branch||""):g():[],[t,h,d,g]),y=b.filter(x=>!x.viewedBy?.includes(t?.id||"")).length,w=p.useMemo(()=>{const x=new Date,_=new Date(x.getTime()+10080*60*1e3);return f.filter(A=>{if(!A.confirmedDateTime)return!1;const C=new Date(A.confirmedDateTime);return C>=x&&C<=_&&A.status!=="cancelled"})},[f]),j=p.useMemo(()=>!h||!t?[]:[{id:"password",title:"Сменить пароль",description:"Установите надёжный пароль",icon:Me,path:"/profile",completed:!!t.passwordChangedAt},{id:"phone",title:"Указать телефон",description:"Для связи и уведомлений",icon:ht,path:"/profile",completed:!!(t.phone&&t.phone.length>=5)},{id:"contract",title:"Подписать договор",description:"Договор с управляющей компанией",icon:ne,path:"/contract",completed:!!t.contractSignedAt},{id:"vehicle",title:"Добавить транспорт",description:"Зарегистрируйте ваш автомобиль",icon:ee,path:"/vehicles",completed:m.some(_=>_.ownerId===t.id)}],[h,t,m]),O=j.filter(x=>!x.completed).length,I=y+w.length,N=o.filter(x=>x.userId===t?.id).slice(0,10),R=x=>{const _=new Date(x),C=new Date().getTime()-_.getTime(),D=Math.floor(C/6e4),Ae=Math.floor(C/36e5);return D<1?"только что":D<60?`${D} мин`:Ae<24?`${Ae} ч`:_.toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"})},T=x=>{switch(x){case"request_created":return"📝";case"request_assigned":return"📋";case"request_accepted":return"✅";case"request_started":return"🔧";case"request_completed":return"✨";case"request_approved":return"⭐";case"request_rejected":return"❌";case"request_cancelled":return"🚫";case"request_declined":return"↩️";default:return"🔔"}},P=s+y+w.length+O;return i.jsxs(i.Fragment,{children:[i.jsxs("header",{className:"mobile-header",children:[i.jsxs("button",{onClick:e,className:"p-2 hover:bg-white/30 rounded-lg relative",children:[i.jsx(dn,{className:"w-6 h-6"}),I>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-amber-500 rounded-full text-white text-[10px] flex items-center justify-center",children:I>9?"9+":I})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(yt,{size:"sm"}),i.jsx("span",{className:"font-bold text-gray-900 text-sm",children:"Kamizo"})]}),i.jsxs("button",{onClick:()=>a(!r),className:"p-2 hover:bg-white/30 rounded-lg relative",children:[i.jsx(ge,{className:"w-6 h-6"}),P>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center",children:P>9?"9+":P})]})]}),r&&ot.createPortal(i.jsxs("div",{className:"notifications-portal",children:[i.jsx("div",{className:"fixed inset-0 bg-black/20",style:{zIndex:1e4},onClick:()=>a(!1)}),i.jsxs("div",{className:"fixed left-2 right-2 bottom-16 bg-white rounded-2xl border border-gray-200 shadow-2xl overflow-hidden",style:{zIndex:10001,maxHeight:"70vh"},children:[i.jsxs("div",{className:"p-3 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[i.jsx("h3",{className:"font-semibold text-sm",children:"Уведомления"}),s>0&&i.jsx("button",{onClick:()=>t&&l(t.id),className:"text-xs text-blue-600",children:"Прочитать все"})]}),i.jsxs("div",{className:"overflow-y-auto",style:{maxHeight:"calc(70vh - 90px)"},children:[h&&j.length>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-3 py-2 bg-amber-50 border-b border-amber-100",children:i.jsxs("p",{className:"text-xs font-medium text-amber-700 flex items-center gap-1",children:[i.jsx(Je,{className:"w-3 h-3"}),"Задачи (",O,"/",j.length,")"]})}),j.map(x=>i.jsxs("div",{onClick:()=>{a(!1),n(x.path)},className:`p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 flex items-center gap-2 ${x.completed?"bg-green-50/50":"bg-amber-50/50"}`,children:[i.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${x.completed?"bg-green-100":"bg-amber-100"}`,children:i.jsx(x.icon,{className:`w-4 h-4 ${x.completed?"text-green-600":"text-amber-600"}`})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:`text-sm font-medium ${x.completed?"text-green-700 line-through":"text-gray-900"}`,children:x.title}),i.jsx("p",{className:"text-xs text-gray-500",children:x.description})]}),x.completed?i.jsx(Je,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):i.jsx("span",{className:"w-2 h-2 bg-amber-500 rounded-full flex-shrink-0"})]},x.id))]}),y>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-3 py-2 bg-blue-50 border-b border-blue-100",children:i.jsxs("p",{className:"text-xs font-medium text-blue-700 flex items-center gap-1",children:[i.jsx(J,{className:"w-3 h-3"}),"Объявления (",y,")"]})}),b.filter(x=>!x.viewedBy?.includes(t?.id||"")).slice(0,3).map(x=>i.jsxs("div",{onClick:()=>{a(!1),n("/announcements")},className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 bg-blue-50/50 flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(J,{className:"w-4 h-4 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium truncate",children:x.title}),i.jsx("p",{className:"text-xs text-gray-500 line-clamp-1",children:x.content})]}),i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]},x.id))]}),w.length>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-3 py-2 bg-purple-50 border-b border-purple-100",children:i.jsxs("p",{className:"text-xs font-medium text-purple-700 flex items-center gap-1",children:[i.jsx(M,{className:"w-3 h-3"}),"Собрания (",w.length,")"]})}),w.slice(0,2).map(x=>i.jsxs("div",{onClick:()=>{a(!1),n("/meetings")},className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 bg-purple-50/50 flex items-center gap-2",children:[i.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(M,{className:"w-4 h-4 text-purple-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium truncate",children:"Собрание дома"}),i.jsx("p",{className:"text-xs text-gray-500",children:x.confirmedDateTime?new Date(x.confirmedDateTime).toLocaleDateString("ru-RU",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"Дата уточняется"})]}),i.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full flex-shrink-0"})]},x.id))]}),N.length===0&&y===0&&w.length===0&&O===0?i.jsxs("div",{className:"p-6 text-center text-gray-500",children:[i.jsx(ge,{className:"w-10 h-10 mx-auto mb-2 text-gray-300"}),i.jsx("p",{children:"Нет уведомлений"})]}):N.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"px-3 py-2 bg-gray-50 border-b border-gray-100",children:i.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Уведомления"})}),N.map(x=>i.jsx("div",{onClick:()=>{x.read||c(x.id)},className:`p-3 border-b border-gray-100 ${x.read?"bg-white":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("span",{className:"text-lg",children:T(x.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("h4",{className:"font-medium text-sm truncate",children:x.title}),i.jsx("span",{className:"text-xs text-gray-400 flex-shrink-0",children:R(x.createdAt)})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-2",children:x.message})]})]})},x.id))]})]}),i.jsx("div",{className:"p-2 border-t border-gray-200 bg-gray-50",children:i.jsx("button",{onClick:()=>a(!1),className:"w-full text-center text-sm text-gray-600 py-1",children:"Закрыть"})})]})]}),document.body)]})}const os={uk_general:{label:"Общий чат УК",labelUz:"UK umumiy chat",icon:"🏢",description:"Общий чат всех жителей управляющей компании",descriptionUz:"Boshqaruv kompaniyasi barcha turar joy egalari uchun umumiy chat"},building_general:{label:"Чат ЖК",labelUz:"TJM chat",icon:"🏠",description:"Чат жителей вашего жилого комплекса",descriptionUz:"Sizning turar joy majmuangiz aholisi uchun chat"},entrance:{label:"Чат подъезда",labelUz:"Kirish chati",icon:"🚪",description:"Чат жителей вашего подъезда",descriptionUz:"Sizning kirishingiz aholisi uchun chat"},floor:{label:"Чат этажа",labelUz:"Qavat chati",icon:"🔢",description:"Чат жителей вашего этажа",descriptionUz:"Sizning qavatingiz aholisi uchun chat"},admin_support:{label:"Чат с администрацией",labelUz:"Administratsiya bilan chat",icon:"👨‍💼",description:"Прямой чат с администрацией УК",descriptionUz:"UK administratsiyasi bilan to'g'ridan-to'g'ri chat"},private_support:{label:"Личный чат с УК",labelUz:"UK bilan shaxsiy chat",icon:"💬",description:"Ваш личный чат с администрацией",descriptionUz:"Administratsiya bilan shaxsiy chatizngiz"}},cs=[{id:"plumber",name:"Сантехника",icon:"🔧",description:"Ремонт труб, кранов, унитазов"},{id:"electrician",name:"Электрика",icon:"💡",description:"Проводка, розетки, освещение"},{id:"security",name:"Охрана",icon:"🛡️",description:"Безопасность и охрана территории"},{id:"cleaning",name:"Уборка",icon:"🧹",description:"Уборка подъездов и территории"},{id:"elevator",name:"Лифт",icon:"🛗",description:"Ремонт и обслуживание лифтов"},{id:"intercom",name:"Домофон",icon:"🔔",description:"Ремонт домофонов и замков"},{id:"carpenter",name:"Столярные работы",icon:"🪚",description:"Ремонт дверей, окон, мебели"},{id:"boiler",name:"Котёл",icon:"🔥",description:"Ремонт и обслуживание котлов"},{id:"ac",name:"Кондиционер",icon:"❄️",description:"Установка и ремонт кондиционеров"},{id:"other",name:"Другое",icon:"📋",description:"Прочие услуги"}],kt={plumber:"Сантехник",electrician:"Электрик",elevator:"Лифтёр",intercom:"Домофон",cleaning:"Уборщица",security:"Охранник",carpenter:"Столяр",boiler:"Котельщик",ac:"Кондиционерщик",courier:"Курьер",other:"Другое"},ls={new:"Новая",assigned:"Назначена",accepted:"Принята",in_progress:"В работе",pending_approval:"Ожидает подтверждения",completed:"Выполнена",cancelled:"Отменена"},ds={low:"Низкий",medium:"Средний",high:"Высокий",urgent:"Срочный"},us={budget_approval:{label:"Утверждение бюджета",labelUz:"Byudjetni tasdiqlash",defaultThreshold:"simple_majority",requiresMaterials:!0,description:"Рассмотрение и утверждение годового бюджета дома",descriptionUz:"Yillik uy byudjetini ko'rib chiqish va tasdiqlash"},tariff_change:{label:"Изменение тарифов",labelUz:"Tariflarni o'zgartirish",defaultThreshold:"simple_majority",requiresMaterials:!0,description:"Изменение размера ежемесячных платежей",descriptionUz:"Oylik to'lovlar miqdorini o'zgartirish"},major_repair:{label:"Капитальный ремонт",labelUz:"Asosiy ta'mirlash",defaultThreshold:"two_thirds",requiresMaterials:!0,description:"Решение о проведении капитального ремонта",descriptionUz:"Asosiy ta'mirlash to'g'risida qaror"},common_property:{label:"Общее имущество",labelUz:"Umumiy mulk",defaultThreshold:"two_thirds",requiresMaterials:!1,description:"Использование общего имущества дома",descriptionUz:"Umumiy uy mulkidan foydalanish"},management_contract:{label:"Договор управления",labelUz:"Boshqaruv shartnomasi",defaultThreshold:"simple_majority",requiresMaterials:!0,description:"Заключение или изменение договора с УК",descriptionUz:"Boshqaruv kompaniyasi bilan shartnoma tuzish yoki o'zgartirish"},chairman_election:{label:"Выбор председателя",labelUz:"Rais saylov",defaultThreshold:"simple_majority",requiresMaterials:!1,description:"Выборы председателя совета дома",descriptionUz:"Uy kengashi raisi saylovi"},audit_commission:{label:"Ревизионная комиссия",labelUz:"Taftish komissiyasi",defaultThreshold:"simple_majority",requiresMaterials:!1,description:"Формирование ревизионной комиссии",descriptionUz:"Taftish komissiyasini shakllantirish"},rules_amendment:{label:"Изменение правил",labelUz:"Qoidalarni o'zgartirish",defaultThreshold:"two_thirds",requiresMaterials:!0,description:"Изменение правил проживания в доме",descriptionUz:"Uyda yashash qoidalarini o'zgartirish"},landscaping:{label:"Благоустройство",labelUz:"Obodonlashtirish",defaultThreshold:"simple_majority",requiresMaterials:!0,description:"Работы по благоустройству территории",descriptionUz:"Hududni obodonlashtirish ishlari"},security:{label:"Охрана и безопасность",labelUz:"Xavfsizlik",defaultThreshold:"simple_majority",requiresMaterials:!1,description:"Вопросы охраны и безопасности дома",descriptionUz:"Uy xavfsizligi masalalari"},parking:{label:"Парковка",labelUz:"Avtoturargoh",defaultThreshold:"simple_majority",requiresMaterials:!1,description:"Организация парковки на территории",descriptionUz:"Hududda avtoturargoh tashkil etish"},other:{label:"Другое",labelUz:"Boshqa",defaultThreshold:"simple_majority",requiresMaterials:!1,description:"Прочие вопросы",descriptionUz:"Boshqa masalalar"}},ms={simple_majority:{label:"Простое большинство (50%+1)",labelUz:"Oddiy ko'pchilik (50%+1)",percent:50},qualified_majority:{label:"Квалифицированное большинство (60%)",labelUz:"Malakali ko'pchilik (60%)",percent:60},two_thirds:{label:"Две трети (66.7%)",labelUz:"Uchdan ikki (66.7%)",percent:66.67},three_quarters:{label:"Три четверти (75%)",labelUz:"To'rtdan uch (75%)",percent:75},unanimous:{label:"Единогласно (100%)",labelUz:"Bir ovozdan (100%)",percent:100}},gs={draft:{label:"Черновик",labelUz:"Qoralama",color:"gray"},pending_moderation:{label:"На модерации",labelUz:"Moderatsiyada",color:"yellow"},schedule_poll_open:{label:"Выбор даты",labelUz:"Sana tanlash",color:"blue"},schedule_confirmed:{label:"Дата утверждена",labelUz:"Sana tasdiqlangan",color:"indigo"},voting_open:{label:"Голосование",labelUz:"Ovoz berish",color:"green"},voting_closed:{label:"Голосование закрыто",labelUz:"Ovoz berish yopildi",color:"orange"},results_published:{label:"Итоги опубликованы",labelUz:"Natijalar e'lon qilindi",color:"purple"},protocol_generated:{label:"Протокол готов",labelUz:"Bayonnoma tayyor",color:"teal"},protocol_approved:{label:"Протокол утвержден",labelUz:"Bayonnoma tasdiqlangan",color:"emerald"},cancelled:{label:"Отменено",labelUz:"Bekor qilindi",color:"red"}},ps={panel:"Панельный",brick:"Кирпичный",monolith:"Монолитный",block:"Блочный",wooden:"Деревянный",mixed:"Смешанный"},hs={car:{label:"Легковой автомобиль",labelUz:"Yengil avtomobil"},motorcycle:{label:"Мотоцикл",labelUz:"Mototsikl"},truck:{label:"Грузовик",labelUz:"Yuk mashinasi"},other:{label:"Другое",labelUz:"Boshqa"}},ys={individual:{label:"Физ. лицо",labelUz:"Jismoniy shaxs",icon:"👤"},legal_entity:{label:"Юр. лицо",labelUz:"Yuridik shaxs",icon:"🏢"},service:{label:"Служебный",labelUz:"Xizmat",icon:"🚐"}},fs={courier:{label:"Курьер",labelUz:"Kuryer",icon:"📦"},guest:{label:"Гость",labelUz:"Mehmon",icon:"👥"},taxi:{label:"Такси",labelUz:"Taksi",icon:"🚕"},other:{label:"Другое",labelUz:"Boshqa",icon:"👤"}},bs={single_use:{label:"Одноразовый",labelUz:"Bir martalik",description:"Действует до первого использования",descriptionUz:"Birinchi foydalanishgacha amal qiladi"},day:{label:"На день",labelUz:"Kunlik",description:"Действует до конца дня",descriptionUz:"Kun oxirigacha amal qiladi"},week:{label:"На неделю",labelUz:"Haftalik",description:"Действует 7 дней",descriptionUz:"7 kun amal qiladi"},custom:{label:"Свой срок",labelUz:"Maxsus muddat",description:"Укажите период действия",descriptionUz:"Amal qilish muddatini belgilang"}},vs={active:{label:"Активен",labelUz:"Faol",color:"green"},expired:{label:"Истёк",labelUz:"Muddati tugagan",color:"gray"},used:{label:"Использован",labelUz:"Ishlatilgan",color:"blue"},revoked:{label:"Отменён",labelUz:"Bekor qilingan",color:"red"}},xs={busy_time:{label:"Занят в это время",labelUz:"Bu vaqtda band"},emergency:{label:"Непредвиденные обстоятельства",labelUz:"Kutilmagan holat"},not_at_home:{label:"Не буду дома",labelUz:"Uyda bo'lmayman"},need_preparation:{label:"Нужно время на подготовку",labelUz:"Tayyorgarlik kerak"},other:{label:"Другая причина",labelUz:"Boshqa sabab"}},ws={pending:{label:"Ожидает ответа",labelUz:"Javob kutilmoqda",color:"yellow"},accepted:{label:"Принято",labelUz:"Qabul qilindi",color:"green"},rejected:{label:"Отклонено",labelUz:"Rad etildi",color:"red"},expired:{label:"Истёк срок",labelUz:"Muddati tugadi",color:"gray"}},Zn=[{id:"change_password",title:"Сменить пароль",description:"Установите надёжный пароль для защиты аккаунта",icon:i.jsx(mn,{className:"w-5 h-5 text-amber-500"}),route:"/profile",checkComplete:e=>!!e?.passwordChangedAt},{id:"add_phone",title:"Добавить номер телефона",description:"Укажите контактный номер для связи",icon:i.jsx(ht,{className:"w-5 h-5 text-blue-500"}),route:"/profile",checkComplete:e=>!!e?.phone&&e.phone.length>5},{id:"sign_contract",title:"Подписать договор",description:"Ознакомьтесь и подпишите договор с УК",icon:i.jsx(ne,{className:"w-5 h-5 text-green-500"}),route:"/",checkComplete:e=>!!e?.contractSignedAt},{id:"add_vehicle",title:"Добавить автомобиль",description:"Зарегистрируйте ваш автомобиль для парковки",icon:i.jsx(ee,{className:"w-5 h-5 text-purple-500"}),route:"/vehicles",checkComplete:(e,s)=>s.some(t=>t.ownerId===e?.id)}];function er(){const{user:e}=U(),{notifications:s,requests:t,vehicles:n,getUnreadCount:r,markNotificationAsRead:a,markAllNotificationsAsRead:o,getAnnouncementsForResidents:c,getAnnouncementsForEmployees:l}=G(),{meetings:d}=Ke(),g=It(),[m,f]=p.useState(!1),[h,b]=p.useState(new Date),y=p.useRef(new Set),[w,j]=p.useState(""),[O,I]=p.useState(!1),N=e?.role?.toLowerCase()==="resident"||e?.role?.toLowerCase()==="tenant",R=e?.role==="tenant"||e?.role==="commercial_owner",T=N?Zn.filter(v=>!v.checkComplete(e,n)):[],P=N?c(e?.login||"",e?.buildingId||"",e?.entrance||"",e?.floor||"",e?.branch||""):l(),x=P.filter(v=>!v.viewedBy.includes(e?.id||"")).length,_=new Date,A=new Date(_.getTime()+10080*60*1e3),C=d.filter(v=>{if(!v.confirmedDateTime)return!1;const re=new Date(v.confirmedDateTime);return re>=_&&re<=A&&v.status!=="cancelled"}),D=C.length,Ae=v=>{f(!1),g(v.route)};p.useEffect(()=>{const v=setInterval(()=>{b(new Date)},1e3);return()=>clearInterval(v)},[]),p.useEffect(()=>{if(!e)return;const v=()=>{const Q=U.getState().user,{requests:pe,executors:he,addNotification:ye}=G.getState();if(!Q)return;const K=new Date,Gt=new Date(K.getTime()+600*1e3),Qt=new Date(K.getTime()+300*1e3);pe.filter(E=>{if(!E.scheduledDate||!E.scheduledTime||!["assigned","accepted"].includes(E.status))return!1;if(Q.role==="executor"){const bt=he.find(Ne=>Ne.login===Q.login);return E.executorId===bt?.id}return Q.role==="resident"?E.residentId===Q.id:!1}).forEach(E=>{const Ne=E.scheduledTime.split("-")[0],[Wt,Xt]=Ne.split(":").map(Number),se=new Date(E.scheduledDate);se.setHours(Wt,Xt,0,0);const Qe=`${E.id}-10min`,vt=`${E.id}-5min`;if(se>K&&se<=Gt&&!y.current.has(Qe)){const fe=Math.round((se.getTime()-K.getTime())/6e4);ye({userId:Q.id,type:"request_assigned",title:`Напоминание: через ${fe} мин`,message:`Заявка #${E.number} "${E.title}" запланирована на ${Ne}. ${E.address}, кв. ${E.apartment}`,requestId:E.id}),y.current.add(Qe)}if(se>K&&se<=Qt&&!y.current.has(vt)){const fe=Math.round((se.getTime()-K.getTime())/6e4);fe<=5&&!y.current.has(Qe)&&ye({userId:Q.id,type:"request_assigned",title:`Срочно: через ${fe} мин!`,message:`Заявка #${E.number} начинается через ${fe} минут! Адрес: ${E.address}, кв. ${E.apartment}`,requestId:E.id}),y.current.add(vt)}})};v();const re=setInterval(v,6e4);return()=>clearInterval(re)},[e?.id]);const ft=e?r(e.id):0,Ye=ft+T.length+x+D,Se=s.filter(v=>v.userId===e?.id).slice(0,10),Vt=()=>h.toLocaleTimeString("ru-RU",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),Ft=()=>h.toLocaleDateString("ru-RU",{weekday:"short",day:"numeric",month:"short"}),Jt=()=>{switch(e?.role){case"admin":return"Администратор";case"manager":return"Менеджер";case"department_head":return`Глава отдела ${kt[e?.specialization]||""}`.trim();case"executor":return kt[e?.specialization]||"Исполнитель";case"resident":return"Житель";default:return"Пользователь"}},Ht=v=>{const re=new Date(v),pe=new Date().getTime()-re.getTime(),he=Math.floor(pe/6e4),ye=Math.floor(pe/36e5),K=Math.floor(pe/864e5);return he<1?"только что":he<60?`${he} мин назад`:ye<24?`${ye} ч назад`:K<7?`${K} дн назад`:re.toLocaleDateString("ru-RU")},Kt=v=>{switch(v){case"request_created":return"📝";case"request_assigned":return"📋";case"request_accepted":return"✅";case"request_started":return"🔧";case"request_completed":return"✨";case"request_approved":return"⭐";case"request_rejected":return"❌";case"request_cancelled":return"🚫";case"request_declined":return"↩️";default:return"🔔"}},Ge=w.trim()?t.filter(v=>v.title.toLowerCase().includes(w.toLowerCase())||v.description.toLowerCase().includes(w.toLowerCase())||v.number.toString().includes(w)||v.residentName.toLowerCase().includes(w.toLowerCase())||v.address.toLowerCase().includes(w.toLowerCase())).slice(0,5):[],Yt=()=>{e?.role==="executor"?(g("/"),window.dispatchEvent(new CustomEvent("openSchedule"))):e?.role==="resident"?g("/"):g("/requests")};return i.jsxs("header",{className:"h-16 glass-card rounded-none border-x-0 border-t-0 flex items-center justify-between px-6",children:[i.jsx("div",{className:"flex items-center gap-4",children:!R&&i.jsxs("div",{className:"relative",children:[i.jsx(wt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Поиск заявок...",value:w,onChange:v=>{j(v.target.value),I(v.target.value.trim().length>0)},onFocus:()=>w.trim()&&I(!0),className:"glass-input pl-10 w-64"}),O&&ot.createPortal(i.jsxs("div",{className:"search-results-portal",children:[i.jsx("div",{className:"fixed inset-0",onClick:()=>I(!1)}),i.jsx("div",{className:"fixed left-[280px] top-14 w-96 bg-white rounded-xl border border-gray-200 shadow-xl overflow-hidden",style:{zIndex:10002},children:Ge.length===0?i.jsxs("div",{className:"p-4 text-center text-gray-500",children:[i.jsx(wt,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),i.jsx("p",{children:"Ничего не найдено"})]}):i.jsxs("div",{children:[i.jsxs("div",{className:"p-2 bg-gray-50 border-b text-xs text-gray-500",children:["Найдено: ",Ge.length," заявок"]}),Ge.map(v=>i.jsxs("div",{onClick:()=>{g("/requests"),I(!1),j("")},className:"p-3 hover:bg-gray-50 cursor-pointer border-b last:border-b-0",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("span",{className:"text-xs text-gray-400",children:["#",v.number]}),i.jsx("span",{className:"font-medium text-sm",children:v.title})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[v.address,", кв. ",v.apartment]}),i.jsx("div",{className:"flex items-center gap-2 mt-1",children:i.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${v.status==="new"?"bg-blue-100 text-blue-700":v.status==="in_progress"?"bg-amber-100 text-amber-700":v.status==="completed"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:v.status==="new"?"Новая":v.status==="in_progress"?"В работе":v.status==="completed"?"Выполнена":v.status})})]},v.id))]})})]}),document.body)]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("button",{onClick:Yt,className:"flex items-center gap-2 px-3 py-1.5 bg-white/50 rounded-xl border border-white/30 hover:bg-white/70 transition-colors cursor-pointer",title:"Перейти к расписанию",children:[i.jsx(Pt,{className:"w-4 h-4 text-primary-600"}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-mono font-semibold text-gray-800",children:Vt()}),i.jsx("div",{className:"text-xs text-gray-500",children:Ft()})]})]}),i.jsx("div",{className:"relative",children:i.jsxs("button",{onClick:()=>f(!m),className:"p-2 hover:bg-white/30 rounded-lg relative",children:[i.jsx(ge,{className:"w-5 h-5 text-gray-600"}),Ye>0&&i.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full text-white text-xs flex items-center justify-center",children:Ye>9?"9+":Ye})]})}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm font-medium",children:e?.name}),i.jsx("div",{className:"text-xs text-gray-500",children:Jt()})]})]}),m&&ot.createPortal(i.jsxs("div",{className:"notifications-portal",children:[i.jsx("div",{className:"fixed inset-0 bg-black/20",style:{zIndex:1e4},onClick:()=>f(!1)}),i.jsxs("div",{className:"fixed right-6 top-20 w-96 bg-white rounded-2xl border border-gray-200 shadow-2xl overflow-hidden flex flex-col",style:{zIndex:10001,maxHeight:"calc(100vh - 100px)"},children:[i.jsxs("div",{className:"p-4 border-b border-gray-200 flex items-center justify-between bg-gray-50",children:[i.jsx("h3",{className:"font-semibold text-lg",children:"Уведомления"}),ft>0&&i.jsx("button",{onClick:()=>e&&o(e.id),className:"text-sm text-blue-600 hover:text-blue-800",children:"Прочитать все"})]}),T.length>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-4 py-2 bg-amber-50 border-b border-amber-100",children:i.jsx("p",{className:"text-xs font-medium text-amber-700",children:"Необходимые действия"})}),T.map(v=>i.jsx("div",{onClick:()=>Ae(v),className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:v.icon}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-sm text-gray-900",children:v.title}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:v.description})]}),i.jsx(un,{className:"w-4 h-4 text-gray-400 flex-shrink-0"})]})},v.id))]}),x>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-4 py-2 bg-blue-50 border-b border-blue-100",children:i.jsxs("p",{className:"text-xs font-medium text-blue-700 flex items-center gap-1",children:[i.jsx(J,{className:"w-3 h-3"}),"Объявления (",x,")"]})}),P.filter(v=>!v.viewedBy.includes(e?.id||"")).slice(0,3).map(v=>i.jsx("div",{onClick:()=>{f(!1),g(N?"/announcements":"/staff/announcements")},className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 bg-blue-50/50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(J,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h4",{className:"font-medium text-sm text-gray-900 truncate",children:v.title}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:v.content})]}),i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0"})]})},v.id))]}),D>0&&i.jsxs("div",{className:"border-b border-gray-200",children:[i.jsx("div",{className:"px-4 py-2 bg-purple-50 border-b border-purple-100",children:i.jsxs("p",{className:"text-xs font-medium text-purple-700 flex items-center gap-1",children:[i.jsx(M,{className:"w-3 h-3"}),"Собрания (",D,")"]})}),C.slice(0,3).map(v=>i.jsx("div",{onClick:()=>{f(!1),g(N?"/meetings":"/staff/meetings")},className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0 bg-purple-50/50",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:i.jsx(M,{className:"w-5 h-5 text-purple-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("h4",{className:"font-medium text-sm text-gray-900 truncate",children:["Собрание дома ",v.buildingAddress]}),i.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:v.confirmedDateTime?new Date(v.confirmedDateTime).toLocaleDateString("ru-RU",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"}):"Дата уточняется"})]}),i.jsx("span",{className:"w-2 h-2 bg-purple-500 rounded-full flex-shrink-0"})]})},v.id))]}),i.jsx("div",{className:"overflow-y-auto flex-1",style:{maxHeight:"400px"},children:Se.length===0&&T.length===0&&x===0&&D===0?i.jsxs("div",{className:"p-8 text-center text-gray-500",children:[i.jsx(ge,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"Нет уведомлений"})]}):Se.length===0?null:Se.map(v=>i.jsx("div",{onClick:()=>{v.read||a(v.id)},className:`p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer transition-colors ${v.read?"bg-white":"bg-blue-50"}`,children:i.jsxs("div",{className:"flex gap-3",children:[i.jsx("span",{className:"text-2xl flex-shrink-0",children:Kt(v.type)}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2",children:[i.jsx("h4",{className:`font-medium text-sm ${v.read?"text-gray-600":"text-gray-900"}`,children:v.title}),!v.read&&i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]}),i.jsx("p",{className:"text-sm text-gray-500 mt-0.5 line-clamp-2",children:v.message}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:Ht(v.createdAt)})]})]})},v.id))}),Se.length>0&&i.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:i.jsx("button",{onClick:()=>f(!1),className:"w-full text-center text-sm text-gray-600 hover:text-gray-900",children:"Закрыть"})})]})]}),document.body)]})}const Fe=()=>{try{const e=sessionStorage.getItem("shown_popup_ids");return e?new Set(JSON.parse(e)):new Set}catch{return new Set}},it=e=>{try{const s=Fe();s.add(e),sessionStorage.setItem("shown_popup_ids",JSON.stringify([...s]))}catch{}};function tr(){const{user:e}=U(),{announcements:s,getAnnouncementsForResidents:t,markAnnouncementAsViewed:n,requests:r}=G(),[a,o]=p.useState([]),c=p.useRef(!1);p.useEffect(()=>{if(c.current||!e||e.role!=="resident")return;const g=t(e.login,e.buildingId,e.entrance,e.floor,e.branch),m=Fe(),h=g.filter(b=>{const y=b.priority==="urgent"||b.priority==="important",w=!b.viewedBy.includes(e.id),j=!m.has(`announcement-${b.id}`);return y&&w&&j}).map(b=>{const y=/собрани|встреч|заседани|йиғилиш/i.test(b.title+" "+b.content);return it(`announcement-${b.id}`),{id:`announcement-${b.id}`,type:y?"announcement_meeting":"announcement_urgent",title:b.title,message:b.content.length>200?b.content.substring(0,200)+"...":b.content,actionLabel:"Понятно",onAction:()=>{n(b.id,e.id)}}});h.length>0&&o(b=>[...b,...h]),c.current=!0},[e,s,t,n]),p.useEffect(()=>{if(!e||e.role!=="resident")return;const g=Fe(),f=r.filter(h=>h.residentId===e.id&&h.status==="pending_approval"&&!g.has(`request-completed-${h.id}`)).map(h=>(it(`request-completed-${h.id}`),{id:`request-completed-${h.id}`,type:"request_completed",title:"Работа завершена!",message:`Заявка ${h.number}: ${h.executorName||"Исполнитель"} завершил работу. Пожалуйста, подтвердите выполнение и оцените работу.`,actionLabel:"Оценить работу",onAction:()=>{sessionStorage.setItem("open_rating_for_request",h.id),window.location.pathname!=="/"?window.location.href="/":window.dispatchEvent(new CustomEvent("openRatingModal",{detail:{requestId:h.id}}))}}));f.length>0&&o(h=>[...h,...f])},[e,r]),p.useEffect(()=>{if(!e||e.role!=="resident")return;const g=async()=>{try{const h=(await u("/api/marketplace/orders?status=delivered"))?.orders||[],b=Fe(),w=h.filter(j=>j.status==="delivered"&&!j.rating&&!b.has(`delivery-completed-${j.id}`)).map(j=>(it(`delivery-completed-${j.id}`),{id:`delivery-completed-${j.id}`,type:"delivery_completed",title:"Заказ доставлен!",message:`Ваш заказ ${j.order_number} успешно доставлен. Пожалуйста, оцените доставку.`,actionLabel:"Оценить доставку",onAction:()=>{sessionStorage.setItem("open_delivery_rating_for_order",j.id),window.location.pathname!=="/marketplace"?window.location.href="/marketplace":window.dispatchEvent(new CustomEvent("openDeliveryRatingModal",{detail:{orderId:j.id}}))}}));w.length>0&&o(j=>[...j,...w])}catch{}};g();const m=setInterval(g,15e3);return()=>clearInterval(m)},[e]);const l=p.useCallback(g=>{o(m=>m.filter(f=>f.id!==g))},[]),d=p.useCallback(g=>{const m=`custom-${Date.now()}`;o(f=>[...f,{...g,id:m}])},[]);return{popups:a,dismissPopup:l,addPopup:d}}const pt=new Set;function _s(e){return pt.add(e),()=>pt.delete(e)}function Rt(e){pt.forEach(s=>s(e))}const nr=new Set;function rr(e){nr.forEach(s=>s(e))}function sr(){const{user:e,token:s}=U(),{fetchRequests:t,fetchExecutors:n,fetchAnnouncements:r,fetchPendingReschedules:a}=G(),{fetchMeetings:o}=Ke(),c=p.useRef(null),l=p.useRef(null),d=p.useRef(0),g=p.useRef(null),m=p.useRef(0),f=10,h=500,b=3e4,y=p.useCallback(async()=>{if(!e)return;const R=Date.now();if(!(R-m.current<h)){m.current=R;try{const T=[t()];["manager","admin","director","dispatcher","department_head"].includes(e.role)&&T.push(n()),await Promise.all(T)}catch{}}},[e,t,n]),w=p.useCallback(async()=>{if(e)try{await o()}catch{}},[e,o]),j=p.useCallback(()=>{g.current&&clearInterval(g.current),g.current=setInterval(()=>{c.current?.readyState===WebSocket.OPEN&&c.current.send(JSON.stringify({type:"ping"}))},b)},[]),O=p.useCallback(()=>{g.current&&(clearInterval(g.current),g.current=null)},[]),I=p.useCallback(()=>{if(!e||!s)return;c.current&&(c.current.close(),c.current=null);const T=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/api/ws?token=${s}`;try{const P=new WebSocket(T);c.current=P,P.onopen=()=>{d.current=0,j()},P.onmessage=async x=>{try{const _=JSON.parse(x.data);switch(_.type){case"connected":await y(),await w();break;case"pong":break;case"request_update":await y();break;case"meeting_update":if(await w(),_.data?.meetings&&_.data.meetings.length>0){const A=_.data.meetings.find(C=>C.status==="voting_open"||C.status==="schedule_poll_open");A&&await te.show({title:"📢 Собрание жильцов",body:A.status==="voting_open"?"Голосование открыто! Примите участие в собрании.":"Новое собрание объявлено. Выберите удобную дату.",tag:`meeting-${A.id}`,requireInteraction:!0,data:{url:"/meetings"}})}break;case"announcement_update":await r();break;case"chat_message":Rt(_.data?.message||_.data);break;case"chat_read":Rt({type:"read",..._.data});break;case"executor_update":["manager","admin","director","dispatcher","department_head"].includes(e.role)&&await n();break;case"reschedule_update":await a(),_.data?.reschedule&&rr(_.data.reschedule);break;default:}}catch{}},P.onerror=x=>{},P.onclose=x=>{if(O(),c.current=null,d.current<f){const _=Math.min(1e3*Math.pow(2,d.current),3e4);l.current=setTimeout(()=>{d.current++,I()},_)}}}catch{}},[e,s,y,w,j,O,a]);return p.useEffect(()=>{if(!e||!s){c.current&&(c.current.close(),c.current=null),O();return}return y(),w(),I(),()=>{c.current&&(c.current.close(),c.current=null),l.current&&clearTimeout(l.current),O()}},[e,s,I,y,w,O]),p.useEffect(()=>{const R=()=>{document.hidden||(y(),w(),(!c.current||c.current.readyState===WebSocket.CLOSED)&&(d.current=0,I()))};return document.addEventListener("visibilitychange",R),()=>{document.removeEventListener("visibilitychange",R)}},[I,y,w]),{refresh:p.useCallback(()=>{y(),w()},[y,w])}}function ar({type:e,title:s,message:t,onClose:n,onAction:r,actionLabel:a,autoClose:o=0}){const[c,l]=p.useState(!1);p.useEffect(()=>{if(o>0){const b=setTimeout(()=>d(),o);return()=>clearTimeout(b)}},[o]);const d=()=>{l(!0),setTimeout(()=>n(),300)},g=()=>{r&&r(),d()},m=()=>{switch(e){case"announcement_urgent":return i.jsx(zt,{className:"w-8 h-8 text-red-500"});case"announcement_meeting":return i.jsx(M,{className:"w-8 h-8 text-blue-500"});case"request_completed":return i.jsx(Je,{className:"w-8 h-8 text-green-500"});case"delivery_completed":return i.jsx(gn,{className:"w-8 h-8 text-orange-500"});default:return i.jsx(ge,{className:"w-8 h-8 text-yellow-500"})}},f=()=>{switch(e){case"announcement_urgent":return"bg-gradient-to-br from-red-50 to-orange-50 border-red-200";case"announcement_meeting":return"bg-gradient-to-br from-blue-50 to-indigo-50 border-blue-200";case"request_completed":return"bg-gradient-to-br from-green-50 to-emerald-50 border-green-200";case"delivery_completed":return"bg-gradient-to-br from-orange-50 to-amber-50 border-orange-200";default:return"bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200"}},h=()=>{switch(e){case"announcement_urgent":return"bg-red-500 hover:bg-red-600 text-white";case"announcement_meeting":return"bg-blue-500 hover:bg-blue-600 text-white";case"request_completed":return"bg-green-500 hover:bg-green-600 text-white";case"delivery_completed":return"bg-orange-500 hover:bg-orange-600 text-white";default:return"bg-orange-400 hover:bg-orange-500 text-black"}};return i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:i.jsxs("div",{className:`
          relative w-full max-w-sm rounded-2xl border-2 shadow-2xl p-6
          ${f()}
          ${c?"animate-out zoom-out-95 fade-out duration-300":"animate-in zoom-in-95 fade-in duration-300"}
        `,children:[i.jsx("button",{onClick:d,className:"absolute top-3 right-3 p-2 rounded-full hover:bg-black/10 transition-colors",children:i.jsx(He,{className:"w-5 h-5 text-gray-500"})}),i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx("div",{className:"w-16 h-16 rounded-full bg-white shadow-lg flex items-center justify-center",children:m()})}),i.jsx("h3",{className:"text-xl font-bold text-center text-gray-900 mb-2",children:s}),i.jsx("p",{className:"text-center text-gray-600 mb-6 leading-relaxed",children:t}),i.jsxs("div",{className:"flex flex-col gap-2",children:[r&&a&&i.jsx("button",{onClick:g,className:`w-full py-3 px-4 rounded-xl font-semibold transition-colors ${h()}`,children:a}),i.jsx("button",{onClick:d,className:"w-full py-3 px-4 rounded-xl font-medium text-gray-600 hover:bg-black/5 transition-colors",children:"Закрыть"})]})]})})}function ir({popups:e,onDismiss:s}){const t=e[0];return t?i.jsx(ar,{type:t.type,title:t.title,message:t.message,actionLabel:t.actionLabel,onAction:t.onAction,onClose:()=>s(t.id)}):null}const Dt=p.memo(({enabled:e=!1,position:s="bottom-right"})=>{const[t,n]=p.useState({fps:60,memory:0,renderTime:0,apiLatency:0}),[r,a]=p.useState(!1);if(p.useEffect(()=>{if(!e)return;let l=0,d=performance.now(),g;const m=()=>{l++;const w=performance.now();if(w>=d+1e3){const j=Math.round(l*1e3/(w-d));l=0,d=w,n(O=>({...O,fps:j}))}g=requestAnimationFrame(m)};g=requestAnimationFrame(m);const f=setInterval(()=>{if("memory"in performance){const w=performance.memory,j=Math.round(w.usedJSHeapSize/1024/1024);n(O=>({...O,memory:j}))}},1e3),h=setInterval(()=>{if(window.perfMonitor){const j=window.perfMonitor.getAverages().filter(O=>O.name.startsWith("render:"));if(j.length>0){const O=j.reduce((I,N)=>I+N.avg,0)/j.length;n(I=>({...I,renderTime:Math.round(O)}))}}},2e3),b=window.fetch;let y=[];return window.fetch=async(...w)=>{const j=performance.now(),O=await b(...w),I=performance.now()-j;if(typeof w[0]=="string"&&w[0].includes("/api/")){y.push(I),y.length>10&&(y=y.slice(-10));const N=y.reduce((R,T)=>R+T,0)/y.length;n(R=>({...R,apiLatency:Math.round(N)}))}return O},()=>{cancelAnimationFrame(g),clearInterval(f),clearInterval(h),window.fetch=b}},[e]),!e)return null;const o={"top-left":"top-4 left-4","top-right":"top-4 right-4","bottom-left":"bottom-4 left-4","bottom-right":"bottom-4 right-4"},c=(l,d)=>{const m={fps:{good:55,warning:30},memory:{good:100,warning:150},renderTime:{good:50,warning:100},apiLatency:{good:200,warning:500}}[l];return l==="fps"?d>=m.good?"text-green-500":d>=m.warning?"text-yellow-500":"text-red-500":d<=m.good?"text-green-500":d<=m.warning?"text-yellow-500":"text-red-500"};return i.jsxs("div",{className:`fixed ${o[s]} z-50 bg-gray-900/95 backdrop-blur-sm rounded-lg shadow-2xl border border-gray-700 transition-all duration-200 ${r?"w-64":"w-12 h-12"}`,children:[i.jsx("button",{onClick:()=>a(!r),className:"w-full h-12 flex items-center justify-center text-gray-400 hover:text-white transition-colors",title:"Performance Monitor",children:i.jsx(Ze,{className:"w-5 h-5"})}),r&&i.jsxs("div",{className:"px-3 pb-3 space-y-2 text-xs",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ze,{className:"w-4 h-4 text-purple-400"}),i.jsx("span",{className:"text-gray-400",children:"FPS"})]}),i.jsx("span",{className:`font-mono font-bold ${c("fps",t.fps)}`,children:t.fps})]}),t.memory>0&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(pn,{className:"w-4 h-4 text-blue-400"}),i.jsx("span",{className:"text-gray-400",children:"Memory"})]}),i.jsxs("span",{className:`font-mono font-bold ${c("memory",t.memory)}`,children:[t.memory," MB"]})]}),t.renderTime>0&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Pt,{className:"w-4 h-4 text-green-400"}),i.jsx("span",{className:"text-gray-400",children:"Render"})]}),i.jsxs("span",{className:`font-mono font-bold ${c("renderTime",t.renderTime)}`,children:[t.renderTime," ms"]})]}),t.apiLatency>0&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ze,{className:"w-4 h-4 text-yellow-400"}),i.jsx("span",{className:"text-gray-400",children:"API"})]}),i.jsxs("span",{className:`font-mono font-bold ${c("apiLatency",t.apiLatency)}`,children:[t.apiLatency," ms"]})]}),i.jsx("div",{className:"pt-2 border-t border-gray-700",children:i.jsx("div",{className:"flex items-center gap-2",children:t.fps>=55&&t.renderTime<=50&&t.apiLatency<=200?i.jsxs(i.Fragment,{children:[i.jsx(Je,{className:"w-4 h-4 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Excellent"})]}):t.fps>=30&&t.renderTime<=100&&t.apiLatency<=500?i.jsxs(i.Fragment,{children:[i.jsx(ct,{className:"w-4 h-4 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500 font-medium",children:"Good"})]}):i.jsxs(i.Fragment,{children:[i.jsx(ct,{className:"w-4 h-4 text-red-500"}),i.jsx("span",{className:"text-red-500 font-medium",children:"Poor"})]})})}),i.jsxs("div",{className:"pt-2 border-t border-gray-700 flex gap-2",children:[i.jsx("button",{onClick:()=>{window.perfReport&&window.perfReport()},className:"flex-1 px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-gray-300 hover:text-white transition-colors",children:"Report"}),i.jsx("button",{onClick:()=>{window.perfMonitor&&window.perfMonitor.clear()},className:"flex-1 px-2 py-1 bg-gray-800 hover:bg-gray-700 rounded text-gray-300 hover:text-white transition-colors",children:"Clear"})]})]})]})});Dt.displayName="PerformanceMonitor";const or=()=>i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(Et,{className:"w-8 h-8 animate-spin text-blue-600"})}),cr=p.lazy(()=>S(()=>import("./ManagerDashboard-1768932757711-DSjr5U0w.js"),__vite__mapDeps([0,1,2,3,4,5,6,7])).then(e=>({default:e.ManagerDashboard}))),lr=p.lazy(()=>S(()=>import("./DepartmentHeadDashboard-1768932757711-D0-eCE3W.js"),__vite__mapDeps([8,1,2,3,4,5,6])).then(e=>({default:e.DepartmentHeadDashboard}))),dr=p.lazy(()=>S(()=>import("./ExecutorDashboard-1768932757711-Cy9ROWZH.js"),__vite__mapDeps([9,1,2,3,4,7])).then(e=>({default:e.ExecutorDashboard}))),ur=p.lazy(()=>S(()=>import("./ExecutorSchedulePage-1768932757711-BrvuSqYt.js"),__vite__mapDeps([10,1,2,3,4])).then(e=>({default:e.ExecutorSchedulePage}))),mr=p.lazy(()=>S(()=>import("./ExecutorStatsPage-1768932757711-RSMifDbB.js"),__vite__mapDeps([11,1,2,3,4])).then(e=>({default:e.ExecutorStatsPage}))),gr=p.lazy(()=>S(()=>import("./ExecutorAnnouncementsPage-1768932757711-DTdNWky1.js"),__vite__mapDeps([12,1,2,3,4])).then(e=>({default:e.ExecutorAnnouncementsPage}))),pr=p.lazy(()=>S(()=>import("./ResidentDashboard-1768932757711-BZe1JmRA.js"),__vite__mapDeps([13,1,2,3,4,7])).then(e=>({default:e.ResidentDashboard}))),hr=p.lazy(()=>S(()=>import("./AdminDashboard-1768932757711-64VgSxW1.js"),__vite__mapDeps([14,1,2,3,4])).then(e=>({default:e.AdminDashboard}))),yr=p.lazy(()=>S(()=>import("./DirectorDashboard-1768932757711-B5rnPIC7.js"),__vite__mapDeps([15,1,2,3,4,5,6,7])).then(e=>({default:e.DirectorDashboard}))),fr=p.lazy(()=>S(()=>import("./BuildingsPage-1768932757711-QkUXHkeS.js"),__vite__mapDeps([16,1,2,3,4])).then(e=>({default:e.BuildingsPage}))),br=p.lazy(()=>S(()=>import("./AnnouncementsPage-1768932757711-Dba57RfE.js"),__vite__mapDeps([17,1,2,3,4])).then(e=>({default:e.AnnouncementsPage}))),vr=p.lazy(()=>S(()=>import("./MeetingsPage-1768932757711-CGccnF0z.js"),__vite__mapDeps([18,1,2,3,4])).then(e=>({default:e.MeetingsPage}))),xr=p.lazy(()=>S(()=>import("./ResidentAnnouncementsPage-1768932757711-DKYbHZS3.js"),__vite__mapDeps([19,1,2,3,4])).then(e=>({default:e.ResidentAnnouncementsPage}))),wr=p.lazy(()=>S(()=>import("./ResidentMeetingsPage-1768932757711-CXPhkWgP.js"),__vite__mapDeps([20,1,2,3,4,21])).then(e=>({default:e.ResidentMeetingsPage}))),_r=p.lazy(()=>S(()=>import("./ResidentRateEmployeesPage-1768932757711-BtG2mAxe.js"),__vite__mapDeps([22,1,2,3,4])).then(e=>({default:e.ResidentRateEmployeesPage}))),Ar=p.lazy(()=>S(()=>import("./WorkOrdersPage-1768932757711-DsQqNjuR.js"),__vite__mapDeps([23,1,2,3,4])).then(e=>({default:e.WorkOrdersPage}))),Sr=p.lazy(()=>S(()=>import("./TrainingsPage-1768932757711-BN5wiTSR.js"),__vite__mapDeps([24,1,2,3,4]))),Nr=p.lazy(()=>S(()=>import("./ColleaguesSection-1768932757711-CxTai_k0.js"),__vite__mapDeps([25,1,2,3,4])).then(e=>({default:e.ColleaguesSection}))),jr=p.lazy(()=>S(()=>import("./ResidentVehiclesPage-1768932757711-Bdb0iGmF.js"),__vite__mapDeps([26,1,2,3,4])).then(e=>({default:e.ResidentVehiclesPage}))),kr=p.lazy(()=>S(()=>import("./VehicleSearchPage-1768932757711-BBlAhQNG.js"),__vite__mapDeps([27,1,2,3,4])).then(e=>({default:e.VehicleSearchPage}))),Rr=p.lazy(()=>S(()=>import("./ResidentGuestAccessPage-1768932757711-BQtSyw63.js"),__vite__mapDeps([28,1,2,3,4,21])).then(e=>({default:e.ResidentGuestAccessPage}))),Tr=p.lazy(()=>S(()=>import("./GuardQRScannerPage-1768932757711-BzVMWyw9.js"),__vite__mapDeps([29,1,2,3,4])).then(e=>({default:e.GuardQRScannerPage}))),qr=p.lazy(()=>S(()=>import("./ManagerGuestAccessPage-1768932757711-U9qAiKUA.js"),__vite__mapDeps([30,1,2,3,4])).then(e=>({default:e.ManagerGuestAccessPage}))),Or=p.lazy(()=>S(()=>import("./ResidentsPage-1768932757711-CrFfuX0_.js"),__vite__mapDeps([31,1,2,3,4])).then(e=>({default:e.ResidentsPage}))),Ir=p.lazy(()=>S(()=>import("./ChatPage-1768932757711-fKnKiPBJ.js"),__vite__mapDeps([32,1,2,3,4])).then(e=>({default:e.ChatPage}))),Pr=p.lazy(()=>S(()=>import("./ResidentProfilePage-1768932757711-B-dh1Lbz.js"),__vite__mapDeps([33,1,2,3,4,21,34])).then(e=>({default:e.ResidentProfilePage}))),zr=p.lazy(()=>S(()=>import("./ResidentContractPage-1768932757711-BMvoaDFm.js"),__vite__mapDeps([35,1,2,3,4,21,34])).then(e=>({default:e.ResidentContractPage}))),Er=p.lazy(()=>S(()=>import("./ResidentUsefulContactsPage-1768932757711-C1F1oMiI.js"),__vite__mapDeps([36,1,2,3,4]))),Cr=p.lazy(()=>S(()=>import("./AdvertiserDashboard-1768932757711-6j9mc1XA.js"),__vite__mapDeps([37,1,2,3,4])).then(e=>({default:e.AdvertiserDashboard}))),Lr=p.lazy(()=>S(()=>import("./CouponCheckerDashboard-1768932757711-mY7_yOFC.js"),__vite__mapDeps([38,1,2,3,4])).then(e=>({default:e.CouponCheckerDashboard}))),$r=p.lazy(()=>S(()=>import("./NotepadPage-1768932757711-YFdZwGgM.js"),__vite__mapDeps([39,1,2,3,4])).then(e=>({default:e.NotepadPage}))),Mr=p.lazy(()=>S(()=>import("./TenantDashboard-1768932757711-oNWZzJfM.js"),__vite__mapDeps([40,1,2,3,4])).then(e=>({default:e.TenantDashboard}))),Ur=p.lazy(()=>S(()=>import("./ExecutorsPage-1768932757711-ChQaiWbn.js"),__vite__mapDeps([41,1,2,3,4])).then(e=>({default:e.ExecutorsPage}))),Br=p.lazy(()=>S(()=>import("./RequestsPage-1768932757711-jxDhP2a4.js"),__vite__mapDeps([42,1,2,3,4,7])).then(e=>({default:e.RequestsPage}))),Dr=p.lazy(()=>S(()=>import("./RentalsPage-1768932757711-BZX1dhAJ.js"),__vite__mapDeps([43,1,2,3,4])).then(e=>({default:e.RentalsPage}))),Vr=p.lazy(()=>S(()=>import("./TeamPage-1768932757711-D4y-8bW_.js"),__vite__mapDeps([44,1,2,3,4])).then(e=>({default:e.TeamPage}))),Fr=p.lazy(()=>S(()=>import("./ReportsPage-1768932757711-BtgGAc1T.js"),__vite__mapDeps([45,1,2,3,4])).then(e=>({default:e.ReportsPage}))),Jr=p.lazy(()=>S(()=>import("./SettingsPage-1768932757711-lYA971fi.js"),__vite__mapDeps([46,1,2,3,4])).then(e=>({default:e.SettingsPage}))),Hr=p.lazy(()=>S(()=>import("./MonitoringPage-1768932757711-BApz3j5k.js"),__vite__mapDeps([47,1,2,3,4,5,6])).then(e=>({default:e.MonitoringPage}))),Kr=p.lazy(()=>S(()=>import("./MarketplacePage-1768932757711-dJSQ2SpJ.js"),__vite__mapDeps([48,1,2,3,4])).then(e=>({default:e.MarketplacePage}))),Tt=p.lazy(()=>S(()=>import("./MarketplaceManagerDashboard-1768932757711-jKcwjfWN.js"),__vite__mapDeps([49,1,2,3,4])).then(e=>({default:e.MarketplaceManagerDashboard}))),Yr=p.lazy(()=>S(()=>import("./MarketplaceOrdersPage-1768932757711-Ci24qOHw.js"),__vite__mapDeps([50,1,2,3,4])).then(e=>({default:e.MarketplaceOrdersPage})));function Gr(){const e=qt(),{user:s,logout:t}=U(),[n,r]=p.useState(!1),{getUnreadCount:a,fetchAnnouncements:o}=G(),c=s?a(s.id):0,{popups:l,dismissPopup:d}=tr();sr(),p.useEffect(()=>{o()},[o]),p.useEffect(()=>{r(!1)},[e.pathname]);const g=()=>{if(s?.account_type==="advertiser"||s?.role==="advertiser")return i.jsx(Cr,{});if(s?.account_type==="coupon_checker"||s?.role==="coupon_checker")return i.jsx(Lr,{});if(s?.role==="marketplace_manager")return i.jsx(Tt,{});switch(s?.role){case"admin":return i.jsx(hr,{});case"director":return i.jsx(yr,{});case"department_head":return i.jsx(lr,{});case"executor":return i.jsx(dr,{});case"resident":return i.jsx(pr,{});case"tenant":case"commercial_owner":return i.jsx(Mr,{});default:return i.jsx(cr,{})}},m=()=>s?.role==="resident"?i.jsx(xr,{}):s?.role==="executor"?i.jsx(gr,{}):i.jsx(br,{}),f=()=>s?.role==="resident"?i.jsx(wr,{}):i.jsx(vr,{}),h=()=>s?.role==="resident"?i.jsx(Rr,{}):i.jsx(qr,{});return i.jsxs("div",{className:"min-h-screen min-h-dvh",children:[i.jsx(Wn,{onLogout:t,isOpen:n,onClose:()=>r(!1)}),i.jsx(Xn,{onMenuClick:()=>r(!0),unreadCount:c}),i.jsxs("div",{className:"main-content",children:[i.jsx("div",{className:"hide-mobile",children:i.jsx(er,{})}),i.jsx("main",{className:"p-4 md:p-6 page-content",children:i.jsx(p.Suspense,{fallback:i.jsx(or,{}),children:i.jsxs(hn,{children:[i.jsx(q,{path:"/",element:g()}),i.jsx(q,{path:"/requests",element:i.jsx(Br,{})}),i.jsx(q,{path:"/residents",element:i.jsx(Or,{})}),i.jsx(q,{path:"/executors",element:i.jsx(Ur,{})}),i.jsx(q,{path:"/rentals",element:i.jsx(Dr,{})}),i.jsx(q,{path:"/buildings",element:i.jsx(fr,{})}),i.jsx(q,{path:"/work-orders",element:i.jsx(Ar,{})}),i.jsx(q,{path:"/meetings",element:f()}),i.jsx(q,{path:"/announcements",element:m()}),i.jsx(q,{path:"/schedule",element:i.jsx(ur,{})}),i.jsx(q,{path:"/stats",element:i.jsx(mr,{})}),i.jsx(q,{path:"/rate-employees",element:i.jsx(_r,{})}),i.jsx(q,{path:"/vehicles",element:i.jsx(jr,{})}),i.jsx(q,{path:"/vehicle-search",element:i.jsx(kr,{})}),i.jsx(q,{path:"/guest-access",element:h()}),i.jsx(q,{path:"/qr-scanner",element:i.jsx(Tr,{})}),i.jsx(q,{path:"/chat",element:i.jsx(Ir,{})}),i.jsx(q,{path:"/profile",element:i.jsx(Pr,{})}),i.jsx(q,{path:"/contract",element:i.jsx(zr,{})}),i.jsx(q,{path:"/useful-contacts",element:i.jsx(Er,{})}),i.jsx(q,{path:"/colleagues",element:i.jsx(Nr,{})}),i.jsx(q,{path:"/notepad",element:i.jsx($r,{})}),i.jsx(q,{path:"/trainings",element:i.jsx(Sr,{})}),i.jsx(q,{path:"/team",element:i.jsx(Vr,{})}),i.jsx(q,{path:"/reports",element:i.jsx(Fr,{})}),i.jsx(q,{path:"/settings",element:i.jsx(Jr,{})}),i.jsx(q,{path:"/monitoring",element:i.jsx(Hr,{})}),i.jsx(q,{path:"/marketplace",element:i.jsx(Kr,{})}),i.jsx(q,{path:"/marketplace-orders",element:i.jsx(Yr,{})}),i.jsx(q,{path:"/marketplace-products",element:i.jsx(Tt,{})})]})})})]}),i.jsx(ir,{popups:l,onDismiss:d}),i.jsx(Dt,{})]})}const Qr=[{login:"director",password:"kamizo",role:"director",labelRu:"Директор",labelUz:"Direktor",icon:vn,color:"bg-rose-600"},{login:"manager",password:"kamizo",role:"manager",labelRu:"Управляющий",labelUz:"Boshqaruvchi",icon:xn,color:"bg-blue-500"},{login:"department_head",password:"kamizo",role:"department_head",labelRu:"Глава отдела",labelUz:"Bo'lim boshlig'i",icon:wn,color:"bg-indigo-500"},{login:"resident",password:"kamizo",role:"resident",labelRu:"Житель",labelUz:"Aholi",icon:M,color:"bg-green-500"},{login:"executor",password:"kamizo",role:"executor",labelRu:"Исполнитель",labelUz:"Ijrochi",icon:be,color:"bg-amber-500"},{login:"security",password:"kamizo",role:"security",labelRu:"Охранник",labelUz:"Qo'riqchi",icon:_n,color:"bg-slate-500"}];function Wr(){const{login:e,isLoading:s,error:t}=U(),{language:n,setLanguage:r,t:a}=Bt(),[o,c]=p.useState(""),[l,d]=p.useState(""),[g,m]=p.useState(!1),[f,h]=p.useState(""),[b,y]=p.useState(!1),[w,j]=p.useState(!1),[O,I]=p.useState(!1),N=p.useRef(null),R=[{code:"ru",label:"RU",flag:"🇷🇺"},{code:"uz",label:"UZ",flag:"🇺🇿"}],T=()=>{if(N.current){const{scrollTop:A,scrollHeight:C,clientHeight:D}=N.current;A+D>=C-50&&I(!0)}};p.useEffect(()=>{w&&(I(!1),setTimeout(()=>{if(N.current){const{scrollHeight:A,clientHeight:C}=N.current;C>=A&&I(!0)}},100))},[w]);const P=()=>{y(!0),j(!1)},x=async A=>{if(A.preventDefault(),h(""),!b){h(n==="ru"?"Необходимо принять условия публичной оферты":"Ommaviy oferta shartlarini qabul qilish kerak");return}try{await e(o,l)||h(n==="ru"?"Неверный логин или пароль":"Login yoki parol noto'g'ri")}catch{h(n==="ru"?"Ошибка при входе":"Kirishda xatolik")}},_=f||t;return i.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 relative overflow-hidden",children:[i.jsx("div",{className:"absolute top-4 right-4 z-20",children:i.jsx("div",{className:"flex items-center gap-1 bg-white/80 backdrop-blur-sm rounded-xl p-1 shadow-sm",children:R.map(A=>i.jsxs("button",{onClick:()=>r(A.code),className:`flex items-center gap-1 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors touch-manipulation ${n===A.code?"bg-orange-400 text-gray-900":"hover:bg-gray-100 text-gray-600"}`,children:[i.jsx("span",{children:A.flag}),i.jsx("span",{children:A.label})]},A.code))})}),i.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-primary-300/30 rounded-full blur-3xl"}),i.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-primary-200/40 rounded-full blur-3xl"}),i.jsx("div",{className:"absolute top-1/2 left-1/3 w-64 h-64 bg-orange-200/30 rounded-full blur-3xl"}),i.jsxs("div",{className:"glass-card p-6 md:p-8 w-full max-w-md relative z-10",children:[i.jsx("div",{className:"text-center mb-6 md:mb-8",children:i.jsxs("div",{className:"flex items-center justify-center gap-5",children:[i.jsx(yt,{size:"xl"}),i.jsxs("div",{className:"text-left",children:[i.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900",children:"kamizo"}),i.jsx("p",{className:"text-gray-500 text-sm md:text-base",children:n==="ru"?"Управление жильём":"Uy-joy boshqaruvi"})]})]})}),i.jsxs("form",{onSubmit:x,className:"space-y-4 md:space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 md:mb-2",children:a("auth.login")}),i.jsx("input",{type:"text",value:o,onChange:A=>c(A.target.value),placeholder:n==="ru"?"Введите логин":"Login kiriting",className:"glass-input text-base",required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5 md:mb-2",children:a("auth.password")}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:g?"text":"password",value:l,onChange:A=>d(A.target.value),placeholder:n==="ru"?"Введите пароль":"Parol kiriting",className:"glass-input pr-12 text-base",required:!0}),i.jsx("button",{type:"button",onClick:A=>{A.preventDefault(),A.stopPropagation(),m(!g)},className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 active:text-gray-800 touch-manipulation p-2 z-10","aria-label":g?"Скрыть пароль":"Показать пароль",children:g?i.jsx(yn,{className:"w-5 h-5"}):i.jsx(fn,{className:"w-5 h-5"})})]})]}),_&&i.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-xl text-red-600 text-sm",children:[i.jsx(ct,{className:"w-4 h-4 flex-shrink-0"}),_]}),i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("button",{type:"button",onClick:()=>{b?y(!1):j(!0)},className:`flex-shrink-0 w-11 h-11 md:w-6 md:h-6 rounded-lg md:rounded border-2 flex items-center justify-center transition-colors touch-manipulation active:scale-95 ${b?"bg-orange-400 border-orange-400":"border-gray-300 hover:border-orange-400 bg-white/50"}`,children:b&&i.jsx(bn,{className:"w-5 h-5 md:w-4 md:h-4 text-gray-800"})}),i.jsx("div",{className:"text-sm text-gray-600",children:n==="ru"?i.jsxs(i.Fragment,{children:["Я согласен с условиями"," ",i.jsx("button",{type:"button",onClick:()=>j(!0),className:"text-orange-600 hover:text-orange-700 underline font-medium touch-manipulation",children:"публичной оферты"})]}):i.jsxs(i.Fragment,{children:["Men"," ",i.jsx("button",{type:"button",onClick:()=>j(!0),className:"text-orange-600 hover:text-orange-700 underline font-medium touch-manipulation",children:"ommaviy oferta"})," ","shartlariga roziman"]})})]}),i.jsx("button",{type:"submit",disabled:s||!b,className:"btn-primary w-full text-center disabled:opacity-50 py-3 text-base touch-manipulation",children:s?n==="ru"?"Вход...":"Kirish...":a("auth.enter")})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[i.jsx("p",{className:"text-xs text-gray-500 text-center mb-3",children:n==="ru"?"Демо-входы для тестирования:":"Test uchun demo-kirish:"}),i.jsx("div",{className:"grid grid-cols-2 gap-2",children:Qr.map(A=>{const C=A.icon;return i.jsxs("button",{type:"button",onClick:()=>{c(A.login),d(A.password),b||j(!0)},className:"flex items-center gap-2 px-3 py-2 bg-gray-50 hover:bg-gray-100 active:bg-gray-200 rounded-xl transition-colors touch-manipulation text-left",children:[i.jsx("div",{className:`w-7 h-7 ${A.color} rounded-lg flex items-center justify-center flex-shrink-0`,children:i.jsx(C,{className:"w-4 h-4 text-white"})}),i.jsx("span",{className:"text-xs font-medium text-gray-700 truncate",children:n==="ru"?A.labelRu:A.labelUz})]},A.login)})})]})]}),w&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-end sm:items-center justify-center z-50 p-0 sm:p-4",children:i.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl shadow-2xl w-full sm:max-w-2xl max-h-[95vh] sm:max-h-[90vh] flex flex-col",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[i.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-orange-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(ne,{className:"w-4 h-4 sm:w-5 sm:h-5 text-orange-600"})}),i.jsx("h2",{className:"text-base sm:text-lg md:text-xl font-bold text-gray-900",children:n==="ru"?"Публичная оферта":"Ommaviy oferta"})]}),i.jsx("button",{onClick:()=>j(!1),className:"p-2 hover:bg-gray-100 active:bg-gray-200 rounded-xl transition-colors touch-manipulation",children:i.jsx(He,{className:"w-5 h-5 text-gray-500"})})]}),i.jsx("div",{ref:N,onScroll:T,className:"flex-1 overflow-y-auto p-4 md:p-6 text-sm text-gray-700 leading-relaxed",children:n==="ru"?i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-bold text-base",children:"ПУБЛИЧНАЯ ОФЕРТА"}),i.jsx("p",{className:"font-medium",children:'на оказание услуг управляющей компании "Kamizo"'}),i.jsx("h4",{className:"font-semibold mt-4",children:"1. ОБЩИЕ ПОЛОЖЕНИЯ"}),i.jsx("p",{children:'1.1. Настоящая публичная оферта (далее – «Оферта») является официальным предложением ООО "Kamizo" (далее – «Исполнитель») неограниченному кругу физических и юридических лиц (далее – «Заказчик») заключить договор на оказание услуг по управлению многоквартирным домом.'}),i.jsx("p",{children:"1.2. Полным и безоговорочным акцептом настоящей Оферты является регистрация Заказчика в системе и использование сервиса."}),i.jsx("p",{children:"1.3. Оферта вступает в силу с момента её акцепта и действует до полного исполнения сторонами своих обязательств."}),i.jsx("h4",{className:"font-semibold mt-4",children:"2. ПРЕДМЕТ ОФЕРТЫ"}),i.jsx("p",{children:"2.1. Исполнитель обязуется предоставлять Заказчику услуги по управлению многоквартирным домом, включая:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Техническое обслуживание и текущий ремонт общего имущества;"}),i.jsx("li",{children:"Санитарное содержание мест общего пользования;"}),i.jsx("li",{children:"Организация круглосуточной аварийно-диспетчерской службы;"}),i.jsx("li",{children:"Обеспечение сбора и вывоза твердых бытовых отходов;"}),i.jsx("li",{children:"Содержание придомовой территории;"}),i.jsx("li",{children:"Техническое обслуживание лифтов и инженерных систем;"}),i.jsx("li",{children:"Организация охраны и видеонаблюдения."})]}),i.jsx("h4",{className:"font-semibold mt-4",children:"3. ПРАВА И ОБЯЗАННОСТИ СТОРОН"}),i.jsx("p",{children:"3.1. Исполнитель обязуется:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Качественно и в срок выполнять заявки на обслуживание;"}),i.jsx("li",{children:"Обеспечить круглосуточный доступ к сервису подачи заявок;"}),i.jsx("li",{children:"Предоставлять отчёты о выполненных работах;"}),i.jsx("li",{children:"Соблюдать конфиденциальность персональных данных."})]}),i.jsx("p",{className:"mt-2",children:"3.2. Заказчик обязуется:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Своевременно вносить плату за оказанные услуги;"}),i.jsx("li",{children:"Обеспечивать доступ к помещению для выполнения работ;"}),i.jsx("li",{children:"Бережно относиться к общему имуществу дома;"}),i.jsx("li",{children:"Соблюдать правила проживания в многоквартирном доме."})]}),i.jsx("h4",{className:"font-semibold mt-4",children:"4. СТОИМОСТЬ И ПОРЯДОК ОПЛАТЫ"}),i.jsx("p",{children:"4.1. Стоимость услуг определяется согласно утверждённым тарифам управляющей компании."}),i.jsx("p",{children:"4.2. Оплата производится ежемесячно до 10 числа месяца, следующего за расчётным."}),i.jsx("p",{children:"4.3. При просрочке платежа начисляется пеня в размере 0,1% от суммы задолженности за каждый день просрочки."}),i.jsx("h4",{className:"font-semibold mt-4",children:"5. ОТВЕТСТВЕННОСТЬ СТОРОН"}),i.jsx("p",{children:"5.1. Стороны несут ответственность за неисполнение или ненадлежащее исполнение своих обязательств в соответствии с действующим законодательством."}),i.jsx("p",{children:"5.2. Исполнитель не несёт ответственности за ущерб, причинённый вследствие обстоятельств непреодолимой силы."}),i.jsx("h4",{className:"font-semibold mt-4",children:"6. ПЕРСОНАЛЬНЫЕ ДАННЫЕ"}),i.jsx("p",{children:"6.1. Заказчик даёт согласие на обработку персональных данных в соответствии с Политикой конфиденциальности."}),i.jsx("p",{children:"6.2. Персональные данные используются исключительно для оказания услуг и не передаются третьим лицам без согласия Заказчика."}),i.jsx("h4",{className:"font-semibold mt-4",children:"7. ПОРЯДОК РАЗРЕШЕНИЯ СПОРОВ"}),i.jsx("p",{children:"7.1. Все споры решаются путём переговоров."}),i.jsx("p",{children:"7.2. При невозможности достижения согласия спор передаётся на рассмотрение в суд по месту нахождения Исполнителя."}),i.jsx("h4",{className:"font-semibold mt-4",children:"8. ЗАКЛЮЧИТЕЛЬНЫЕ ПОЛОЖЕНИЯ"}),i.jsx("p",{children:"8.1. Настоящая Оферта может быть изменена Исполнителем в одностороннем порядке с уведомлением Заказчика не менее чем за 30 дней."}),i.jsx("p",{children:"8.2. Продолжение использования сервиса после внесения изменений означает согласие с новой редакцией Оферты."}),i.jsx("div",{className:"mt-6 p-4 bg-orange-50 rounded-xl border border-orange-200",children:i.jsx("p",{className:"font-medium text-orange-800",children:"Прокрутите до конца документа, чтобы принять условия оферты."})})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-bold text-base",children:"OMMAVIY OFERTA"}),i.jsx("p",{className:"font-medium",children:`"Kamizo" boshqaruv kompaniyasi xizmatlarini ko'rsatish bo'yicha`}),i.jsx("h4",{className:"font-semibold mt-4",children:"1. UMUMIY QOIDALAR"}),i.jsx("p",{children:`1.1. Ushbu ommaviy oferta (keyingi o'rinlarda - «Oferta») "Kamizo" MChJ (keyingi o'rinlarda - «Ijrochi») tomonidan cheklanmagan doiradagi jismoniy va yuridik shaxslarga (keyingi o'rinlarda - «Buyurtmachi») ko'p qavatli uyni boshqarish xizmatlarini ko'rsatish bo'yicha shartnoma tuzish haqidagi rasmiy taklifdir.`}),i.jsx("p",{children:"1.2. Ushbu Ofertaning to'liq va shartsiz aksepti - Buyurtmachining tizimda ro'yxatdan o'tishi va xizmatdan foydalanishidir."}),i.jsx("p",{children:"1.3. Oferta aksept qilingan paytdan boshlab kuchga kiradi va tomonlar o'z majburiyatlarini to'liq bajargunga qadar amal qiladi."}),i.jsx("h4",{className:"font-semibold mt-4",children:"2. OFERTA PREDMETI"}),i.jsx("p",{children:"2.1. Ijrochi Buyurtmachiga ko'p qavatli uyni boshqarish xizmatlarini ko'rsatishni o'z zimmasiga oladi, jumladan:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Umumiy mulkning texnik xizmati va joriy ta'miri;"}),i.jsx("li",{children:"Umumiy foydalanish joylarini sanitariya-gigienik holatda saqlash;"}),i.jsx("li",{children:"Kun-tun avariya-dispetcherlik xizmatini tashkil etish;"}),i.jsx("li",{children:"Qattiq maishiy chiqindilarni yig'ish va olib chiqishni ta'minlash;"}),i.jsx("li",{children:"Uy atrofi hududini saqlash;"}),i.jsx("li",{children:"Liftlar va muhandislik tizimlariga texnik xizmat ko'rsatish;"}),i.jsx("li",{children:"Qo'riqlash va video kuzatuvni tashkil etish."})]}),i.jsx("h4",{className:"font-semibold mt-4",children:"3. TOMONLARNING HUQUQ VA MAJBURIYATLARI"}),i.jsx("p",{children:"3.1. Ijrochi majburiyatlari:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Xizmat ko'rsatish bo'yicha arizalarni sifatli va o'z vaqtida bajarish;"}),i.jsx("li",{children:"Ariza berish xizmatiga kun-tun kirish imkoniyatini ta'minlash;"}),i.jsx("li",{children:"Bajarilgan ishlar bo'yicha hisobotlarni taqdim etish;"}),i.jsx("li",{children:"Shaxsiy ma'lumotlar maxfiyligini saqlash."})]}),i.jsx("p",{className:"mt-2",children:"3.2. Buyurtmachi majburiyatlari:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-1",children:[i.jsx("li",{children:"Ko'rsatilgan xizmatlar uchun o'z vaqtida to'lov qilish;"}),i.jsx("li",{children:"Ishlarni bajarish uchun xonaga kirishni ta'minlash;"}),i.jsx("li",{children:"Uyning umumiy mulkiga ehtiyotkorona munosabatda bo'lish;"}),i.jsx("li",{children:"Ko'p qavatli uyda yashash qoidalariga rioya qilish."})]}),i.jsx("h4",{className:"font-semibold mt-4",children:"4. NARX VA TO'LOV TARTIBI"}),i.jsx("p",{children:"4.1. Xizmatlar narxi boshqaruv kompaniyasining tasdiqlangan tariflariga muvofiq belgilanadi."}),i.jsx("p",{children:"4.2. To'lov hisob-kitob oyidan keyingi oyning 10-sanasigacha har oy amalga oshiriladi."}),i.jsx("p",{children:"4.3. To'lovni kechiktirgan taqdirda, har bir kechiktirilgan kun uchun qarz summasining 0,1% miqdorida jarima hisoblanadi."}),i.jsx("h4",{className:"font-semibold mt-4",children:"5. TOMONLARNING JAVOBGARLIGI"}),i.jsx("p",{children:"5.1. Tomonlar o'z majburiyatlarini bajarmaslik yoki lozim darajada bajarmaslik uchun amaldagi qonunchilikka muvofiq javobgar bo'ladi."}),i.jsx("p",{children:"5.2. Ijrochi fors-major holatlari tufayli yetkazilgan zarar uchun javobgar emas."}),i.jsx("h4",{className:"font-semibold mt-4",children:"6. SHAXSIY MA'LUMOTLAR"}),i.jsx("p",{children:"6.1. Buyurtmachi Maxfiylik siyosatiga muvofiq shaxsiy ma'lumotlarni qayta ishlashga rozilik beradi."}),i.jsx("p",{children:"6.2. Shaxsiy ma'lumotlar faqat xizmatlar ko'rsatish uchun ishlatiladi va Buyurtmachining roziligisiz uchinchi shaxslarga berilmaydi."}),i.jsx("h4",{className:"font-semibold mt-4",children:"7. NIZOLARNI HAL ETISH TARTIBI"}),i.jsx("p",{children:"7.1. Barcha nizolar muzokaralar yo'li bilan hal etiladi."}),i.jsx("p",{children:"7.2. Kelishuvga erishish imkonsiz bo'lganda, nizo Ijrochi joylashgan joy sudiga ko'rib chiqish uchun topshiriladi."}),i.jsx("h4",{className:"font-semibold mt-4",children:"8. YAKUNIY QOIDALAR"}),i.jsx("p",{children:"8.1. Ushbu Oferta Ijrochi tomonidan bir tomonlama tartibda, Buyurtmachini kamida 30 kun oldin xabardor qilgan holda o'zgartirilishi mumkin."}),i.jsx("p",{children:"8.2. O'zgartirishlar kiritilganidan keyin xizmatdan foydalanishni davom ettirish Ofertaning yangi tahririga rozilikni bildiradi."}),i.jsx("div",{className:"mt-6 p-4 bg-orange-50 rounded-xl border border-orange-200",children:i.jsx("p",{className:"font-medium text-orange-800",children:"Oferta shartlarini qabul qilish uchun hujjat oxirigacha aylantiring."})})]})}),i.jsx("div",{className:"p-4 md:p-6 border-t border-gray-200 bg-gray-50 sm:rounded-b-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[i.jsx("p",{className:`text-xs sm:text-sm text-center sm:text-left ${O?"text-green-600":"text-gray-500"}`,children:O?n==="ru"?"✓ Вы прочитали документ":"✓ Siz hujjatni o'qidingiz":n==="ru"?"Прокрутите вниз для прочтения":"O'qish uchun pastga aylantiring"}),i.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[i.jsx("button",{onClick:()=>j(!1),className:"flex-1 sm:flex-none px-4 py-3 sm:py-2 text-gray-600 hover:bg-gray-100 active:bg-gray-200 rounded-xl transition-colors touch-manipulation text-sm sm:text-base",children:n==="ru"?"Закрыть":"Yopish"}),i.jsx("button",{onClick:P,disabled:!O,className:`flex-1 sm:flex-none px-6 py-3 sm:py-2 rounded-xl font-medium transition-colors touch-manipulation text-sm sm:text-base ${O?"bg-orange-400 hover:bg-orange-500 active:bg-orange-600 text-gray-900":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:n==="ru"?"Принять":"Qabul qilish"})]})]})})]})})]})}function Xr(){const[e,s]=p.useState(!1),[t,n]=p.useState(!1),[r,a]=p.useState(!1),{user:o}=U();p.useEffect(()=>{if(!te.isBrowserNotificationsSupported())return;const d=te.getPermission(),g=`push_prompt_dismissed_${o?.id||"anon"}`,m=localStorage.getItem(g),f=m?parseInt(m):0,h=(Date.now()-f)/(1e3*60*60*24);if(d==="default"&&(!m||h>7)){const y=setTimeout(()=>s(!0),2e3);return()=>clearTimeout(y)}},[o?.id]);const c=async()=>{a(!0);try{const d=await te.subscribe();if("serviceWorker"in navigator)try{await(await navigator.serviceWorker.ready).showNotification("🔔 Уведомления включены!",{body:d?"Теперь вы будете получать уведомления от УК Kamizo даже когда приложение закрыто.":"Теперь вы будете получать важные уведомления о заявках и объявлениях.",icon:"/favicon.ico",badge:"/favicon.ico",tag:"welcome-notification",requireInteraction:!1})}catch{await te.show({title:"🔔 Уведомления включены!",body:"Теперь вы будете получать важные уведомления о заявках и объявлениях.",requireInteraction:!1})}else d||await te.requestPermission()&&await te.show({title:"Уведомления включены!",body:"Теперь вы будете получать важные уведомления о заявках и объявлениях.",requireInteraction:!1})}catch{}finally{a(!1),s(!1),n(!0)}},l=()=>{const d=`push_prompt_dismissed_${o?.id||"anon"}`;localStorage.setItem(d,Date.now().toString()),s(!1),n(!0)};return!e||t?null:i.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-96 z-50 animate-in slide-in-from-bottom-4 duration-300",children:i.jsx("div",{className:"bg-white rounded-xl shadow-xl border border-gray-200 p-4",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-yellow-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(ge,{className:"w-5 h-5 text-yellow-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Включить уведомления?"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Получайте мгновенные уведомления о завершении заявок, срочных объявлениях и собраниях жильцов."}),i.jsxs("div",{className:"flex gap-2 mt-3",children:[i.jsx("button",{onClick:c,disabled:r,className:"px-4 py-2 bg-orange-400 hover:bg-orange-500 text-black font-medium rounded-lg transition-colors text-sm disabled:opacity-50 flex items-center gap-2",children:r?i.jsxs(i.Fragment,{children:[i.jsx(Et,{className:"w-4 h-4 animate-spin"}),"Включение..."]}):"Разрешить"}),i.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors text-sm",children:"Позже"})]})]}),i.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 p-1",children:i.jsx(He,{className:"w-4 h-4"})})]})})})}class Zr extends p.Component{constructor(t){super(t);ae(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});ae(this,"handleReload",()=>{window.location.reload()});ae(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null,errorCount:0}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){this.setState(r=>({errorInfo:n,errorCount:r.errorCount+1})),this.logError(t,n),this.props.onError?.(t,n),this.sendToMonitoring(t,n)}logError(t,n){try{const r={timestamp:new Date().toISOString(),message:t.message,stack:t.stack,componentStack:n.componentStack,userAgent:navigator.userAgent,url:window.location.href},a=JSON.parse(localStorage.getItem("error_logs")||"[]");a.push(r),a.length>50&&a.shift(),localStorage.setItem("error_logs",JSON.stringify(a))}catch{}}async sendToMonitoring(t,n){try{await fetch("/api/admin/monitoring/frontend-error",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({error:{message:t.message,stack:t.stack,name:t.name},componentStack:n.componentStack,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href,userId:localStorage.getItem("user_id")})})}catch{}}render(){return this.state.hasError?this.props.fallback?this.props.fallback:i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:i.jsx("div",{className:"max-w-2xl w-full",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8",children:[i.jsx("div",{className:"flex items-center justify-center mb-6",children:i.jsx("div",{className:"bg-red-100 rounded-full p-4",children:i.jsx(zt,{className:"w-12 h-12 text-red-600"})})}),i.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-4",children:"Упс! Что-то пошло не так"}),i.jsx("p",{className:"text-gray-600 text-center mb-6",children:"Произошла непредвиденная ошибка. Мы уже работаем над её исправлением."}),!1,i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsxs("button",{onClick:this.handleReset,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:[i.jsx(_t,{className:"w-5 h-5"}),"Попробовать снова"]}),i.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors",children:[i.jsx(Ot,{className:"w-5 h-5"}),"На главную"]}),i.jsxs("button",{onClick:this.handleReload,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-200 text-gray-900 rounded-lg hover:bg-gray-300 transition-colors",children:[i.jsx(_t,{className:"w-5 h-5"}),"Перезагрузить"]})]}),this.state.errorCount>1&&i.jsx("div",{className:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:i.jsxs("p",{className:"text-sm text-yellow-800 text-center",children:["⚠️ Ошибка повторяется (",this.state.errorCount," раз). Попробуйте перезагрузить страницу."]})}),i.jsx("p",{className:"text-sm text-gray-500 text-center mt-6",children:"Если проблема повторяется, обратитесь в службу поддержки или попробуйте позже."})]})})}):this.props.children}}function es(){const{user:e}=U(),{fetchBuildings:s}=Bn(),{fetchExecutors:t,fetchRequests:n,fetchVehicles:r}=G();return p.useEffect(()=>{e&&(s(),["admin","manager","department_head","dispatcher"].includes(e.role)&&t(),n(),e.role==="resident"&&r())},[e,s,t,n,r]),i.jsx(Zr,{children:i.jsx(An,{children:e?i.jsxs(i.Fragment,{children:[i.jsx(Gr,{}),i.jsx(Xr,{})]}):i.jsx(Wr,{})})})}Sn.createRoot(document.getElementById("root")).render(i.jsx(p.StrictMode,{children:i.jsx(es,{})}));export{us as A,ps as B,_s as C,ms as D,os as E,qn as F,vs as G,te as H,V as I,gs as M,ds as P,xs as R,kt as S,ys as V,S as _,ws as a,U as b,ls as c,Bt as d,u as e,Mt as f,cs as g,Bn as h,Ke as i,de as j,$t as k,Mn as l,$n as m,zn as n,Ln as o,Cn as p,En as q,Pn as r,hs as s,On as t,G as u,fs as v,bs as w,le as x,ce as y,Lt as z};
//# sourceMappingURL=index-1768932757711-DHvFoTU4.js.map
