import{r as B,j as e,ac as z,B as F,H as ae,F as V,y as Z,m as A,h as le,A as U,Z as re,bg as H,O as _,N as q,ay as Y,bh as ne,ah as ie,aq as de,g as ce}from"./react-vendor-1769968761754-o8ep_QJr.js";import{u as oe,h as me,b as xe,S as C}from"./index-1769968761754-gKQ9-77E.js";import"./vendor-1769968761754-C4uPnf_k.js";import"./qr-scanner-1769968761754-B_vB3SDT.js";import"./zustand-1769968761754-wNUYBKDB.js";function Ne(){const{requests:k,executors:E}=oe(),{buildings:O,residents:W}=me(),{additionalUsers:G}=xe(),[R,J]=B.useState("week"),[b,I]=B.useState("all"),[D,P]=B.useState("general"),i=(()=>{const s=new Date;let l;switch(R){case"day":l=new Date(s.getFullYear(),s.getMonth(),s.getDate());break;case"week":l=new Date(s.getTime()-10080*60*1e3);break;case"month":l=new Date(s.getTime()-720*60*60*1e3);break;case"year":l=new Date(s.getTime()-365*24*60*60*1e3);break;default:l=new Date(0)}return k.filter(j=>new Date(j.createdAt)>=l)})(),y=O.map(s=>{const l=W.filter(a=>a.building_id===s.id||a.buildingId===s.id||a.apartmentId?.startsWith(s.id)).length,j=Object.values(G).filter(a=>a.user.role!=="resident"?!1:!!(a.user.buildingId===s.id||a.user.building_id===s.id||a.user.address&&(a.user.address.includes(s.address)||s.address.includes(a.user.address)||a.user.address.includes(s.name)))).length,N=Math.max(l,j),m=i.filter(a=>{if(a.buildingId===s.id)return!0;if(a.address){const g=a.address.toLowerCase(),p=s.name.toLowerCase().replace(/дом\s*/i,"").trim().toLowerCase();if(p&&g.includes(p+"-")||p&&g.includes(p+" "))return!0}return!1}),x=m.filter(a=>a.status==="completed"),u=x.filter(a=>a.rating).length>0?x.reduce((a,g)=>a+(g.rating||0),0)/x.filter(a=>a.rating).length:0,c=m.reduce((a,g)=>(a[g.category]=(a[g.category]||0)+1,a),{});return{branch:s.name,buildingId:s.id,buildings:1,residents:N,totalRequests:m.length,completed:x.length,avgRating:u.toFixed(1),categoryBreakdown:c}}),K=s=>{const l={day:"сегодня",week:"неделю",month:"месяц",year:"год"},j=s?y.filter(n=>n.branch===s):y,N=["Объект","Домов","Жителей","Заявок","Выполнено","Ср. оценка","Сантехника","Электрика","Охрана","Уборка","Лифт","Домофон"],m=j.map(n=>[n.branch,n.buildings,n.residents,n.totalRequests,n.completed,n.avgRating,n.categoryBreakdown.plumber||0,n.categoryBreakdown.electrician||0,n.categoryBreakdown.security||0,n.categoryBreakdown.cleaning||0,n.categoryBreakdown.elevator||0,n.categoryBreakdown.intercom||0]),x=[N,...m].map(n=>n.join(";")).join(`
`),u="\uFEFF",c=new Blob([u+x],{type:"text/csv;charset=utf-8;"}),a=window.URL.createObjectURL(c),g=document.createElement("a");g.href=a,g.download=`отчет_объекты_${s||"все"}_${l[R]}_${new Date().toLocaleDateString("ru-RU")}.csv`,g.click(),window.URL.revokeObjectURL(a)},Q=()=>{const s={day:"сегодня",week:"неделю",month:"месяц",year:"год"},l=["№","Название","Категория","Статус","Приоритет","Житель","Адрес","Исполнитель","Создано","Оценка"],j=i.map(a=>[a.number,a.title,C[a.category]||a.category,a.status,a.priority,a.residentName,`${a.address} кв.${a.apartment}`,a.executorName||"-",new Date(a.createdAt).toLocaleDateString("ru-RU"),a.rating||"-"]),N=[l,...j].map(a=>a.join(";")).join(`
`),m="\uFEFF",x=new Blob([m+N],{type:"text/csv;charset=utf-8;"}),u=window.URL.createObjectURL(x),c=document.createElement("a");c.href=u,c.download=`отчет_за_${s[R]}_${new Date().toLocaleDateString("ru-RU")}.csv`,c.click(),window.URL.revokeObjectURL(u)},f=i.filter(s=>s.status==="completed"),X=f.length>0?(f.reduce((s,l)=>s+(l.rating||0),0)/f.filter(s=>s.rating).length).toFixed(1):"—",ee=f.length>0?Math.round(f.reduce((s,l)=>s+(l.workDuration||0),0)/f.length/60):0,d=B.useMemo(()=>{const s=i.length>0?Math.round(f.length/i.length*100):0,l=i.filter(o=>o.assignedAt),j=l.length>0?Math.round(l.reduce((o,t)=>{const r=new Date(t.createdAt).getTime(),h=new Date(t.assignedAt).getTime();return o+(h-r)/6e4},0)/l.length):0,N=i.filter(o=>o.status==="cancelled").length,m=i.length>0?Math.round(N/i.length*100):0,x=new Date;let u,c;switch(R){case"day":c=new Date(x.getFullYear(),x.getMonth(),x.getDate()),u=new Date(c.getTime()-1440*60*1e3);break;case"week":c=new Date(x.getTime()-10080*60*1e3),u=new Date(c.getTime()-10080*60*1e3);break;case"month":c=new Date(x.getTime()-720*60*60*1e3),u=new Date(c.getTime()-720*60*60*1e3);break;default:c=new Date(x.getTime()-365*24*60*60*1e3),u=new Date(c.getTime()-365*24*60*60*1e3)}const a=k.filter(o=>{const t=new Date(o.createdAt);return t>=u&&t<c}),g=a.filter(o=>o.status==="completed").length,n=a.length>0?Math.round(g/a.length*100):0,p=s-n,L=i.length-a.length,S=E.filter(o=>o.specialization!=="courier").map(o=>{const t=i.filter(w=>w.executorId===o.id),r=t.filter(w=>w.status==="completed"),h=r.filter(w=>w.rating),v=h.length>0?h.reduce((w,M)=>w+(M.rating||0),0)/h.length:0;return{...o,periodRequests:t.length,periodCompleted:r.length,periodAvgRating:v,efficiency:t.length>0?Math.round(r.length/t.length*100):0}}).sort((o,t)=>t.periodCompleted-o.periodCompleted),$=S[0];return{completionRate:s,avgResponseTime:j,cancelledRate:m,completionTrend:p,requestsTrend:L,bestExecutor:$,executorPerformance:S}},[i,f,R,k,E]),se=i.reduce((s,l)=>(s[l.category]||(s[l.category]={total:0,completed:0,inProgress:0}),s[l.category].total++,l.status==="completed"&&s[l.category].completed++,l.status==="in_progress"&&s[l.category].inProgress++,s),{}),te=E.filter(s=>s.specialization!=="courier").map(s=>({...s,requests:k.filter(l=>l.executorId===s.id).length,completedCount:k.filter(l=>l.executorId===s.id&&l.status==="completed").length})).sort((s,l)=>l.completedCount-s.completedCount);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Отчёты и аналитика"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Статистика и показатели эффективности"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("select",{value:R,onChange:s=>J(s.target.value),className:"glass-input w-40",children:[e.jsx("option",{value:"day",children:"За сегодня"}),e.jsx("option",{value:"week",children:"За неделю"}),e.jsx("option",{value:"month",children:"За месяц"}),e.jsx("option",{value:"year",children:"За год"})]}),e.jsxs("button",{onClick:Q,className:"btn-secondary flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Скачать CSV"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>P("general"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${D==="general"?"bg-primary-500 text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"Общий отчёт"}),e.jsx("button",{onClick:()=>P("branch"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${D==="branch"?"bg-primary-500 text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:"По объектам"})]}),D==="branch"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(F,{className:"w-5 h-5 text-gray-400"}),"Выберите объект для анализа"]}),e.jsxs("button",{onClick:()=>K(b==="all"?void 0:b),className:"btn-secondary flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Скачать отчёт"]})]}),y.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(F,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"Нет данных по объектам"}),e.jsx("p",{className:"text-sm mt-1",children:'Добавьте здания в разделе "Дома"'})]}):e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:[e.jsx("button",{onClick:()=>I("all"),className:`p-4 rounded-xl border-2 transition-all text-left ${b==="all"?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300 bg-white"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-primary-400 to-primary-600 rounded-lg flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Все объекты"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[y.length," объектов"]})]})]})}),y.map(s=>e.jsx("button",{onClick:()=>I(s.branch),className:`p-4 rounded-xl border-2 transition-all text-left ${b===s.branch?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300 bg-white"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("div",{className:"font-semibold truncate",children:s.branch}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.totalRequests," заявок"]})]})]})},s.buildingId))]})]}),b&&y.length>0&&(()=>{const s=b==="all"?y:y.filter(t=>t.branch===b),l=s.reduce((t,r)=>t+r.totalRequests,0),j=s.reduce((t,r)=>t+r.completed,0),N=s.reduce((t,r)=>t+r.residents,0),m=b==="all"?i:i.filter(t=>{const r=O.find(h=>h.name===b);return r&&(t.address?.includes(r.address)||t.address?.includes(r.name))}),x=m.reduce((t,r)=>(t[r.status]=(t[r.status]||0)+1,t),{}),u=m.reduce((t,r)=>(t[r.category]=(t[r.category]||0)+1,t),{}),c=m.reduce((t,r)=>(t[r.priority]=(t[r.priority]||0)+1,t),{}),a=m.filter(t=>t.status==="cancelled"),g=m.filter(t=>t.assignedAt),n=g.length>0?Math.round(g.reduce((t,r)=>{const h=new Date(r.createdAt).getTime(),v=new Date(r.assignedAt).getTime();return t+(v-h)/6e4},0)/g.length):0,p=m.filter(t=>t.completedAt&&t.startedAt),L=p.length>0?Math.round(p.reduce((t,r)=>t+(r.workDuration||0),0)/p.length/60):0,T=m.filter(t=>t.rating),S=T.length>0?(T.reduce((t,r)=>t+(r.rating||0),0)/T.length).toFixed(1):"—",$={new:{label:"Новые",color:"bg-blue-100 text-blue-700",barColor:"from-blue-400 to-blue-500"},assigned:{label:"Назначены",color:"bg-purple-100 text-purple-700",barColor:"from-purple-400 to-purple-500"},accepted:{label:"Приняты",color:"bg-indigo-100 text-indigo-700",barColor:"from-indigo-400 to-indigo-500"},in_progress:{label:"В работе",color:"bg-yellow-100 text-yellow-700",barColor:"from-orange-400 to-amber-500"},pending_approval:{label:"На проверке",color:"bg-orange-100 text-orange-700",barColor:"from-orange-400 to-orange-500"},completed:{label:"Выполнены",color:"bg-green-100 text-green-700",barColor:"from-green-400 to-emerald-500"},cancelled:{label:"Отменены",color:"bg-red-100 text-red-700",barColor:"from-red-400 to-red-500"}},o={low:{label:"Низкий",color:"bg-gray-100 text-gray-600"},medium:{label:"Средний",color:"bg-blue-100 text-blue-600"},high:{label:"Высокий",color:"bg-orange-100 text-orange-600"},urgent:{label:"Срочный",color:"bg-red-100 text-red-600"}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-xl flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:l}),e.jsx("div",{className:"text-sm text-gray-500",children:"Всего заявок"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-500 rounded-xl flex items-center justify-center",children:e.jsx(Z,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:j}),e.jsx("div",{className:"text-sm text-gray-500",children:"Выполнено"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-amber-500 rounded-xl flex items-center justify-center",children:e.jsx(A,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:S}),e.jsx("div",{className:"text-sm text-gray-500",children:"Средняя оценка"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-violet-500 rounded-xl flex items-center justify-center",children:e.jsx(le,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:N}),e.jsx("div",{className:"text-sm text-gray-500",children:"Жителей"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Время реакции"}),e.jsx("div",{className:"text-sm text-gray-500",children:"от создания до назначения"})]})]}),e.jsxs("div",{className:"text-4xl font-bold text-blue-600",children:[n," мин"]})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx(U,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:"Время выполнения"}),e.jsx("div",{className:"text-sm text-gray-500",children:"среднее время работы"})]})]}),e.jsxs("div",{className:"text-4xl font-bold text-green-600",children:[L," мин"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-gray-400"}),"Статусы заявок"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(x).sort((t,r)=>r[1]-t[1]).map(([t,r])=>{const h=$[t]||{label:t,color:"bg-gray-100 text-gray-600",barColor:"from-gray-400 to-gray-500"},v=l>0?Math.round(r/l*100):0;return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${h.color}`,children:h.label})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-gradient-to-r ${h.barColor} rounded-full transition-all`,style:{width:`${v}%`}})})}),e.jsxs("div",{className:"w-16 text-right",children:[e.jsx("span",{className:"font-bold",children:r}),e.jsxs("span",{className:"text-gray-400 text-sm ml-1",children:["(",v,"%)"]})]})]},t)})})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-gray-400"}),"По категориям (специалистам)"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(u).sort((t,r)=>r[1]-t[1]).map(([t,r])=>{const h=C[t]||t,v=l>0?Math.round(r/l*100):0,M={plumber:"from-blue-400 to-blue-500",electrician:"from-orange-400 to-orange-500",security:"from-red-400 to-red-500",cleaning:"from-green-400 to-emerald-500",elevator:"from-purple-400 to-violet-500",intercom:"from-indigo-400 to-indigo-500",carpenter:"from-amber-400 to-amber-500",locksmith:"from-gray-400 to-gray-500",other:"from-pink-400 to-pink-500"}[t]||"from-gray-400 to-gray-500";return e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-28 truncate",children:e.jsx("span",{className:"text-sm font-medium",children:h})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full bg-gradient-to-r ${M} rounded-full transition-all`,style:{width:`${v}%`}})})}),e.jsxs("div",{className:"w-16 text-right",children:[e.jsx("span",{className:"font-bold",children:r}),e.jsxs("span",{className:"text-gray-400 text-sm ml-1",children:["(",v,"%)"]})]})]},t)})})]})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-gray-400"}),"Приоритеты заявок"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(o).map(([t,r])=>{const h=c[t]||0;return e.jsxs("div",{className:`p-4 rounded-xl ${r.color}`,children:[e.jsx("div",{className:"text-3xl font-bold",children:h}),e.jsx("div",{className:"text-sm font-medium mt-1",children:r.label})]},t)})})]}),a.length>0&&e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2 text-red-600",children:[e.jsx(_,{className:"w-5 h-5"}),"Отменённые заявки (",a.length,")"]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"pb-2 font-medium",children:"№"}),e.jsx("th",{className:"pb-2 font-medium",children:"Заявка"}),e.jsx("th",{className:"pb-2 font-medium",children:"Категория"}),e.jsx("th",{className:"pb-2 font-medium",children:"Адрес"}),e.jsx("th",{className:"pb-2 font-medium",children:"Дата"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:a.slice(0,10).map(t=>e.jsxs("tr",{className:"hover:bg-white/50",children:[e.jsxs("td",{className:"py-2 font-mono text-gray-500",children:["#",t.number]}),e.jsx("td",{className:"py-2 font-medium",children:t.title}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"px-2 py-0.5 bg-gray-100 rounded text-xs",children:C[t.category]})}),e.jsxs("td",{className:"py-2 text-gray-500",children:[t.address,", кв. ",t.apartment]}),e.jsx("td",{className:"py-2 text-gray-400",children:new Date(t.createdAt).toLocaleDateString("ru-RU")})]},t.id))})]}),a.length>10&&e.jsxs("div",{className:"text-center text-gray-400 text-sm mt-3",children:["И ещё ",a.length-10," отменённых заявок..."]})]})]})]})})()]}),D==="general"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-400 to-indigo-500 rounded-xl flex items-center justify-center",children:e.jsx(V,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-3xl font-bold",children:i.length}),d.requestsTrend!==0&&e.jsxs("span",{className:`flex items-center text-sm ${d.requestsTrend>0?"text-green-600":"text-red-600"}`,children:[d.requestsTrend>0?e.jsx(q,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"}),Math.abs(d.requestsTrend)]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Всего заявок"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-400 to-emerald-500 rounded-xl flex items-center justify-center",children:e.jsx(ne,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-3xl font-bold",children:[d.completionRate,"%"]}),d.completionTrend!==0&&e.jsxs("span",{className:`flex items-center text-sm ${d.completionTrend>0?"text-green-600":"text-red-600"}`,children:[d.completionTrend>0?e.jsx(q,{className:"w-4 h-4"}):e.jsx(Y,{className:"w-4 h-4"}),Math.abs(d.completionTrend),"%"]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Выполнено"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-orange-400 to-amber-500 rounded-xl flex items-center justify-center",children:e.jsx(A,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:X}),e.jsx("div",{className:"text-sm text-gray-500",children:"Средний рейтинг"})]})]})}),e.jsx("div",{className:"glass-card p-5",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-purple-400 to-violet-500 rounded-xl flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-bold",children:d.avgResponseTime}),e.jsx("div",{className:"text-sm text-gray-500",children:"Время реакции (мин)"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"font-medium",children:"Выполнено"})]}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:f.length})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-green-400 to-green-500 rounded-full",style:{width:`${d.completionRate}%`}})})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{className:"w-5 h-5 text-amber-500"}),e.jsx("span",{className:"font-medium",children:"Время выполнения"})]}),e.jsxs("span",{className:"text-2xl font-bold text-amber-600",children:[ee," мин"]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Среднее время работы над заявкой"})]}),e.jsxs("div",{className:"glass-card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"font-medium",children:"Отменено"})]}),e.jsxs("span",{className:"text-2xl font-bold text-red-600",children:[d.cancelledRate,"%"]})]}),e.jsx("div",{className:"text-sm text-gray-500",children:"Процент отмененных заявок"})]})]}),d.bestExecutor&&d.bestExecutor.periodCompleted>0&&e.jsx("div",{className:"glass-card p-5 bg-gradient-to-r from-amber-50 to-yellow-50 border-amber-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-gradient-to-br from-amber-400 to-orange-500 rounded-full flex items-center justify-center",children:e.jsx(de,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-amber-700 font-medium",children:"Лучший исполнитель периода"}),e.jsx("div",{className:"text-xl font-bold text-gray-900",children:d.bestExecutor.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[C[d.bestExecutor.specialization]," •",d.bestExecutor.periodCompleted," выполнено •",e.jsx(A,{className:"w-3 h-3 inline text-amber-500 ml-1"}),d.bestExecutor.periodAvgRating.toFixed(1)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-3xl font-bold text-amber-600",children:[d.bestExecutor.efficiency,"%"]}),e.jsx("div",{className:"text-sm text-amber-700",children:"эффективность"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-gray-400"}),"Распределение по категориям"]}),e.jsx("div",{className:"space-y-3",children:Object.entries(se).map(([s,l])=>e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium",children:C[s]}),e.jsx("span",{className:"text-sm text-gray-500",children:l.total})]}),e.jsx("div",{className:"w-full h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-primary-400 to-primary-500 rounded-full",style:{width:`${l.completed/l.total*100}%`}})})]})},s))})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5 text-gray-400"}),"Статусы заявок"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:i.filter(s=>s.status==="new").length}),e.jsx("div",{className:"text-sm text-blue-700",children:"Новых"})]}),e.jsxs("div",{className:"bg-indigo-50 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-indigo-600",children:i.filter(s=>s.status==="assigned"||s.status==="accepted").length}),e.jsx("div",{className:"text-sm text-indigo-700",children:"Назначено"})]}),e.jsxs("div",{className:"bg-amber-50 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-amber-600",children:i.filter(s=>s.status==="in_progress").length}),e.jsx("div",{className:"text-sm text-amber-700",children:"В работе"})]}),e.jsxs("div",{className:"bg-green-50 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:i.filter(s=>s.status==="completed").length}),e.jsx("div",{className:"text-sm text-green-700",children:"Выполнено"})]})]})]})]}),e.jsxs("div",{className:"glass-card p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5 text-gray-400"}),"Топ исполнителей"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-sm text-gray-500 border-b border-gray-200",children:[e.jsx("th",{className:"pb-3 font-medium",children:"#"}),e.jsx("th",{className:"pb-3 font-medium",children:"Исполнитель"}),e.jsx("th",{className:"pb-3 font-medium",children:"Специализация"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Заявок"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Выполнено"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Рейтинг"}),e.jsx("th",{className:"pb-3 font-medium text-center",children:"Статус"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:te.slice(0,10).map((s,l)=>e.jsxs("tr",{className:"hover:bg-white/30",children:[e.jsx("td",{className:"py-3 text-gray-500",children:l+1}),e.jsx("td",{className:"py-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center text-sm font-medium text-primary-700",children:s.name.split(" ").map(j=>j[0]).join("").slice(0,2)}),e.jsx("span",{className:"font-medium",children:s.name})]})}),e.jsx("td",{className:"py-3 text-gray-600",children:C[s.specialization]}),e.jsx("td",{className:"py-3 text-center",children:s.requests}),e.jsx("td",{className:"py-3 text-center",children:e.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded-full text-sm",children:s.completedCount})}),e.jsx("td",{className:"py-3 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(A,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),e.jsx("span",{className:"font-medium",children:s.rating})]})}),e.jsx("td",{className:"py-3 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="available"?"bg-green-100 text-green-700":s.status==="busy"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600"}`,children:s.status==="available"?"Доступен":s.status==="busy"?"Занят":"Оффлайн"})})]},s.id))})]})})]})]})]})}export{Ne as ReportsPage};
//# sourceMappingURL=ReportsPage-1769968761754-MKBtlE5a.js.map
