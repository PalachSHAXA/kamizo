import{r as c,j as e,y as U,Q as G,ad as _,as as V,z as I,aH as M,ab as T,A as Z,a1 as Q,am as y,J as R,X as Y,l as L,f as z,U as H,h as J,q as O}from"./react-vendor-1769428875114-t_MJ7TI5.js";import{b as X,u as K,d as W,v as x,G as w}from"./index-1769428875114-CG_16j_e.js";import"./vendor-1769428875114-wOrLRiCI.js";import"./qr-scanner-1769428875114-B_vB3SDT.js";import"./zustand-1769428875114-wNUYBKDB.js";function le(){const{user:o}=X(),{getAllGuestAccessCodes:B,revokeGuestAccessCode:$,getGuestAccessStats:q,getGuestAccessLogs:P}=K(),{language:a}=W(),[v,F]=c.useState(""),[d,k]=c.useState("all"),[l,u]=c.useState("all"),[t,b]=c.useState(null),[n,h]=c.useState(null),[g,N]=c.useState(""),[p,D]=c.useState(!1),C=B(),j=q(),S=P().slice(0,10),f=C.filter(s=>{if(d!=="all"&&s.status!==d||l!=="all"&&s.visitorType!==l)return!1;if(v){const r=v.toLowerCase(),i=s.residentName.toLowerCase().includes(r)||s.residentApartment.toLowerCase().includes(r),m=s.visitorName?.toLowerCase().includes(r)||s.visitorPhone?.toLowerCase().includes(r);if(!i&&!m)return!1}return!0}),E=()=>{!n||!o||!g.trim()||($(n.id,o.id,o.name,o.role,g.trim()),h(null),N(""))},A=s=>{switch(s){case"courier":return e.jsx(O,{className:"w-5 h-5"});case"guest":return e.jsx(J,{className:"w-5 h-5"});case"taxi":return e.jsx(z,{className:"w-5 h-5"});default:return e.jsx(H,{className:"w-5 h-5"})}};return e.jsxs("div",{className:"space-y-4 md:space-y-6 pb-20 md:pb-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:a==="ru"?"Гостевые пропуска":"Mehmon ruxsatnomalari"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a==="ru"?"Мониторинг и управление пропусками посетителей":"Tashrif buyuruvchilar ruxsatnomalarini monitoring va boshqarish"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(U,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:j.totalActive}),e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Активных":"Faol"})]})]})}),e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j.totalUsedToday}),e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Сегодня":"Bugun"})]})]})}),e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(_,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:j.totalCreatedToday}),e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Создано":"Yaratilgan"})]})]})}),e.jsx("div",{className:"glass-card p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(V,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:C.length}),e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Всего":"Jami"})]})]})})]}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:["courier","guest","taxi","other"].map(s=>{const r=x[s],i=j.byVisitorType[s];return e.jsxs("button",{onClick:()=>u(l===s?"all":s),className:`glass-card p-3 text-center transition-all ${l===s?"ring-2 ring-primary-500":""}`,children:[e.jsx("div",{className:"text-2xl mb-1",children:r.icon}),e.jsx("div",{className:"font-bold",children:i}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:a==="ru"?r.label:r.labelUz})]},s)})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:v,onChange:s=>F(s.target.value),placeholder:a==="ru"?"Поиск по жителю или гостю...":"Turar joy egasi yoki mehmon bo'yicha qidirish...",className:"w-full pl-10 pr-4 py-3 bg-white/50 border-2 border-gray-200 rounded-xl focus:border-primary-500 focus:ring-0"})]}),e.jsxs("button",{onClick:()=>D(!p),className:`px-4 py-3 rounded-xl font-medium flex items-center gap-2 transition-colors ${p||d!=="all"||l!=="all"?"bg-primary-500 text-gray-900":"bg-white/50 text-gray-600 hover:bg-white"}`,children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:a==="ru"?"Фильтры":"Filtrlar"}),(d!=="all"||l!=="all")&&e.jsx("span",{className:"w-5 h-5 bg-white/30 rounded-full text-xs flex items-center justify-center",children:(d!=="all"?1:0)+(l!=="all"?1:0)})]})]}),p&&e.jsxs("div",{className:"glass-card p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-medium",children:a==="ru"?"Фильтры":"Filtrlar"}),e.jsx("button",{onClick:()=>{k("all"),u("all")},className:"text-sm text-primary-600 hover:underline",children:a==="ru"?"Сбросить":"Tozalash"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 mb-2 block",children:a==="ru"?"Статус":"Status"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[{value:"all",label:a==="ru"?"Все":"Barchasi"},{value:"active",label:a==="ru"?"Активные":"Faol"},{value:"used",label:a==="ru"?"Использованные":"Ishlatilgan"},{value:"expired",label:a==="ru"?"Истекшие":"Muddati tugagan"},{value:"revoked",label:a==="ru"?"Отменённые":"Bekor qilingan"}].map(({value:s,label:r})=>e.jsx("button",{onClick:()=>k(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${d===s?"bg-primary-500 text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:r},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-500 mb-2 block",children:a==="ru"?"Тип посетителя":"Tashrif buyuruvchi turi"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${l==="all"?"bg-primary-500 text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:a==="ru"?"Все":"Barchasi"}),["courier","guest","taxi","other"].map(s=>{const r=x[s];return e.jsxs("button",{onClick:()=>u(s),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${l===s?"bg-primary-500 text-gray-900":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx("span",{children:r.icon}),a==="ru"?r.label:r.labelUz]},s)})]})]})]}),e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b flex items-center justify-between",children:e.jsxs("h3",{className:"font-bold",children:[a==="ru"?"Пропуска":"Ruxsatnomalar"," (",f.length,")"]})}),f.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:a==="ru"?"Пропуска не найдены":"Ruxsatnomalar topilmadi"}):e.jsx("div",{className:"divide-y max-h-[600px] overflow-y-auto",children:f.map(s=>{const r=x[s.visitorType],i=w[s.status],m=s.status==="active";return e.jsx("div",{className:"p-4 hover:bg-gray-50/50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center flex-shrink-0 ${m?"bg-green-100 text-green-600":s.status==="used"?"bg-blue-100 text-blue-600":s.status==="revoked"?"bg-red-100 text-red-600":"bg-gray-100 text-gray-600"}`,children:A(s.visitorType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium truncate",children:s.residentName}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full font-medium ${m?"bg-green-100 text-green-700":s.status==="used"?"bg-blue-100 text-blue-700":s.status==="revoked"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:a==="ru"?i.label:i.labelUz})]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(T,{className:"w-3.5 h-3.5"}),s.residentAddress,", ",a==="ru"?"кв.":"xona"," ",s.residentApartment]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-base",children:r.icon}),s.visitorName||(a==="ru"?r.label:r.labelUz)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"w-3.5 h-3.5"}),new Date(s.validUntil).toLocaleDateString(a==="ru"?"ru-RU":"uz-UZ")]})]}),s.revocationReason&&e.jsxs("div",{className:"mt-2 text-xs text-red-600 bg-red-50 px-2 py-1 rounded inline-block",children:[a==="ru"?"Причина":"Sabab",": ",s.revocationReason]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>b(s),className:"p-2 text-gray-500 hover:bg-gray-100 rounded-lg transition-colors",title:a==="ru"?"Подробнее":"Batafsil",children:e.jsx(Q,{className:"w-4 h-4"})}),m&&e.jsx("button",{onClick:()=>h(s),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:a==="ru"?"Отменить":"Bekor qilish",children:e.jsx(y,{className:"w-4 h-4"})})]})]})},s.id)})})]}),S.length>0&&e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-bold",children:a==="ru"?"Последняя активность":"So'nggi faoliyat"})}),e.jsx("div",{className:"divide-y",children:S.slice(0,5).map(s=>{const r=s.action==="entry_allowed",i=s.action==="entry_denied";return e.jsxs("div",{className:"p-3 flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${r?"bg-green-100 text-green-600":i?"bg-red-100 text-red-600":"bg-amber-100 text-amber-600"}`,children:r?e.jsx(U,{className:"w-4 h-4"}):i?e.jsx(y,{className:"w-4 h-4"}):e.jsx(R,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:s.residentName}),e.jsxs("span",{className:"text-gray-500",children:[" - ",a==="ru"?"кв.":"xona"," ",s.residentApartment]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(s.timestamp).toLocaleString(a==="ru"?"ru-RU":"uz-UZ")})]}),e.jsx("span",{className:"text-lg",children:x[s.visitorType].icon})]},s.id)})})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-bold",children:a==="ru"?"Детали пропуска":"Ruxsatnoma tafsilotlari"}),e.jsx("button",{onClick:()=>b(null),className:"p-2 hover:bg-gray-100 rounded-xl",children:e.jsx(Y,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("div",{className:`p-4 rounded-xl ${t.status==="active"?"bg-green-50":t.status==="used"?"bg-blue-50":t.status==="revoked"?"bg-red-50":"bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${t.status==="active"?"bg-green-200 text-green-700":t.status==="used"?"bg-blue-200 text-blue-700":t.status==="revoked"?"bg-red-200 text-red-700":"bg-gray-200 text-gray-700"}`,children:A(t.visitorType)}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold",children:a==="ru"?x[t.visitorType].label:x[t.visitorType].labelUz}),e.jsx("div",{className:`text-sm ${t.status==="active"?"text-green-600":t.status==="used"?"text-blue-600":t.status==="revoked"?"text-red-600":"text-gray-600"}`,children:a==="ru"?w[t.status].label:w[t.status].labelUz})]})]})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a==="ru"?"Житель":"Turar joy egasi"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-1",children:[e.jsx("div",{className:"font-medium",children:t.residentName}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(T,{className:"w-4 h-4"}),t.residentAddress,", ",a==="ru"?"кв.":"xona"," ",t.residentApartment]}),e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(L,{className:"w-4 h-4"}),t.residentPhone]})]})]}),(t.visitorName||t.visitorPhone||t.visitorVehiclePlate)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:a==="ru"?"Посетитель":"Tashrif buyuruvchi"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 space-y-1",children:[t.visitorName&&e.jsx("div",{className:"font-medium",children:t.visitorName}),t.visitorPhone&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(L,{className:"w-4 h-4"}),t.visitorPhone]}),t.visitorVehiclePlate&&e.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(z,{className:"w-4 h-4"}),t.visitorVehiclePlate]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Создан":"Yaratilgan"}),e.jsx("div",{className:"font-medium text-sm",children:new Date(t.createdAt).toLocaleString(a==="ru"?"ru-RU":"uz-UZ")})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Действует до":"Gacha amal qiladi"}),e.jsx("div",{className:"font-medium text-sm",children:new Date(t.validUntil).toLocaleString(a==="ru"?"ru-RU":"uz-UZ")})]})]}),t.accessType!=="single_use"&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:a==="ru"?"Использований":"Ishlatilgan"}),e.jsxs("div",{className:"font-medium",children:[t.currentUses," / ",t.maxUses===999?"∞":t.maxUses]})]}),t.status==="revoked"&&e.jsxs("div",{className:"bg-red-50 rounded-xl p-3 space-y-1",children:[e.jsx("div",{className:"text-xs text-red-500",children:a==="ru"?"Отменено":"Bekor qilingan"}),e.jsx("div",{className:"font-medium text-red-700",children:t.revokedByName}),e.jsx("div",{className:"text-sm text-red-600",children:t.revocationReason}),t.revokedAt&&e.jsx("div",{className:"text-xs text-red-400",children:new Date(t.revokedAt).toLocaleString(a==="ru"?"ru-RU":"uz-UZ")})]}),t.notes&&e.jsxs("div",{className:"bg-blue-50 rounded-xl p-3",children:[e.jsx("div",{className:"text-xs text-blue-500",children:a==="ru"?"Примечание":"Izoh"}),e.jsx("div",{className:"text-sm text-blue-700",children:t.notes})]}),t.status==="active"&&e.jsxs("button",{onClick:()=>{b(null),h(t)},className:"w-full py-3 bg-red-500 hover:bg-red-600 text-white rounded-xl font-bold flex items-center justify-center gap-2",children:[e.jsx(y,{className:"w-5 h-5"}),a==="ru"?"Отменить пропуск":"Ruxsatnomani bekor qilish"]})]})]})}),n&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(R,{className:"w-8 h-8 text-red-600"})}),e.jsx("h3",{className:"text-lg font-bold mb-2",children:a==="ru"?"Отменить пропуск?":"Ruxsatnomani bekor qilasizmi?"}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:a==="ru"?`Пропуск для ${n.residentName} (кв. ${n.residentApartment})`:`${n.residentName} (${n.residentApartment}-xona) uchun ruxsatnoma`})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a==="ru"?"Причина отмены *":"Bekor qilish sababi *"}),e.jsx("textarea",{value:g,onChange:s=>N(s.target.value),placeholder:a==="ru"?"Укажите причину...":"Sababni kiriting...",rows:3,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-red-500 focus:ring-0 resize-none"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{h(null),N("")},className:"flex-1 py-3 border-2 border-gray-200 rounded-xl font-medium hover:bg-gray-50",children:a==="ru"?"Отмена":"Bekor qilish"}),e.jsx("button",{onClick:E,disabled:!g.trim(),className:"flex-1 py-3 bg-red-500 hover:bg-red-600 disabled:bg-gray-300 text-white rounded-xl font-bold",children:a==="ru"?"Отменить пропуск":"Bekor qilish"})]})]})})]})}export{le as ManagerGuestAccessPage};
//# sourceMappingURL=ManagerGuestAccessPage-1769428875114-T8IAAkIo.js.map
