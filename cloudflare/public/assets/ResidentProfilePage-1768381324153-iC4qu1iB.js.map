{"version":3,"file":"ResidentProfilePage-1768381324153-iC4qu1iB.js","sources":["../../src/pages/ResidentProfilePage.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\nimport {\n  Key, MapPin, Home, Phone, Save, Eye, EyeOff, Edit3,\n  AlertCircle, Shield, Loader2, X, FileText, CheckCircle,\n  Building2, Ruler, QrCode, Globe,\n  Download, User as UserIcon, Sparkles\n} from 'lucide-react';\nimport { useAuthStore } from '../stores/authStore';\nimport { useLanguageStore } from '../stores/languageStore';\nimport { generateQRCode } from '../components/LazyQRCode';\nimport { generateContractDocx } from '../utils/contractGenerator';\nimport { ContractPreview } from '../components/ContractPreview';\n\nexport function ResidentProfilePage() {\n  const { user, changePassword, updateProfile, markContractSigned } = useAuthStore();\n  const { language, setLanguage } = useLanguageStore();\n\n  // Check if user is a rental user (tenant/commercial_owner) - they have simplified profile\n  const isRentalUser = user?.role === 'tenant' || user?.role === 'commercial_owner';\n\n  const [editingPhone, setEditingPhone] = useState(false);\n  const [newPhone, setNewPhone] = useState(user?.phone || '');\n  const [phoneLoading, setPhoneLoading] = useState(false);\n  const [editingPassword, setEditingPassword] = useState(false);\n  const [currentPassword, setCurrentPassword] = useState('');\n  const [newPassword, setNewPassword] = useState('');\n  const [confirmPassword, setConfirmPassword] = useState('');\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\n  const [showNewPassword, setShowNewPassword] = useState(false);\n  const [passwordError, setPasswordError] = useState('');\n  const [passwordLoading, setPasswordLoading] = useState(false);\n  const [successMessage, setSuccessMessage] = useState('');\n  const [showContract, setShowContract] = useState(false);\n  const [qrCodeUrl, setQrCodeUrl] = useState<string>('');\n  const [isDownloading, setIsDownloading] = useState(false);\n\n  // Generate QR code with resident data\n  useEffect(() => {\n    const generateQR = async () => {\n      if (!user) return;\n\n      // Compact format with Cyrillic - no decorative symbols\n      const residentData = [\n        `–§–ò–û: ${user.name}`,\n        `–õ/–°: ${user.login}`,\n        user.address ? `–ê–¥—Ä–µ—Å: ${user.address}` : null,\n        user.apartment ? `–ö–≤: ${user.apartment}` : null,\n        user.phone ? `–¢–µ–ª: ${user.phone}` : null,\n      ].filter(Boolean).join('\\n');\n\n      const url = await generateQRCode(residentData, {\n        width: 300,\n        margin: 2,\n        errorCorrectionLevel: 'M',\n        color: { dark: '#1f2937', light: '#ffffff' },\n      });\n      setQrCodeUrl(url);\n    };\n\n    generateQR();\n  }, [user]);\n\n  // Translations\n  const t = useMemo(() => ({\n    // Page header\n    myProfile: language === 'ru' ? '–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å' : 'Mening profilim',\n    personalData: language === 'ru' ? '–í–∞—à–∏ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–æ–≥–æ–≤–æ—Ä' : 'Shaxsiy ma\\'lumotlaringiz va shartnoma',\n\n    // Sections\n    personalInfo: language === 'ru' ? '–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' : 'Shaxsiy ma\\'lumotlar',\n    contractInfo: language === 'ru' ? '–î–æ–≥–æ–≤–æ—Ä —Å –£–ö' : 'UK bilan shartnoma',\n    security: language === 'ru' ? '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å' : 'Xavfsizlik',\n\n    // Personal data labels\n    resident: language === 'ru' ? '–ñ–∏—Ç–µ–ª—å' : 'Aholi',\n    tenant: language === 'ru' ? '–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä' : 'Ijarachi',\n    commercialOwner: language === 'ru' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : 'Egasi',\n    personalAccount: language === 'ru' ? '–õ–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç' : 'Shaxsiy hisob',\n    loginHint: language === 'ru' ? '–õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞' : 'Kirish logini',\n    cannotChange: language === 'ru' ? '–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å' : 'O\\'zgartirib bo\\'lmaydi',\n    address: language === 'ru' ? '–ê–¥—Ä–µ—Å' : 'Manzil',\n    apartment: language === 'ru' ? '–ö–≤–∞—Ä—Ç–∏—Ä–∞' : 'Kvartira',\n    area: language === 'ru' ? '–ü–ª–æ—â–∞–¥—å' : 'Maydon',\n    phone: language === 'ru' ? '–¢–µ–ª–µ—Ñ–æ–Ω' : 'Telefon',\n    notSpecified: language === 'ru' ? '–ù–µ —É–∫–∞–∑–∞–Ω' : 'Ko\\'rsatilmagan',\n    branch: language === 'ru' ? '–§–∏–ª–∏–∞–ª' : 'Filial',\n    building: language === 'ru' ? '–î–æ–º' : 'Uy',\n\n    // Contract labels\n    contractNumber: language === 'ru' ? '–ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma raqami',\n    contractType: language === 'ru' ? '–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma turi',\n    contractStart: language === 'ru' ? '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' : 'Boshlanish sanasi',\n    contractEnd: language === 'ru' ? '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è' : 'Tugash sanasi',\n    indefinite: language === 'ru' ? '–ë–µ—Å—Å—Ä–æ—á–Ω—ã–π' : 'Muddatsiz',\n    contractStatus: language === 'ru' ? '–°—Ç–∞—Ç—É—Å –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma holati',\n    active: language === 'ru' ? '–î–µ–π—Å—Ç–≤—É—é—â–∏–π' : 'Amalda',\n    pending: language === 'ru' ? '–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è' : 'Imzo kutilmoqda',\n    yourQrCode: language === 'ru' ? '–í–∞—à QR-–∫–æ–¥' : 'Sizning QR-kodingiz',\n    qrHint: language === 'ru' ? '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤' : 'Hujjatlarni imzolash uchun noyob identifikator',\n    viewContract: language === 'ru' ? '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–≥–æ–≤–æ—Ä' : 'Shartnomani ko\\'rish',\n    hideContract: language === 'ru' ? '–°–∫—Ä—ã—Ç—å' : 'Yashirish',\n    downloadContract: language === 'ru' ? '–°–∫–∞—á–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä' : 'Shartnomani yuklash',\n    downloading: language === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : 'Yuklanmoqda...',\n\n    // Contract types\n    typeStandard: language === 'ru' ? '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' : 'Standart',\n    typeCommercial: language === 'ru' ? '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π' : 'Tijorat',\n    typeTemporary: language === 'ru' ? '–í—Ä–µ–º–µ–Ω–Ω—ã–π' : 'Vaqtinchalik',\n\n    // Security\n    password: language === 'ru' ? '–ü–∞—Ä–æ–ª—å' : 'Parol',\n    currentPassword: language === 'ru' ? '–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parol',\n    newPassword: language === 'ru' ? '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å' : 'Yangi parol',\n    confirmPassword: language === 'ru' ? '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å' : 'Parolni tasdiqlang',\n    minChars: language === 'ru' ? '–ú–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞' : 'Kamida 4 ta belgi',\n    repeatPassword: language === 'ru' ? '–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å' : 'Yangi parolni takrorlang',\n    passwordChanged: language === 'ru' ? '–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω' : 'Parol muvaffaqiyatli o\\'zgartirildi',\n    wrongPassword: language === 'ru' ? '–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parol noto\\'g\\'ri',\n    passwordsNotMatch: language === 'ru' ? '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç' : 'Parollar mos kelmaydi',\n    passwordSameAsOld: language === 'ru' ? '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ' : 'Yangi parol joriy paroldan farq qilishi kerak',\n    enterCurrentPassword: language === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parolni kiriting',\n    passwordTooShort: language === 'ru' ? '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞' : 'Parol kamida 4 ta belgidan iborat bo\\'lishi kerak',\n    passwordError: language === 'ru' ? '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è' : 'Parolni o\\'zgartirishda xatolik',\n\n    // Actions\n    save: language === 'ru' ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : 'Saqlash',\n    cancel: language === 'ru' ? '–û—Ç–º–µ–Ω–∞' : 'Bekor qilish',\n    phoneSaved: language === 'ru' ? '–¢–µ–ª–µ—Ñ–æ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω' : 'Telefon saqlandi',\n\n    // Info\n    loginInfo: language === 'ru'\n      ? '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à –õ/–° (–ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç) –∫–∞–∫ –ª–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.'\n      : 'Tizimga kirish uchun L/H (shaxsiy hisob) dan foydalaning.',\n    loginInfoTitle: language === 'ru' ? '–î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:' : 'Kirish ma\\'lumotlari:',\n\n    // Language switcher\n    languageTitle: language === 'ru' ? '–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞' : 'Interfeys tili',\n    languageRu: '–†—É—Å—Å–∫–∏–π',\n    languageUz: 'O\\'zbekcha',\n  }), [language]);\n\n  const formatDate = (dateStr?: string) => {\n    if (!dateStr) return '-';\n    return new Date(dateStr).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\n      day: '2-digit',\n      month: 'long',\n      year: 'numeric',\n    });\n  };\n\n  const getContractTypeLabel = (type?: string) => {\n    switch (type) {\n      case 'commercial': return t.typeCommercial;\n      case 'temporary': return t.typeTemporary;\n      default: return t.typeStandard;\n    }\n  };\n\n  if (!user) {\n    return null;\n  }\n\n  const handleSavePhone = async () => {\n    if (!newPhone.trim()) return;\n\n    setPhoneLoading(true);\n    try {\n      const success = await updateProfile({ phone: newPhone.trim() });\n      if (success) {\n        setEditingPhone(false);\n        setSuccessMessage(t.phoneSaved);\n        setTimeout(() => setSuccessMessage(''), 3000);\n      }\n    } catch {\n      // Error handled by store\n    } finally {\n      setPhoneLoading(false);\n    }\n  };\n\n  const handleSavePassword = async () => {\n    setPasswordError('');\n\n    if (!currentPassword.trim()) {\n      setPasswordError(t.enterCurrentPassword);\n      return;\n    }\n\n    if (newPassword.length < 4) {\n      setPasswordError(t.passwordTooShort);\n      return;\n    }\n\n    if (newPassword !== confirmPassword) {\n      setPasswordError(t.passwordsNotMatch);\n      return;\n    }\n\n    if (currentPassword === newPassword) {\n      setPasswordError(t.passwordSameAsOld);\n      return;\n    }\n\n    setPasswordLoading(true);\n    try {\n      const success = await changePassword(currentPassword, newPassword);\n      if (success) {\n        setEditingPassword(false);\n        setCurrentPassword('');\n        setNewPassword('');\n        setConfirmPassword('');\n        setSuccessMessage(t.passwordChanged);\n        setTimeout(() => setSuccessMessage(''), 3000);\n        // Password change is now tracked in DB (passwordChangedAt) via authStore.changePassword\n      } else {\n        setPasswordError(t.wrongPassword);\n      }\n    } catch (error: unknown) {\n      const errorMessage = (error as Error)?.message || '';\n      if (errorMessage.includes('incorrect') || errorMessage.includes('–Ω–µ–≤–µ—Ä–Ω—ã–π')) {\n        setPasswordError(t.wrongPassword);\n      } else {\n        setPasswordError(t.passwordError);\n      }\n    } finally {\n      setPasswordLoading(false);\n    }\n  };\n\n  const handleDownloadContract = async () => {\n    if (!user || !qrCodeUrl || isDownloading) return;\n\n    setIsDownloading(true);\n    try {\n      await generateContractDocx(user, qrCodeUrl, language);\n      // Mark contract as signed if not already\n      if (!user.contractSignedAt) {\n        await markContractSigned();\n      }\n    } catch (error) {\n      console.error('Error generating contract:', error);\n      alert(language === 'ru' ? '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma yaratishda xatolik');\n    } finally {\n      setIsDownloading(false);\n    }\n  };\n\n  return (\n    <div className=\"max-w-2xl mx-auto space-y-6 pb-24 md:pb-6\">\n      {/* Header Card */}\n      <div className=\"glass-card p-4 md:p-6 bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200\">\n        <h1 className=\"text-lg font-bold text-gray-900 leading-tight\">{user.name}</h1>\n        <div className=\"flex flex-wrap items-center gap-2 mt-2\">\n          <span className=\"px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium\">\n            {user.role === 'tenant' ? t.tenant : user.role === 'commercial_owner' ? t.commercialOwner : t.resident}\n          </span>\n          {!isRentalUser && user.contractSignedAt && (\n            <span className=\"px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1\">\n              <CheckCircle className=\"w-3 h-3\" />\n              {t.active}\n            </span>\n          )}\n        </div>\n        <p className=\"text-gray-500 mt-2 text-xs\">{t.personalData}</p>\n      </div>\n\n      {/* Success Message */}\n      {successMessage && (\n        <div className=\"p-3 bg-green-50 text-green-700 rounded-xl flex items-center gap-2 animate-fade-in\">\n          <CheckCircle className=\"w-5 h-5\" />\n          {successMessage}\n        </div>\n      )}\n\n      {/* Personal Info Section */}\n      <div className=\"glass-card p-4 md:p-6\">\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\n          <UserIcon className=\"w-5 h-5 text-primary-500\" />\n          {t.personalInfo}\n        </h2>\n\n        <div className=\"space-y-4\">\n          {/* Login (–õ/–°) */}\n          <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\n              <Key className=\"w-5 h-5 text-blue-600\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"text-xs text-gray-500 font-medium\">{t.personalAccount}</div>\n              <div className=\"font-mono font-bold text-gray-900\">{user.login}</div>\n            </div>\n            <div className=\"px-2 py-1 bg-gray-200 rounded text-xs text-gray-500 flex-shrink-0\">\n              {t.cannotChange}\n            </div>\n          </div>\n\n          {/* Address */}\n          {user.address && (\n            <div className=\"flex items-start gap-4 p-3 bg-gray-50 rounded-xl\">\n              <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5\">\n                <MapPin className=\"w-5 h-5 text-green-600\" />\n              </div>\n              <div className=\"flex-1 min-w-0\">\n                <div className=\"text-xs text-gray-500 font-medium\">{t.address}</div>\n                <div className=\"font-medium text-gray-900 break-words leading-snug\">{user.address}</div>\n              </div>\n            </div>\n          )}\n\n          {/* Apartment and Area - Grid */}\n          <div className=\"grid grid-cols-2 gap-3\">\n            {user.apartment && (\n              <div className=\"p-3 bg-purple-50 rounded-xl text-center\">\n                <Home className=\"w-5 h-5 text-purple-600 mx-auto mb-1\" />\n                <div className=\"text-xs text-gray-500\">{t.apartment}</div>\n                <div className=\"font-bold text-gray-900\">{user.apartment}</div>\n              </div>\n            )}\n            {user.totalArea && (\n              <div className=\"p-3 bg-cyan-50 rounded-xl text-center\">\n                <Ruler className=\"w-5 h-5 text-cyan-600 mx-auto mb-1\" />\n                <div className=\"text-xs text-gray-500\">{t.area}</div>\n                <div className=\"font-bold text-gray-900\">{user.totalArea} –º¬≤</div>\n              </div>\n            )}\n          </div>\n\n          {/* Branch (only show if not redundant with address) */}\n          {user.branch && (\n            <div className=\"flex items-center gap-3 p-3 bg-amber-50 rounded-xl\">\n              <Building2 className=\"w-5 h-5 text-amber-600\" />\n              <div>\n                <div className=\"text-xs text-gray-500\">{t.branch}</div>\n                <div className=\"font-bold text-gray-900\">{user.branch}</div>\n              </div>\n            </div>\n          )}\n\n          {/* Phone - Editable */}\n          <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\n            <div className=\"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\n              <Phone className=\"w-5 h-5 text-orange-600\" />\n            </div>\n            <div className=\"flex-1 min-w-0\">\n              <div className=\"text-xs text-gray-500 font-medium\">{t.phone}</div>\n              {!editingPhone ? (\n                <div className=\"font-medium text-gray-900\">\n                  {user.phone || t.notSpecified}\n                </div>\n              ) : (\n                <input\n                  type=\"tel\"\n                  value={newPhone}\n                  onChange={(e) => setNewPhone(e.target.value)}\n                  placeholder=\"+998 90 123 45 67\"\n                  className=\"input-field py-1.5 text-sm\"\n                  autoFocus\n                />\n              )}\n            </div>\n            {!editingPhone ? (\n              <button\n                onClick={() => {\n                  setNewPhone(user.phone || '');\n                  setEditingPhone(true);\n                }}\n                className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\n              >\n                <Edit3 className=\"w-5 h-5 text-gray-500\" />\n              </button>\n            ) : (\n              <div className=\"flex gap-1\">\n                <button\n                  onClick={handleSavePhone}\n                  disabled={phoneLoading}\n                  className=\"p-2 hover:bg-green-100 rounded-lg transition-colors disabled:opacity-50\"\n                >\n                  {phoneLoading ? (\n                    <Loader2 className=\"w-5 h-5 text-green-600 animate-spin\" />\n                  ) : (\n                    <Save className=\"w-5 h-5 text-green-600\" />\n                  )}\n                </button>\n                <button\n                  onClick={() => setEditingPhone(false)}\n                  disabled={phoneLoading}\n                  className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50\"\n                >\n                  <X className=\"w-5 h-5 text-gray-400\" />\n                </button>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Language Switcher Section */}\n      <div className=\"glass-card p-4 md:p-6\">\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\n          <Globe className=\"w-5 h-5 text-blue-500\" />\n          {t.languageTitle}\n        </h2>\n\n        <div className=\"flex gap-3\">\n          <button\n            onClick={() => setLanguage('ru')}\n            className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium transition-all ${\n              language === 'ru'\n                ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30'\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n            }`}\n          >\n            <span className=\"text-lg\">üá∑üá∫</span>\n            {t.languageRu}\n          </button>\n          <button\n            onClick={() => setLanguage('uz')}\n            className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium transition-all ${\n              language === 'uz'\n                ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30'\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n            }`}\n          >\n            <span className=\"text-lg\">üá∫üáø</span>\n            {t.languageUz}\n          </button>\n        </div>\n      </div>\n\n      {/* Contract Section - only for residents, not rental users */}\n      {!isRentalUser && (\n        <div className=\"glass-card p-4 md:p-6\">\n          <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\n            <FileText className=\"w-5 h-5 text-yellow-500\" />\n            {t.contractInfo}\n          </h2>\n\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            {/* Contract Details */}\n            <div className=\"space-y-3\">\n              {/* Contract Number */}\n              <div className=\"p-3 bg-yellow-50 rounded-xl\">\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractNumber}</div>\n                <div className=\"font-mono font-bold text-gray-900\">\n                  {user.contractNumber || `–î–û–ì-${new Date().getFullYear()}-${user.login}`}\n                </div>\n              </div>\n\n              {/* Contract Type */}\n              <div className=\"p-3 bg-gray-50 rounded-xl\">\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractType}</div>\n                <div className=\"font-medium text-gray-900\">\n                  {getContractTypeLabel(user.contractType)}\n                </div>\n              </div>\n\n              {/* Status */}\n              <div className=\"p-3 bg-gray-50 rounded-xl\">\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractStatus}</div>\n                <div className=\"flex items-center gap-2\">\n                  {user.contractSignedAt ? (\n                    <>\n                      <span className=\"w-2 h-2 rounded-full bg-green-500\" />\n                      <span className=\"font-medium text-green-700\">{t.active}</span>\n                    </>\n                  ) : (\n                    <>\n                      <span className=\"w-2 h-2 rounded-full bg-orange-500 animate-pulse\" />\n                      <span className=\"font-medium text-yellow-700\">{t.pending}</span>\n                    </>\n                  )}\n                </div>\n              </div>\n\n              {/* Dates */}\n              <div className=\"grid grid-cols-2 gap-2\">\n                <div className=\"p-3 bg-gray-50 rounded-xl\">\n                  <div className=\"text-xs text-gray-500 mb-1\">{t.contractStart}</div>\n                  <div className=\"font-medium text-gray-900 text-sm\">\n                    {formatDate(user.contractStartDate || user.contractSignedAt || user.createdAt)}\n                  </div>\n                </div>\n                <div className=\"p-3 bg-gray-50 rounded-xl\">\n                  <div className=\"text-xs text-gray-500 mb-1\">{t.contractEnd}</div>\n                  <div className=\"font-medium text-gray-900 text-sm flex items-center gap-1\">\n                    {user.contractEndDate ? formatDate(user.contractEndDate) : (\n                      <>\n                        <Sparkles className=\"w-3 h-3 text-green-500\" />\n                        {t.indefinite}\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            {/* QR Code & Signature ID */}\n            <div className=\"flex flex-col items-center justify-center p-4 bg-white border-2 border-dashed border-gray-200 rounded-xl\">\n              <div className=\"text-xs text-gray-500 mb-2 flex items-center gap-1\">\n                <QrCode className=\"w-3 h-3\" />\n                {t.yourQrCode}\n              </div>\n              {qrCodeUrl ? (\n                <img src={qrCodeUrl} alt=\"QR Code\" className=\"w-32 h-32\" />\n              ) : (\n                <div className=\"w-32 h-32 bg-gray-100 rounded animate-pulse\" />\n              )}\n              <p className=\"text-xs text-gray-400 mt-2 text-center max-w-[180px]\">\n                {t.qrHint}\n              </p>\n              {/* Signature ID */}\n              <div className=\"mt-3 pt-3 border-t border-gray-200 w-full text-center\">\n                <div className=\"text-xs text-gray-500\">{language === 'ru' ? 'ID –ø–æ–¥–ø–∏—Å–∏' : 'Imzo ID'}</div>\n                <div className=\"font-mono text-sm font-bold text-gray-700 select-all\">{user.id}</div>\n              </div>\n            </div>\n          </div>\n\n          {/* Contract Actions */}\n          <div className=\"grid grid-cols-2 gap-3 mt-4\">\n            <button\n              onClick={() => setShowContract(!showContract)}\n              className=\"flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-xl text-sm font-medium text-gray-700 transition-colors\"\n            >\n              {showContract ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n              {showContract ? t.hideContract : t.viewContract}\n            </button>\n            <button\n              onClick={handleDownloadContract}\n              disabled={isDownloading || !qrCodeUrl}\n              className=\"flex items-center justify-center gap-2 px-4 py-3 bg-orange-400 hover:bg-orange-500 disabled:bg-gray-300 disabled:cursor-not-allowed rounded-xl text-sm font-medium text-gray-900 transition-colors\"\n            >\n              {isDownloading ? (\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\n              ) : (\n                <Download className=\"w-4 h-4\" />\n              )}\n              {isDownloading ? t.downloading : t.downloadContract}\n            </button>\n          </div>\n\n          {/* Contract Preview - Full Document */}\n          {showContract && (\n            <div className=\"mt-4\">\n              <ContractPreview user={user} qrCodeUrl={qrCodeUrl} language={language} />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Security Section */}\n      <div className=\"glass-card p-4 md:p-6\">\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\n          <Shield className=\"w-5 h-5 text-red-500\" />\n          {t.security}\n        </h2>\n\n        <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\n          <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0\">\n            <Key className=\"w-5 h-5 text-red-600\" />\n          </div>\n          <div className=\"flex-1\">\n            <div className=\"text-xs text-gray-500 font-medium\">{t.password}</div>\n            <div className=\"font-medium text-gray-900\">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>\n          </div>\n          {!editingPassword && (\n            <button\n              onClick={() => setEditingPassword(true)}\n              className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\n            >\n              <Edit3 className=\"w-5 h-5 text-gray-500\" />\n            </button>\n          )}\n        </div>\n\n        {editingPassword && (\n          <div className=\"space-y-3 mt-4 pt-4 border-t\">\n            {/* Current Password */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t.currentPassword}\n              </label>\n              <div className=\"relative\">\n                <input\n                  type={showCurrentPassword ? 'text' : 'password'}\n                  value={currentPassword}\n                  onChange={(e) => setCurrentPassword(e.target.value)}\n                  className=\"input-field pr-10\"\n                  placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowCurrentPassword(!showCurrentPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-400 hover:text-gray-600\"\n                >\n                  {showCurrentPassword ? (\n                    <EyeOff className=\"w-4 h-4\" />\n                  ) : (\n                    <Eye className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* New Password */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t.newPassword}\n              </label>\n              <div className=\"relative\">\n                <input\n                  type={showNewPassword ? 'text' : 'password'}\n                  value={newPassword}\n                  onChange={(e) => setNewPassword(e.target.value)}\n                  className=\"input-field pr-10\"\n                  placeholder={t.minChars}\n                />\n                <button\n                  type=\"button\"\n                  onClick={() => setShowNewPassword(!showNewPassword)}\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-400 hover:text-gray-600\"\n                >\n                  {showNewPassword ? (\n                    <EyeOff className=\"w-4 h-4\" />\n                  ) : (\n                    <Eye className=\"w-4 h-4\" />\n                  )}\n                </button>\n              </div>\n            </div>\n\n            {/* Confirm Password */}\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                {t.confirmPassword}\n              </label>\n              <input\n                type={showNewPassword ? 'text' : 'password'}\n                value={confirmPassword}\n                onChange={(e) => setConfirmPassword(e.target.value)}\n                className=\"input-field\"\n                placeholder={t.repeatPassword}\n              />\n            </div>\n\n            {/* Error Message */}\n            {passwordError && (\n              <div className=\"p-2 bg-red-50 text-red-600 text-sm rounded-lg flex items-center gap-2\">\n                <AlertCircle className=\"w-4 h-4\" />\n                {passwordError}\n              </div>\n            )}\n\n            {/* Buttons */}\n            <div className=\"flex gap-3 pt-2\">\n              <button\n                onClick={() => {\n                  setEditingPassword(false);\n                  setCurrentPassword('');\n                  setNewPassword('');\n                  setConfirmPassword('');\n                  setPasswordError('');\n                }}\n                disabled={passwordLoading}\n                className=\"btn-secondary flex-1\"\n              >\n                {t.cancel}\n              </button>\n              <button\n                onClick={handleSavePassword}\n                disabled={passwordLoading}\n                className=\"btn-primary flex-1 flex items-center justify-center gap-2\"\n              >\n                {passwordLoading ? (\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                ) : (\n                  <Save className=\"w-4 h-4\" />\n                )}\n                {t.save}\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n\n      {/* Info Note - only for residents */}\n      {!isRentalUser && (\n        <div className=\"p-4 bg-blue-50 rounded-xl text-sm text-blue-700\">\n          <p className=\"font-medium mb-1\">{t.loginInfoTitle}</p>\n          <p>{t.loginInfo}</p>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["ResidentProfilePage","user","changePassword","updateProfile","markContractSigned","useAuthStore","language","setLanguage","useLanguageStore","isRentalUser","editingPhone","setEditingPhone","useState","newPhone","setNewPhone","phoneLoading","setPhoneLoading","editingPassword","setEditingPassword","currentPassword","setCurrentPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","showCurrentPassword","setShowCurrentPassword","showNewPassword","setShowNewPassword","passwordError","setPasswordError","passwordLoading","setPasswordLoading","successMessage","setSuccessMessage","showContract","setShowContract","qrCodeUrl","setQrCodeUrl","isDownloading","setIsDownloading","useEffect","residentData","url","generateQRCode","t","useMemo","formatDate","dateStr","getContractTypeLabel","type","handleSavePhone","handleSavePassword","error","errorMessage","handleDownloadContract","generateContractDocx","jsxs","jsx","CheckCircle","UserIcon","Key","MapPin","Home","Ruler","Building2","Phone","e","Loader2","Save","X","Edit3","Globe","FileText","Fragment","Sparkles","QrCode","EyeOff","Eye","Download","ContractPreview","Shield","AlertCircle"],"mappings":"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"}