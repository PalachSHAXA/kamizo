{"version":3,"file":"MeetingsPage-1768381324153-DTdiFgd7.js","sources":["../../src/utils/protocolGenerator.ts","../../src/pages/MeetingsPage.tsx"],"sourcesContent":["import PizZip from 'pizzip';\nimport QRCode from 'qrcode';\n\ninterface VoteResult {\n  votesFor: number;\n  votesAgainst: number;\n  votesAbstain: number;\n  percentFor: number;\n  percentAgainst: number;\n  percentAbstain: number;\n}\n\ninterface AgendaItem {\n  id: string;\n  item_order: number;\n  title: string;\n  description?: string;\n  votes_for_area: number;\n  votes_against_area: number;\n  votes_abstain_area: number;\n  decision?: 'approved' | 'rejected' | 'no_quorum';\n}\n\ninterface VoteRecord {\n  voter_id: string;\n  voter_name: string;\n  apartment_number: string;\n  vote_weight: number;\n  voted_at: string;\n  choice?: 'for' | 'against' | 'abstain';\n  qr_code?: string; // QR code for signature\n  comment?: string; // Комментарий/обоснование голоса\n}\n\ninterface Meeting {\n  id: string;\n  number: number;\n  building_id: string;\n  buildingAddress?: string;\n  building_address?: string;\n  description?: string;\n  format: 'online' | 'offline' | 'hybrid';\n  status: string;\n  confirmed_date_time?: string;\n  location?: string;\n  total_area: number;\n  voted_area: number;\n  total_eligible_count: number;\n  participated_count: number;\n  quorum_percent: number;\n  participation_percent: number;\n  quorum_reached: number;\n  voting_opened_at?: string;\n  voting_closed_at?: string;\n  organizer_name?: string;\n}\n\ninterface ProtocolData {\n  meeting: Meeting;\n  agendaItems: AgendaItem[];\n  voteRecords: VoteRecord[];\n  votesByItem: Record<string, VoteRecord[]>;\n  protocolHash?: string;\n}\n\n// UK Company details for QR code\nconst UK_COMPANY = {\n  name: 'OOO KAMIZO',\n  address: 'г. Ташкент, Яшнобадский район, ул. Махтумкули, дом 93/3',\n  bank: '«Ориент Финанс» ЧАКБ Миробад филиал',\n  account: '20208000805307918001',\n  inn: '307928888',\n  oked: '81100',\n  mfo: '01071',\n};\n\n// Cross-browser file download\nfunction downloadBlob(blob: Blob, fileName: string): void {\n  const url = URL.createObjectURL(blob);\n  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent);\n  const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n\n  if (isIOS || isSafari) {\n    const newWindow = window.open(url, '_blank');\n    if (!newWindow) {\n      window.location.href = url;\n    }\n    setTimeout(() => URL.revokeObjectURL(url), 10000);\n  } else {\n    const link = document.createElement('a');\n    link.href = url;\n    link.download = fileName;\n    link.style.display = 'none';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    setTimeout(() => URL.revokeObjectURL(url), 100);\n  }\n}\n\nconst MONTHS_RU: Record<number, string> = {\n  0: 'января', 1: 'февраля', 2: 'марта', 3: 'апреля', 4: 'мая', 5: 'июня',\n  6: 'июля', 7: 'августа', 8: 'сентября', 9: 'октября', 10: 'ноября', 11: 'декабря'\n};\n\nfunction formatDateRu(dateStr: string | undefined): string {\n  if (!dateStr) return '___';\n  const date = new Date(dateStr);\n  return `${date.getDate()} ${MONTHS_RU[date.getMonth()]} ${date.getFullYear()}`;\n}\n\nfunction formatTimeRu(dateStr: string | undefined): string {\n  if (!dateStr) return '___';\n  const date = new Date(dateStr);\n  return `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;\n}\n\nfunction escapeXml(str: string): string {\n  return str\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&apos;');\n}\n\n// Calculate vote result for an agenda item\nfunction calculateVoteResult(item: AgendaItem, _totalArea: number): VoteResult {\n  const votedArea = item.votes_for_area + item.votes_against_area + item.votes_abstain_area;\n  return {\n    votesFor: item.votes_for_area,\n    votesAgainst: item.votes_against_area,\n    votesAbstain: item.votes_abstain_area,\n    percentFor: votedArea > 0 ? (item.votes_for_area / votedArea) * 100 : 0,\n    percentAgainst: votedArea > 0 ? (item.votes_against_area / votedArea) * 100 : 0,\n    percentAbstain: votedArea > 0 ? (item.votes_abstain_area / votedArea) * 100 : 0,\n  };\n}\n\n// Convert base64 data URL to binary array\nfunction dataUrlToUint8Array(dataUrl: string): Uint8Array {\n  const base64 = dataUrl.split(',')[1];\n  const binaryString = atob(base64);\n  const bytes = new Uint8Array(binaryString.length);\n  for (let i = 0; i < binaryString.length; i++) {\n    bytes[i] = binaryString.charCodeAt(i);\n  }\n  return bytes;\n}\n\n// Generate UK company QR code\nasync function generateUKQRCode(): Promise<string> {\n  const ukData = [\n    `Компания: ${UK_COMPANY.name}`,\n    `Адрес: ${UK_COMPANY.address}`,\n    `Банк: ${UK_COMPANY.bank}`,\n    `Р/С: ${UK_COMPANY.account}`,\n    `ИНН: ${UK_COMPANY.inn}`,\n    `ОКЭД: ${UK_COMPANY.oked}`,\n    `МФО: ${UK_COMPANY.mfo}`,\n  ].join('\\n');\n\n  return await QRCode.toDataURL(ukData, {\n    width: 150,\n    margin: 1,\n    color: { dark: '#1f2937', light: '#ffffff' },\n  });\n}\n\n// Generate voter signature QR code\nasync function generateVoterQRCode(voter: VoteRecord, meetingNumber: number, buildingAddress: string): Promise<string> {\n  const voterData = [\n    `ЭЛЕКТРОННАЯ ПОДПИСЬ`,\n    `Протокол: ${meetingNumber}`,\n    `ФИО: ${voter.voter_name}`,\n    `Квартира: ${voter.apartment_number || '-'}`,\n    `Площадь: ${voter.vote_weight?.toFixed(2) || '-'} кв.м`,\n    `Голос: ${voter.choice === 'for' ? 'ЗА' : voter.choice === 'against' ? 'ПРОТИВ' : 'ВОЗДЕРЖАЛСЯ'}`,\n    `Дата: ${new Date(voter.voted_at).toLocaleString('ru-RU')}`,\n    `Адрес: ${buildingAddress}`,\n  ].join('\\n');\n\n  return await QRCode.toDataURL(voterData, {\n    width: 80,\n    margin: 1,\n    color: { dark: '#1f2937', light: '#ffffff' },\n  });\n}\n\n// Generate a table row XML for voting results\nfunction generateVotingTableXml(result: VoteResult): string {\n  return `\n<w:tbl>\n  <w:tblPr>\n    <w:tblW w:w=\"9000\" w:type=\"dxa\"/>\n    <w:tblBorders>\n      <w:top w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:left w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:bottom w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:right w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideH w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideV w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n    </w:tblBorders>\n    <w:jc w:val=\"center\"/>\n  </w:tblPr>\n  <w:tblGrid>\n    <w:gridCol w:w=\"3000\"/>\n    <w:gridCol w:w=\"3000\"/>\n    <w:gridCol w:w=\"3000\"/>\n  </w:tblGrid>\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr><w:t>ЗА</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr><w:t>ПРОТИВ</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr><w:t>ВОЗДЕРЖАЛИСЬ</w:t></w:r></w:p>\n    </w:tc>\n  </w:tr>\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>${result.votesFor.toFixed(2)} кв.м</w:t></w:r></w:p>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>(${result.percentFor.toFixed(1)}%)</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>${result.votesAgainst.toFixed(2)} кв.м</w:t></w:r></w:p>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>(${result.percentAgainst.toFixed(1)}%)</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"3000\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>${result.votesAbstain.toFixed(2)} кв.м</w:t></w:r></w:p>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"20\"/></w:rPr><w:t>(${result.percentAbstain.toFixed(1)}%)</w:t></w:r></w:p>\n    </w:tc>\n  </w:tr>\n</w:tbl>`;\n}\n\n// Generate voter list table for appendix with QR signatures\nfunction generateVoterListTableXml(voteRecords: VoteRecord[], voterImageIds: Map<string, string>): string {\n  let tableXml = `\n<w:tbl>\n  <w:tblPr>\n    <w:tblW w:w=\"9500\" w:type=\"dxa\"/>\n    <w:tblBorders>\n      <w:top w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:left w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:bottom w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:right w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideH w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideV w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n    </w:tblBorders>\n  </w:tblPr>\n  <w:tblGrid>\n    <w:gridCol w:w=\"500\"/>\n    <w:gridCol w:w=\"2800\"/>\n    <w:gridCol w:w=\"800\"/>\n    <w:gridCol w:w=\"1200\"/>\n    <w:gridCol w:w=\"1400\"/>\n    <w:gridCol w:w=\"1400\"/>\n    <w:gridCol w:w=\"1400\"/>\n  </w:tblGrid>\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"500\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>№</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"2800\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>ФИО собственника</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"800\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Кв.</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1200\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Площадь</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Дата</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Голос</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Э-подпись</w:t></w:r></w:p>\n    </w:tc>\n  </w:tr>`;\n\n  voteRecords.forEach((record, idx) => {\n    const votedDate = new Date(record.voted_at);\n    const choiceText = record.choice === 'for' ? 'ЗА' : record.choice === 'against' ? 'ПРОТИВ' : 'ВОЗДЕРЖ.';\n    const imageId = voterImageIds.get(record.voter_id);\n\n    // QR code image XML - inline (wp:inline) 1.5cm x 1.5cm = 600000 EMUs for table cell\n    const qrImageXml = imageId ? `<w:r><w:drawing><wp:inline distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"><wp:extent cx=\"600000\" cy=\"600000\"/><wp:docPr id=\"${1000 + idx}\" name=\"QR Signature ${idx}\"/><a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"><pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"><pic:nvPicPr><pic:cNvPr id=\"0\" name=\"voter_qr_${idx}.png\"/><pic:cNvPicPr/></pic:nvPicPr><pic:blipFill><a:blip r:embed=\"${imageId}\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"/><a:stretch><a:fillRect/></a:stretch></pic:blipFill><pic:spPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"600000\" cy=\"600000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r>` : '<w:r><w:t>✓</w:t></w:r>';\n\n    tableXml += `\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"500\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${idx + 1}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"2800\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${escapeXml(record.voter_name)}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"800\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${record.apartment_number || '-'}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1200\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${record.vote_weight?.toFixed(2) || '-'}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${votedDate.toLocaleDateString('ru-RU')}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${choiceText}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1400\" w:type=\"dxa\"/><w:vAlign w:val=\"center\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/></w:pPr>${qrImageXml}</w:p>\n    </w:tc>\n  </w:tr>`;\n  });\n\n  tableXml += `</w:tbl>`;\n  return tableXml;\n}\n\n// Generate votes by item table with optional comments\nfunction generateVotesByItemTableXml(_agendaItem: AgendaItem, votes: VoteRecord[]): string {\n  if (!votes || votes.length === 0) {\n    return '';\n  }\n\n  // Check if any vote has a comment\n  const hasComments = votes.some(v => v.comment && v.comment.trim().length > 0);\n\n  let tableXml = `\n<w:p><w:pPr><w:spacing w:before=\"100\"/><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr><w:t>Голоса участников:</w:t></w:r></w:p>\n<w:tbl>\n  <w:tblPr>\n    <w:tblW w:w=\"${hasComments ? '10500' : '9000'}\" w:type=\"dxa\"/>\n    <w:tblBorders>\n      <w:top w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:left w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:bottom w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:right w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideH w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n      <w:insideV w:val=\"single\" w:sz=\"4\" w:color=\"000000\"/>\n    </w:tblBorders>\n    <w:jc w:val=\"center\"/>\n  </w:tblPr>\n  <w:tblGrid>\n    <w:gridCol w:w=\"500\"/>\n    <w:gridCol w:w=\"${hasComments ? '2500' : '3500'}\"/>\n    <w:gridCol w:w=\"800\"/>\n    <w:gridCol w:w=\"1200\"/>\n    <w:gridCol w:w=\"1500\"/>\n    ${hasComments ? '<w:gridCol w:w=\"4000\"/>' : ''}\n  </w:tblGrid>\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"500\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>№</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"${hasComments ? '2500' : '3500'}\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>ФИО</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"800\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Кв.</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1200\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Площадь</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1500\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Голос</w:t></w:r></w:p>\n    </w:tc>\n    ${hasComments ? `<w:tc><w:tcPr><w:tcW w:w=\"4000\" w:type=\"dxa\"/><w:shd w:val=\"clear\" w:fill=\"E7E6E6\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:b/><w:sz w:val=\"16\"/></w:rPr><w:t>Обоснование</w:t></w:r></w:p>\n    </w:tc>` : ''}\n  </w:tr>`;\n\n  votes.forEach((v, idx) => {\n    const choiceText = v.choice === 'for' ? 'ЗА' : v.choice === 'against' ? 'ПРОТИВ' : 'ВОЗДЕРЖАЛСЯ';\n    const commentText = v.comment?.trim() || '';\n    tableXml += `\n  <w:tr>\n    <w:tc><w:tcPr><w:tcW w:w=\"500\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${idx + 1}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"${hasComments ? '2500' : '3500'}\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${escapeXml(v.voter_name)}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"800\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${v.apartment_number || '-'}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1200\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${v.vote_weight?.toFixed(2) || '-'}</w:t></w:r></w:p>\n    </w:tc>\n    <w:tc><w:tcPr><w:tcW w:w=\"1500\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"16\"/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"16\"/></w:rPr><w:t>${choiceText}</w:t></w:r></w:p>\n    </w:tc>\n    ${hasComments ? `<w:tc><w:tcPr><w:tcW w:w=\"4000\" w:type=\"dxa\"/></w:tcPr>\n      <w:p><w:pPr><w:rPr><w:sz w:val=\"14\"/><w:i/></w:rPr></w:pPr>\n      <w:r><w:rPr><w:sz w:val=\"14\"/><w:i/></w:rPr><w:t>${escapeXml(commentText)}</w:t></w:r></w:p>\n    </w:tc>` : ''}\n  </w:tr>`;\n  });\n\n  tableXml += `</w:tbl>`;\n  return tableXml;\n}\n\nexport async function generateProtocolDocx(data: ProtocolData): Promise<void> {\n  const { meeting, agendaItems, voteRecords, votesByItem } = data;\n\n  const address = meeting.buildingAddress || meeting.building_address || 'Адрес не указан';\n  const meetingDate = formatDateRu(meeting.confirmed_date_time || meeting.voting_opened_at);\n  const meetingTime = formatTimeRu(meeting.confirmed_date_time || meeting.voting_opened_at);\n  const location = meeting.location || address;\n  const format = meeting.format === 'online' ? 'заочной' : meeting.format === 'hybrid' ? 'очно-заочной' : 'очной';\n\n  // Generate UK company QR code\n  const ukQrCodeDataUrl = await generateUKQRCode();\n\n  // Generate QR codes for each voter\n  const voterQRCodes = new Map<string, string>();\n  const voterImageIds = new Map<string, string>();\n\n  for (let i = 0; i < voteRecords.length; i++) {\n    const voter = voteRecords[i];\n    const qrCode = await generateVoterQRCode(voter, meeting.number, address);\n    voterQRCodes.set(voter.voter_id, qrCode);\n    voterImageIds.set(voter.voter_id, `rId${200 + i}`);\n  }\n\n  // Generate agenda items content\n  let agendaItemsXml = '';\n\n  // First question is always election of chairman and secretary\n  agendaItemsXml += `\n<w:p><w:pPr><w:spacing w:before=\"200\" w:after=\"100\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>1. Избрание Председателя и Секретаря собрания</w:t></w:r></w:p>\n<w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>СЛУШАЛИ: Предложение об избрании Председателя и Секретаря собрания из числа присутствующих собственников помещений.</w:t></w:r></w:p>\n<w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>ПРЕДЛОЖЕНО: Избрать Председателем собрания представителя УК, Секретарём - ${meeting.organizer_name || 'представителя УК'}.</w:t></w:r></w:p>\n<w:p><w:pPr><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>ГОЛОСОВАЛИ:</w:t></w:r></w:p>\n${generateVotingTableXml({\n  votesFor: meeting.voted_area,\n  votesAgainst: 0,\n  votesAbstain: 0,\n  percentFor: 100,\n  percentAgainst: 0,\n  percentAbstain: 0,\n})}\n<w:p><w:pPr><w:spacing w:before=\"100\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>РЕШЕНИЕ: Избрать Председателя и Секретаря собрания. Решение принято.</w:t></w:r></w:p>\n`;\n\n  // Add actual agenda items\n  agendaItems.forEach((item, idx) => {\n    const result = calculateVoteResult(item, meeting.total_area);\n    const itemNumber = idx + 2; // +2 because first is election of chairman\n    const isApproved = result.percentFor > 50;\n    const itemVotes = votesByItem[item.id] || [];\n\n    agendaItemsXml += `\n<w:p><w:pPr><w:spacing w:before=\"300\" w:after=\"100\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>${itemNumber}. ${escapeXml(item.title)}</w:t></w:r></w:p>\n${item.description ? `<w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>СЛУШАЛИ: ${escapeXml(item.description)}</w:t></w:r></w:p>` : ''}\n<w:p><w:pPr><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>ГОЛОСОВАЛИ:</w:t></w:r></w:p>\n${generateVotingTableXml(result)}\n${generateVotesByItemTableXml(item, itemVotes)}\n<w:p><w:pPr><w:spacing w:before=\"100\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n<w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>РЕШЕНИЕ: ${isApproved ? 'Решение принято.' : 'Решение не принято.'}</w:t></w:r></w:p>\n`;\n  });\n\n  // UK QR code image XML for signatures section\n  const ukQrImageXml = `<w:r><w:drawing><wp:inline distT=\"0\" distB=\"0\" distL=\"0\" distR=\"0\" xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"><wp:extent cx=\"900000\" cy=\"900000\"/><wp:docPr id=\"999\" name=\"UK QR Code\"/><a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"><a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"><pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"><pic:nvPicPr><pic:cNvPr id=\"0\" name=\"uk_qr.png\"/><pic:cNvPicPr/></pic:nvPicPr><pic:blipFill><a:blip r:embed=\"rId100\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"/><a:stretch><a:fillRect/></a:stretch></pic:blipFill><pic:spPr><a:xfrm><a:off x=\"0\" y=\"0\"/><a:ext cx=\"900000\" cy=\"900000\"/></a:xfrm><a:prstGeom prst=\"rect\"><a:avLst/></a:prstGeom></pic:spPr></pic:pic></a:graphicData></a:graphic></wp:inline></w:drawing></w:r>`;\n\n  // Build the complete document.xml content\n  const documentXml = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<w:document xmlns:w=\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\"\n            xmlns:wp=\"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing\"\n            xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"\n            xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"\n            xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\">\n  <w:body>\n    <!-- Header -->\n    <w:p><w:pPr><w:jc w:val=\"right\"/><w:rPr><w:i/><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:i/><w:sz w:val=\"20\"/></w:rPr><w:t>Закон РУз «Об управлении многоквартирными домами»</w:t></w:r></w:p>\n\n    <!-- Title -->\n    <w:p><w:pPr><w:spacing w:before=\"400\" w:after=\"200\"/><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"28\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"28\"/></w:rPr><w:t>ПРОТОКОЛ № ${meeting.number}/${new Date().getFullYear()}</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr><w:t>общего собрания собственников помещений</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr><w:t>многоквартирного дома по адресу:</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr><w:t>${escapeXml(address)}</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>проведённого в форме ${format} голосования</w:t></w:r></w:p>\n\n    <!-- Meeting Info -->\n    <w:p><w:pPr><w:spacing w:before=\"200\"/><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>Дата проведения: </w:t></w:r>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>${meetingDate}</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>Время: </w:t></w:r>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>${meetingTime}</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>Место проведения: </w:t></w:r>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>${escapeXml(location)}</w:t></w:r></w:p>\n\n    <!-- Quorum Info -->\n    <w:p><w:pPr><w:spacing w:before=\"200\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>КВОРУМ:</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>Общая площадь помещений в доме: ${meeting.total_area.toFixed(2)} кв.м</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>Площадь помещений проголосовавших собственников: ${meeting.voted_area.toFixed(2)} кв.м</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>Процент участия: ${meeting.participation_percent.toFixed(1)}%</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>Количество проголосовавших: ${meeting.participated_count} из ${meeting.total_eligible_count} собственников</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:b/><w:sz w:val=\"22\"/><w:color w:val=\"${meeting.quorum_reached ? '008000' : 'FF0000'}\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/><w:color w:val=\"${meeting.quorum_reached ? '008000' : 'FF0000'}\"/></w:rPr><w:t>Кворум ${meeting.quorum_reached ? 'ИМЕЕТСЯ' : 'ОТСУТСТВУЕТ'} (требуется ${meeting.quorum_percent}%)</w:t></w:r></w:p>\n\n    <!-- Agenda -->\n    <w:p><w:pPr><w:spacing w:before=\"300\" w:after=\"100\"/><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr><w:t>ПОВЕСТКА ДНЯ:</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>1. Избрание Председателя и Секретаря собрания</w:t></w:r></w:p>\n    ${agendaItems.map((item, idx) => `\n    <w:p><w:pPr><w:rPr><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"22\"/></w:rPr><w:t>${idx + 2}. ${escapeXml(item.title)}</w:t></w:r></w:p>`).join('')}\n\n    <!-- Agenda Items Content -->\n    ${agendaItemsXml}\n\n    <!-- UK QR Code Signature -->\n    <w:p><w:pPr><w:spacing w:before=\"400\"/><w:jc w:val=\"center\"/></w:pPr>${ukQrImageXml}</w:p>\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"20\"/></w:rPr><w:t>Управляющая компания</w:t></w:r></w:p>\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:sz w:val=\"18\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:sz w:val=\"18\"/></w:rPr><w:t>${UK_COMPANY.name}</w:t></w:r></w:p>\n\n    <!-- Appendix - Page Break -->\n    <w:p><w:r><w:br w:type=\"page\"/></w:r></w:p>\n\n    <!-- Appendix Header -->\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"24\"/></w:rPr><w:t>ПРИЛОЖЕНИЕ № 1</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>к Протоколу № ${meeting.number}/${new Date().getFullYear()}</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:jc w:val=\"center\"/><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:b/><w:sz w:val=\"22\"/></w:rPr><w:t>РЕЕСТР УЧАСТНИКОВ ГОЛОСОВАНИЯ С ЭЛЕКТРОННЫМИ ПОДПИСЯМИ</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:spacing w:before=\"200\"/></w:pPr></w:p>\n\n    ${generateVoterListTableXml(voteRecords, voterImageIds)}\n\n    <!-- Footer -->\n    <w:p><w:pPr><w:spacing w:before=\"300\"/><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr><w:t>Протокол сформирован автоматически системой УК «KAMIZO»</w:t></w:r></w:p>\n\n    <w:p><w:pPr><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr><w:t>Дата формирования: ${new Date().toLocaleString('ru-RU')}</w:t></w:r></w:p>\n\n    ${data.protocolHash ? `<w:p><w:pPr><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr></w:pPr>\n    <w:r><w:rPr><w:i/><w:sz w:val=\"18\"/></w:rPr><w:t>Хеш документа: ${data.protocolHash}</w:t></w:r></w:p>` : ''}\n\n    <w:sectPr>\n      <w:pgSz w:w=\"11906\" w:h=\"16838\"/>\n      <w:pgMar w:top=\"1134\" w:right=\"850\" w:bottom=\"1134\" w:left=\"1701\"/>\n    </w:sectPr>\n  </w:body>\n</w:document>`;\n\n  // Create minimal DOCX structure\n  const zip = new PizZip();\n\n  // Add UK QR code image\n  const ukImageBytes = dataUrlToUint8Array(ukQrCodeDataUrl);\n  zip.file('word/media/uk_qr.png', ukImageBytes);\n\n  // Add voter QR code images\n  for (const [voterId, qrCode] of voterQRCodes) {\n    const imageBytes = dataUrlToUint8Array(qrCode);\n    const idx = voteRecords.findIndex(v => v.voter_id === voterId);\n    zip.file(`word/media/voter_qr_${idx}.png`, imageBytes);\n  }\n\n  // Build relationships for all images\n  let relsContent = `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n  <Relationship Id=\"rId100\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"media/uk_qr.png\"/>`;\n\n  for (let i = 0; i < voteRecords.length; i++) {\n    relsContent += `\n  <Relationship Id=\"rId${200 + i}\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"media/voter_qr_${i}.png\"/>`;\n  }\n  relsContent += `\n</Relationships>`;\n\n  // Add required files\n  zip.file('[Content_Types].xml', `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">\n  <Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\"/>\n  <Default Extension=\"xml\" ContentType=\"application/xml\"/>\n  <Default Extension=\"png\" ContentType=\"image/png\"/>\n  <Override PartName=\"/word/document.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml\"/>\n</Types>`);\n\n  zip.file('_rels/.rels', `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">\n  <Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"word/document.xml\"/>\n</Relationships>`);\n\n  zip.file('word/_rels/document.xml.rels', relsContent);\n  zip.file('word/document.xml', documentXml);\n\n  // Generate blob\n  const blob = zip.generate({\n    type: 'blob',\n    mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  });\n\n  // Download\n  const fileName = `Протокол_${meeting.number}_${address.replace(/[^a-zA-Zа-яА-ЯёЁ0-9]/g, '_')}.docx`;\n  downloadBlob(blob, fileName);\n}\n","import { useState, useMemo, useEffect } from 'react';\nimport {\n  Plus, Users, Calendar, AlertCircle,\n  FileText, Building2, User,\n  ThumbsUp, ThumbsDown, Minus, Eye,\n  Play, Square, BarChart3, Shield, X, Check, CalendarCheck, Download, Trash2\n} from 'lucide-react';\nimport { useAuthStore } from '../stores/authStore';\nimport { useMeetingStore } from '../stores/meetingStore';\nimport { useLanguageStore } from '../stores/languageStore';\nimport { useCRMStore } from '../stores/crmStore';\nimport { generateProtocolDocx } from '../utils/protocolGenerator';\nimport type {\n  Meeting, MeetingStatus, MeetingFormat, AgendaItem, AgendaItemType,\n  MeetingOrganizerType, DecisionThreshold\n} from '../types';\nimport { AGENDA_ITEM_TYPES, MEETING_STATUS_LABELS, DECISION_THRESHOLD_LABELS } from '../types';\n\nexport function MeetingsPage() {\n  const { user } = useAuthStore();\n  const { t, language } = useLanguageStore();\n  const { buildings, fetchBuildings } = useCRMStore();\n  const {\n    meetings,\n    fetchMeetings,\n    createMeeting,\n    approveMeeting,\n    rejectMeeting,\n    confirmSchedule,\n    openVoting,\n    closeVoting,\n    publishResults,\n    generateProtocol,\n    approveProtocol,\n    deleteMeeting,\n    calculateAgendaItemResult,\n    calculateMeetingQuorum,\n  } = useMeetingStore();\n\n  // Fetch meetings and buildings on component mount\n  useEffect(() => {\n    fetchMeetings();\n    fetchBuildings();\n  }, [fetchMeetings, fetchBuildings]);\n\n  const [activeTab, setActiveTab] = useState<'all' | 'active' | 'completed' | 'pending'>('all');\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedMeeting, setSelectedMeeting] = useState<Meeting | null>(null);\n  const [showDetailsModal, setShowDetailsModal] = useState(false);\n\n  // Filter meetings by tab\n  const filteredMeetings = useMemo(() => {\n    switch (activeTab) {\n      case 'active':\n        return meetings.filter(m =>\n          ['schedule_poll_open', 'schedule_confirmed', 'voting_open'].includes(m.status)\n        );\n      case 'completed':\n        return meetings.filter(m =>\n          ['voting_closed', 'results_published', 'protocol_generated', 'protocol_approved'].includes(m.status)\n        );\n      case 'pending':\n        return meetings.filter(m =>\n          ['draft', 'pending_moderation'].includes(m.status)\n        );\n      default:\n        return meetings;\n    }\n  }, [meetings, activeTab]);\n\n  const getStatusColor = (status: MeetingStatus): string => {\n    return MEETING_STATUS_LABELS[status]?.color || 'gray';\n  };\n\n  const getStatusLabel = (status: MeetingStatus): string => {\n    const labels = MEETING_STATUS_LABELS[status];\n    return language === 'ru' ? labels?.label : labels?.labelUz;\n  };\n\n  const formatDate = (dateStr: string) => {\n    const date = new Date(dateStr);\n    return date.toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\n      day: '2-digit',\n      month: 'short',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  const handleViewDetails = (meeting: Meeting) => {\n    setSelectedMeeting(meeting);\n    setShowDetailsModal(true);\n  };\n\n  const handleDelete = async (id: string) => {\n    if (confirm(language === 'ru' ? 'Удалить собрание? Это действие необратимо.' : 'Yig\\'ilishni o\\'chirmoqchimisiz? Bu amalni bekor qilib bo\\'lmaydi.')) {\n      await deleteMeeting(id);\n    }\n  };\n\n  const tabs = [\n    { id: 'all' as const, label: language === 'ru' ? 'Все' : 'Barchasi', count: meetings.length },\n    { id: 'active' as const, label: language === 'ru' ? 'Активные' : 'Faol', count: meetings.filter(m => ['schedule_poll_open', 'schedule_confirmed', 'voting_open'].includes(m.status)).length },\n    { id: 'pending' as const, label: language === 'ru' ? 'Ожидают' : 'Kutmoqda', count: meetings.filter(m => ['draft', 'pending_moderation'].includes(m.status)).length },\n    { id: 'completed' as const, label: language === 'ru' ? 'Завершены' : 'Tugallangan', count: meetings.filter(m => ['voting_closed', 'results_published', 'protocol_generated', 'protocol_approved'].includes(m.status)).length },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-gray-900\">{t('meetings.title')}</h1>\n          <p className=\"text-gray-500\">{t('meetings.subtitle')}</p>\n        </div>\n        <button\n          onClick={() => setShowCreateModal(true)}\n          className=\"btn-primary flex items-center gap-2\"\n        >\n          <Plus className=\"w-5 h-5\" />\n          {t('meetings.create')}\n        </button>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"flex gap-2 flex-wrap\">\n        {tabs.map((tab) => (\n          <button\n            key={tab.id}\n            onClick={() => setActiveTab(tab.id)}\n            className={`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-colors ${\n              activeTab === tab.id\n                ? 'bg-orange-400 text-gray-900'\n                : 'bg-white text-gray-600 hover:bg-gray-100'\n            }`}\n          >\n            {tab.label}\n            {tab.count > 0 && (\n              <span className=\"ml-1 px-2 py-0.5 rounded-full bg-gray-900/10 text-xs\">\n                {tab.count}\n              </span>\n            )}\n          </button>\n        ))}\n      </div>\n\n      {/* Meetings List */}\n      <div className=\"space-y-4\">\n        {filteredMeetings.length === 0 ? (\n          <div className=\"glass-card p-12 text-center\">\n            <Users className=\"w-16 h-16 mx-auto text-gray-300 mb-4\" />\n            <h3 className=\"text-lg font-medium text-gray-600 mb-2\">\n              {t('meetings.noMeetings')}\n            </h3>\n            <p className=\"text-gray-400\">{t('meetings.createFirst')}</p>\n          </div>\n        ) : (\n          filteredMeetings.map((meeting) => (\n            <MeetingCard\n              key={meeting.id}\n              meeting={meeting}\n              language={language}\n              getStatusColor={getStatusColor}\n              getStatusLabel={getStatusLabel}\n              formatDate={formatDate}\n              onViewDetails={() => handleViewDetails(meeting)}\n              onApprove={() => approveMeeting(meeting.id)}\n              onReject={(reason) => rejectMeeting(meeting.id, reason)}\n              onConfirmSchedule={() => confirmSchedule(meeting.id)}\n              onOpenVoting={() => openVoting(meeting.id)}\n              onCloseVoting={() => closeVoting(meeting.id)}\n              onPublishResults={() => publishResults(meeting.id)}\n              onGenerateProtocol={() => generateProtocol(meeting.id)}\n              onApproveProtocol={() => approveProtocol(meeting.id)}\n              onDelete={() => handleDelete(meeting.id)}\n              calculateQuorum={() => calculateMeetingQuorum(meeting.id)}\n              user={user}\n            />\n          ))\n        )}\n      </div>\n\n      {/* Create Meeting Modal */}\n      {showCreateModal && (\n        <CreateMeetingWizard\n          onClose={() => setShowCreateModal(false)}\n          onCreate={async (data) => {\n            try {\n              await createMeeting(data);\n              await fetchMeetings(); // Refresh the list\n              setShowCreateModal(false);\n            } catch (err) {\n              console.error('Failed to create meeting:', err);\n            }\n          }}\n          language={language}\n          user={user}\n          buildings={buildings.map(b => ({ id: b.id, name: b.name, address: b.address }))}\n        />\n      )}\n\n      {/* Meeting Details Modal */}\n      {showDetailsModal && selectedMeeting && (\n        <MeetingDetailsModal\n          meeting={selectedMeeting}\n          onClose={() => {\n            setShowDetailsModal(false);\n            setSelectedMeeting(null);\n          }}\n          language={language}\n          calculateResult={calculateAgendaItemResult}\n          calculateQuorum={() => calculateMeetingQuorum(selectedMeeting.id)}\n        />\n      )}\n    </div>\n  );\n}\n\n// Meeting Card Component\nfunction MeetingCard({\n  meeting,\n  language,\n  getStatusColor,\n  getStatusLabel,\n  formatDate,\n  onViewDetails,\n  onApprove,\n  onReject,\n  onConfirmSchedule,\n  onOpenVoting,\n  onCloseVoting,\n  onPublishResults,\n  onGenerateProtocol,\n  onApproveProtocol,\n  onDelete,\n  calculateQuorum,\n  user,\n}: {\n  meeting: Meeting;\n  language: string;\n  getStatusColor: (status: MeetingStatus) => string;\n  getStatusLabel: (status: MeetingStatus) => string;\n  formatDate: (date: string) => string;\n  onViewDetails: () => void;\n  onApprove: () => void;\n  onReject: (reason: string) => void;\n  onConfirmSchedule: () => void;\n  onOpenVoting: () => void;\n  onCloseVoting: () => void;\n  onPublishResults: () => void;\n  onGenerateProtocol: () => void;\n  onApproveProtocol: () => void;\n  onDelete: () => void;\n  calculateQuorum: () => { participated: number; total: number; percent: number; quorumReached: boolean };\n  user: { id: string; role: string } | null;\n}) {\n  const quorum = calculateQuorum();\n\n  const statusColor = getStatusColor(meeting.status);\n  const colorClasses: Record<string, string> = {\n    gray: 'bg-gray-100 text-gray-700',\n    yellow: 'bg-yellow-100 text-orange-700',\n    blue: 'bg-blue-100 text-blue-700',\n    indigo: 'bg-indigo-100 text-indigo-700',\n    green: 'bg-green-100 text-green-700',\n    orange: 'bg-orange-100 text-orange-700',\n    purple: 'bg-purple-100 text-purple-700',\n    teal: 'bg-teal-100 text-teal-700',\n    emerald: 'bg-emerald-100 text-emerald-700',\n    red: 'bg-red-100 text-red-700',\n  };\n\n  return (\n    <div className=\"glass-card p-5 hover:shadow-lg transition-shadow\">\n      <div className=\"flex items-start justify-between gap-4\">\n        <div className=\"flex-1 min-w-0\">\n          {/* Header */}\n          <div className=\"flex items-center gap-3 mb-3 flex-wrap\">\n            <span className={`px-3 py-1 rounded-lg text-sm font-medium ${colorClasses[statusColor] || colorClasses.gray}`}>\n              {getStatusLabel(meeting.status)}\n            </span>\n            <span className=\"text-sm text-gray-500\">\n              #{meeting.number}\n            </span>\n            <span className={`px-2 py-0.5 rounded text-xs font-medium ${\n              meeting.format === 'online' ? 'bg-blue-50 text-blue-600' :\n              meeting.format === 'offline' ? 'bg-green-50 text-green-600' :\n              'bg-purple-50 text-purple-600'\n            }`}>\n              {meeting.format === 'online' ? (language === 'ru' ? 'Онлайн' : 'Onlayn') :\n               meeting.format === 'offline' ? (language === 'ru' ? 'Очное' : 'Yuzma-yuz') :\n               (language === 'ru' ? 'Смешанное' : 'Aralash')}\n            </span>\n          </div>\n\n          {/* Building & Date */}\n          <div className=\"flex items-center gap-4 text-sm text-gray-600 mb-2\">\n            <span className=\"flex items-center gap-1\">\n              <Building2 className=\"w-4 h-4\" />\n              {meeting.buildingAddress}\n            </span>\n            {meeting.confirmedDateTime && (\n              <span className=\"flex items-center gap-1\">\n                <Calendar className=\"w-4 h-4\" />\n                {formatDate(meeting.confirmedDateTime)}\n              </span>\n            )}\n          </div>\n\n          {/* Organizer */}\n          <div className=\"flex items-center gap-2 text-sm text-gray-500 mb-3\">\n            <User className=\"w-4 h-4\" />\n            <span>{meeting.organizerName}</span>\n            <span className=\"text-gray-400\">\n              ({meeting.organizerType === 'resident'\n                ? (language === 'ru' ? 'Житель' : 'Aholi')\n                : (language === 'ru' ? 'УК' : 'UK')})\n            </span>\n          </div>\n\n          {/* Agenda Summary */}\n          <div className=\"flex items-center gap-2 text-sm\">\n            <FileText className=\"w-4 h-4 text-gray-400\" />\n            <span className=\"text-gray-600\">\n              {meeting.agendaItems.length} {language === 'ru' ? 'вопросов в повестке' : 'savol kun tartibida'}\n            </span>\n          </div>\n\n          {/* Schedule Poll Stats - show votes for each date option */}\n          {meeting.status === 'schedule_poll_open' && meeting.scheduleOptions && meeting.scheduleOptions.length > 0 && (\n            <div className=\"mt-3 pt-3 border-t border-gray-100\">\n              <div className=\"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2\">\n                <Calendar className=\"w-4 h-4 text-blue-500\" />\n                {language === 'ru' ? 'Голосование за дату:' : 'Sana uchun ovoz berish:'}\n              </div>\n              <div className=\"space-y-1\">\n                {meeting.scheduleOptions.map((option) => {\n                  const totalVotes = meeting.scheduleOptions.reduce((sum, opt) => sum + ((opt as any).voteCount ?? opt.votes?.length ?? 0), 0);\n                  const voteCount = (option as any).voteCount ?? option.votes?.length ?? 0;\n                  const percent = totalVotes > 0 ? (voteCount / totalVotes * 100) : 0;\n                  const isLeading = voteCount > 0 && voteCount === Math.max(...meeting.scheduleOptions.map(o => (o as any).voteCount ?? o.votes?.length ?? 0));\n\n                  return (\n                    <div key={option.id} className=\"flex items-center gap-2 text-sm\">\n                      <div className={`flex-1 flex items-center gap-2 ${isLeading ? 'font-medium text-blue-700' : 'text-gray-600'}`}>\n                        <span>{formatDate(option.dateTime)}</span>\n                        {isLeading && voteCount > 0 && (\n                          <span className=\"text-xs px-1.5 py-0.5 bg-blue-100 text-blue-700 rounded\">\n                            {language === 'ru' ? 'Лидер' : 'Yetakchi'}\n                          </span>\n                        )}\n                      </div>\n                      <div className=\"flex items-center gap-2\">\n                        <div className=\"w-20 h-2 bg-gray-100 rounded-full overflow-hidden\">\n                          <div\n                            className=\"h-full bg-blue-500 rounded-full transition-all\"\n                            style={{ width: `${percent}%` }}\n                          />\n                        </div>\n                        <span className=\"text-xs text-gray-500 w-12 text-right\">{voteCount} ({percent.toFixed(0)}%)</span>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n              <div className=\"text-xs text-gray-400 mt-2\">\n                {language === 'ru' ? 'Всего голосов: ' : 'Jami ovozlar: '}\n                {meeting.scheduleOptions.reduce((sum, opt) => sum + ((opt as any).voteCount ?? opt.votes?.length ?? 0), 0)}\n              </div>\n            </div>\n          )}\n\n          {/* Participation stats for active/completed meetings */}\n          {['voting_open', 'voting_closed', 'results_published', 'protocol_generated', 'protocol_approved'].includes(meeting.status) && (\n            <div className=\"flex items-center gap-4 mt-3 pt-3 border-t border-gray-100\">\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"w-4 h-4 text-gray-400\" />\n                <span className=\"text-sm\">\n                  {quorum.participated}/{quorum.total} ({quorum.percent.toFixed(1)}%)\n                </span>\n              </div>\n              <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${\n                quorum.quorumReached\n                  ? 'bg-green-100 text-green-700'\n                  : 'bg-red-100 text-red-700'\n              }`}>\n                {quorum.quorumReached\n                  ? (language === 'ru' ? 'Кворум есть' : 'Kvorum bor')\n                  : (language === 'ru' ? 'Нет кворума' : 'Kvorum yo\\'q')}\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex flex-col gap-2\">\n          <button\n            onClick={onViewDetails}\n            className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors\"\n            title={language === 'ru' ? 'Подробнее' : 'Batafsil'}\n          >\n            <Eye className=\"w-5 h-5\" />\n          </button>\n\n          {/* Status-specific actions */}\n          {meeting.status === 'pending_moderation' && (user?.role === 'admin' || user?.role === 'manager' || user?.role === 'director') && (\n            <>\n              <button\n                onClick={onApprove}\n                className=\"p-2 text-green-500 hover:text-green-700 hover:bg-green-50 rounded-lg transition-colors\"\n                title={language === 'ru' ? 'Одобрить' : 'Tasdiqlash'}\n              >\n                <Check className=\"w-5 h-5\" />\n              </button>\n              <button\n                onClick={() => onReject(language === 'ru' ? 'Отклонено модератором' : 'Moderator tomonidan rad etildi')}\n                className=\"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors\"\n                title={language === 'ru' ? 'Отклонить' : 'Rad etish'}\n              >\n                <X className=\"w-5 h-5\" />\n              </button>\n            </>\n          )}\n\n          {/* Delete button - for admin/manager/director (all meetings including completed) */}\n          {(user?.role === 'admin' || user?.role === 'manager' || user?.role === 'director') && (\n            <button\n              onClick={onDelete}\n              className=\"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors\"\n              title={language === 'ru' ? 'Удалить' : 'O\\'chirish'}\n            >\n              <Trash2 className=\"w-5 h-5\" />\n            </button>\n          )}\n\n        </div>\n      </div>\n\n      {/* Admin Action Buttons - Full width at bottom */}\n      {(user?.role === 'admin' || user?.role === 'manager' || user?.role === 'director') && (\n        <div className=\"mt-4 pt-4 border-t border-gray-100 flex flex-wrap gap-2\">\n          {meeting.status === 'schedule_poll_open' && (\n            <button\n              onClick={onConfirmSchedule}\n              className=\"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm font-medium\"\n            >\n              <CalendarCheck className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Подтвердить дату' : 'Sanani tasdiqlash'}\n            </button>\n          )}\n\n          {meeting.status === 'schedule_confirmed' && (\n            <button\n              onClick={onOpenVoting}\n              className=\"flex items-center gap-2 px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors text-sm font-medium\"\n            >\n              <Play className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Открыть голосование' : 'Ovoz berishni ochish'}\n            </button>\n          )}\n\n          {meeting.status === 'voting_open' && (\n            <button\n              onClick={onCloseVoting}\n              className=\"flex items-center gap-2 px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors text-sm font-medium\"\n            >\n              <Square className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Закрыть голосование' : 'Ovoz berishni yopish'}\n            </button>\n          )}\n\n          {meeting.status === 'voting_closed' && (\n            <button\n              onClick={onPublishResults}\n              className=\"flex items-center gap-2 px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors text-sm font-medium\"\n            >\n              <BarChart3 className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Опубликовать итоги' : 'Natijalarni e\\'lon qilish'}\n            </button>\n          )}\n\n          {meeting.status === 'results_published' && (\n            <button\n              onClick={onGenerateProtocol}\n              className=\"flex items-center gap-2 px-4 py-2 bg-teal-500 hover:bg-teal-600 text-white rounded-lg transition-colors text-sm font-medium\"\n            >\n              <FileText className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Сформировать протокол' : 'Bayonnoma yaratish'}\n            </button>\n          )}\n\n          {meeting.status === 'protocol_generated' && (\n            <>\n              <button\n                onClick={onApproveProtocol}\n                className=\"flex items-center gap-2 px-4 py-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-lg transition-colors text-sm font-medium\"\n              >\n                <Shield className=\"w-4 h-4\" />\n                {language === 'ru' ? 'Подписать протокол' : 'Bayonnomani imzolash'}\n              </button>\n              <button\n                onClick={onViewDetails}\n                className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium\"\n              >\n                <Download className=\"w-4 h-4\" />\n                {language === 'ru' ? 'Скачать протокол' : 'Bayonnomani yuklab olish'}\n              </button>\n            </>\n          )}\n\n          {meeting.status === 'protocol_approved' && (\n            <button\n              onClick={onViewDetails}\n              className=\"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-medium\"\n            >\n              <Download className=\"w-4 h-4\" />\n              {language === 'ru' ? 'Скачать протокол' : 'Bayonnomani yuklab olish'}\n            </button>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Create Meeting Wizard\nfunction CreateMeetingWizard({\n  onClose,\n  onCreate,\n  language,\n  user,\n  buildings,\n}: {\n  onClose: () => void;\n  onCreate: (data: {\n    buildingId: string;\n    buildingAddress: string;\n    organizerType: MeetingOrganizerType;\n    organizerId: string;\n    organizerName: string;\n    format: MeetingFormat;\n    agendaItems: Omit<AgendaItem, 'id' | 'votesFor' | 'votesAgainst' | 'votesAbstain' | 'order'>[];\n    location?: string;\n    description?: string;\n  }) => void;\n  language: string;\n  user: { id: string; name: string; role: string; buildingId?: string } | null;\n  buildings: { id: string; name: string; address: string }[];\n}) {\n  const [step, setStep] = useState(1);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [showCustomItemForm, setShowCustomItemForm] = useState(false);\n  const [newCustomItem, setNewCustomItem] = useState({ title: '', description: '', threshold: 'simple_majority' as DecisionThreshold });\n  const [formData, setFormData] = useState({\n    buildingId: user?.buildingId || (buildings.length > 0 ? buildings[0].id : ''),\n    buildingAddress: buildings.length > 0 ? buildings[0].address : '',\n    organizerType: 'management' as MeetingOrganizerType,\n    format: 'online' as MeetingFormat,\n    agendaItems: [] as AgendaItemType[],\n    customItems: [] as { title: string; description: string; threshold: DecisionThreshold }[],\n    location: '',\n    description: '', // Описание/обоснование собрания\n  });\n\n  const handleBuildingChange = (buildingId: string) => {\n    const building = buildings.find(b => b.id === buildingId);\n    setFormData({\n      ...formData,\n      buildingId,\n      buildingAddress: building?.address || '',\n    });\n  };\n\n  const handleAddAgendaItem = (type: AgendaItemType) => {\n    if (formData.agendaItems.includes(type)) {\n      setFormData({ ...formData, agendaItems: formData.agendaItems.filter(t => t !== type) });\n    } else {\n      setFormData({ ...formData, agendaItems: [...formData.agendaItems, type] });\n    }\n  };\n\n  const handleCreate = async () => {\n    if (!user || !formData.buildingId || isSubmitting) return;\n\n    setIsSubmitting(true);\n\n    const agendaItems = [\n      ...formData.agendaItems.map(type => ({\n        type,\n        title: language === 'ru' ? AGENDA_ITEM_TYPES[type].label : AGENDA_ITEM_TYPES[type].labelUz,\n        description: language === 'ru' ? AGENDA_ITEM_TYPES[type].description : AGENDA_ITEM_TYPES[type].descriptionUz,\n        threshold: AGENDA_ITEM_TYPES[type].defaultThreshold,\n        materials: [],\n      })),\n      ...formData.customItems.map(item => ({\n        type: 'other' as AgendaItemType,\n        title: item.title,\n        description: item.description,\n        threshold: item.threshold,\n        materials: [],\n      })),\n    ];\n\n    try {\n      await onCreate({\n        buildingId: formData.buildingId,\n        buildingAddress: formData.buildingAddress,\n        organizerType: formData.organizerType,\n        organizerId: user.id,\n        organizerName: user.name,\n        format: formData.format,\n        agendaItems,\n        location: formData.location || undefined,\n        description: formData.description || undefined,\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const steps = [\n    { num: 1, label: language === 'ru' ? 'Тип' : 'Turi' },\n    { num: 2, label: language === 'ru' ? 'Повестка' : 'Kun tartibi' },\n    { num: 3, label: language === 'ru' ? 'Публикация' : 'Nashr' },\n  ];\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-gray-100 flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-xl font-bold\">\n              {language === 'ru' ? 'Созвать собрание' : 'Yig\\'ilish chaqirish'}\n            </h2>\n            <p className=\"text-sm text-gray-500\">\n              {language === 'ru' ? `Шаг ${step} из 3` : `Bosqich ${step} dan 3`}\n            </p>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 rounded-xl transition-colors\"\n          >\n            <X className=\"w-5 h-5\" />\n          </button>\n        </div>\n\n        {/* Progress */}\n        <div className=\"px-6 py-4 border-b border-gray-100\">\n          <div className=\"flex items-center justify-between\">\n            {steps.map((s, i) => (\n              <div key={s.num} className=\"flex items-center\">\n                <div className={`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${\n                  step >= s.num ? 'bg-orange-400 text-gray-900' : 'bg-gray-200 text-gray-500'\n                }`}>\n                  {s.num}\n                </div>\n                <span className={`ml-2 text-sm ${step >= s.num ? 'text-gray-900' : 'text-gray-500'}`}>\n                  {s.label}\n                </span>\n                {i < steps.length - 1 && (\n                  <div className={`w-16 h-1 mx-4 rounded ${step > s.num ? 'bg-orange-400' : 'bg-gray-200'}`} />\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-6\">\n          {step === 1 && (\n            <>\n              {/* Building Selection */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                  {language === 'ru' ? 'Выберите дом' : 'Uyni tanlang'}\n                </label>\n                {buildings.length === 0 ? (\n                  <div className=\"p-4 bg-yellow-50 border border-yellow-200 rounded-xl text-sm text-yellow-800\">\n                    {language === 'ru'\n                      ? 'Нет доступных домов. Сначала добавьте дом в системе.'\n                      : 'Mavjud uylar yo\\'q. Avval tizimda uy qo\\'shing.'}\n                  </div>\n                ) : (\n                  <select\n                    value={formData.buildingId}\n                    onChange={(e) => handleBuildingChange(e.target.value)}\n                    className=\"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-400 focus:border-orange-400\"\n                  >\n                    {buildings.map((building) => (\n                      <option key={building.id} value={building.id}>\n                        {building.name} - {building.address}\n                      </option>\n                    ))}\n                  </select>\n                )}\n              </div>\n\n              {/* Organizer Type */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                  {language === 'ru' ? 'Организатор' : 'Tashkilotchi'}\n                </label>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  <button\n                    onClick={() => setFormData({ ...formData, organizerType: 'management' })}\n                    className={`p-4 rounded-xl border-2 transition-colors ${\n                      formData.organizerType === 'management'\n                        ? 'border-orange-400 bg-yellow-50'\n                        : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                  >\n                    <Building2 className=\"w-6 h-6 mb-2 mx-auto text-gray-600\" />\n                    <div className=\"text-sm font-medium\">\n                      {language === 'ru' ? 'Управляющая компания' : 'Boshqaruv kompaniyasi'}\n                    </div>\n                  </button>\n                  <button\n                    onClick={() => setFormData({ ...formData, organizerType: 'resident' })}\n                    className={`p-4 rounded-xl border-2 transition-colors ${\n                      formData.organizerType === 'resident'\n                        ? 'border-orange-400 bg-yellow-50'\n                        : 'border-gray-200 hover:border-gray-300'\n                    }`}\n                  >\n                    <User className=\"w-6 h-6 mb-2 mx-auto text-gray-600\" />\n                    <div className=\"text-sm font-medium\">\n                      {language === 'ru' ? 'Житель (инициатива)' : 'Aholi (tashabbusi)'}\n                    </div>\n                  </button>\n                </div>\n              </div>\n\n              {/* Format */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                  {language === 'ru' ? 'Формат проведения' : 'O\\'tkazish formati'}\n                </label>\n                <div className=\"grid grid-cols-3 gap-3\">\n                  {(['online', 'offline', 'hybrid'] as MeetingFormat[]).map((format) => (\n                    <button\n                      key={format}\n                      onClick={() => setFormData({ ...formData, format })}\n                      className={`p-3 rounded-xl border-2 transition-colors ${\n                        formData.format === format\n                          ? 'border-orange-400 bg-yellow-50'\n                          : 'border-gray-200 hover:border-gray-300'\n                      }`}\n                    >\n                      <div className=\"text-sm font-medium\">\n                        {format === 'online'\n                          ? (language === 'ru' ? 'Онлайн' : 'Onlayn')\n                          : format === 'offline'\n                          ? (language === 'ru' ? 'Очное' : 'Yuzma-yuz')\n                          : (language === 'ru' ? 'Смешанное' : 'Aralash')}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </div>\n\n              {/* Location (for offline/hybrid) */}\n              {formData.format !== 'online' && (\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    {language === 'ru' ? 'Место проведения' : 'O\\'tkazish joyi'}\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={formData.location}\n                    onChange={(e) => setFormData({ ...formData, location: e.target.value })}\n                    className=\"glass-input\"\n                    placeholder={language === 'ru' ? 'Например: Холл 1 этажа' : 'Masalan: 1-qavat zali'}\n                  />\n                </div>\n              )}\n\n              {/* Description/Justification */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  {language === 'ru' ? 'Обоснование собрания' : 'Yig\\'ilish asoslashi'}\n                  <span className=\"text-gray-400 font-normal ml-1\">\n                    ({language === 'ru' ? 'необязательно' : 'ixtiyoriy'})\n                  </span>\n                </label>\n                <textarea\n                  value={formData.description}\n                  onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n                  className=\"glass-input min-h-[80px] resize-none\"\n                  placeholder={language === 'ru'\n                    ? 'Опишите причину созыва собрания и что планируется обсудить...'\n                    : 'Yig\\'ilish sababi va nimalar muhokama qilinishini tasvirlang...'}\n                  rows={3}\n                />\n              </div>\n            </>\n          )}\n\n          {step === 2 && (\n            <>\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-3\">\n                  {language === 'ru' ? 'Выберите вопросы повестки' : 'Kun tartibi savollarini tanlang'}\n                </label>\n                <div className=\"space-y-2 max-h-96 overflow-y-auto\">\n                  {(Object.keys(AGENDA_ITEM_TYPES) as AgendaItemType[]).map((type) => {\n                    const item = AGENDA_ITEM_TYPES[type];\n                    const isSelected = formData.agendaItems.includes(type);\n\n                    return (\n                      <button\n                        key={type}\n                        onClick={() => handleAddAgendaItem(type)}\n                        className={`w-full p-4 rounded-xl border-2 text-left transition-colors ${\n                          isSelected\n                            ? 'border-orange-400 bg-yellow-50'\n                            : 'border-gray-200 hover:border-gray-300'\n                        }`}\n                      >\n                        <div className=\"flex items-start justify-between\">\n                          <div>\n                            <div className=\"font-medium\">\n                              {language === 'ru' ? item.label : item.labelUz}\n                            </div>\n                            <div className=\"text-sm text-gray-500 mt-1\">\n                              {language === 'ru' ? item.description : item.descriptionUz}\n                            </div>\n                            <div className=\"flex items-center gap-2 mt-2\">\n                              <span className=\"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600\">\n                                {language === 'ru'\n                                  ? DECISION_THRESHOLD_LABELS[item.defaultThreshold].label\n                                  : DECISION_THRESHOLD_LABELS[item.defaultThreshold].labelUz}\n                              </span>\n                              {item.requiresMaterials && (\n                                <span className=\"text-xs px-2 py-0.5 rounded bg-blue-100 text-blue-600\">\n                                  {language === 'ru' ? 'Нужны материалы' : 'Materiallar kerak'}\n                                </span>\n                              )}\n                            </div>\n                          </div>\n                          <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${\n                            isSelected ? 'border-orange-400 bg-orange-400' : 'border-gray-300'\n                          }`}>\n                            {isSelected && <Check className=\"w-4 h-4 text-gray-900\" />}\n                          </div>\n                        </div>\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n\n              {/* Custom Items Section */}\n              <div className=\"mt-6 pt-6 border-t border-gray-200\">\n                <div className=\"flex items-center justify-between mb-3\">\n                  <label className=\"block text-sm font-medium text-gray-700\">\n                    {language === 'ru' ? 'Свои вопросы' : 'O\\'z savollaringiz'}\n                  </label>\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowCustomItemForm(true)}\n                    className=\"text-sm text-orange-600 hover:text-orange-700 font-medium flex items-center gap-1\"\n                  >\n                    <Plus className=\"w-4 h-4\" />\n                    {language === 'ru' ? 'Добавить вопрос' : 'Savol qo\\'shish'}\n                  </button>\n                </div>\n\n                {/* Custom Items List */}\n                {formData.customItems.length > 0 && (\n                  <div className=\"space-y-2 mb-4\">\n                    {formData.customItems.map((item, index) => (\n                      <div key={index} className=\"p-3 rounded-xl border-2 border-orange-400 bg-yellow-50\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex-1\">\n                            <div className=\"font-medium\">{item.title}</div>\n                            {item.description && (\n                              <div className=\"text-sm text-gray-500 mt-1\">{item.description}</div>\n                            )}\n                            <span className=\"text-xs px-2 py-0.5 rounded bg-gray-100 text-gray-600 mt-2 inline-block\">\n                              {language === 'ru'\n                                ? DECISION_THRESHOLD_LABELS[item.threshold].label\n                                : DECISION_THRESHOLD_LABELS[item.threshold].labelUz}\n                            </span>\n                          </div>\n                          <button\n                            onClick={() => setFormData({\n                              ...formData,\n                              customItems: formData.customItems.filter((_, i) => i !== index)\n                            })}\n                            className=\"p-1 text-red-500 hover:bg-red-50 rounded\"\n                          >\n                            <X className=\"w-4 h-4\" />\n                          </button>\n                        </div>\n                      </div>\n                    ))}\n                  </div>\n                )}\n\n                {/* Add Custom Item Form */}\n                {showCustomItemForm && (\n                  <div className=\"p-4 rounded-xl border-2 border-dashed border-gray-300 bg-gray-50 space-y-3\">\n                    <input\n                      type=\"text\"\n                      value={newCustomItem.title}\n                      onChange={(e) => setNewCustomItem({ ...newCustomItem, title: e.target.value })}\n                      className=\"glass-input\"\n                      placeholder={language === 'ru' ? 'Название вопроса *' : 'Savol nomi *'}\n                    />\n                    <textarea\n                      value={newCustomItem.description}\n                      onChange={(e) => setNewCustomItem({ ...newCustomItem, description: e.target.value })}\n                      className=\"glass-input min-h-[60px] resize-none\"\n                      placeholder={language === 'ru' ? 'Описание (необязательно)' : 'Tavsif (ixtiyoriy)'}\n                      rows={2}\n                    />\n                    <div>\n                      <label className=\"block text-xs text-gray-500 mb-1\">\n                        {language === 'ru' ? 'Порог принятия' : 'Qabul qilish chegarasi'}\n                      </label>\n                      <select\n                        value={newCustomItem.threshold}\n                        onChange={(e) => setNewCustomItem({ ...newCustomItem, threshold: e.target.value as DecisionThreshold })}\n                        className=\"glass-input text-sm\"\n                      >\n                        {(Object.keys(DECISION_THRESHOLD_LABELS) as DecisionThreshold[]).map((t) => (\n                          <option key={t} value={t}>\n                            {language === 'ru' ? DECISION_THRESHOLD_LABELS[t].label : DECISION_THRESHOLD_LABELS[t].labelUz}\n                          </option>\n                        ))}\n                      </select>\n                    </div>\n                    <div className=\"flex gap-2\">\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          if (newCustomItem.title.trim()) {\n                            setFormData({\n                              ...formData,\n                              customItems: [...formData.customItems, { ...newCustomItem }]\n                            });\n                            setNewCustomItem({ title: '', description: '', threshold: 'simple_majority' });\n                            setShowCustomItemForm(false);\n                          }\n                        }}\n                        disabled={!newCustomItem.title.trim()}\n                        className=\"flex-1 py-2 px-4 bg-orange-400 hover:bg-orange-500 text-gray-900 rounded-lg font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed\"\n                      >\n                        {language === 'ru' ? 'Добавить' : 'Qo\\'shish'}\n                      </button>\n                      <button\n                        type=\"button\"\n                        onClick={() => {\n                          setShowCustomItemForm(false);\n                          setNewCustomItem({ title: '', description: '', threshold: 'simple_majority' });\n                        }}\n                        className=\"py-2 px-4 bg-gray-200 hover:bg-gray-300 rounded-lg font-medium text-sm\"\n                      >\n                        {language === 'ru' ? 'Отмена' : 'Bekor qilish'}\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {formData.agendaItems.length === 0 && formData.customItems.length === 0 && (\n                <p className=\"text-sm text-red-500\">\n                  {language === 'ru' ? 'Выберите хотя бы один вопрос или добавьте свой' : 'Kamida bitta savol tanlang yoki o\\'zingiznikini qo\\'shing'}\n                </p>\n              )}\n            </>\n          )}\n\n          {step === 3 && (\n            <>\n              {/* Summary */}\n              <div className=\"space-y-4\">\n                <div className=\"p-4 rounded-xl bg-gray-50\">\n                  <h3 className=\"font-medium mb-3\">\n                    {language === 'ru' ? 'Сводка' : 'Xulosa'}\n                  </h3>\n\n                  <div className=\"space-y-2 text-sm\">\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">{language === 'ru' ? 'Формат:' : 'Format:'}</span>\n                      <span className=\"font-medium\">\n                        {formData.format === 'online'\n                          ? (language === 'ru' ? 'Онлайн' : 'Onlayn')\n                          : formData.format === 'offline'\n                          ? (language === 'ru' ? 'Очное' : 'Yuzma-yuz')\n                          : (language === 'ru' ? 'Смешанное' : 'Aralash')}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">{language === 'ru' ? 'Дом:' : 'Uy:'}</span>\n                      <span className=\"font-medium\">\n                        {buildings.find(b => b.id === formData.buildingId)?.name || formData.buildingAddress}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">{language === 'ru' ? 'Организатор:' : 'Tashkilotchi:'}</span>\n                      <span className=\"font-medium\">\n                        {formData.organizerType === 'management'\n                          ? (language === 'ru' ? 'УК' : 'UK')\n                          : (language === 'ru' ? 'Житель' : 'Aholi')}\n                      </span>\n                    </div>\n                    <div className=\"flex justify-between\">\n                      <span className=\"text-gray-500\">{language === 'ru' ? 'Вопросов:' : 'Savollar:'}</span>\n                      <span className=\"font-medium\">{formData.agendaItems.length}</span>\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"p-4 rounded-xl bg-blue-50 border border-blue-200\">\n                  <div className=\"flex items-start gap-3\">\n                    <AlertCircle className=\"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5\" />\n                    <div className=\"text-sm text-blue-700\">\n                      {language === 'ru'\n                        ? 'После публикации жильцам будет отправлено уведомление. Они смогут проголосовать за удобную дату проведения собрания.'\n                        : 'Nashrdan so\\'ng aholiga bildirishnoma yuboriladi. Ular yig\\'ilish uchun qulay sanani tanlashlari mumkin bo\\'ladi.'}\n                    </div>\n                  </div>\n                </div>\n\n                <div className=\"p-4 rounded-xl bg-yellow-50 border border-yellow-200\">\n                  <h4 className=\"font-medium mb-2\">\n                    {language === 'ru' ? 'Повестка дня:' : 'Kun tartibi:'}\n                  </h4>\n                  <ol className=\"list-decimal list-inside space-y-1 text-sm\">\n                    {formData.agendaItems.map((type) => (\n                      <li key={type}>\n                        {language === 'ru'\n                          ? AGENDA_ITEM_TYPES[type].label\n                          : AGENDA_ITEM_TYPES[type].labelUz}\n                      </li>\n                    ))}\n                    {formData.customItems.map((item, index) => (\n                      <li key={`custom-${index}`} className=\"text-blue-700\">\n                        {item.title}\n                        <span className=\"text-xs text-gray-500 ml-1\">\n                          ({language === 'ru' ? 'свой вопрос' : 'o\\'z savoli'})\n                        </span>\n                      </li>\n                    ))}\n                  </ol>\n                </div>\n\n                {/* Description preview */}\n                {formData.description && (\n                  <div className=\"p-4 rounded-xl bg-gray-50 border border-gray-200\">\n                    <h4 className=\"font-medium mb-2\">\n                      {language === 'ru' ? 'Обоснование:' : 'Asoslash:'}\n                    </h4>\n                    <p className=\"text-sm text-gray-600\">{formData.description}</p>\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"p-6 border-t border-gray-100 flex gap-3\">\n          {step > 1 && (\n            <button\n              onClick={() => setStep(step - 1)}\n              disabled={isSubmitting}\n              className=\"flex-1 py-3 rounded-xl font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors disabled:opacity-50\"\n            >\n              {language === 'ru' ? 'Назад' : 'Orqaga'}\n            </button>\n          )}\n          {step < 3 ? (\n            <button\n              onClick={() => setStep(step + 1)}\n              disabled={(step === 1 && !formData.buildingId) || (step === 2 && formData.agendaItems.length === 0 && formData.customItems.length === 0)}\n              className=\"flex-1 py-3 rounded-xl font-medium bg-orange-400 text-gray-900 hover:bg-orange-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {language === 'ru' ? 'Далее' : 'Keyingi'}\n            </button>\n          ) : (\n            <button\n              onClick={handleCreate}\n              disabled={isSubmitting || !formData.buildingId}\n              className=\"flex-1 py-3 rounded-xl font-medium bg-orange-400 text-gray-900 hover:bg-orange-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {isSubmitting\n                ? (language === 'ru' ? 'Создание...' : 'Yaratilmoqda...')\n                : (language === 'ru' ? 'Опубликовать' : 'Nashr qilish')}\n            </button>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// Meeting Details Modal\nfunction MeetingDetailsModal({\n  meeting,\n  onClose,\n  language,\n  calculateResult,\n  calculateQuorum,\n}: {\n  meeting: Meeting;\n  onClose: () => void;\n  language: string;\n  calculateResult: (meetingId: string, agendaItemId: string) => {\n    votesFor: number;\n    votesAgainst: number;\n    votesAbstain: number;\n    totalVotes: number;\n    percentFor: number;\n    isApproved: boolean;\n    thresholdMet: boolean;\n  };\n  calculateQuorum: () => { participated: number; total: number; percent: number; quorumReached: boolean };\n}) {\n  const quorum = calculateQuorum();\n  const [downloadingProtocol, setDownloadingProtocol] = useState(false);\n\n  // Download protocol as DOCX file (official format)\n  const handleDownloadProtocol = async () => {\n    setDownloadingProtocol(true);\n    try {\n      // Fetch protocol data from backend\n      const response = await fetch(`/api/meetings/${meeting.id}/protocol/data`);\n\n      if (!response.ok) {\n        throw new Error('Failed to fetch protocol data');\n      }\n\n      const data = await response.json();\n\n      // Generate DOCX using the protocol generator\n      await generateProtocolDocx({\n        meeting: {\n          ...data.meeting,\n          buildingAddress: meeting.buildingAddress || data.meeting.building_address,\n        },\n        agendaItems: data.agendaItems,\n        voteRecords: data.voteRecords,\n        votesByItem: data.votesByItem,\n        protocolHash: data.protocolHash,\n      });\n    } catch (error) {\n      console.error('Failed to download protocol:', error);\n      alert(language === 'ru' ? 'Ошибка при скачивании протокола' : 'Bayonnomani yuklashda xato');\n    } finally {\n      setDownloadingProtocol(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto\">\n        {/* Header */}\n        <div className=\"p-6 border-b border-gray-100 flex items-center justify-between\">\n          <div>\n            <h2 className=\"text-xl font-bold\">\n              {language === 'ru' ? `Собрание #${meeting.number}` : `Yig'ilish #${meeting.number}`}\n            </h2>\n            <p className=\"text-sm text-gray-500\">{meeting.buildingAddress}</p>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            {/* Download protocol button - show for completed meetings */}\n            {['protocol_generated', 'protocol_approved'].includes(meeting.status) && (\n              <button\n                onClick={handleDownloadProtocol}\n                disabled={downloadingProtocol}\n                className=\"flex items-center gap-2 px-4 py-2 bg-teal-500 text-white rounded-xl hover:bg-teal-600 transition-colors disabled:opacity-50\"\n              >\n                <Download className=\"w-4 h-4\" />\n                {downloadingProtocol\n                  ? (language === 'ru' ? 'Загрузка...' : 'Yuklanmoqda...')\n                  : (language === 'ru' ? 'Скачать протокол' : 'Bayonnomani yuklab olish')}\n              </button>\n            )}\n            <button\n              onClick={onClose}\n              className=\"p-2 hover:bg-gray-100 rounded-xl transition-colors\"\n            >\n              <X className=\"w-5 h-5\" />\n            </button>\n          </div>\n        </div>\n\n        <div className=\"p-6 space-y-6\">\n          {/* Status & Quorum */}\n          <div className=\"flex items-center gap-4 flex-wrap\">\n            <span className={`px-3 py-1 rounded-lg text-sm font-medium ${\n              MEETING_STATUS_LABELS[meeting.status]?.color === 'green' ? 'bg-green-100 text-green-700' :\n              MEETING_STATUS_LABELS[meeting.status]?.color === 'blue' ? 'bg-blue-100 text-blue-700' :\n              MEETING_STATUS_LABELS[meeting.status]?.color === 'yellow' ? 'bg-yellow-100 text-orange-700' :\n              'bg-gray-100 text-gray-700'\n            }`}>\n              {language === 'ru'\n                ? MEETING_STATUS_LABELS[meeting.status]?.label\n                : MEETING_STATUS_LABELS[meeting.status]?.labelUz}\n            </span>\n\n            {meeting.status !== 'draft' && meeting.status !== 'pending_moderation' && (\n              <div className=\"flex items-center gap-2\">\n                <Users className=\"w-4 h-4 text-gray-400\" />\n                <span className=\"text-sm\">\n                  {quorum.participated}/{quorum.total} ({quorum.percent.toFixed(1)}%)\n                </span>\n                <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${\n                  quorum.quorumReached ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n                }`}>\n                  {quorum.quorumReached\n                    ? (language === 'ru' ? 'Кворум' : 'Kvorum')\n                    : (language === 'ru' ? 'Нет кворума' : 'Kvorum yo\\'q')}\n                </span>\n              </div>\n            )}\n          </div>\n\n          {/* Confirmed Date */}\n          {meeting.confirmedDateTime && (\n            <div className=\"flex items-center gap-2 text-gray-600\">\n              <Calendar className=\"w-5 h-5\" />\n              <span>\n                {new Date(meeting.confirmedDateTime).toLocaleDateString(\n                  language === 'ru' ? 'ru-RU' : 'uz-UZ',\n                  { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric', hour: '2-digit', minute: '2-digit' }\n                )}\n              </span>\n            </div>\n          )}\n\n          {/* Agenda Items with Results */}\n          <div>\n            <h3 className=\"font-medium mb-3\">\n              {language === 'ru' ? 'Повестка дня' : 'Kun tartibi'}\n            </h3>\n            <div className=\"space-y-4\">\n              {meeting.agendaItems.map((item, index) => {\n                const result = calculateResult(meeting.id, item.id);\n\n                return (\n                  <div key={item.id} className=\"p-4 rounded-xl bg-gray-50 border border-gray-200\">\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1\">\n                        <div className=\"font-medium\">\n                          {index + 1}. {item.title}\n                        </div>\n                        <p className=\"text-sm text-gray-500 mt-1\">{item.description}</p>\n\n                        {/* Voting results */}\n                        {['voting_open', 'voting_closed', 'results_published', 'protocol_generated', 'protocol_approved'].includes(meeting.status) && (\n                          <div className=\"mt-3 pt-3 border-t border-gray-200\">\n                            <div className=\"grid grid-cols-3 gap-2 text-sm\">\n                              <div className=\"flex items-center gap-1\">\n                                <ThumbsUp className=\"w-4 h-4 text-green-500\" />\n                                <span>{result.votesFor} ({result.percentFor.toFixed(0)}%)</span>\n                              </div>\n                              <div className=\"flex items-center gap-1\">\n                                <ThumbsDown className=\"w-4 h-4 text-red-500\" />\n                                <span>{result.votesAgainst}</span>\n                              </div>\n                              <div className=\"flex items-center gap-1\">\n                                <Minus className=\"w-4 h-4 text-gray-400\" />\n                                <span>{result.votesAbstain}</span>\n                              </div>\n                            </div>\n\n                            {/* Progress bar */}\n                            <div className=\"mt-2 h-2 bg-gray-200 rounded-full overflow-hidden\">\n                              <div\n                                className={`h-full ${result.thresholdMet ? 'bg-green-500' : 'bg-red-500'}`}\n                                style={{ width: `${result.percentFor}%` }}\n                              />\n                            </div>\n\n                            {/* Threshold line */}\n                            <div className=\"flex items-center justify-between mt-1 text-xs text-gray-500\">\n                              <span>0%</span>\n                              <span>\n                                {language === 'ru' ? 'Порог:' : 'Chegara:'} {DECISION_THRESHOLD_LABELS[item.threshold].percent}%\n                              </span>\n                              <span>100%</span>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n\n                      {/* Result badge */}\n                      {item.isApproved !== undefined && (\n                        <span className={`px-2 py-1 rounded-lg text-xs font-medium ${\n                          item.isApproved ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\n                        }`}>\n                          {item.isApproved\n                            ? (language === 'ru' ? 'Принято' : 'Qabul')\n                            : (language === 'ru' ? 'Не принято' : 'Rad')}\n                        </span>\n                      )}\n                    </div>\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["UK_COMPANY","downloadBlob","blob","fileName","url","isIOS","isSafari","link","MONTHS_RU","formatDateRu","dateStr","date","formatTimeRu","escapeXml","str","calculateVoteResult","item","_totalArea","votedArea","dataUrlToUint8Array","dataUrl","base64","binaryString","bytes","i","generateUKQRCode","ukData","QRCode","generateVoterQRCode","voter","meetingNumber","buildingAddress","voterData","generateVotingTableXml","result","generateVoterListTableXml","voteRecords","voterImageIds","tableXml","record","idx","votedDate","choiceText","imageId","qrImageXml","generateVotesByItemTableXml","_agendaItem","votes","hasComments","v","commentText","generateProtocolDocx","data","meeting","agendaItems","votesByItem","address","meetingDate","meetingTime","location","format","ukQrCodeDataUrl","voterQRCodes","qrCode","agendaItemsXml","itemNumber","isApproved","itemVotes","documentXml","zip","PizZip","ukImageBytes","voterId","imageBytes","relsContent","MeetingsPage","user","useAuthStore","t","language","useLanguageStore","buildings","fetchBuildings","useCRMStore","meetings","fetchMeetings","createMeeting","approveMeeting","rejectMeeting","confirmSchedule","openVoting","closeVoting","publishResults","generateProtocol","approveProtocol","deleteMeeting","calculateAgendaItemResult","calculateMeetingQuorum","useMeetingStore","useEffect","activeTab","setActiveTab","useState","showCreateModal","setShowCreateModal","selectedMeeting","setSelectedMeeting","showDetailsModal","setShowDetailsModal","filteredMeetings","useMemo","m","getStatusColor","status","MEETING_STATUS_LABELS","getStatusLabel","labels","formatDate","handleViewDetails","handleDelete","id","tabs","jsxs","jsx","Plus","tab","Users","MeetingCard","reason","CreateMeetingWizard","b","MeetingDetailsModal","onViewDetails","onApprove","onReject","onConfirmSchedule","onOpenVoting","onCloseVoting","onPublishResults","onGenerateProtocol","onApproveProtocol","onDelete","calculateQuorum","quorum","statusColor","colorClasses","Building2","Calendar","User","FileText","option","totalVotes","sum","opt","voteCount","percent","isLeading","o","Eye","Fragment","Check","X","Trash2","CalendarCheck","Play","Square","BarChart3","Shield","Download","onClose","onCreate","step","setStep","isSubmitting","setIsSubmitting","showCustomItemForm","setShowCustomItemForm","newCustomItem","setNewCustomItem","formData","setFormData","handleBuildingChange","buildingId","building","handleAddAgendaItem","type","handleCreate","AGENDA_ITEM_TYPES","steps","s","e","isSelected","DECISION_THRESHOLD_LABELS","index","_","AlertCircle","calculateResult","downloadingProtocol","setDownloadingProtocol","handleDownloadProtocol","response","ThumbsUp","ThumbsDown","Minus"],"mappings":"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"}