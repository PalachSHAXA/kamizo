import{r as i,S as re,bo as I,q as F,aV as v,j as e,y as B,z as je,ax as L,au as w,aa as pe,ak as Ne,I as ie,X as O,m as ve}from"./react-vendor-1768934878736-ANIjY9im.js";import{b as we,d as ke,e as n}from"./index-1768934878736-CI4IDBu9.js";import"./vendor-1768934878736-dYh5IFHH.js";import"./qr-scanner-1768934878736-cr32YHjo.js";import"./zustand-1768934878736-wNUYBKDB.js";const M=[{id:"created",statuses:["new"],labelRu:"–°–æ–∑–¥–∞–Ω",labelUz:"Yaratildi",icon:re,descRu:"–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω",descUz:"Buyurtma yaratildi"},{id:"confirmed",statuses:["confirmed"],labelRu:"–ü—Ä–∏–Ω—è—Ç",labelUz:"Qabul qilindi",icon:B,descRu:"–ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω",descUz:"Buyurtma tasdiqlandi"},{id:"preparing",statuses:["preparing"],labelRu:"–ì–æ—Ç–æ–≤–∏—Ç—Å—è",labelUz:"Tayyorlanmoqda",icon:Ne,descRu:"–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑",descUz:"Buyurtma yig'ilmoqda"},{id:"delivering",statuses:["ready","delivering"],labelRu:"–î–æ—Å—Ç–∞–≤–∫–∞",labelUz:"Yetkazish",icon:ie,descRu:"–í –ø—É—Ç–∏ –∫ –≤–∞–º",descUz:"Sizga yo'lda"},{id:"delivered",statuses:["delivered"],labelRu:"–ü–æ–ª—É—á–µ–Ω",labelUz:"Qabul qilindi",icon:B,descRu:"–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω",descUz:"Buyurtma yetkazildi"}];function _e(m){if(m==="cancelled")return-1;for(let t=0;t<M.length;t++)if(M[t].statuses.includes(m))return t;return 0}function Se(m,t){switch(m){case"new":return{title:t==="ru"?"–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω":"Buyurtma yaratildi",subtitle:t==="ru"?"–û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è":"Tasdiqlanishini kutmoqdamiz"};case"confirmed":return{title:t==="ru"?"–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç":"Buyurtma qabul qilindi",subtitle:t==="ru"?"–ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä–∫—É":"Yig'ishni boshlaymiz"};case"preparing":return{title:t==="ru"?"–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑":"Buyurtma yig'ilmoqda",subtitle:t==="ru"?"–°–∫–æ—Ä–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤":"Tez orada tayyor bo'ladi"};case"ready":return{title:t==="ru"?"–ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤":"Buyurtma tayyor",subtitle:t==="ru"?"–ü–µ—Ä–µ–¥–∞—ë–º –∫—É—Ä—å–µ—Ä—É":"Kuryerga topshirilmoqda"};case"delivering":return{title:t==="ru"?"–ö—É—Ä—å–µ—Ä –≤ –ø—É—Ç–∏":"Kuryer yo'lda",subtitle:t==="ru"?"–°–∫–æ—Ä–æ –±—É–¥–µ—Ç —É –≤–∞—Å":"Tez orada sizda bo'ladi"};case"delivered":return{title:t==="ru"?"–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω":"Buyurtma yetkazildi",subtitle:t==="ru"?"–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∞–ø–ø–µ—Ç–∏—Ç–∞!":"Yoqimli ishtaha!"};case"cancelled":return{title:t==="ru"?"–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω":"Buyurtma bekor qilindi",subtitle:""};default:return{title:"",subtitle:""}}}const k={cat_groceries:"üõí",cat_dairy:"ü•õ",cat_meat:"ü•©",cat_bakery:"üçû",cat_fruits:"üçé",cat_beverages:"ü•§",cat_household:"üßπ",cat_personal:"üß¥",cat_baby:"üë∂",cat_pets:"üêæ",cat_frozen:"‚ùÑÔ∏è",cat_snacks:"üçø"};function Be(){const{user:m}=we(),{language:t}=ke(),[y,j]=i.useState("shop"),[le,ne]=i.useState([]),[_,ce]=i.useState([]),[b,p]=i.useState([]),[o,S]=i.useState([]),[u,N]=i.useState([]),[C,Q]=i.useState(null),[T,de]=i.useState(""),[oe,A]=i.useState(!0),[c,$]=i.useState(null),[me,P]=i.useState(!1),[J,H]=i.useState(""),[ue,X]=i.useState(!1),[xe,q]=i.useState(!1),[z,R]=i.useState(null),[g,D]=i.useState(5),[G,U]=i.useState(""),[K,V]=i.useState(!1),W=i.useCallback(async()=>{try{A(!0);const[s,a]=await Promise.all([n("/api/marketplace/categories"),n("/api/marketplace/products")]);if(ne(s?.categories||[]),ce(a?.products||[]),m)try{const[r,l,d]=await Promise.all([n("/api/marketplace/cart"),n("/api/marketplace/orders"),n("/api/marketplace/favorites")]);p(r?.cart||[]),S(l?.orders||[]),N((d?.favorites||[]).map(h=>h.id))}catch{}}catch{}finally{A(!1)}},[m]);i.useEffect(()=>{W()},[W]),i.useEffect(()=>{if(!m||!o.some(l=>!["delivered","cancelled"].includes(l.status)))return;const r=setInterval(async()=>{try{const l=await n("/api/marketplace/orders");l?.orders&&S(l.orders)}catch{}},1e4);return()=>clearInterval(r)},[m,o.length>0&&o.some(s=>!["delivered","cancelled"].includes(s.status))]),i.useEffect(()=>{const s=a=>{const{orderId:r}=a.detail,l=o.find(d=>d.id===r);l&&l.status==="delivered"&&(R(r),q(!0),sessionStorage.removeItem("open_delivery_rating_for_order"))};return window.addEventListener("openDeliveryRatingModal",s),()=>{window.removeEventListener("openDeliveryRatingModal",s)}},[o]),i.useEffect(()=>{if(o.length===0)return;const s=sessionStorage.getItem("open_delivery_rating_for_order");if(s){const a=o.find(r=>r.id===s);a&&a.status==="delivered"&&(R(s),q(!0),sessionStorage.removeItem("open_delivery_rating_for_order"))}},[o]);const E=async(s,a=1)=>{try{await n("/api/marketplace/cart",{method:"POST",body:JSON.stringify({product_id:s,quantity:a})});const r=await n("/api/marketplace/cart");p(r?.cart||[])}catch{}},f=async(s,a)=>{if(a<=0){await Z(s);return}try{await n("/api/marketplace/cart",{method:"POST",body:JSON.stringify({product_id:s,quantity:a})});const r=await n("/api/marketplace/cart");p(r?.cart||[])}catch{}},Z=async s=>{try{await n(`/api/marketplace/cart/${s}`,{method:"DELETE"});const a=await n("/api/marketplace/cart");p(a?.cart||[])}catch{}},Y=async s=>{const a=u.includes(s);N(a?u.filter(r=>r!==s):[...u,s]);try{await n(`/api/marketplace/favorites/${s}`,{method:"POST"})}catch{N(a?[...u,s]:u.filter(l=>l!==s))}},he=async()=>{try{await n("/api/marketplace/orders",{method:"POST",body:JSON.stringify({delivery_notes:J})}),X(!0),P(!1),H("");const[s,a]=await Promise.all([n("/api/marketplace/cart"),n("/api/marketplace/orders")]);p(s?.cart||[]),S(a?.orders||[]),setTimeout(()=>{X(!1),j("orders")},2e3)}catch{}},ge=async()=>{if(z)try{V(!0),await n(`/api/marketplace/orders/${z}/rate`,{method:"POST",body:JSON.stringify({rating:g,review:G||void 0})});const s=await n("/api/marketplace/orders");S(s?.orders||[]),q(!1),R(null),D(5),U("")}catch{}finally{V(!1)}},ee=_.filter(s=>{const a=!C||s.category_id===C,r=!T||(t==="ru"?s.name_ru:s.name_uz).toLowerCase().includes(T.toLowerCase());return a&&r}),se=s=>b.find(r=>r.product_id===s)?.quantity||0,te=b.reduce((s,a)=>{const r=_.find(l=>l.id===a.product_id);return s+(r?.price||0)*a.quantity},0),x=s=>new Intl.NumberFormat("ru-RU").format(s)+" —Å—É–º",be=[{id:"shop",label:t==="ru"?"–ú–∞–≥–∞–∑–∏–Ω":"Do'kon",icon:re},{id:"cart",label:t==="ru"?"–ö–æ—Ä–∑–∏–Ω–∞":"Savat",icon:I,count:b.length},{id:"orders",label:t==="ru"?"–ó–∞–∫–∞–∑—ã":"Buyurtmalar",icon:F,count:o.filter(s=>s.status!=="delivered"&&s.status!=="cancelled").length},{id:"favorites",label:t==="ru"?"–ò–∑–±—Ä–∞–Ω–Ω–æ–µ":"Sevimlilar",icon:v,count:u.length}];return oe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 bg-orange-50/50"})}):e.jsxs("div",{className:"space-y-4 md:space-y-6 pb-20 md:pb-0",children:[ue&&e.jsxs("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5"}),e.jsx("span",{children:t==="ru"?"–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!":"Buyurtma muvaffaqiyatli yaratildi!"})]}),e.jsx("div",{className:"glass-card sticky top-0 z-40",children:e.jsx("div",{className:"flex overflow-x-auto",children:be.map(s=>e.jsxs("button",{onClick:()=>j(s.id),className:`flex-1 min-w-0 py-3 px-4 flex items-center justify-center gap-2 border-b-2 transition-colors ${y===s.id?"border-orange-500 text-orange-600 bg-orange-50/50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium truncate",children:s.label}),s.count!==void 0&&s.count>0&&e.jsx("span",{className:"bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full",children:s.count})]},s.id))})}),e.jsxs("div",{className:"p-4 pb-20",children:[y==="shop"&&e.jsxs("div",{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:t==="ru"?"–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...":"Mahsulot qidirish...",value:T,onChange:s=>de(s.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>Q(null),className:`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${C?"glass-card text-gray-700 hover:bg-white/60":"bg-orange-500 text-white shadow-md"}`,children:[e.jsx("span",{className:"text-2xl mb-1",children:"üè™"}),e.jsx("span",{className:"text-xs font-medium text-center",children:t==="ru"?"–í—Å–µ":"Hammasi"})]}),le.map(s=>e.jsxs("button",{onClick:()=>Q(s.id),className:`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${C===s.id?"bg-orange-500 text-white shadow-md":"glass-card text-gray-700 hover:bg-white/60"}`,children:[e.jsx("span",{className:"text-2xl mb-1",children:k[s.id]||"üì¶"}),e.jsx("span",{className:"text-xs font-medium text-center line-clamp-1",children:t==="ru"?s.name_ru:s.name_uz})]},s.id))]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:ee.map(s=>{const a=se(s.id),r=u.includes(s.id);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 flex items-center justify-center cursor-pointer",onClick:()=>$(s),children:[s.image_url?e.jsx("img",{src:s.image_url,alt:t==="ru"?s.name_ru:s.name_uz,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-4xl",children:k[s.category_id]||"üì¶"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),Y(s.id)},className:"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm",children:e.jsx(v,{className:`w-4 h-4 ${r?"fill-red-500 text-red-500":"text-gray-400"}`})}),s.is_featured&&e.jsx("div",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full",children:t==="ru"?"–•–∏—Ç":"Hit"})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]",children:t==="ru"?s.name_ru:s.name_uz}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.unit}),e.jsx("p",{className:`text-xs mt-1 ${s.stock_quantity===0?"text-red-500":s.stock_quantity<=5?"text-amber-500":"text-green-600"}`,children:s.stock_quantity===0?t==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas":t==="ru"?`–í –Ω–∞–ª–∏—á–∏–∏: ${s.stock_quantity} ${s.unit}`:`Mavjud: ${s.stock_quantity} ${s.unit}`}),e.jsx("div",{className:"flex items-center justify-between mt-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-orange-600",children:x(s.price)}),s.old_price&&e.jsx("p",{className:"text-xs text-gray-400 line-through",children:x(s.old_price)})]})}),a>0?e.jsxs("div",{className:"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(s.id,a-1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(L,{className:"w-4 h-4 text-orange-600"})}),e.jsx("span",{className:"font-medium text-orange-600",children:a}),e.jsx("button",{onClick:()=>f(s.id,a+1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(w,{className:"w-4 h-4 text-orange-600"})})]}):e.jsxs("button",{onClick:()=>E(s.id),disabled:s.stock_quantity===0,className:`w-full mt-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 ${s.stock_quantity===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-orange-500 text-white hover:bg-orange-600"}`,children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:s.stock_quantity===0?t==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas":t==="ru"?"–í –∫–æ—Ä–∑–∏–Ω—É":"Savatga"})]})]})]},s.id)})}),ee.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:t==="ru"?"–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã":"Mahsulotlar topilmadi"})]})]}),y==="cart"&&e.jsx("div",{children:b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(I,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t==="ru"?"–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞":"Savat bo'sh"}),e.jsx("button",{onClick:()=>j("shop"),className:"text-orange-600 font-medium",children:t==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-4",children:b.map(s=>{const a=_.find(r=>r.id===s.product_id);return a?e.jsxs("div",{className:"glass-card p-4 flex gap-3",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.image_url?e.jsx("img",{src:a.image_url,alt:"",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-2xl",children:k[a.category_id]||"üì¶"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 line-clamp-2",children:t==="ru"?a.name_ru:a.name_uz}),e.jsx("p",{className:"text-sm text-gray-500",children:a.unit}),e.jsx("p",{className:"font-bold text-orange-600 mt-1",children:x(a.price*s.quantity)})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between",children:[e.jsx("button",{onClick:()=>Z(a.id),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(a.id,s.quantity-1),className:"p-1 rounded bg-white shadow-sm",children:e.jsx(L,{className:"w-3 h-3"})}),e.jsx("span",{className:"w-6 text-center text-sm font-medium",children:s.quantity}),e.jsx("button",{onClick:()=>f(a.id,s.quantity+1),className:"p-1 rounded bg-white shadow-sm",children:e.jsx(w,{className:"w-3 h-3"})})]})]})]},s.id):null})}),e.jsxs("div",{className:"glass-card p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-gray-600",children:t==="ru"?"–¢–æ–≤–∞—Ä–æ–≤:":"Mahsulotlar:"}),e.jsxs("span",{className:"font-medium",children:[b.reduce((s,a)=>s+a.quantity,0)," —à—Ç"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[e.jsx("span",{children:t==="ru"?"–ò—Ç–æ–≥–æ:":"Jami:"}),e.jsx("span",{className:"text-orange-600",children:x(te)})]})]}),e.jsx("button",{onClick:()=>P(!0),className:"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors",children:t==="ru"?"–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑":"Buyurtma berish"})]})}),y==="orders"&&e.jsx("div",{children:o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(F,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t==="ru"?"–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤":"Sizda hali buyurtmalar yo'q"}),e.jsx("button",{onClick:()=>j("shop"),className:"text-orange-600 font-medium",children:t==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsx("div",{className:"space-y-4",children:o.map(s=>{const a=_e(s.status),r=s.status==="cancelled",l=Se(s.status,t);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-orange-500/10 to-amber-400/10 border-b border-orange-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-gray-900",children:[t==="ru"?"–ó–∞–∫–∞–∑":"Buyurtma"," #",s.order_number]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("span",{className:"font-bold text-orange-600",children:x(s.total_amount)})]})}),e.jsxs("div",{className:"px-4 pt-4 pb-2 text-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:l.title}),e.jsx("p",{className:"text-sm text-gray-500",children:l.subtitle})]}),e.jsxs("div",{className:"px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute top-4 left-4 right-4 h-1 bg-gray-200 rounded-full"}),e.jsx("div",{className:"absolute top-4 left-4 h-1 bg-orange-500 rounded-full transition-all duration-500",style:{width:r?"0%":`calc(${Math.min(a/(M.length-1)*100,100)}% - 32px)`}}),M.map((d,h)=>{const ae=!r&&a>=h,fe=!r&&a===h,ye=d.icon;return e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${r?"bg-gray-200 text-gray-400":ae?fe?"bg-orange-500 text-white ring-4 ring-orange-200 shadow-lg":"bg-orange-500 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("span",{className:`text-[10px] mt-1.5 font-medium text-center max-w-[50px] leading-tight ${ae&&!r?"text-gray-900":"text-gray-400"}`,children:t==="ru"?d.labelRu:d.labelUz})]},d.id)})]}),r&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 rounded-xl flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(O,{className:"w-4 h-4 text-red-500"})}),e.jsx("div",{className:"text-sm font-medium text-red-700",children:t==="ru"?"–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω":"Buyurtma bekor qilindi"})]})]}),e.jsx("div",{className:"px-4 pb-4 border-t border-gray-100 pt-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex -space-x-2",children:[(s.items||[]).slice(0,3).map((d,h)=>e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border-2 border-white",children:d.product_image?e.jsx("img",{src:d.product_image,alt:"",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-sm",children:"üì¶"})},h)),(s.items||[]).length>3&&e.jsxs("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center border-2 border-white text-xs text-gray-500 font-medium",children:["+",(s.items||[]).length-3]})]}),e.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:[(s.items||[]).reduce((d,h)=>d+h.quantity,0)," ",t==="ru"?"—Ç–æ–≤–∞—Ä–æ–≤":"mahsulot"]})]})})]},s.id)})})}),y==="favorites"&&e.jsx("div",{children:u.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(v,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:t==="ru"?"–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç":"Sevimli mahsulotlar yo'q"}),e.jsx("button",{onClick:()=>j("shop"),className:"text-orange-600 font-medium",children:t==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:_.filter(s=>u.includes(s.id)).map(s=>{const a=se(s.id);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 flex items-center justify-center",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:t==="ru"?s.name_ru:s.name_uz,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-4xl",children:k[s.category_id]||"üì¶"}),e.jsx("button",{onClick:()=>Y(s.id),className:"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm",children:e.jsx(v,{className:"w-4 h-4 fill-red-500 text-red-500"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]",children:t==="ru"?s.name_ru:s.name_uz}),e.jsx("p",{className:"font-bold text-orange-600 mt-2",children:x(s.price)}),a>0?e.jsxs("div",{className:"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(s.id,a-1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(L,{className:"w-4 h-4 text-orange-600"})}),e.jsx("span",{className:"font-medium text-orange-600",children:a}),e.jsx("button",{onClick:()=>f(s.id,a+1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(w,{className:"w-4 h-4 text-orange-600"})})]}):e.jsxs("button",{onClick:()=>E(s.id),className:"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors flex items-center justify-center gap-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:t==="ru"?"–í –∫–æ—Ä–∑–∏–Ω—É":"Savatga"})]})]})]},s.id)})})})]}),c&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md w-full rounded-t-3xl max-h-[90vh] overflow-y-auto animate-slide-up",children:[e.jsxs("div",{className:"sticky top-0 bg-white/90 backdrop-blur-md p-4 border-b flex items-center justify-between z-10",children:[e.jsx("h2",{className:"font-bold text-lg",children:t==="ru"?c.name_ru:c.name_uz}),e.jsx("button",{onClick:()=>$(null),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"aspect-square bg-gray-100 rounded-xl flex items-center justify-center mb-4",children:c.image_url?e.jsx("img",{src:c.image_url,alt:"",className:"w-full h-full object-cover rounded-xl"}):e.jsx("span",{className:"text-6xl",children:k[c.category_id]||"üì¶"})}),e.jsx("p",{className:"text-gray-600 mb-4",children:t==="ru"?c.description_ru:c.description_uz}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:x(c.price)}),c.old_price&&e.jsx("p",{className:"text-gray-400 line-through",children:x(c.old_price)})]}),e.jsx("p",{className:"text-gray-500",children:c.unit})]}),c.stock_quantity>0?e.jsx("p",{className:"text-green-600 text-sm mb-4",children:t==="ru"?"–í –Ω–∞–ª–∏—á–∏–∏":"Mavjud"}):e.jsx("p",{className:"text-red-600 text-sm mb-4",children:t==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>Y(c.id),className:"p-3 border rounded-xl",children:e.jsx(v,{className:`w-6 h-6 ${u.includes(c.id)?"fill-red-500 text-red-500":"text-gray-400"}`})}),e.jsxs("button",{onClick:()=>{E(c.id),$(null)},disabled:c.stock_quantity===0,className:"flex-1 py-3 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),e.jsx("span",{children:t==="ru"?"–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É":"Savatga qo'shish"})]})]})]})]})}),me&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"font-bold text-lg",children:t==="ru"?"–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞":"Buyurtmani rasmiylashtirish"}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:t==="ru"?"–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:":"Yetkazish manzili:"}),e.jsxs("p",{className:"font-medium",children:[m?.address||"–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω",", ",t==="ru"?"–∫–≤.":"xonadon"," ",m?.apartment||"-"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:t==="ru"?"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É:":"Buyurtmaga izoh:"}),e.jsx("textarea",{value:J,onChange:s=>H(s.target.value),placeholder:t==="ru"?"–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏":"Masalan: yetkazishdan 10 daqiqa oldin qo'ng'iroq qiling",className:"w-full p-3 border rounded-xl resize-none",rows:3})]}),e.jsx("div",{className:"bg-orange-50 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:t==="ru"?"–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:":"To'lanishi kerak:"}),e.jsx("span",{className:"text-xl font-bold text-orange-600",children:x(te)})]})}),e.jsx("button",{onClick:he,className:"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors",children:t==="ru"?"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑":"Buyurtmani tasdiqlash"})]})]})}),xe&&z&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 bg-gradient-to-r from-orange-500 to-amber-500",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:t==="ru"?"–û—Ü–µ–Ω–∏—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É":"Yetkazishni baholang"}),e.jsx("button",{onClick:()=>{q(!1),R(null),D(5),U("")},className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(O,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-orange-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(ie,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:t==="ru"?"–ó–∞–∫–∞–∑":"Buyurtma"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:["#",o.find(s=>s.id===z)?.order_number||""]})]})]})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t==="ru"?"–ö–∞–∫ –≤–∞–º –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∞–≤–∫–∏?":"Yetkazish sifati qanday edi?"}),e.jsx("div",{className:"flex justify-center gap-2 mb-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>D(s),className:"p-1 active:scale-90 transition-transform touch-manipulation",children:e.jsx(ve,{className:`w-10 h-10 ${s<=g?"text-yellow-400 fill-yellow-400":"text-gray-300"}`})},s))}),e.jsxs("div",{className:"text-sm font-medium text-gray-700",children:[g===5&&(t==="ru"?"–û—Ç–ª–∏—á–Ω–æ!":"Ajoyib!"),g===4&&(t==="ru"?"–•–æ—Ä–æ—à–æ":"Yaxshi"),g===3&&(t==="ru"?"–ù–æ—Ä–º–∞–ª—å–Ω–æ":"O'rtacha"),g===2&&(t==="ru"?"–ü–ª–æ—Ö–æ":"Yomon"),g===1&&(t==="ru"?"–û—á–µ–Ω—å –ø–ª–æ—Ö–æ":"Juda yomon")]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:t==="ru"?"–û—Ç–∑—ã–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)":"Sharh (ixtiyoriy)"}),e.jsx("textarea",{value:G,onChange:s=>U(s.target.value),placeholder:t==="ru"?"–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤ –æ –¥–æ—Å—Ç–∞–≤–∫–µ...":"Yetkazish haqida sharh yozing...",className:"w-full px-4 py-3 border border-gray-200 rounded-xl resize-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",rows:3})]}),e.jsx("button",{onClick:ge,disabled:K,className:"w-full py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-xl font-semibold hover:from-orange-600 hover:to-amber-600 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:K?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-5 h-5"}),t==="ru"?"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É":"Bahoni yuborish"]})})]})]})})]})}export{Be as MarketplacePage};
//# sourceMappingURL=MarketplacePage-1768934878736-C3bWi42s.js.map
