{"version":3,"file":"ResidentProfilePage-1768936274458-BO_oiQjJ.js","sources":["../../src/pages/ResidentProfilePage.tsx"],"sourcesContent":["import { useState, useEffect, useMemo } from 'react';\r\nimport {\r\n  Key, MapPin, Home, Phone, Save, Eye, EyeOff, Edit3,\r\n  AlertCircle, Shield, Loader2, X, FileText, CheckCircle,\r\n  Building2, Ruler, QrCode, Globe,\r\n  Download, User as UserIcon, Sparkles\r\n} from 'lucide-react';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport { useLanguageStore } from '../stores/languageStore';\r\nimport { generateQRCode } from '../components/LazyQRCode';\r\nimport { generateContractDocx } from '../utils/contractGenerator';\r\nimport { ContractPreview } from '../components/ContractPreview';\r\n\r\nexport function ResidentProfilePage() {\r\n  const { user, changePassword, updateProfile, markContractSigned } = useAuthStore();\r\n  const { language, setLanguage } = useLanguageStore();\r\n\r\n  // Check if user is a rental user (tenant/commercial_owner) - they have simplified profile\r\n  const isRentalUser = user?.role === 'tenant' || user?.role === 'commercial_owner';\r\n\r\n  const [editingPhone, setEditingPhone] = useState(false);\r\n  const [newPhone, setNewPhone] = useState(user?.phone || '');\r\n  const [phoneLoading, setPhoneLoading] = useState(false);\r\n  const [editingPassword, setEditingPassword] = useState(false);\r\n  const [currentPassword, setCurrentPassword] = useState('');\r\n  const [newPassword, setNewPassword] = useState('');\r\n  const [confirmPassword, setConfirmPassword] = useState('');\r\n  const [showCurrentPassword, setShowCurrentPassword] = useState(false);\r\n  const [showNewPassword, setShowNewPassword] = useState(false);\r\n  const [passwordError, setPasswordError] = useState('');\r\n  const [passwordLoading, setPasswordLoading] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n  const [showContract, setShowContract] = useState(false);\r\n  const [qrCodeUrl, setQrCodeUrl] = useState<string>('');\r\n  const [isDownloading, setIsDownloading] = useState(false);\r\n\r\n  // Generate QR code with resident data\r\n  useEffect(() => {\r\n    const generateQR = async () => {\r\n      if (!user) return;\r\n\r\n      // Compact format with Cyrillic - no decorative symbols\r\n      const residentData = [\r\n        `–§–ò–û: ${user.name}`,\r\n        `–õ/–°: ${user.login}`,\r\n        user.address ? `–ê–¥—Ä–µ—Å: ${user.address}` : null,\r\n        user.apartment ? `–ö–≤: ${user.apartment}` : null,\r\n        user.phone ? `–¢–µ–ª: ${user.phone}` : null,\r\n      ].filter(Boolean).join('\\n');\r\n\r\n      const url = await generateQRCode(residentData, {\r\n        width: 300,\r\n        margin: 2,\r\n        errorCorrectionLevel: 'M',\r\n        color: { dark: '#1f2937', light: '#ffffff' },\r\n      });\r\n      setQrCodeUrl(url);\r\n    };\r\n\r\n    generateQR();\r\n  }, [user]);\r\n\r\n  // Translations\r\n  const t = useMemo(() => ({\r\n    // Page header\r\n    myProfile: language === 'ru' ? '–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å' : 'Mening profilim',\r\n    personalData: language === 'ru' ? '–í–∞—à–∏ –ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–æ–≥–æ–≤–æ—Ä' : 'Shaxsiy ma\\'lumotlaringiz va shartnoma',\r\n\r\n    // Sections\r\n    personalInfo: language === 'ru' ? '–õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ' : 'Shaxsiy ma\\'lumotlar',\r\n    contractInfo: language === 'ru' ? '–î–æ–≥–æ–≤–æ—Ä —Å –£–ö' : 'UK bilan shartnoma',\r\n    security: language === 'ru' ? '–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å' : 'Xavfsizlik',\r\n\r\n    // Personal data labels\r\n    resident: language === 'ru' ? '–ñ–∏—Ç–µ–ª—å' : 'Aholi',\r\n    tenant: language === 'ru' ? '–ê—Ä–µ–Ω–¥–∞—Ç–æ—Ä' : 'Ijarachi',\r\n    commercialOwner: language === 'ru' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : 'Egasi',\r\n    personalAccount: language === 'ru' ? '–õ–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç' : 'Shaxsiy hisob',\r\n    loginHint: language === 'ru' ? '–õ–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞' : 'Kirish logini',\r\n    cannotChange: language === 'ru' ? '–ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å' : 'O\\'zgartirib bo\\'lmaydi',\r\n    address: language === 'ru' ? '–ê–¥—Ä–µ—Å' : 'Manzil',\r\n    apartment: language === 'ru' ? '–ö–≤–∞—Ä—Ç–∏—Ä–∞' : 'Kvartira',\r\n    area: language === 'ru' ? '–ü–ª–æ—â–∞–¥—å' : 'Maydon',\r\n    phone: language === 'ru' ? '–¢–µ–ª–µ—Ñ–æ–Ω' : 'Telefon',\r\n    notSpecified: language === 'ru' ? '–ù–µ —É–∫–∞–∑–∞–Ω' : 'Ko\\'rsatilmagan',\r\n    branch: language === 'ru' ? '–§–∏–ª–∏–∞–ª' : 'Filial',\r\n    building: language === 'ru' ? '–î–æ–º' : 'Uy',\r\n\r\n    // Contract labels\r\n    contractNumber: language === 'ru' ? '–ù–æ–º–µ—Ä –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma raqami',\r\n    contractType: language === 'ru' ? '–¢–∏–ø –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma turi',\r\n    contractStart: language === 'ru' ? '–î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞' : 'Boshlanish sanasi',\r\n    contractEnd: language === 'ru' ? '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è' : 'Tugash sanasi',\r\n    indefinite: language === 'ru' ? '–ë–µ—Å—Å—Ä–æ—á–Ω—ã–π' : 'Muddatsiz',\r\n    contractStatus: language === 'ru' ? '–°—Ç–∞—Ç—É—Å –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma holati',\r\n    active: language === 'ru' ? '–î–µ–π—Å—Ç–≤—É—é—â–∏–π' : 'Amalda',\r\n    pending: language === 'ru' ? '–û–∂–∏–¥–∞–µ—Ç –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è' : 'Imzo kutilmoqda',\r\n    yourQrCode: language === 'ru' ? '–í–∞—à QR-–∫–æ–¥' : 'Sizning QR-kodingiz',\r\n    qrHint: language === 'ru' ? '–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤' : 'Hujjatlarni imzolash uchun noyob identifikator',\r\n    viewContract: language === 'ru' ? '–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–≥–æ–≤–æ—Ä' : 'Shartnomani ko\\'rish',\r\n    hideContract: language === 'ru' ? '–°–∫—Ä—ã—Ç—å' : 'Yashirish',\r\n    downloadContract: language === 'ru' ? '–°–∫–∞—á–∞—Ç—å –¥–æ–≥–æ–≤–æ—Ä' : 'Shartnomani yuklash',\r\n    downloading: language === 'ru' ? '–ó–∞–≥—Ä—É–∑–∫–∞...' : 'Yuklanmoqda...',\r\n\r\n    // Contract types\r\n    typeStandard: language === 'ru' ? '–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π' : 'Standart',\r\n    typeCommercial: language === 'ru' ? '–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π' : 'Tijorat',\r\n    typeTemporary: language === 'ru' ? '–í—Ä–µ–º–µ–Ω–Ω—ã–π' : 'Vaqtinchalik',\r\n\r\n    // Security\r\n    password: language === 'ru' ? '–ü–∞—Ä–æ–ª—å' : 'Parol',\r\n    currentPassword: language === 'ru' ? '–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parol',\r\n    newPassword: language === 'ru' ? '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å' : 'Yangi parol',\r\n    confirmPassword: language === 'ru' ? '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å' : 'Parolni tasdiqlang',\r\n    minChars: language === 'ru' ? '–ú–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞' : 'Kamida 4 ta belgi',\r\n    repeatPassword: language === 'ru' ? '–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å' : 'Yangi parolni takrorlang',\r\n    passwordChanged: language === 'ru' ? '–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω—ë–Ω' : 'Parol muvaffaqiyatli o\\'zgartirildi',\r\n    wrongPassword: language === 'ru' ? '–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parol noto\\'g\\'ri',\r\n    passwordsNotMatch: language === 'ru' ? '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç' : 'Parollar mos kelmaydi',\r\n    passwordSameAsOld: language === 'ru' ? '–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ' : 'Yangi parol joriy paroldan farq qilishi kerak',\r\n    enterCurrentPassword: language === 'ru' ? '–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å' : 'Joriy parolni kiriting',\r\n    passwordTooShort: language === 'ru' ? '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞' : 'Parol kamida 4 ta belgidan iborat bo\\'lishi kerak',\r\n    passwordError: language === 'ru' ? '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ –ø–∞—Ä–æ–ª—è' : 'Parolni o\\'zgartirishda xatolik',\r\n\r\n    // Actions\r\n    save: language === 'ru' ? '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å' : 'Saqlash',\r\n    cancel: language === 'ru' ? '–û—Ç–º–µ–Ω–∞' : 'Bekor qilish',\r\n    phoneSaved: language === 'ru' ? '–¢–µ–ª–µ—Ñ–æ–Ω —Å–æ—Ö—Ä–∞–Ω—ë–Ω' : 'Telefon saqlandi',\r\n\r\n    // Info\r\n    loginInfo: language === 'ru'\r\n      ? '–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à –õ/–° (–ª–∏—Ü–µ–≤–æ–π —Å—á—ë—Ç) –∫–∞–∫ –ª–æ–≥–∏–Ω –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É.'\r\n      : 'Tizimga kirish uchun L/H (shaxsiy hisob) dan foydalaning.',\r\n    loginInfoTitle: language === 'ru' ? '–î–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞:' : 'Kirish ma\\'lumotlari:',\r\n\r\n    // Language switcher\r\n    languageTitle: language === 'ru' ? '–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞' : 'Interfeys tili',\r\n    languageRu: '–†—É—Å—Å–∫–∏–π',\r\n    languageUz: 'O\\'zbekcha',\r\n  }), [language]);\r\n\r\n  const formatDate = (dateStr?: string) => {\r\n    if (!dateStr) return '-';\r\n    return new Date(dateStr).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\r\n      day: '2-digit',\r\n      month: 'long',\r\n      year: 'numeric',\r\n    });\r\n  };\r\n\r\n  const getContractTypeLabel = (type?: string) => {\r\n    switch (type) {\r\n      case 'commercial': return t.typeCommercial;\r\n      case 'temporary': return t.typeTemporary;\r\n      default: return t.typeStandard;\r\n    }\r\n  };\r\n\r\n  if (!user) {\r\n    return null;\r\n  }\r\n\r\n  const handleSavePhone = async () => {\r\n    if (!newPhone.trim()) return;\r\n\r\n    setPhoneLoading(true);\r\n    try {\r\n      const success = await updateProfile({ phone: newPhone.trim() });\r\n      if (success) {\r\n        setEditingPhone(false);\r\n        setSuccessMessage(t.phoneSaved);\r\n        setTimeout(() => setSuccessMessage(''), 3000);\r\n      }\r\n    } catch {\r\n      // Error handled by store\r\n    } finally {\r\n      setPhoneLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSavePassword = async () => {\r\n    setPasswordError('');\r\n\r\n    if (!currentPassword.trim()) {\r\n      setPasswordError(t.enterCurrentPassword);\r\n      return;\r\n    }\r\n\r\n    if (newPassword.length < 4) {\r\n      setPasswordError(t.passwordTooShort);\r\n      return;\r\n    }\r\n\r\n    if (newPassword !== confirmPassword) {\r\n      setPasswordError(t.passwordsNotMatch);\r\n      return;\r\n    }\r\n\r\n    if (currentPassword === newPassword) {\r\n      setPasswordError(t.passwordSameAsOld);\r\n      return;\r\n    }\r\n\r\n    setPasswordLoading(true);\r\n    try {\r\n      const success = await changePassword(currentPassword, newPassword);\r\n      if (success) {\r\n        setEditingPassword(false);\r\n        setCurrentPassword('');\r\n        setNewPassword('');\r\n        setConfirmPassword('');\r\n        setSuccessMessage(t.passwordChanged);\r\n        setTimeout(() => setSuccessMessage(''), 3000);\r\n        // Password change is now tracked in DB (passwordChangedAt) via authStore.changePassword\r\n      } else {\r\n        setPasswordError(t.wrongPassword);\r\n      }\r\n    } catch (error: unknown) {\r\n      const errorMessage = (error as Error)?.message || '';\r\n      if (errorMessage.includes('incorrect') || errorMessage.includes('–Ω–µ–≤–µ—Ä–Ω—ã–π')) {\r\n        setPasswordError(t.wrongPassword);\r\n      } else {\r\n        setPasswordError(t.passwordError);\r\n      }\r\n    } finally {\r\n      setPasswordLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDownloadContract = async () => {\r\n    if (!user || !qrCodeUrl || isDownloading) return;\r\n\r\n    setIsDownloading(true);\r\n    try {\r\n      await generateContractDocx(user, qrCodeUrl, language);\r\n      // Mark contract as signed if not already\r\n      if (!user.contractSignedAt) {\r\n        await markContractSigned();\r\n      }\r\n    } catch (error) {\r\n      console.error('Error generating contract:', error);\r\n      alert(language === 'ru' ? '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞' : 'Shartnoma yaratishda xatolik');\r\n    } finally {\r\n      setIsDownloading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-2xl mx-auto space-y-6 pb-24 md:pb-6\">\r\n      {/* Header Card */}\r\n      <div className=\"glass-card p-4 md:p-6 bg-gradient-to-br from-yellow-50 to-amber-50 border-yellow-200\">\r\n        <h1 className=\"text-lg font-bold text-gray-900 leading-tight\">{user.name}</h1>\r\n        <div className=\"flex flex-wrap items-center gap-2 mt-2\">\r\n          <span className=\"px-2 py-0.5 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium\">\r\n            {user.role === 'tenant' ? t.tenant : user.role === 'commercial_owner' ? t.commercialOwner : t.resident}\r\n          </span>\r\n          {!isRentalUser && user.contractSignedAt && (\r\n            <span className=\"px-2 py-0.5 bg-green-100 text-green-700 rounded-full text-xs font-medium flex items-center gap-1\">\r\n              <CheckCircle className=\"w-3 h-3\" />\r\n              {t.active}\r\n            </span>\r\n          )}\r\n        </div>\r\n        <p className=\"text-gray-500 mt-2 text-xs\">{t.personalData}</p>\r\n      </div>\r\n\r\n      {/* Success Message */}\r\n      {successMessage && (\r\n        <div className=\"p-3 bg-green-50 text-green-700 rounded-xl flex items-center gap-2 animate-fade-in\">\r\n          <CheckCircle className=\"w-5 h-5\" />\r\n          {successMessage}\r\n        </div>\r\n      )}\r\n\r\n      {/* Personal Info Section */}\r\n      <div className=\"glass-card p-4 md:p-6\">\r\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\r\n          <UserIcon className=\"w-5 h-5 text-primary-500\" />\r\n          {t.personalInfo}\r\n        </h2>\r\n\r\n        <div className=\"space-y-4\">\r\n          {/* Login (–õ/–°) */}\r\n          <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\r\n            <div className=\"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n              <Key className=\"w-5 h-5 text-blue-600\" />\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <div className=\"text-xs text-gray-500 font-medium\">{t.personalAccount}</div>\r\n              <div className=\"font-mono font-bold text-gray-900\">{user.login}</div>\r\n            </div>\r\n            <div className=\"px-2 py-1 bg-gray-200 rounded text-xs text-gray-500 flex-shrink-0\">\r\n              {t.cannotChange}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Address */}\r\n          {user.address && (\r\n            <div className=\"flex items-start gap-4 p-3 bg-gray-50 rounded-xl\">\r\n              <div className=\"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center flex-shrink-0 mt-0.5\">\r\n                <MapPin className=\"w-5 h-5 text-green-600\" />\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"text-xs text-gray-500 font-medium\">{t.address}</div>\r\n                <div className=\"font-medium text-gray-900 break-words leading-snug\">{user.address}</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Apartment and Area - Grid */}\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            {user.apartment && (\r\n              <div className=\"p-3 bg-purple-50 rounded-xl text-center\">\r\n                <Home className=\"w-5 h-5 text-purple-600 mx-auto mb-1\" />\r\n                <div className=\"text-xs text-gray-500\">{t.apartment}</div>\r\n                <div className=\"font-bold text-gray-900\">{user.apartment}</div>\r\n              </div>\r\n            )}\r\n            {user.totalArea && (\r\n              <div className=\"p-3 bg-cyan-50 rounded-xl text-center\">\r\n                <Ruler className=\"w-5 h-5 text-cyan-600 mx-auto mb-1\" />\r\n                <div className=\"text-xs text-gray-500\">{t.area}</div>\r\n                <div className=\"font-bold text-gray-900\">{user.totalArea} –º¬≤</div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Branch (only show if not redundant with address) */}\r\n          {user.branch && (\r\n            <div className=\"flex items-center gap-3 p-3 bg-amber-50 rounded-xl\">\r\n              <Building2 className=\"w-5 h-5 text-amber-600\" />\r\n              <div>\r\n                <div className=\"text-xs text-gray-500\">{t.branch}</div>\r\n                <div className=\"font-bold text-gray-900\">{user.branch}</div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Phone - Editable */}\r\n          <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\r\n            <div className=\"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n              <Phone className=\"w-5 h-5 text-orange-600\" />\r\n            </div>\r\n            <div className=\"flex-1 min-w-0\">\r\n              <div className=\"text-xs text-gray-500 font-medium\">{t.phone}</div>\r\n              {!editingPhone ? (\r\n                <div className=\"font-medium text-gray-900\">\r\n                  {user.phone || t.notSpecified}\r\n                </div>\r\n              ) : (\r\n                <input\r\n                  type=\"tel\"\r\n                  value={newPhone}\r\n                  onChange={(e) => setNewPhone(e.target.value)}\r\n                  placeholder=\"+998 90 123 45 67\"\r\n                  className=\"input-field py-1.5 text-sm\"\r\n                  autoFocus\r\n                />\r\n              )}\r\n            </div>\r\n            {!editingPhone ? (\r\n              <button\r\n                onClick={() => {\r\n                  setNewPhone(user.phone || '');\r\n                  setEditingPhone(true);\r\n                }}\r\n                className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\r\n              >\r\n                <Edit3 className=\"w-5 h-5 text-gray-500\" />\r\n              </button>\r\n            ) : (\r\n              <div className=\"flex gap-1\">\r\n                <button\r\n                  onClick={handleSavePhone}\r\n                  disabled={phoneLoading}\r\n                  className=\"p-2 hover:bg-green-100 rounded-lg transition-colors disabled:opacity-50\"\r\n                >\r\n                  {phoneLoading ? (\r\n                    <Loader2 className=\"w-5 h-5 text-green-600 animate-spin\" />\r\n                  ) : (\r\n                    <Save className=\"w-5 h-5 text-green-600\" />\r\n                  )}\r\n                </button>\r\n                <button\r\n                  onClick={() => setEditingPhone(false)}\r\n                  disabled={phoneLoading}\r\n                  className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50\"\r\n                >\r\n                  <X className=\"w-5 h-5 text-gray-400\" />\r\n                </button>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Language Switcher Section */}\r\n      <div className=\"glass-card p-4 md:p-6\">\r\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\r\n          <Globe className=\"w-5 h-5 text-blue-500\" />\r\n          {t.languageTitle}\r\n        </h2>\r\n\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            onClick={() => setLanguage('ru')}\r\n            className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium transition-all ${\r\n              language === 'ru'\r\n                ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            <span className=\"text-lg\">üá∑üá∫</span>\r\n            {t.languageRu}\r\n          </button>\r\n          <button\r\n            onClick={() => setLanguage('uz')}\r\n            className={`flex-1 flex items-center justify-center gap-2 px-4 py-3 rounded-xl font-medium transition-all ${\r\n              language === 'uz'\r\n                ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30'\r\n                : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n            }`}\r\n          >\r\n            <span className=\"text-lg\">üá∫üáø</span>\r\n            {t.languageUz}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Contract Section - only for residents, not rental users */}\r\n      {!isRentalUser && (\r\n        <div className=\"glass-card p-4 md:p-6\">\r\n          <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\r\n            <FileText className=\"w-5 h-5 text-yellow-500\" />\r\n            {t.contractInfo}\r\n          </h2>\r\n\r\n          <div className=\"grid md:grid-cols-2 gap-4\">\r\n            {/* Contract Details */}\r\n            <div className=\"space-y-3\">\r\n              {/* Contract Number */}\r\n              <div className=\"p-3 bg-yellow-50 rounded-xl\">\r\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractNumber}</div>\r\n                <div className=\"font-mono font-bold text-gray-900\">\r\n                  {user.contractNumber || `–î–û–ì-${new Date().getFullYear()}-${user.login}`}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Contract Type */}\r\n              <div className=\"p-3 bg-gray-50 rounded-xl\">\r\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractType}</div>\r\n                <div className=\"font-medium text-gray-900\">\r\n                  {getContractTypeLabel(user.contractType)}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Status */}\r\n              <div className=\"p-3 bg-gray-50 rounded-xl\">\r\n                <div className=\"text-xs text-gray-500 mb-1\">{t.contractStatus}</div>\r\n                <div className=\"flex items-center gap-2\">\r\n                  {user.contractSignedAt ? (\r\n                    <>\r\n                      <span className=\"w-2 h-2 rounded-full bg-green-500\" />\r\n                      <span className=\"font-medium text-green-700\">{t.active}</span>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <span className=\"w-2 h-2 rounded-full bg-orange-500 animate-pulse\" />\r\n                      <span className=\"font-medium text-yellow-700\">{t.pending}</span>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Dates */}\r\n              <div className=\"grid grid-cols-2 gap-2\">\r\n                <div className=\"p-3 bg-gray-50 rounded-xl\">\r\n                  <div className=\"text-xs text-gray-500 mb-1\">{t.contractStart}</div>\r\n                  <div className=\"font-medium text-gray-900 text-sm\">\r\n                    {formatDate(user.contractStartDate || user.contractSignedAt || user.createdAt)}\r\n                  </div>\r\n                </div>\r\n                <div className=\"p-3 bg-gray-50 rounded-xl\">\r\n                  <div className=\"text-xs text-gray-500 mb-1\">{t.contractEnd}</div>\r\n                  <div className=\"font-medium text-gray-900 text-sm flex items-center gap-1\">\r\n                    {user.contractEndDate ? formatDate(user.contractEndDate) : (\r\n                      <>\r\n                        <Sparkles className=\"w-3 h-3 text-green-500\" />\r\n                        {t.indefinite}\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* QR Code & Signature ID */}\r\n            <div className=\"flex flex-col items-center justify-center p-4 bg-white border-2 border-dashed border-gray-200 rounded-xl\">\r\n              <div className=\"text-xs text-gray-500 mb-2 flex items-center gap-1\">\r\n                <QrCode className=\"w-3 h-3\" />\r\n                {t.yourQrCode}\r\n              </div>\r\n              {qrCodeUrl ? (\r\n                <img src={qrCodeUrl} alt=\"QR Code\" className=\"w-32 h-32\" />\r\n              ) : (\r\n                <div className=\"w-32 h-32 bg-gray-100 rounded animate-pulse\" />\r\n              )}\r\n              <p className=\"text-xs text-gray-400 mt-2 text-center max-w-[180px]\">\r\n                {t.qrHint}\r\n              </p>\r\n              {/* Signature ID */}\r\n              <div className=\"mt-3 pt-3 border-t border-gray-200 w-full text-center\">\r\n                <div className=\"text-xs text-gray-500\">{language === 'ru' ? 'ID –ø–æ–¥–ø–∏—Å–∏' : 'Imzo ID'}</div>\r\n                <div className=\"font-mono text-sm font-bold text-gray-700 select-all\">{user.id}</div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Contract Actions */}\r\n          <div className=\"grid grid-cols-2 gap-3 mt-4\">\r\n            <button\r\n              onClick={() => setShowContract(!showContract)}\r\n              className=\"flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-xl text-sm font-medium text-gray-700 transition-colors\"\r\n            >\r\n              {showContract ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\r\n              {showContract ? t.hideContract : t.viewContract}\r\n            </button>\r\n            <button\r\n              onClick={handleDownloadContract}\r\n              disabled={isDownloading || !qrCodeUrl}\r\n              className=\"flex items-center justify-center gap-2 px-4 py-3 bg-orange-400 hover:bg-orange-500 disabled:bg-gray-300 disabled:cursor-not-allowed rounded-xl text-sm font-medium text-gray-900 transition-colors\"\r\n            >\r\n              {isDownloading ? (\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n              ) : (\r\n                <Download className=\"w-4 h-4\" />\r\n              )}\r\n              {isDownloading ? t.downloading : t.downloadContract}\r\n            </button>\r\n          </div>\r\n\r\n          {/* Contract Preview - Full Document */}\r\n          {showContract && (\r\n            <div className=\"mt-4\">\r\n              <ContractPreview user={user} qrCodeUrl={qrCodeUrl} language={language} />\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Security Section */}\r\n      <div className=\"glass-card p-4 md:p-6\">\r\n        <h2 className=\"text-lg font-bold text-gray-900 flex items-center gap-2 mb-4\">\r\n          <Shield className=\"w-5 h-5 text-red-500\" />\r\n          {t.security}\r\n        </h2>\r\n\r\n        <div className=\"flex items-center gap-4 p-3 bg-gray-50 rounded-xl\">\r\n          <div className=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center flex-shrink-0\">\r\n            <Key className=\"w-5 h-5 text-red-600\" />\r\n          </div>\r\n          <div className=\"flex-1\">\r\n            <div className=\"text-xs text-gray-500 font-medium\">{t.password}</div>\r\n            <div className=\"font-medium text-gray-900\">‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>\r\n          </div>\r\n          {!editingPassword && (\r\n            <button\r\n              onClick={() => setEditingPassword(true)}\r\n              className=\"p-2 hover:bg-gray-200 rounded-lg transition-colors\"\r\n            >\r\n              <Edit3 className=\"w-5 h-5 text-gray-500\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {editingPassword && (\r\n          <div className=\"space-y-3 mt-4 pt-4 border-t\">\r\n            {/* Current Password */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                {t.currentPassword}\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={showCurrentPassword ? 'text' : 'password'}\r\n                  value={currentPassword}\r\n                  onChange={(e) => setCurrentPassword(e.target.value)}\r\n                  className=\"input-field pr-10\"\r\n                  placeholder=\"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢\"\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowCurrentPassword(!showCurrentPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  {showCurrentPassword ? (\r\n                    <EyeOff className=\"w-4 h-4\" />\r\n                  ) : (\r\n                    <Eye className=\"w-4 h-4\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* New Password */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                {t.newPassword}\r\n              </label>\r\n              <div className=\"relative\">\r\n                <input\r\n                  type={showNewPassword ? 'text' : 'password'}\r\n                  value={newPassword}\r\n                  onChange={(e) => setNewPassword(e.target.value)}\r\n                  className=\"input-field pr-10\"\r\n                  placeholder={t.minChars}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowNewPassword(!showNewPassword)}\r\n                  className=\"absolute right-3 top-1/2 -translate-y-1/2 p-2 hover:bg-gray-100 rounded-lg transition-colors text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  {showNewPassword ? (\r\n                    <EyeOff className=\"w-4 h-4\" />\r\n                  ) : (\r\n                    <Eye className=\"w-4 h-4\" />\r\n                  )}\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Confirm Password */}\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                {t.confirmPassword}\r\n              </label>\r\n              <input\r\n                type={showNewPassword ? 'text' : 'password'}\r\n                value={confirmPassword}\r\n                onChange={(e) => setConfirmPassword(e.target.value)}\r\n                className=\"input-field\"\r\n                placeholder={t.repeatPassword}\r\n              />\r\n            </div>\r\n\r\n            {/* Error Message */}\r\n            {passwordError && (\r\n              <div className=\"p-2 bg-red-50 text-red-600 text-sm rounded-lg flex items-center gap-2\">\r\n                <AlertCircle className=\"w-4 h-4\" />\r\n                {passwordError}\r\n              </div>\r\n            )}\r\n\r\n            {/* Buttons */}\r\n            <div className=\"flex gap-3 pt-2\">\r\n              <button\r\n                onClick={() => {\r\n                  setEditingPassword(false);\r\n                  setCurrentPassword('');\r\n                  setNewPassword('');\r\n                  setConfirmPassword('');\r\n                  setPasswordError('');\r\n                }}\r\n                disabled={passwordLoading}\r\n                className=\"btn-secondary flex-1\"\r\n              >\r\n                {t.cancel}\r\n              </button>\r\n              <button\r\n                onClick={handleSavePassword}\r\n                disabled={passwordLoading}\r\n                className=\"btn-primary flex-1 flex items-center justify-center gap-2\"\r\n              >\r\n                {passwordLoading ? (\r\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                ) : (\r\n                  <Save className=\"w-4 h-4\" />\r\n                )}\r\n                {t.save}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Info Note - only for residents */}\r\n      {!isRentalUser && (\r\n        <div className=\"p-4 bg-blue-50 rounded-xl text-sm text-blue-700\">\r\n          <p className=\"font-medium mb-1\">{t.loginInfoTitle}</p>\r\n          <p>{t.loginInfo}</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["ResidentProfilePage","user","changePassword","updateProfile","markContractSigned","useAuthStore","language","setLanguage","useLanguageStore","isRentalUser","editingPhone","setEditingPhone","useState","newPhone","setNewPhone","phoneLoading","setPhoneLoading","editingPassword","setEditingPassword","currentPassword","setCurrentPassword","newPassword","setNewPassword","confirmPassword","setConfirmPassword","showCurrentPassword","setShowCurrentPassword","showNewPassword","setShowNewPassword","passwordError","setPasswordError","passwordLoading","setPasswordLoading","successMessage","setSuccessMessage","showContract","setShowContract","qrCodeUrl","setQrCodeUrl","isDownloading","setIsDownloading","useEffect","residentData","url","generateQRCode","t","useMemo","formatDate","dateStr","getContractTypeLabel","type","handleSavePhone","handleSavePassword","error","errorMessage","handleDownloadContract","generateContractDocx","jsxs","jsx","CheckCircle","UserIcon","Key","MapPin","Home","Ruler","Building2","Phone","e","Loader2","Save","X","Edit3","Globe","FileText","Fragment","Sparkles","QrCode","EyeOff","Eye","Download","ContractPreview","Shield","AlertCircle"],"mappings":"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"}