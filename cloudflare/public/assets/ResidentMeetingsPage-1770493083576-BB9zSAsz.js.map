{"version":3,"file":"ResidentMeetingsPage-1770493083576-BB9zSAsz.js","sources":["../../src/components/QRSignatureModal.tsx","../../src/pages/ResidentMeetingsPage.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from 'react';\r\nimport { X, Camera, CheckCircle, AlertCircle, Key, Loader2 } from 'lucide-react';\r\nimport { generateQRCode } from './LazyQRCode';\r\n\r\ninterface QRSignatureModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onVerified: () => void;\r\n  user: {\r\n    id: string;\r\n    name: string;\r\n    login?: string;\r\n    address?: string;\r\n    apartment?: string;\r\n    phone?: string;\r\n    contractNumber?: string;\r\n  };\r\n  language: string;\r\n  title?: string;\r\n  description?: string;\r\n}\r\n\r\nexport function QRSignatureModal({\r\n  isOpen,\r\n  onClose,\r\n  onVerified,\r\n  user,\r\n  language,\r\n  title,\r\n  description\r\n}: QRSignatureModalProps) {\r\n  const [mode, setMode] = useState<'show' | 'scan'>('show');\r\n  const [qrCodeUrl, setQrCodeUrl] = useState<string>('');\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [scanResult, setScanResult] = useState<'success' | 'error' | null>(null);\r\n  const [inputCode, setInputCode] = useState('');\r\n  const videoRef = useRef<HTMLVideoElement>(null);\r\n  const streamRef = useRef<MediaStream | null>(null);\r\n\r\n  // Use user ID directly as signature code for consistency\r\n  const signatureCode = user.id.toUpperCase();\r\n\r\n  // Generate QR code with same format as profile (for consistency)\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const generateQR = async () => {\r\n      // Use same QR content as in ResidentProfilePage for consistency\r\n      const signatureText = [\r\n        `ID: ${user.id}`,\r\n        `Л/С: ${user.login || '-'}`,\r\n        `ФИО: ${user.name}`,\r\n        `Адрес: ${user.address || '-'}`,\r\n        `Кв: ${user.apartment || '-'}`,\r\n        `Тел: ${user.phone || '-'}`,\r\n        `Договор: ${user.contractNumber || '-'}`,\r\n      ].join('\\n');\r\n\r\n      const url = await generateQRCode(signatureText, {\r\n        width: 200,\r\n        margin: 2,\r\n        color: { dark: '#1f2937', light: '#ffffff' },\r\n      });\r\n      setQrCodeUrl(url);\r\n    };\r\n\r\n    generateQR();\r\n  }, [isOpen, user]);\r\n\r\n  // Cleanup camera on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      if (streamRef.current) {\r\n        streamRef.current.getTracks().forEach(track => track.stop());\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  const stopCamera = () => {\r\n    if (streamRef.current) {\r\n      streamRef.current.getTracks().forEach(track => track.stop());\r\n      streamRef.current = null;\r\n    }\r\n    setIsScanning(false);\r\n  };\r\n\r\n  const handleShowMode = () => {\r\n    setMode('show');\r\n    stopCamera();\r\n  };\r\n\r\n  // Manual code verification\r\n  const handleManualVerify = () => {\r\n    const normalizedInput = inputCode.trim().toUpperCase();\r\n    if (normalizedInput === signatureCode) {\r\n      setScanResult('success');\r\n      setTimeout(() => {\r\n        onVerified();\r\n        onClose();\r\n      }, 1500);\r\n    } else {\r\n      setScanResult('error');\r\n      setTimeout(() => setScanResult(null), 2000);\r\n    }\r\n  };\r\n\r\n  // Simple verification - just confirm they have the key\r\n  const handleConfirmSignature = () => {\r\n    setScanResult('success');\r\n    setTimeout(() => {\r\n      onVerified();\r\n      onClose();\r\n    }, 1000);\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4\">\r\n      <div className=\"bg-white rounded-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in duration-200\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b border-gray-100\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"w-10 h-10 bg-blue-100 rounded-xl flex items-center justify-center\">\r\n              <Key className=\"w-5 h-5 text-blue-600\" />\r\n            </div>\r\n            <div>\r\n              <h3 className=\"font-bold text-gray-900\">\r\n                {title || (language === 'ru' ? 'Электронная подпись' : 'Elektron imzo')}\r\n              </h3>\r\n              <p className=\"text-xs text-gray-500\">\r\n                {language === 'ru' ? 'Подтвердите вашу личность' : 'Shaxsingizni tasdiqlang'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-gray-100 rounded-xl transition-colors\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-4\">\r\n          {description && (\r\n            <p className=\"text-sm text-gray-600 mb-4 text-center\">{description}</p>\r\n          )}\r\n\r\n          {/* Success State */}\r\n          {scanResult === 'success' && (\r\n            <div className=\"text-center py-8\">\r\n              <div className=\"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce\">\r\n                <CheckCircle className=\"w-10 h-10 text-green-500\" />\r\n              </div>\r\n              <h4 className=\"text-lg font-bold text-green-700\">\r\n                {language === 'ru' ? 'Подпись подтверждена!' : 'Imzo tasdiqlandi!'}\r\n              </h4>\r\n              <p className=\"text-sm text-gray-500 mt-2\">\r\n                {language === 'ru' ? 'Ваш голос будет записан' : 'Ovozingiz qayd etiladi'}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Error State */}\r\n          {scanResult === 'error' && (\r\n            <div className=\"text-center py-4 mb-4 bg-red-50 rounded-xl\">\r\n              <AlertCircle className=\"w-8 h-8 text-red-500 mx-auto mb-2\" />\r\n              <p className=\"text-sm text-red-600\">\r\n                {language === 'ru' ? 'Неверный ключ подписи' : 'Noto\\'g\\'ri imzo kaliti'}\r\n              </p>\r\n            </div>\r\n          )}\r\n\r\n          {/* Main Content - Show QR or Scan */}\r\n          {!scanResult && (\r\n            <>\r\n              {mode === 'show' ? (\r\n                <>\r\n                  {/* Show User's QR Signature */}\r\n                  <div className=\"text-center\">\r\n                    <p className=\"text-sm text-gray-600 mb-4\">\r\n                      {language === 'ru'\r\n                        ? 'Ваш уникальный ключ электронной подписи:'\r\n                        : 'Sizning noyob elektron imzo kalitingiz:'}\r\n                    </p>\r\n\r\n                    {/* QR Code */}\r\n                    <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-4 mb-3\">\r\n                      {qrCodeUrl ? (\r\n                        <img src={qrCodeUrl} alt=\"QR Signature\" className=\"w-32 h-32 mx-auto\" />\r\n                      ) : (\r\n                        <div className=\"w-32 h-32 mx-auto bg-gray-100 rounded animate-pulse flex items-center justify-center\">\r\n                          <Loader2 className=\"w-6 h-6 animate-spin text-gray-400\" />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* User Info with ID */}\r\n                    <div className=\"bg-blue-50 rounded-xl p-3 mb-3\">\r\n                      <div className=\"flex items-center gap-2\">\r\n                        <div className=\"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-sm flex-shrink-0\">\r\n                          {user.name.charAt(0)}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"font-semibold text-gray-900\">{user.name}</p>\r\n                          <p className=\"text-xs text-gray-500\">\r\n                            {language === 'ru' ? 'Л/С:' : 'L/H:'} {user.login || '-'}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n                      {/* Signature ID */}\r\n                      <div className=\"mt-3 pt-3 border-t border-blue-100\">\r\n                        <p className=\"text-xs text-gray-500 mb-1\">\r\n                          {language === 'ru' ? 'ID электронной подписи:' : 'Elektron imzo ID:'}\r\n                        </p>\r\n                        <p className=\"font-mono text-lg font-bold text-blue-600 tracking-wider select-all\">\r\n                          {signatureCode}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Confirm Button */}\r\n                    <button\r\n                      onClick={handleConfirmSignature}\r\n                      className=\"w-full py-3 px-4 rounded-xl font-semibold text-white flex items-center justify-center gap-2 active:scale-[0.98] transition-transform\"\r\n                      style={{ background: 'linear-gradient(135deg, #3b82f6, #1d4ed8)' }}\r\n                    >\r\n                      <CheckCircle className=\"w-5 h-5\" />\r\n                      {language === 'ru' ? 'Подтвердить подпись' : 'Imzoni tasdiqlash'}\r\n                    </button>\r\n\r\n                    <p className=\"text-xs text-gray-400 mt-3 text-center\">\r\n                      {language === 'ru'\r\n                        ? 'Нажимая \"Подтвердить\", вы подписываете голос электронным ключом'\r\n                        : '\"Tasdiqlash\" tugmasini bosish orqali ovozingizni elektron kalit bilan imzolaysiz'}\r\n                    </p>\r\n                  </div>\r\n                </>\r\n              ) : (\r\n                <>\r\n                  {/* Camera Scanner */}\r\n                  <div className=\"text-center\">\r\n                    <div className=\"bg-black rounded-2xl overflow-hidden mb-4 aspect-square relative\">\r\n                      <video\r\n                        ref={videoRef}\r\n                        autoPlay\r\n                        playsInline\r\n                        className=\"w-full h-full object-cover\"\r\n                      />\r\n                      {!isScanning && (\r\n                        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900\">\r\n                          <Camera className=\"w-12 h-12 text-gray-500\" />\r\n                        </div>\r\n                      )}\r\n                      {/* Scanner overlay */}\r\n                      <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                        <div className=\"w-48 h-48 border-2 border-white/50 rounded-2xl\" />\r\n                      </div>\r\n                    </div>\r\n\r\n                    <p className=\"text-sm text-gray-600 mb-4\">\r\n                      {language === 'ru'\r\n                        ? 'Наведите камеру на ваш QR-код подписи'\r\n                        : 'Kamerani QR-kod imzongizga yo\\'naltiring'}\r\n                    </p>\r\n\r\n                    {/* Manual Input Option */}\r\n                    <div className=\"border-t border-gray-100 pt-4 mt-4\">\r\n                      <p className=\"text-xs text-gray-500 mb-2\">\r\n                        {language === 'ru' ? 'Или введите код вручную:' : 'Yoki kodni qo\\'lda kiriting:'}\r\n                      </p>\r\n                      <div className=\"flex gap-2\">\r\n                        <input\r\n                          type=\"text\"\r\n                          value={inputCode}\r\n                          onChange={(e) => setInputCode(e.target.value.toUpperCase())}\r\n                          placeholder=\"SIG-XXXXX-XXXX\"\r\n                          className=\"flex-1 px-4 py-3 rounded-xl border border-gray-200 text-center font-mono uppercase\"\r\n                        />\r\n                        <button\r\n                          onClick={handleManualVerify}\r\n                          disabled={!inputCode.trim()}\r\n                          className=\"px-4 py-3 bg-blue-500 text-white rounded-xl font-medium disabled:opacity-50\"\r\n                        >\r\n                          OK\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n\r\n                    <button\r\n                      onClick={handleShowMode}\r\n                      className=\"mt-4 text-sm text-blue-600 hover:text-blue-800\"\r\n                    >\r\n                      {language === 'ru' ? '← Показать мой QR-код' : '← QR-kodimni ko\\'rsatish'}\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        {!scanResult && (\r\n          <div className=\"px-4 pb-4\">\r\n            <button\r\n              onClick={onClose}\r\n              className=\"w-full py-2.5 px-4 rounded-xl font-medium bg-gray-100 hover:bg-gray-200 transition-colors text-sm\"\r\n            >\r\n              {language === 'ru' ? 'Отмена' : 'Bekor qilish'}\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import { useState, useEffect, useMemo, useRef, useCallback } from 'react';\r\nimport {\r\n  Vote, Calendar, FileText, Users, Building2, CheckCircle, X,\r\n  ThumbsUp, ThumbsDown, Minus, ChevronRight, Loader2, Clock, Trophy, ArrowRight, Key, User,\r\n  MessageSquare, AlertTriangle, RefreshCw\r\n} from 'lucide-react';\r\nimport { useAuthStore } from '../stores/authStore';\r\nimport { useMeetingStore } from '../stores/meetingStore';\r\nimport { useLanguageStore } from '../stores/languageStore';\r\nimport { MEETING_STATUS_LABELS, DECISION_THRESHOLD_LABELS } from '../types';\r\nimport type { Meeting, VoteChoice } from '../types';\r\nimport { QRSignatureModal } from '../components/QRSignatureModal';\r\n\r\nexport function ResidentMeetingsPage() {\r\n  const { user } = useAuthStore();\r\n  const {\r\n    meetings,\r\n    fetchMeetings,\r\n    voteForSchedule,\r\n    getScheduleVoteByUser,\r\n    voteOnAgendaItem,\r\n    getVoteByUser,\r\n    getUserVotesForMeeting,\r\n    calculateAgendaItemResult,\r\n    calculateMeetingQuorum,\r\n    fetchMyReconsiderationRequests,\r\n    markReconsiderationRequestViewed,\r\n    ignoreReconsiderationRequest,\r\n  } = useMeetingStore();\r\n  const { language } = useLanguageStore();\r\n\r\n  const [selectedMeetingId, setSelectedMeetingId] = useState<string | null>(null);\r\n  const [showVotingModal, setShowVotingModal] = useState(false);\r\n  const [reconsiderationRequests, setReconsiderationRequests] = useState<any[]>([]);\r\n  const [allowRevote, setAllowRevote] = useState(false); // Allow changing vote when responding to reconsideration request\r\n  const [newRequestAlert, setNewRequestAlert] = useState<any | null>(null); // For showing new request popup\r\n\r\n  // Track known request IDs to detect new ones\r\n  const knownRequestIds = useRef<Set<string>>(new Set());\r\n\r\n  // Get selected meeting from store (reactive to changes)\r\n  const selectedMeeting = selectedMeetingId ? meetings.find(m => m.id === selectedMeetingId) || null : null;\r\n\r\n  // ✅ OPTIMIZED: Fetch meetings once on mount (empty deps)\r\n  useEffect(() => {\r\n    fetchMeetings();\r\n  }, []); // Empty array - runs only once\r\n\r\n  // Load reconsideration requests with new request detection\r\n  const loadReconsiderationRequests = useCallback(async (isInitial = false) => {\r\n    const requests = await fetchMyReconsiderationRequests();\r\n\r\n    // Detect new requests (only after initial load)\r\n    if (!isInitial && requests.length > 0) {\r\n      const newRequests = requests.filter(r =>\r\n        (r.status === 'pending' || r.status === 'viewed') &&\r\n        !knownRequestIds.current.has(r.id)\r\n      );\r\n\r\n      if (newRequests.length > 0) {\r\n        // Show alert for the first new request\r\n        setNewRequestAlert(newRequests[0]);\r\n\r\n        // Play notification sound if available\r\n        try {\r\n          const audio = new Audio('/notification.mp3');\r\n          audio.volume = 0.5;\r\n          audio.play().catch(() => {}); // Ignore if autoplay blocked\r\n        } catch {}\r\n      }\r\n    }\r\n\r\n    // Update known IDs\r\n    requests.forEach(r => knownRequestIds.current.add(r.id));\r\n\r\n    setReconsiderationRequests(requests);\r\n  }, [fetchMyReconsiderationRequests]);\r\n\r\n  // Initial fetch of reconsideration requests\r\n  useEffect(() => {\r\n    loadReconsiderationRequests(true);\r\n  }, [loadReconsiderationRequests]);\r\n\r\n  // Poll for new reconsideration requests every 5 seconds\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      loadReconsiderationRequests(false);\r\n    }, 5000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [loadReconsiderationRequests]);\r\n\r\n  // Handle ignoring a reconsideration request\r\n  const handleIgnoreRequest = async (requestId: string) => {\r\n    await ignoreReconsiderationRequest(requestId);\r\n    // Refresh the requests list\r\n    await loadReconsiderationRequests(false);\r\n    // Close alert if this was the alerted request\r\n    if (newRequestAlert?.id === requestId) {\r\n      setNewRequestAlert(null);\r\n    }\r\n  };\r\n\r\n  // Handle viewing and opening vote modal for a request\r\n  const handleRespondToRequest = async (request: any) => {\r\n    // Mark as viewed\r\n    await markReconsiderationRequestViewed(request.id);\r\n\r\n    // Enable revote mode - allows changing existing votes\r\n    setAllowRevote(true);\r\n\r\n    // Show modal immediately (loading state will show if meeting not yet loaded)\r\n    setSelectedMeetingId(request.meetingId);\r\n    setShowVotingModal(true);\r\n\r\n    // Close alert if responding from alert\r\n    if (newRequestAlert?.id === request.id) {\r\n      setNewRequestAlert(null);\r\n    }\r\n\r\n    // Refresh meetings to ensure the meeting is loaded\r\n    await fetchMeetings();\r\n\r\n    // Refresh requests\r\n    await loadReconsiderationRequests(false);\r\n  };\r\n\r\n  // Load user's votes when opening voting modal\r\n  useEffect(() => {\r\n    if (selectedMeetingId && user?.id) {\r\n      getUserVotesForMeeting(selectedMeetingId, user.id);\r\n    }\r\n  }, [selectedMeetingId, user?.id, getUserVotesForMeeting]);\r\n\r\n  // ✅ OPTIMIZED: Memoized filtering (no re-computation on every render)\r\n  // ✅ FIX: Filter meetings by user's building - residents should only see meetings for their building\r\n  const activeMeetings = useMemo(() =>\r\n    meetings.filter(m =>\r\n      ['schedule_poll_open', 'voting_open', 'results_published', 'protocol_approved'].includes(m.status) &&\r\n      // Filter by building: only show meetings for user's building\r\n      (!user?.buildingId || m.buildingId === user.buildingId)\r\n    ),\r\n    [meetings, user?.buildingId]\r\n  );\r\n\r\n  const votableMeetings = useMemo(() =>\r\n    activeMeetings.filter(m =>\r\n      ['schedule_poll_open', 'voting_open'].includes(m.status)\r\n    ),\r\n    [activeMeetings]\r\n  );\r\n\r\n  const formatDate = (dateStr: string) => {\r\n    return new Date(dateStr).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\r\n      weekday: 'short',\r\n      day: '2-digit',\r\n      month: 'short',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  const getStatusStyles = (status: Meeting['status']) => {\r\n    switch (status) {\r\n      case 'schedule_poll_open':\r\n        return { bg: 'bg-blue-50 border-blue-300', badge: 'bg-blue-100 text-blue-700' };\r\n      case 'voting_open':\r\n        return { bg: 'bg-green-50 border-green-300', badge: 'bg-green-100 text-green-700' };\r\n      case 'results_published':\r\n        return { bg: 'bg-purple-50 border-purple-300', badge: 'bg-purple-100 text-purple-700' };\r\n      case 'protocol_approved':\r\n        return { bg: 'bg-emerald-50 border-emerald-300', badge: 'bg-emerald-100 text-emerald-700' };\r\n      default:\r\n        return { bg: 'bg-gray-50 border-gray-300', badge: 'bg-gray-100 text-gray-700' };\r\n    }\r\n  };\r\n\r\n  const handleOpenMeeting = (meeting: Meeting) => {\r\n    setSelectedMeetingId(meeting.id);\r\n    setShowVotingModal(true);\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4 md:space-y-6 pb-20 md:pb-0\">\r\n      {/* New Request Popup Alert */}\r\n      {newRequestAlert && (\r\n        <div className=\"fixed top-4 right-4 left-4 md:left-auto md:w-96 z-50 animate-in slide-in-from-top-2 duration-300\">\r\n          <div className=\"glass-card p-4 border-2 border-orange-400 bg-gradient-to-r from-orange-50 to-yellow-50 shadow-xl\">\r\n            <div className=\"flex items-start gap-3\">\r\n              <div className=\"p-2 bg-orange-100 rounded-full animate-pulse\">\r\n                <AlertTriangle className=\"w-5 h-5 text-orange-600\" />\r\n              </div>\r\n              <div className=\"flex-1 min-w-0\">\r\n                <div className=\"font-bold text-orange-800 mb-1\">\r\n                  {language === 'ru' ? 'Новый запрос!' : 'Yangi so\\'rov!'}\r\n                </div>\r\n                <div className=\"text-sm text-orange-700 mb-2\">\r\n                  {language === 'ru'\r\n                    ? 'УК просит вас пересмотреть свой голос'\r\n                    : 'BK sizdan ovozingizni qayta ko\\'rib chiqishni so\\'raydi'}\r\n                </div>\r\n                <div className=\"text-xs text-gray-600 mb-3 truncate\">\r\n                  {newRequestAlert.agendaItemTitle}\r\n                </div>\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={() => handleRespondToRequest(newRequestAlert)}\r\n                    className=\"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-orange-500 text-white rounded-xl text-sm font-medium hover:bg-orange-600 transition-colors\"\r\n                  >\r\n                    <RefreshCw className=\"w-4 h-4\" />\r\n                    {language === 'ru' ? 'Открыть' : 'Ochish'}\r\n                  </button>\r\n                  <button\r\n                    onClick={() => setNewRequestAlert(null)}\r\n                    className=\"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-xl transition-colors\"\r\n                  >\r\n                    <X className=\"w-5 h-5\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-xl md:text-2xl font-bold flex items-center gap-3\">\r\n          <Vote className=\"w-7 h-7 text-primary-500\" />\r\n          {language === 'ru' ? 'Собрания' : 'Yig\\'ilishlar'}\r\n        </h1>\r\n\r\n        {votableMeetings.length > 0 && (\r\n          <span className=\"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-medium\">\r\n            {votableMeetings.length} {language === 'ru' ? 'активных' : 'faol'}\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {/* Reconsideration Requests Banner */}\r\n      {reconsiderationRequests.length > 0 && (\r\n        <div className=\"space-y-3\">\r\n          {reconsiderationRequests.map((request) => (\r\n            <div\r\n              key={request.id}\r\n              className=\"glass-card p-4 border-2 border-orange-300 bg-orange-50\"\r\n            >\r\n              <div className=\"flex items-start gap-3\">\r\n                <div className=\"p-2 bg-orange-100 rounded-xl\">\r\n                  <AlertTriangle className=\"w-5 h-5 text-orange-600\" />\r\n                </div>\r\n                <div className=\"flex-1 min-w-0\">\r\n                  <div className=\"font-medium text-orange-800 mb-1\">\r\n                    {language === 'ru' ? 'Просьба пересмотреть голос' : 'Ovozni qayta ko\\'rib chiqish so\\'rovi'}\r\n                  </div>\r\n                  <div className=\"text-sm text-orange-700 mb-2\">\r\n                    {language === 'ru' ? 'Вопрос:' : 'Savol:'} {request.agendaItemTitle}\r\n                  </div>\r\n                  {request.messageToResident && (\r\n                    <div className=\"p-2 bg-white rounded-lg text-sm text-gray-700 mb-2\">\r\n                      <MessageSquare className=\"w-3 h-3 inline mr-1 text-orange-500\" />\r\n                      {request.messageToResident}\r\n                    </div>\r\n                  )}\r\n                  <div className=\"text-xs text-orange-600 mb-3\">\r\n                    {language === 'ru'\r\n                      ? 'Это только просьба. Вы сами решаете, менять голос или нет.'\r\n                      : 'Bu faqat iltimos. Ovozni o\\'zgartirish yoki o\\'zgartirmaslikni o\\'zingiz hal qilasiz.'}\r\n                  </div>\r\n                  <div className=\"flex gap-2\">\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleRespondToRequest(request);\r\n                      }}\r\n                      className=\"flex items-center gap-2 px-4 py-2 bg-orange-500 text-white rounded-xl text-sm font-medium hover:bg-orange-600 transition-colors\"\r\n                    >\r\n                      <RefreshCw className=\"w-4 h-4\" />\r\n                      {language === 'ru' ? 'Изменить голос' : 'Ovozni o\\'zgartirish'}\r\n                    </button>\r\n                    <button\r\n                      onClick={(e) => {\r\n                        e.stopPropagation();\r\n                        handleIgnoreRequest(request.id);\r\n                      }}\r\n                      className=\"flex items-center gap-2 px-4 py-2 border border-orange-300 text-orange-700 rounded-xl text-sm font-medium hover:bg-orange-100 transition-colors\"\r\n                    >\r\n                      <X className=\"w-4 h-4\" />\r\n                      {language === 'ru' ? 'Оставить как есть' : 'Shundayligicha qoldirish'}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Meetings List */}\r\n      {activeMeetings.length === 0 ? (\r\n        <div className=\"glass-card p-8 text-center\">\r\n          <Vote className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n          <p className=\"text-gray-500\">\r\n            {language === 'ru' ? 'Нет активных собраний' : 'Faol yig\\'ilishlar yo\\'q'}\r\n          </p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {activeMeetings.map((meeting) => {\r\n            const styles = getStatusStyles(meeting.status);\r\n            const statusLabel = MEETING_STATUS_LABELS[meeting.status];\r\n            const quorum = calculateMeetingQuorum(meeting.id);\r\n            // Check if user has already voted (is in participatedVoters)\r\n            const hasVoted = user?.id && meeting.participatedVoters?.includes(user.id);\r\n            // Note: scheduleVote will be loaded async in the modal\r\n            const scheduleVote: string | null = null;\r\n\r\n            return (\r\n              <div\r\n                key={meeting.id}\r\n                className={`glass-card p-4 border-2 ${styles.bg} cursor-pointer hover:shadow-md transition-all`}\r\n                onClick={() => handleOpenMeeting(meeting)}\r\n              >\r\n                {/* Header */}\r\n                <div className=\"flex items-start justify-between gap-3 mb-3\">\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2 flex-wrap mb-1\">\r\n                      <span className={`px-2 py-0.5 rounded-lg text-xs font-medium ${styles.badge}`}>\r\n                        {language === 'ru' ? statusLabel?.label : statusLabel?.labelUz}\r\n                      </span>\r\n                      <span className=\"text-xs text-gray-500\">#{meeting.number}</span>\r\n                      {/* Show \"Voted\" badge if user has voted */}\r\n                      {hasVoted && meeting.status === 'voting_open' && (\r\n                        <span className=\"px-2 py-0.5 rounded-lg text-xs font-medium bg-green-100 text-green-700 flex items-center gap-1\">\r\n                          <CheckCircle className=\"w-3 h-3\" />\r\n                          {language === 'ru' ? 'Вы проголосовали' : 'Ovoz berdingiz'}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2 text-sm text-gray-600\">\r\n                      <Building2 className=\"w-4 h-4\" />\r\n                      <span className=\"truncate\">{meeting.buildingAddress}</span>\r\n                    </div>\r\n                  </div>\r\n                  <ChevronRight className=\"w-5 h-5 text-gray-400\" />\r\n                </div>\r\n\r\n                {/* Agenda Summary */}\r\n                <div className=\"flex items-center gap-2 text-sm text-gray-600 mb-3\">\r\n                  <FileText className=\"w-4 h-4\" />\r\n                  <span>\r\n                    {meeting.agendaItems.length} {language === 'ru' ? 'вопросов' : 'savol'}\r\n                  </span>\r\n                </div>\r\n\r\n                {/* Schedule Poll Info */}\r\n                {meeting.status === 'schedule_poll_open' && (\r\n                  <div className=\"bg-white/60 rounded-lg p-3 mb-3\">\r\n                    <div className=\"text-sm font-medium mb-2\">\r\n                      {language === 'ru' ? 'Голосование за дату' : 'Sana uchun ovoz berish'}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {scheduleVote ? (\r\n                        <span className=\"text-xs text-green-600 flex items-center gap-1\">\r\n                          <CheckCircle className=\"w-4 h-4\" />\r\n                          {language === 'ru' ? 'Вы уже проголосовали' : 'Siz ovoz berdingiz'}\r\n                        </span>\r\n                      ) : (\r\n                        <span className=\"text-xs text-blue-600\">\r\n                          {language === 'ru' ? 'Выберите удобную дату' : 'Qulay sanani tanlang'}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Confirmed Date */}\r\n                {meeting.confirmedDateTime && meeting.status !== 'schedule_poll_open' && (\r\n                  <div className=\"flex items-center gap-2 text-sm bg-white/60 rounded-lg p-3 mb-3\">\r\n                    <Calendar className=\"w-4 h-4 text-green-500\" />\r\n                    <span className=\"font-medium\">{formatDate(meeting.confirmedDateTime)}</span>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Thank you message if already voted */}\r\n                {hasVoted && meeting.status === 'voting_open' && (\r\n                  <div className=\"bg-green-50 border border-green-200 rounded-xl p-3 mb-3\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <CheckCircle className=\"w-5 h-5 text-green-500\" />\r\n                      <div>\r\n                        <p className=\"text-sm font-medium text-green-800\">\r\n                          {language === 'ru' ? 'Спасибо за участие!' : 'Ishtirok uchun rahmat!'}\r\n                        </p>\r\n                        <p className=\"text-xs text-green-600\">\r\n                          {language === 'ru' ? 'Ваш голос учтён' : 'Ovozingiz hisobga olindi'}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                )}\r\n\r\n                {/* Voting Call to Action - show only if not voted yet */}\r\n                {meeting.status === 'voting_open' && !hasVoted && (\r\n                  <div\r\n                    className=\"w-full py-3 px-4 rounded-xl font-semibold text-white flex items-center justify-center gap-2 active:scale-[0.98] transition-transform touch-manipulation\"\r\n                    style={{ background: 'linear-gradient(135deg, #10b981, #059669)' }}\r\n                  >\r\n                    <Vote className=\"w-5 h-5\" />\r\n                    {language === 'ru' ? 'Проголосовать' : 'Ovoz berish'}\r\n                  </div>\r\n                )}\r\n\r\n                {/* View Details button if already voted */}\r\n                {meeting.status === 'voting_open' && hasVoted && (\r\n                  <div className=\"w-full py-3 px-4 rounded-xl font-medium bg-gray-100 text-gray-700 flex items-center justify-center gap-2\">\r\n                    <ChevronRight className=\"w-5 h-5\" />\r\n                    {language === 'ru' ? 'Посмотреть детали' : 'Tafsilotlarni ko\\'rish'}\r\n                  </div>\r\n                )}\r\n\r\n                {/* Quorum Info */}\r\n                {['voting_open', 'results_published', 'protocol_approved'].includes(meeting.status) && (\r\n                  <div className=\"flex items-center justify-between text-sm mt-3 pt-3 border-t border-gray-200/50\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Users className=\"w-4 h-4 text-gray-400\" />\r\n                      <span>{quorum.participated}/{quorum.total} ({quorum.percent.toFixed(0)}%)</span>\r\n                    </div>\r\n                    <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${\r\n                      quorum.quorumReached ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                    }`}>\r\n                      {quorum.quorumReached\r\n                        ? (language === 'ru' ? 'Кворум есть' : 'Kvorum bor')\r\n                        : (language === 'ru' ? 'Нет кворума' : 'Kvorum yo\\'q')}\r\n                    </span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      )}\r\n\r\n      {/* Voting Modal */}\r\n      {showVotingModal && selectedMeeting && user && (\r\n        <MeetingVotingModal\r\n          meeting={selectedMeeting}\r\n          language={language}\r\n          user={user}\r\n          allowRevote={allowRevote}\r\n          onClose={() => {\r\n            setShowVotingModal(false);\r\n            setSelectedMeetingId(null);\r\n            setAllowRevote(false); // Reset revote mode on close\r\n          }}\r\n          getVote={(agendaItemId) => {\r\n            const vote = getVoteByUser(selectedMeeting.id, agendaItemId, user.id);\r\n            if (vote && vote.choice !== 'schedule') {\r\n              return { choice: vote.choice as VoteChoice };\r\n            }\r\n            return undefined;\r\n          }}\r\n          onVote={(agendaItemId, choice, verified, comment) =>\r\n            voteOnAgendaItem(selectedMeeting.id, agendaItemId, user.id, user.name, choice, {\r\n              method: 'e_signature',\r\n              otpVerified: verified,\r\n            }, comment)\r\n          }\r\n          getScheduleVote={() => getScheduleVoteByUser(selectedMeeting.id)}\r\n          onScheduleVote={(optionId) => voteForSchedule(selectedMeeting.id, optionId)}\r\n          calculateResult={(agendaItemId) => calculateAgendaItemResult(selectedMeeting.id, agendaItemId)}\r\n          calculateQuorum={() => calculateMeetingQuorum(selectedMeeting.id)}\r\n        />\r\n      )}\r\n\r\n      {/* Loading Modal when meeting not found yet */}\r\n      {showVotingModal && !selectedMeeting && selectedMeetingId && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white rounded-2xl p-6 max-w-sm w-full mx-4 text-center\">\r\n            <Loader2 className=\"w-8 h-8 animate-spin mx-auto mb-3 text-orange-500\" />\r\n            <p className=\"text-gray-600\">\r\n              {language === 'ru' ? 'Загрузка собрания...' : 'Yig\\'ilish yuklanmoqda...'}\r\n            </p>\r\n            <button\r\n              onClick={() => {\r\n                setShowVotingModal(false);\r\n                setSelectedMeetingId(null);\r\n              }}\r\n              className=\"mt-4 px-4 py-2 text-gray-600 hover:text-gray-800\"\r\n            >\r\n              {language === 'ru' ? 'Отмена' : 'Bekor qilish'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Meeting Voting Modal Component\r\nfunction MeetingVotingModal({\r\n  meeting,\r\n  language,\r\n  user,\r\n  allowRevote = false,\r\n  onClose,\r\n  getVote,\r\n  onVote,\r\n  getScheduleVote,\r\n  onScheduleVote,\r\n  calculateResult,\r\n  calculateQuorum,\r\n}: {\r\n  meeting: Meeting;\r\n  language: string;\r\n  user: { id: string; name: string; login?: string; address?: string; apartment?: string; phone?: string; contractNumber?: string };\r\n  allowRevote?: boolean; // Allow changing vote (for reconsideration requests)\r\n  onClose: () => void;\r\n  getVote: (agendaItemId: string) => { choice: VoteChoice } | undefined;\r\n  onVote: (agendaItemId: string, choice: VoteChoice, verified: boolean, comment?: string) => void;\r\n  getScheduleVote: () => Promise<string | null>;\r\n  onScheduleVote: (optionId: string) => Promise<{ success: boolean; error?: string }>;\r\n  calculateResult: (agendaItemId: string) => {\r\n    votesFor: number;\r\n    votesAgainst: number;\r\n    votesAbstain: number;\r\n    totalVotes: number;\r\n    percentFor: number;\r\n    isApproved: boolean;\r\n    thresholdMet: boolean;\r\n  };\r\n  calculateQuorum: () => { participated: number; total: number; percent: number; quorumReached: boolean };\r\n}) {\r\n  // Track pending votes for all agenda items (before submission)\r\n  const [pendingVotes, setPendingVotes] = useState<Record<string, VoteChoice>>({});\r\n  // Track comments for each agenda item vote\r\n  const [pendingComments, setPendingComments] = useState<Record<string, string>>({});\r\n  const [showSignatureModal, setShowSignatureModal] = useState(false);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [selectedScheduleOption, setSelectedScheduleOption] = useState<string | null>(null);\r\n  const [scheduleVoteLoading, setScheduleVoteLoading] = useState(false);\r\n  const [scheduleVoteSuccess, setScheduleVoteSuccess] = useState(false);\r\n  const [previousVote, setPreviousVote] = useState<string | null>(null);\r\n  const [votesSubmitted, setVotesSubmitted] = useState(false);\r\n\r\n  // Load schedule vote on mount\r\n  useEffect(() => {\r\n    getScheduleVote().then(vote => {\r\n      setSelectedScheduleOption(vote);\r\n      setPreviousVote(vote);\r\n    });\r\n  }, [getScheduleVote]);\r\n\r\n  // Initialize pendingVotes with existing votes when in revote mode\r\n  useEffect(() => {\r\n    if (allowRevote) {\r\n      const existingVotes: Record<string, VoteChoice> = {};\r\n      meeting.agendaItems.forEach(item => {\r\n        const vote = getVote(item.id);\r\n        if (vote && vote.choice) {\r\n          existingVotes[item.id] = vote.choice;\r\n        }\r\n      });\r\n      if (Object.keys(existingVotes).length > 0) {\r\n        setPendingVotes(existingVotes);\r\n      }\r\n    }\r\n  }, [allowRevote, meeting.agendaItems, getVote]);\r\n\r\n  // Check if user has already voted on all items\r\n  // When allowRevote is true, treat as if not voted to allow changing votes\r\n  const hasVotedOnAll = allowRevote ? false : meeting.agendaItems.every(item => getVote(item.id) !== undefined);\r\n\r\n  const quorum = calculateQuorum();\r\n  const isVotingOpen = meeting.status === 'voting_open';\r\n  const isSchedulePoll = meeting.status === 'schedule_poll_open';\r\n  const showResults = ['voting_closed', 'results_published', 'protocol_generated', 'protocol_approved'].includes(meeting.status);\r\n\r\n  // Handle selecting a vote for an agenda item (just stores locally, doesn't submit)\r\n  const handleVoteClick = (agendaItemId: string, choice: VoteChoice) => {\r\n    setPendingVotes(prev => ({\r\n      ...prev,\r\n      [agendaItemId]: choice\r\n    }));\r\n  };\r\n\r\n  // Check if all agenda items have a vote (either pending or already submitted)\r\n  const allItemsVoted = meeting.agendaItems.every(item =>\r\n    pendingVotes[item.id] || getVote(item.id)\r\n  );\r\n\r\n  // Count how many items have votes\r\n  const votedItemsCount = meeting.agendaItems.filter(item =>\r\n    pendingVotes[item.id] || getVote(item.id)\r\n  ).length;\r\n\r\n  // Handle confirmation click - opens signature modal\r\n  const handleConfirmAllVotes = () => {\r\n    if (Object.keys(pendingVotes).length === 0) return;\r\n    setShowSignatureModal(true);\r\n  };\r\n\r\n  // After signature verified, submit all pending votes with comments\r\n  const handleSignatureVerified = async () => {\r\n    setShowSignatureModal(false);\r\n    setIsSubmitting(true);\r\n\r\n    try {\r\n      // Submit all pending votes with their comments\r\n      for (const [agendaItemId, choice] of Object.entries(pendingVotes)) {\r\n        const comment = pendingComments[agendaItemId]?.trim() || undefined;\r\n        await onVote(agendaItemId, choice, true, comment);\r\n      }\r\n      setPendingVotes({});\r\n      setPendingComments({});\r\n      setVotesSubmitted(true);\r\n    } catch (error: any) {\r\n      console.error('Failed to submit votes:', error);\r\n      const errorMessage = error?.message || 'Ошибка при голосовании. Проверьте что указана площадь квартиры.';\r\n      alert(errorMessage);\r\n      setVotesSubmitted(false);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleScheduleVote = async (optionId: string) => {\r\n    // Don't allow if already voted (one vote only, no re-voting)\r\n    if (previousVote) return;\r\n\r\n    // Don't do anything if clicking the same option\r\n    if (optionId === selectedScheduleOption) return;\r\n\r\n    setScheduleVoteLoading(true);\r\n    setScheduleVoteSuccess(false);\r\n\r\n    try {\r\n      const result = await onScheduleVote(optionId);\r\n\r\n      if (result && !result.success) {\r\n        // Show error message if vote failed\r\n        const errorMsg = result.error || 'Ошибка при голосовании. Проверьте что указана площадь квартиры.';\r\n        alert(errorMsg);\r\n        setSelectedScheduleOption('');\r\n\r\n        // If meeting not found, close modal and refresh\r\n        if (errorMsg.includes('не найдено')) {\r\n          onClose();\r\n          window.location.reload();\r\n        }\r\n      } else {\r\n        // Vote successful\r\n        setSelectedScheduleOption(optionId);\r\n        setScheduleVoteSuccess(true);\r\n\r\n        // After successful vote, set previousVote to lock further voting\r\n        // Use setTimeout to show the success message briefly first\r\n        setTimeout(() => {\r\n          setPreviousVote(optionId);\r\n          setScheduleVoteSuccess(false);\r\n        }, 2000);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Failed to vote:', error);\r\n      const errorMessage = error?.message || 'Ошибка при голосовании. Проверьте что указана площадь квартиры.';\r\n      alert(errorMessage);\r\n      setSelectedScheduleOption('');\r\n\r\n      // If meeting not found, close modal and refresh\r\n      if (errorMessage.includes('не найдено')) {\r\n        onClose();\r\n        window.location.reload();\r\n      }\r\n    } finally {\r\n      setScheduleVoteLoading(false);\r\n    }\r\n  };\r\n\r\n  // Calculate total votes and find leading option (use voteCount for proper counting)\r\n  const totalScheduleVotes = meeting.scheduleOptions.reduce((sum, opt) => sum + ((opt as any).voteCount ?? opt.votes?.length ?? 0), 0);\r\n  const maxVotes = Math.max(...meeting.scheduleOptions.map(opt => (opt as any).voteCount ?? opt.votes?.length ?? 0));\r\n  const leadingOptions = meeting.scheduleOptions.filter(opt => ((opt as any).voteCount ?? opt.votes?.length ?? 0) === maxVotes && maxVotes > 0);\r\n\r\n  const formatDate = (dateStr: string) => {\r\n    return new Date(dateStr).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\r\n      weekday: 'long',\r\n      day: '2-digit',\r\n      month: 'long',\r\n      year: 'numeric',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  const formatShortDate = (dateStr: string) => {\r\n    return new Date(dateStr).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\r\n      weekday: 'short',\r\n      day: '2-digit',\r\n      month: 'short',\r\n      hour: '2-digit',\r\n      minute: '2-digit',\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 z-50 flex items-end md:items-center justify-center\">\r\n      <div className=\"max-h-[85vh] md:max-h-[90vh] w-full md:max-w-lg md:mx-4 bg-white rounded-t-2xl md:rounded-2xl flex flex-col overflow-hidden animate-in slide-in-from-bottom-4 md:slide-in-from-bottom-0 duration-200\">\r\n        {/* Header - more compact */}\r\n        <div className=\"flex items-center justify-between p-3 border-b border-gray-100 bg-white sticky top-0 z-10\">\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <h2 className=\"text-base font-bold truncate\">\r\n                {language === 'ru' ? `Собрание #${meeting.number}` : `Yig'ilish #${meeting.number}`}\r\n              </h2>\r\n              <span className={`px-2 py-0.5 rounded-lg text-xs font-medium flex-shrink-0 ${\r\n                MEETING_STATUS_LABELS[meeting.status]?.color === 'green' ? 'bg-green-100 text-green-700' :\r\n                MEETING_STATUS_LABELS[meeting.status]?.color === 'blue' ? 'bg-blue-100 text-blue-700' :\r\n                'bg-gray-100 text-gray-700'\r\n              }`}>\r\n                {language === 'ru' ? MEETING_STATUS_LABELS[meeting.status]?.label : MEETING_STATUS_LABELS[meeting.status]?.labelUz}\r\n              </span>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500 truncate\">{meeting.buildingAddress}</p>\r\n          </div>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 hover:bg-gray-100 active:bg-gray-200 rounded-xl transition-colors touch-manipulation ml-2\"\r\n          >\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"flex-1 overflow-y-auto p-3 space-y-3\">\r\n          {/* Revote Banner - shown when changing vote after reconsideration request */}\r\n          {allowRevote && (\r\n            <div className=\"bg-orange-50 border border-orange-200 rounded-xl p-3\">\r\n              <div className=\"flex items-start gap-2\">\r\n                <RefreshCw className=\"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-orange-800\">\r\n                    {language === 'ru' ? 'Изменение голоса' : 'Ovozni o\\'zgartirish'}\r\n                  </p>\r\n                  <p className=\"text-xs text-orange-600\">\r\n                    {language === 'ru'\r\n                      ? 'Выберите новый вариант голоса и подтвердите изменение'\r\n                      : 'Yangi ovoz variantini tanlang va o\\'zgartirishni tasdiqlang'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Quorum Info - compact */}\r\n          <div className=\"flex items-center justify-between bg-gray-50 rounded-xl p-2.5\">\r\n            <div className=\"flex items-center gap-2 text-sm\">\r\n              <User className=\"w-4 h-4 text-gray-400\" />\r\n              <span className=\"text-gray-600\">{language === 'ru' ? 'Участие:' : 'Ishtirok:'}</span>\r\n              <span className=\"font-medium\">{quorum.participated}/{quorum.total}</span>\r\n              <span className=\"text-gray-400\">({quorum.percent.toFixed(0)}%)</span>\r\n            </div>\r\n            <span className={`px-2 py-0.5 rounded-full text-xs font-medium ${\r\n              quorum.quorumReached ? 'bg-green-100 text-green-700' : 'bg-amber-100 text-amber-700'\r\n            }`}>\r\n              {quorum.quorumReached\r\n                ? (language === 'ru' ? 'Кворум есть' : 'Kvorum bor')\r\n                : (language === 'ru' ? 'Нет кворума' : 'Kvorum yo\\'q')\r\n              }\r\n            </span>\r\n          </div>\r\n\r\n          {/* Schedule Poll */}\r\n          {isSchedulePoll && (\r\n            <div className=\"space-y-4\">\r\n              {/* Header with deadline */}\r\n              <div className=\"bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl p-4 text-white\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <h3 className=\"font-semibold text-lg flex items-center gap-2\">\r\n                    <Calendar className=\"w-5 h-5\" />\r\n                    {language === 'ru' ? 'Голосование за дату' : 'Sana uchun ovoz berish'}\r\n                  </h3>\r\n                  {totalScheduleVotes > 0 && (\r\n                    <span className=\"bg-white/20 px-3 py-1 rounded-full text-sm\">\r\n                      {totalScheduleVotes} {language === 'ru' ? 'голосов' : 'ovoz'}\r\n                    </span>\r\n                  )}\r\n                </div>\r\n                {meeting.schedulePollEndsAt && (\r\n                  <div className=\"flex items-center gap-2 text-blue-100 text-sm\">\r\n                    <Clock className=\"w-4 h-4\" />\r\n                    {language === 'ru' ? 'Завершится: ' : 'Tugaydi: '}\r\n                    {new Date(meeting.schedulePollEndsAt).toLocaleDateString(language === 'ru' ? 'ru-RU' : 'uz-UZ', {\r\n                      day: '2-digit', month: 'long', hour: '2-digit', minute: '2-digit'\r\n                    })}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {/* Instructions - only if not voted yet */}\r\n              {!previousVote && !selectedScheduleOption && (\r\n                <div className=\"bg-amber-50 border border-amber-200 rounded-xl p-3\">\r\n                  <p className=\"text-sm text-amber-700 flex items-center gap-2\">\r\n                    <ArrowRight className=\"w-4 h-4 flex-shrink-0\" />\r\n                    {language === 'ru'\r\n                      ? 'Нажмите на удобную для вас дату, чтобы проголосовать'\r\n                      : 'Qulay sanani bosing ovoz berish uchun'}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Already voted indicator */}\r\n              {previousVote && (\r\n                <div className=\"bg-green-50 border border-green-200 rounded-xl p-4\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center\">\r\n                      <CheckCircle className=\"w-6 h-6 text-green-600\" />\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"font-medium text-green-700\">\r\n                        {language === 'ru' ? 'Вы уже проголосовали!' : 'Siz allaqachon ovoz berdingiz!'}\r\n                      </p>\r\n                      <p className=\"text-sm text-green-600\">\r\n                        {language === 'ru'\r\n                          ? 'Ваш голос учтён. Ожидайте подтверждения даты администратором.'\r\n                          : 'Ovozingiz hisobga olindi. Administrator sanani tasdiqlaguncha kuting.'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Vote options */}\r\n              <div className=\"space-y-3\">\r\n                {meeting.scheduleOptions.map((option, index) => {\r\n                  const isSelected = selectedScheduleOption === option.id;\r\n                  const isLeading = leadingOptions.some(lo => lo.id === option.id);\r\n                  const optionVoteCount = (option as any).voteCount ?? option.votes?.length ?? 0;\r\n                  const votePercent = totalScheduleVotes > 0 ? (optionVoteCount / totalScheduleVotes) * 100 : 0;\r\n\r\n                  // Disable voting if already voted (previousVote exists)\r\n                  const alreadyVoted = !!previousVote;\r\n\r\n                  return (\r\n                    <div\r\n                      key={option.id}\r\n                      onClick={() => !alreadyVoted && !scheduleVoteLoading && handleScheduleVote(option.id)}\r\n                      className={`w-full p-4 rounded-xl border-2 text-left transition-all relative overflow-hidden ${\r\n                        isSelected\r\n                          ? 'border-green-500 bg-green-50 shadow-md'\r\n                          : alreadyVoted\r\n                            ? 'border-gray-200 bg-gray-50 cursor-default'\r\n                            : 'border-gray-200 hover:border-blue-300 hover:bg-blue-50/50 bg-white cursor-pointer'\r\n                      } ${scheduleVoteLoading ? 'opacity-70 pointer-events-none' : ''}`}\r\n                    >\r\n                      {/* Progress bar background */}\r\n                      {totalScheduleVotes > 0 && (\r\n                        <div\r\n                          className={`absolute inset-0 transition-all ${\r\n                            isSelected ? 'bg-green-100' : 'bg-blue-50'\r\n                          }`}\r\n                          style={{ width: `${votePercent}%` }}\r\n                        />\r\n                      )}\r\n\r\n                      <div className=\"relative flex items-center justify-between\">\r\n                        <div className=\"flex items-center gap-3\">\r\n                          {/* Option number or checkmark */}\r\n                          <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${\r\n                            isSelected\r\n                              ? 'bg-green-500 text-white'\r\n                              : 'bg-gray-100 text-gray-600'\r\n                          }`}>\r\n                            {isSelected ? <CheckCircle className=\"w-5 h-5\" /> : index + 1}\r\n                          </div>\r\n\r\n                          <div>\r\n                            <div className=\"font-medium text-gray-900\">\r\n                              {formatShortDate(option.dateTime)}\r\n                            </div>\r\n                            {isLeading && !isSelected && option.votes.length > 0 && (\r\n                              <div className=\"flex items-center gap-1 text-xs text-amber-600 mt-0.5\">\r\n                                <Trophy className=\"w-3 h-3\" />\r\n                                {language === 'ru' ? 'Лидирует' : 'Yetakchi'}\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex items-center gap-3\">\r\n                          {/* Vote count with percentage */}\r\n                          <div className=\"text-right\">\r\n                            <div className={`font-semibold ${isSelected ? 'text-green-700' : 'text-gray-700'}`}>\r\n                              {optionVoteCount}\r\n                            </div>\r\n                            {totalScheduleVotes > 0 && (\r\n                              <div className=\"text-xs text-gray-500\">\r\n                                {votePercent.toFixed(0)}%\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n\r\n                          {/* Loading indicator */}\r\n                          {scheduleVoteLoading && isSelected && (\r\n                            <Loader2 className=\"w-5 h-5 text-green-500 animate-spin\" />\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                  );\r\n                })}\r\n              </div>\r\n\r\n              {/* Success message - only show on first vote, then previousVote gets set and the \"already voted\" indicator is shown instead */}\r\n              {scheduleVoteSuccess && !previousVote && (\r\n                <div className=\"bg-green-100 border border-green-300 rounded-xl p-4 animate-pulse\">\r\n                  <div className=\"flex items-center gap-3\">\r\n                    <div className=\"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center\">\r\n                      <CheckCircle className=\"w-6 h-6 text-white\" />\r\n                    </div>\r\n                    <div>\r\n                      <div className=\"font-semibold text-green-800\">\r\n                        {language === 'ru' ? 'Голос принят!' : 'Ovoz qabul qilindi!'}\r\n                      </div>\r\n                      <p className=\"text-sm text-green-600\">\r\n                        {language === 'ru'\r\n                          ? 'Ваш выбор зарегистрирован. После завершения опроса будет выбрана дата с максимальным числом голосов.'\r\n                          : 'Tanlovingiz ro\\'yxatga olindi. So\\'rovnoma tugagandan so\\'ng eng ko\\'p ovoz olgan sana tanlanadi.'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Current vote status - only shown briefly after first voting, then previousVote gets set */}\r\n              {selectedScheduleOption && !scheduleVoteSuccess && !previousVote && (\r\n                <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-4\">\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <CheckCircle className=\"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5\" />\r\n                    <div>\r\n                      <div className=\"font-medium text-blue-800\">\r\n                        {language === 'ru' ? 'Ваш голос учтён' : 'Ovozingiz hisobga olindi'}\r\n                      </div>\r\n                      <p className=\"text-sm text-blue-600 mt-1\">\r\n                        {language === 'ru'\r\n                          ? 'После завершения опроса будет выбрана дата с максимальным числом голосов.'\r\n                          : 'So\\'rovnoma tugagach, eng ko\\'p ovoz olgan sana tanlanadi.'}\r\n                      </p>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Meeting Timeline */}\r\n          <div className=\"bg-gray-50 rounded-xl p-4 border border-gray-200\">\r\n            <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n              <FileText className=\"w-4 h-4\" />\r\n              {language === 'ru' ? 'Этапы собрания' : 'Yig\\'ilish bosqichlari'}\r\n            </h3>\r\n            <div className=\"space-y-3\">\r\n              {[\r\n                { status: 'schedule_poll_open', label: language === 'ru' ? 'Опрос по дате' : 'Sana so\\'rovi', labelUz: 'Sana so\\'rovi' },\r\n                { status: 'schedule_confirmed', label: language === 'ru' ? 'Дата подтверждена' : 'Sana tasdiqlandi', labelUz: 'Sana tasdiqlandi' },\r\n                { status: 'voting_open', label: language === 'ru' ? 'Голосование' : 'Ovoz berish', labelUz: 'Ovoz berish' },\r\n                { status: 'voting_closed', label: language === 'ru' ? 'Подсчёт голосов' : 'Ovozlar sanash', labelUz: 'Ovozlar sanash' },\r\n                { status: 'results_published', label: language === 'ru' ? 'Результаты' : 'Natijalar', labelUz: 'Natijalar' },\r\n                { status: 'protocol_approved', label: language === 'ru' ? 'Протокол' : 'Bayonnoma', labelUz: 'Bayonnoma' },\r\n              ].map((step, index) => {\r\n                const statusOrder = ['schedule_poll_open', 'schedule_confirmed', 'voting_open', 'voting_closed', 'results_published', 'protocol_approved'];\r\n                const currentIndex = statusOrder.indexOf(meeting.status);\r\n                const stepIndex = statusOrder.indexOf(step.status);\r\n                const isCompleted = stepIndex < currentIndex;\r\n                const isCurrent = step.status === meeting.status;\r\n\r\n                return (\r\n                  <div key={step.status} className=\"flex items-center gap-3\">\r\n                    <div className={`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${\r\n                      isCompleted ? 'bg-green-500 text-white' :\r\n                      isCurrent ? 'bg-blue-500 text-white' :\r\n                      'bg-gray-200 text-gray-500'\r\n                    }`}>\r\n                      {isCompleted ? <CheckCircle className=\"w-4 h-4\" /> : index + 1}\r\n                    </div>\r\n                    <span className={`text-sm ${\r\n                      isCompleted ? 'text-green-700' :\r\n                      isCurrent ? 'text-blue-700 font-medium' :\r\n                      'text-gray-400'\r\n                    }`}>\r\n                      {step.label}\r\n                    </span>\r\n                    {isCurrent && (\r\n                      <span className=\"text-xs px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full\">\r\n                        {language === 'ru' ? 'Сейчас' : 'Hozir'}\r\n                      </span>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Confirmed Date */}\r\n          {meeting.confirmedDateTime && !isSchedulePoll && (\r\n            <div className=\"flex items-center gap-2 text-sm bg-gray-50 rounded-lg p-3\">\r\n              <Calendar className=\"w-4 h-4 text-gray-500\" />\r\n              <span>{formatDate(meeting.confirmedDateTime)}</span>\r\n            </div>\r\n          )}\r\n\r\n          {/* Voting Instructions */}\r\n          {isVotingOpen && (\r\n            <div className=\"bg-blue-50 border border-blue-200 rounded-xl p-4\">\r\n              <div className=\"flex items-start gap-3\">\r\n                <Key className=\"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5\" />\r\n                <div className=\"text-sm text-blue-700\">\r\n                  {language === 'ru'\r\n                    ? 'Для подтверждения голоса используется ваш уникальный электронный ключ. Это защищает от подделки голосов.'\r\n                    : 'Ovozni tasdiqlash uchun sizning noyob elektron kalitingiz ishlatiladi. Bu ovozlarni soxtalashtirish oldini oladi.'}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Agenda Items */}\r\n          {(isVotingOpen || showResults) && (\r\n            <div className=\"space-y-4\">\r\n              <h3 className=\"font-medium\">\r\n                {language === 'ru' ? 'Повестка дня' : 'Kun tartibi'}\r\n              </h3>\r\n\r\n              {meeting.agendaItems.map((item, index) => {\r\n                const existingVote = getVote(item.id);\r\n                const result = calculateResult(item.id);\r\n\r\n                return (\r\n                  <div key={item.id} className=\"bg-gray-50 rounded-xl p-4 border border-gray-200\">\r\n                    <div className=\"mb-3\">\r\n                      <div className=\"font-medium text-base\">\r\n                        {index + 1}. {item.title}\r\n                      </div>\r\n                      <p className=\"text-sm text-gray-600 mt-1\">{item.description}</p>\r\n                      <div className=\"flex items-center gap-2 mt-2\">\r\n                        <span className=\"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-600\">\r\n                          {language === 'ru'\r\n                            ? DECISION_THRESHOLD_LABELS[item.threshold]?.label\r\n                            : DECISION_THRESHOLD_LABELS[item.threshold]?.labelUz}\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Voting Buttons */}\r\n                    {isVotingOpen && !hasVotedOnAll && (\r\n                      <div className=\"grid grid-cols-3 gap-2 mb-3\">\r\n                        {/* Get current selection: pendingVotes first, then existingVote */}\r\n                        {(() => {\r\n                          const currentChoice = pendingVotes[item.id] || existingVote?.choice;\r\n                          return (\r\n                            <>\r\n                              <button\r\n                                onClick={() => handleVoteClick(item.id, 'for')}\r\n                                disabled={isSubmitting}\r\n                                className={`py-3 px-3 rounded-xl font-medium text-sm flex items-center justify-center gap-2 transition-all ${\r\n                                  currentChoice === 'for'\r\n                                    ? 'bg-green-500 text-white ring-2 ring-green-300'\r\n                                    : 'bg-green-50 text-green-700 border border-green-200 hover:bg-green-100 active:bg-green-200'\r\n                                }`}\r\n                              >\r\n                                <ThumbsUp className=\"w-4 h-4\" />\r\n                                {language === 'ru' ? 'За' : 'Ha'}\r\n                              </button>\r\n                              <button\r\n                                onClick={() => handleVoteClick(item.id, 'against')}\r\n                                disabled={isSubmitting}\r\n                                className={`py-3 px-3 rounded-xl font-medium text-sm flex items-center justify-center gap-2 transition-all ${\r\n                                  currentChoice === 'against'\r\n                                    ? 'bg-red-500 text-white ring-2 ring-red-300'\r\n                                    : 'bg-red-50 text-red-700 border border-red-200 hover:bg-red-100 active:bg-red-200'\r\n                                }`}\r\n                              >\r\n                                <ThumbsDown className=\"w-4 h-4\" />\r\n                                {language === 'ru' ? 'Против' : 'Yo\\'q'}\r\n                              </button>\r\n                              <button\r\n                                onClick={() => handleVoteClick(item.id, 'abstain')}\r\n                                disabled={isSubmitting}\r\n                                className={`py-3 px-3 rounded-xl font-medium text-sm flex items-center justify-center gap-2 transition-all ${\r\n                                  currentChoice === 'abstain'\r\n                                    ? 'bg-gray-500 text-white ring-2 ring-gray-300'\r\n                                    : 'bg-gray-50 text-gray-700 border border-gray-200 hover:bg-gray-100 active:bg-gray-200'\r\n                                }`}\r\n                              >\r\n                                <Minus className=\"w-4 h-4\" />\r\n                                {language === 'ru' ? 'Воздерж.' : 'Betaraf'}\r\n                              </button>\r\n                            </>\r\n                          );\r\n                        })()}\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Comment input - show when vote is selected but not yet submitted */}\r\n                    {isVotingOpen && !hasVotedOnAll && pendingVotes[item.id] && (\r\n                      <div className=\"mb-3\">\r\n                        <label className=\"flex items-center gap-1.5 text-xs text-gray-500 mb-1\">\r\n                          <MessageSquare className=\"w-3 h-3\" />\r\n                          {language === 'ru' ? 'Обоснование (будет в протоколе)' : 'Asoslash (bayonnomada bo\\'ladi)'}\r\n                        </label>\r\n                        <textarea\r\n                          value={pendingComments[item.id] || ''}\r\n                          onChange={(e) => setPendingComments(prev => ({ ...prev, [item.id]: e.target.value }))}\r\n                          placeholder={language === 'ru' ? 'Почему вы так проголосовали? (необязательно)' : 'Nima uchun shunday ovoz berdingiz? (ixtiyoriy)'}\r\n                          className=\"w-full px-3 py-2 text-sm border border-gray-200 rounded-xl bg-white focus:outline-none focus:ring-2 focus:ring-blue-200 resize-none\"\r\n                          rows={2}\r\n                          maxLength={500}\r\n                        />\r\n                        <div className=\"flex justify-between items-center mt-1\">\r\n                          <span className=\"text-[10px] text-gray-400\">\r\n                            {language === 'ru' ? 'Будет виден в протоколе собрания' : 'Yig\\'ilish bayonnomasida ko\\'rinadi'}\r\n                          </span>\r\n                          <span className=\"text-[10px] text-gray-400\">\r\n                            {(pendingComments[item.id] || '').length}/500\r\n                          </span>\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n\r\n                    {/* Your Vote Indicator - show for submitted votes or pending selection */}\r\n                    {(() => {\r\n                      const currentChoice = existingVote?.choice || pendingVotes[item.id];\r\n                      const isSubmitted = !!existingVote;\r\n                      if (!currentChoice) return null;\r\n                      return (\r\n                        <div className={`text-sm font-medium flex items-center gap-2 mb-2 ${\r\n                          currentChoice === 'for' ? 'text-green-600' :\r\n                          currentChoice === 'against' ? 'text-red-600' : 'text-gray-600'\r\n                        }`}>\r\n                          {isSubmitted ? (\r\n                            <CheckCircle className=\"w-4 h-4\" />\r\n                          ) : (\r\n                            <span className=\"w-4 h-4 rounded-full border-2 border-current\" />\r\n                          )}\r\n                          {isSubmitted\r\n                            ? (language === 'ru' ? 'Ваш голос: ' : 'Sizning ovozingiz: ')\r\n                            : (language === 'ru' ? 'Выбрано: ' : 'Tanlangan: ')\r\n                          }\r\n                          {currentChoice === 'for' ? (language === 'ru' ? 'За' : 'Ha') :\r\n                           currentChoice === 'against' ? (language === 'ru' ? 'Против' : 'Yo\\'q') :\r\n                           (language === 'ru' ? 'Воздержался' : 'Betaraf')}\r\n                          {!isSubmitted && (\r\n                            <span className=\"text-xs text-gray-400 ml-1\">\r\n                              ({language === 'ru' ? 'не подтверждено' : 'tasdiqlanmagan'})\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      );\r\n                    })()}\r\n\r\n                    {/* Results */}\r\n                    {(showResults || (isVotingOpen && meeting.votingSettings?.showIntermediateResults)) && (\r\n                      <div className=\"pt-3 border-t border-gray-200\">\r\n                        <div className=\"grid grid-cols-3 gap-2 text-sm mb-2\">\r\n                          <div className=\"flex items-center gap-1 text-green-600\">\r\n                            <ThumbsUp className=\"w-4 h-4\" />\r\n                            <span>{result.votesFor} ({result.percentFor.toFixed(0)}%)</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-1 text-red-600\">\r\n                            <ThumbsDown className=\"w-4 h-4\" />\r\n                            <span>{result.votesAgainst}</span>\r\n                          </div>\r\n                          <div className=\"flex items-center gap-1 text-gray-600\">\r\n                            <Minus className=\"w-4 h-4\" />\r\n                            <span>{result.votesAbstain}</span>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"h-2 bg-gray-200 rounded-full overflow-hidden\">\r\n                          <div\r\n                            className={`h-full ${result.thresholdMet ? 'bg-green-500' : 'bg-red-500'}`}\r\n                            style={{ width: `${result.percentFor}%` }}\r\n                          />\r\n                        </div>\r\n\r\n                        {showResults && item.isApproved !== undefined && (\r\n                          <div className={`mt-2 px-3 py-1 rounded-lg text-sm font-medium inline-flex items-center gap-1 ${\r\n                            item.isApproved ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'\r\n                          }`}>\r\n                            {item.isApproved\r\n                              ? (language === 'ru' ? 'Принято' : 'Qabul qilindi')\r\n                              : (language === 'ru' ? 'Не принято' : 'Rad etildi')}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-3 border-t border-gray-100 bg-white safe-area-bottom space-y-2\">\r\n          {/* Show confirm button when voting is open and there are pending votes */}\r\n          {isVotingOpen && !hasVotedOnAll && Object.keys(pendingVotes).length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              {/* Progress indicator */}\r\n              <div className=\"flex items-center justify-between text-sm\">\r\n                <div className=\"flex items-center gap-2\">\r\n                  <User className=\"w-4 h-4 text-gray-400\" />\r\n                  <span className=\"text-gray-600\">\r\n                    {language === 'ru' ? 'Отвечено:' : 'Javob berildi:'}\r\n                  </span>\r\n                </div>\r\n                <span className=\"font-medium\">\r\n                  {votedItemsCount}/{meeting.agendaItems.length}\r\n                  <span className=\"text-gray-400 ml-1\">\r\n                    ({Math.round((votedItemsCount / meeting.agendaItems.length) * 100)}%)\r\n                  </span>\r\n                </span>\r\n                {!quorum.quorumReached && (\r\n                  <span className=\"text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full\">\r\n                    {language === 'ru' ? 'Нет кворума' : 'Kvorum yo\\'q'}\r\n                  </span>\r\n                )}\r\n              </div>\r\n\r\n              {/* Confirm button */}\r\n              <button\r\n                onClick={handleConfirmAllVotes}\r\n                disabled={isSubmitting || Object.keys(pendingVotes).length === 0}\r\n                className=\"w-full py-3 px-4 rounded-xl font-semibold text-white flex items-center justify-center gap-2 active:scale-[0.98] transition-transform touch-manipulation disabled:opacity-50\"\r\n                style={{ background: allItemsVoted ? 'linear-gradient(135deg, #10b981, #059669)' : 'linear-gradient(135deg, #3b82f6, #1d4ed8)' }}\r\n              >\r\n                {isSubmitting ? (\r\n                  <>\r\n                    <Loader2 className=\"w-5 h-5 animate-spin\" />\r\n                    {language === 'ru' ? 'Отправка...' : 'Yuborilmoqda...'}\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <Key className=\"w-5 h-5\" />\r\n                    {allItemsVoted\r\n                      ? (language === 'ru' ? 'Подписать и отправить все голоса' : 'Imzolash va barcha ovozlarni yuborish')\r\n                      : (language === 'ru' ? `Подтвердить ${Object.keys(pendingVotes).length} голос(ов)` : `${Object.keys(pendingVotes).length} ta ovozni tasdiqlash`)\r\n                    }\r\n                  </>\r\n                )}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {/* Show success message after voting */}\r\n          {(votesSubmitted || hasVotedOnAll) && isVotingOpen && (\r\n            <div className=\"bg-green-50 border border-green-200 rounded-xl p-3 mb-2\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <CheckCircle className=\"w-5 h-5 text-green-500\" />\r\n                <div>\r\n                  <p className=\"text-sm font-medium text-green-800\">\r\n                    {language === 'ru' ? 'Спасибо за участие!' : 'Ishtirok uchun rahmat!'}\r\n                  </p>\r\n                  <p className=\"text-xs text-green-600\">\r\n                    {language === 'ru' ? 'Все ваши голоса учтены' : 'Barcha ovozlaringiz hisobga olindi'}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          <button\r\n            onClick={onClose}\r\n            className=\"w-full py-3 px-4 rounded-xl font-medium bg-gray-100 hover:bg-gray-200 active:bg-gray-300 transition-colors touch-manipulation\"\r\n          >\r\n            {language === 'ru' ? 'Закрыть' : 'Yopish'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* QR Signature Verification Modal */}\r\n      <QRSignatureModal\r\n        isOpen={showSignatureModal}\r\n        onClose={() => setShowSignatureModal(false)}\r\n        onVerified={handleSignatureVerified}\r\n        user={user}\r\n        language={language}\r\n        title={language === 'ru' ? 'Подтверждение голосов' : 'Ovozlarni tasdiqlash'}\r\n        description={language === 'ru'\r\n          ? `Подтвердите, что все ${Object.keys(pendingVotes).length} голос(ов) поданы вами лично. Нажмите \"Подтвердить\" для подписи электронным ключом.`\r\n          : `Barcha ${Object.keys(pendingVotes).length} ta ovoz sizning tomoningizdan berilganligini tasdiqlang. Elektron kalit bilan imzolash uchun \"Tasdiqlash\" tugmasini bosing.`\r\n        }\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["QRSignatureModal","isOpen","onClose","onVerified","user","language","title","description","mode","setMode","useState","qrCodeUrl","setQrCodeUrl","isScanning","setIsScanning","scanResult","setScanResult","inputCode","setInputCode","videoRef","useRef","streamRef","signatureCode","useEffect","signatureText","url","generateQRCode","track","stopCamera","handleShowMode","handleManualVerify","handleConfirmSignature","jsxs","jsx","Key","X","CheckCircle","AlertCircle","Fragment","Loader2","Camera","e","ResidentMeetingsPage","useAuthStore","meetings","fetchMeetings","voteForSchedule","getScheduleVoteByUser","voteOnAgendaItem","getVoteByUser","getUserVotesForMeeting","calculateAgendaItemResult","calculateMeetingQuorum","fetchMyReconsiderationRequests","markReconsiderationRequestViewed","ignoreReconsiderationRequest","useMeetingStore","useLanguageStore","selectedMeetingId","setSelectedMeetingId","showVotingModal","setShowVotingModal","reconsiderationRequests","setReconsiderationRequests","allowRevote","setAllowRevote","newRequestAlert","setNewRequestAlert","knownRequestIds","selectedMeeting","m","loadReconsiderationRequests","useCallback","isInitial","requests","newRequests","r","audio","interval","handleIgnoreRequest","requestId","handleRespondToRequest","request","activeMeetings","useMemo","votableMeetings","formatDate","dateStr","getStatusStyles","status","handleOpenMeeting","meeting","AlertTriangle","RefreshCw","Vote","MessageSquare","styles","statusLabel","MEETING_STATUS_LABELS","quorum","hasVoted","Building2","ChevronRight","FileText","Calendar","Users","MeetingVotingModal","agendaItemId","vote","choice","verified","comment","optionId","getVote","onVote","getScheduleVote","onScheduleVote","calculateResult","calculateQuorum","pendingVotes","setPendingVotes","pendingComments","setPendingComments","showSignatureModal","setShowSignatureModal","isSubmitting","setIsSubmitting","selectedScheduleOption","setSelectedScheduleOption","scheduleVoteLoading","setScheduleVoteLoading","scheduleVoteSuccess","setScheduleVoteSuccess","previousVote","setPreviousVote","votesSubmitted","setVotesSubmitted","existingVotes","item","hasVotedOnAll","isVotingOpen","isSchedulePoll","showResults","handleVoteClick","prev","allItemsVoted","votedItemsCount","handleConfirmAllVotes","handleSignatureVerified","error","errorMessage","handleScheduleVote","result","errorMsg","totalScheduleVotes","sum","opt","maxVotes","leadingOptions","formatShortDate","User","Clock","ArrowRight","option","index","isSelected","isLeading","lo","optionVoteCount","votePercent","alreadyVoted","Trophy","step","statusOrder","currentIndex","isCompleted","isCurrent","existingVote","DECISION_THRESHOLD_LABELS","currentChoice","ThumbsUp","ThumbsDown","Minus","isSubmitted"],"mappings":"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"}