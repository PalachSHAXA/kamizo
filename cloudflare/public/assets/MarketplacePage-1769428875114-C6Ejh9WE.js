import{r as i,S as te,bn as V,q as E,as as ve,aV as z,j as e,y as M,z as Ee,ax as W,at as R,ao as Z,D as ee,aa as Ye,U as Fe,al as Ie,m as se,X as ae}from"./react-vendor-1769428875114-t_MJ7TI5.js";import{b as Ae,d as Qe,e as c}from"./index-1769428875114-CG_16j_e.js";import"./vendor-1769428875114-wOrLRiCI.js";import"./qr-scanner-1769428875114-B_vB3SDT.js";import"./zustand-1769428875114-wNUYBKDB.js";const Y=[{id:"created",statuses:["new"],labelRu:"–ù–æ–≤—ã–π",labelUz:"Yangi",icon:te,descRu:"–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω",descUz:"Buyurtma yaratildi"},{id:"confirmed",statuses:["confirmed"],labelRu:"–ù–∞–∑–Ω–∞—á–µ–Ω",labelUz:"Tayinlangan",icon:M,descRu:"–ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω",descUz:"Buyurtma tasdiqlandi"},{id:"preparing",statuses:["preparing"],labelRu:"–°–æ–±–∏—Ä–∞–µ—Ç—Å—è",labelUz:"Yig'ilmoqda",icon:E,descRu:"–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑",descUz:"Buyurtma yig'ilmoqda"},{id:"delivering",statuses:["delivering"],labelRu:"–î–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è",labelUz:"Yetkazilmoqda",icon:Fe,descRu:"–í –ø—É—Ç–∏ –∫ –≤–∞–º",descUz:"Sizga yo'lda"},{id:"ready",statuses:["ready"],labelRu:"–ì–æ—Ç–æ–≤",labelUz:"Tayyor",icon:M,descRu:"–ì–æ—Ç–æ–≤ –∫ –ø–æ–ª—É—á–µ–Ω–∏—é",descUz:"Qabul qilishga tayyor"},{id:"delivered",statuses:["delivered"],labelRu:"–ü–æ–ª—É—á–µ–Ω",labelUz:"Qabul qilindi",icon:M,descRu:"–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω",descUz:"Buyurtma yetkazildi"}];function He(o){if(o==="cancelled")return-1;for(let a=0;a<Y.length;a++)if(Y[a].statuses.includes(o))return a;return 0}function Je(o,a){switch(o){case"new":return{title:a==="ru"?"–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω":"Buyurtma yaratildi",subtitle:a==="ru"?"–û–∂–∏–¥–∞–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è":"Tasdiqlanishini kutmoqdamiz"};case"confirmed":return{title:a==="ru"?"–ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç":"Buyurtma qabul qilindi",subtitle:a==="ru"?"–ù–∞—á–∏–Ω–∞–µ–º —Å–±–æ—Ä–∫—É":"Yig'ishni boshlaymiz"};case"preparing":return{title:a==="ru"?"–°–æ–±–∏—Ä–∞–µ–º –∑–∞–∫–∞–∑":"Buyurtma yig'ilmoqda",subtitle:a==="ru"?"–°–∫–æ—Ä–æ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤":"Tez orada tayyor bo'ladi"};case"ready":return{title:a==="ru"?"–ó–∞–∫–∞–∑ –≥–æ—Ç–æ–≤":"Buyurtma tayyor",subtitle:a==="ru"?"–ü–µ—Ä–µ–¥–∞—ë–º –∫—É—Ä—å–µ—Ä—É":"Kuryerga topshirilmoqda"};case"delivering":return{title:a==="ru"?"–ö—É—Ä—å–µ—Ä –≤ –ø—É—Ç–∏":"Kuryer yo'lda",subtitle:a==="ru"?"–°–∫–æ—Ä–æ –±—É–¥–µ—Ç —É –≤–∞—Å":"Tez orada sizda bo'ladi"};case"delivered":return{title:a==="ru"?"–ó–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω":"Buyurtma yetkazildi",subtitle:a==="ru"?"–ü—Ä–∏—è—Ç–Ω–æ–≥–æ –∞–ø–ø–µ—Ç–∏—Ç–∞!":"Yoqimli ishtaha!"};case"cancelled":return{title:a==="ru"?"–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω—ë–Ω":"Buyurtma bekor qilindi",subtitle:""};default:return{title:"",subtitle:""}}}const O={cat_groceries:"üõí",cat_dairy:"ü•õ",cat_meat:"ü•©",cat_bakery:"üçû",cat_fruits:"üçé",cat_beverages:"ü•§",cat_household:"üßπ",cat_personal:"üß¥",cat_baby:"üë∂",cat_pets:"üêæ",cat_frozen:"‚ùÑÔ∏è",cat_snacks:"üçø"};function Ze(){const{user:o}=Ae(),{language:a}=Qe(),[p,y]=i.useState("shop"),[we,ke]=i.useState([]),[P,_e]=i.useState([]),[j,N]=i.useState([]),[m,v]=i.useState([]),[x,w]=i.useState([]),[B,re]=i.useState(null),[F,Se]=i.useState(""),[Ce,le]=i.useState(!0),[d,I]=i.useState(null),[qe,A]=i.useState(!1),[ie,ne]=i.useState(""),[ze,ce]=i.useState(!1),[de,oe]=i.useState(null),[k,me]=i.useState(1),[_,xe]=i.useState(1),[S,ue]=i.useState(1),h=10,[Re,C]=i.useState(!1),[T,q]=i.useState(null),[b,Q]=i.useState(5),[he,H]=i.useState(""),[ge,be]=i.useState(!1),pe=i.useCallback(async()=>{try{le(!0);const[s,t]=await Promise.all([c("/api/marketplace/categories"),c("/api/marketplace/products")]);if(ke(s?.categories||[]),_e(t?.products||[]),o)try{const[r,l,n]=await Promise.all([c("/api/marketplace/cart"),c("/api/marketplace/orders"),c("/api/marketplace/favorites")]);N(r?.cart||[]),v(l?.orders||[]),w((n?.favorites||[]).map(g=>g.id))}catch{}}catch{}finally{le(!1)}},[o]);i.useEffect(()=>{pe()},[pe]),i.useEffect(()=>{if(!o||!m.some(l=>!["delivered","cancelled"].includes(l.status)))return;const r=setInterval(async()=>{try{const l=await c("/api/marketplace/orders");l?.orders&&v(l.orders)}catch{}},1e4);return()=>clearInterval(r)},[o,m.length>0&&m.some(s=>!["delivered","cancelled"].includes(s.status))]),i.useEffect(()=>{const s=t=>{const{orderId:r}=t.detail,l=m.find(n=>n.id===r);l&&l.status==="delivered"&&(q(r),C(!0),sessionStorage.removeItem("open_delivery_rating_for_order"))};return window.addEventListener("openDeliveryRatingModal",s),()=>{window.removeEventListener("openDeliveryRatingModal",s)}},[m]),i.useEffect(()=>{if(m.length===0)return;const s=sessionStorage.getItem("open_delivery_rating_for_order");if(s){const t=m.find(r=>r.id===s);t&&t.status==="delivered"&&(q(s),C(!0),sessionStorage.removeItem("open_delivery_rating_for_order"))}},[m]);const J=async(s,t=1)=>{try{await c("/api/marketplace/cart",{method:"POST",body:JSON.stringify({product_id:s,quantity:t})});const r=await c("/api/marketplace/cart");N(r?.cart||[])}catch{}},f=async(s,t)=>{if(t<=0){await ye(s);return}try{await c("/api/marketplace/cart",{method:"POST",body:JSON.stringify({product_id:s,quantity:t})});const r=await c("/api/marketplace/cart");N(r?.cart||[])}catch{}},ye=async s=>{try{await c(`/api/marketplace/cart/${s}`,{method:"DELETE"});const t=await c("/api/marketplace/cart");N(t?.cart||[])}catch{}},X=async s=>{const t=x.includes(s);w(t?x.filter(r=>r!==s):[...x,s]);try{await c(`/api/marketplace/favorites/${s}`,{method:"POST"})}catch{w(t?[...x,s]:x.filter(l=>l!==s))}},Oe=async()=>{try{await c("/api/marketplace/orders",{method:"POST",body:JSON.stringify({delivery_notes:ie})}),ce(!0),A(!1),ne("");const[s,t]=await Promise.all([c("/api/marketplace/cart"),c("/api/marketplace/orders")]);N(s?.cart||[]),v(t?.orders||[]),setTimeout(()=>{ce(!1),y("orders")},2e3)}catch{}},Me=async()=>{if(T)try{be(!0),await c(`/api/marketplace/orders/${T}/rate`,{method:"POST",body:JSON.stringify({rating:b,review:he||void 0})});const s=await c("/api/marketplace/orders");v(s?.orders||[]),C(!1),q(null),Q(5),H("")}catch{}finally{be(!1)}},Pe=async s=>{if(confirm(a==="ru"?"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑?":"Buyurtmani bekor qilmoqchimisiz?"))try{oe(s),await c(`/api/marketplace/orders/${s}/cancel`,{method:"POST",body:JSON.stringify({reason:"–û—Ç–º–µ–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º"})});const t=await c("/api/marketplace/orders");v(t?.orders||[])}catch{alert(a==="ru"?"–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–∫–∞–∑–∞":"Buyurtmani bekor qilishda xato")}finally{oe(null)}},G=P.filter(s=>{const t=!B||s.category_id===B,r=!F||(a==="ru"?s.name_ru:s.name_uz).toLowerCase().includes(F.toLowerCase());return t&&r}),je=s=>j.find(r=>r.product_id===s)?.quantity||0,fe=j.reduce((s,t)=>{const r=P.find(l=>l.id===t.product_id);return s+(r?.price||0)*t.quantity},0),u=s=>new Intl.NumberFormat("ru-RU").format(s)+" —Å—É–º",$=m.filter(s=>!["delivered","cancelled"].includes(s.status)),K=m.filter(s=>["delivered","cancelled"].includes(s.status)),Be=G.slice((k-1)*h,k*h),D=Math.ceil(G.length/h),Te=$.slice((_-1)*h,_*h),U=Math.ceil($.length/h),$e=K.slice((S-1)*h,S*h),L=Math.ceil(K.length/h),De=[{id:"shop",label:a==="ru"?"–ú–∞–≥–∞–∑–∏–Ω":"Do'kon",shortLabel:a==="ru"?"–¢–æ–≤–∞—Ä—ã":"Do'kon",icon:te},{id:"cart",label:a==="ru"?"–ö–æ—Ä–∑–∏–Ω–∞":"Savat",shortLabel:a==="ru"?"–ö–æ—Ä–∑–∏–Ω–∞":"Savat",icon:V,count:j.length},{id:"orders",label:a==="ru"?"–ê–∫—Ç–∏–≤–Ω—ã–µ":"Faol",shortLabel:a==="ru"?"–ê–∫—Ç–∏–≤.":"Faol",icon:E,count:$.length},{id:"history",label:a==="ru"?"–ò—Å—Ç–æ—Ä–∏—è":"Tarix",shortLabel:a==="ru"?"–ò—Å—Ç–æ—Ä.":"Tarix",icon:ve},{id:"favorites",label:a==="ru"?"–ò–∑–±—Ä–∞–Ω–Ω–æ–µ":"Sevimlilar",shortLabel:a==="ru"?"–ò–∑–±—Ä.":"Sevim.",icon:z,count:x.length}];return Ce?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 bg-orange-50/50"})}):e.jsxs("div",{className:"space-y-4 md:space-y-6 pb-20 md:pb-0",children:[ze&&e.jsxs("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2",children:[e.jsx(M,{className:"w-5 h-5"}),e.jsx("span",{children:a==="ru"?"–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω!":"Buyurtma muvaffaqiyatli yaratildi!"})]}),e.jsx("div",{className:"glass-card sticky top-0 z-40",children:e.jsx("div",{className:"flex",children:De.map(s=>e.jsxs("button",{onClick:()=>y(s.id),className:`flex-1 py-3 px-2 sm:px-4 flex items-center justify-center gap-1 sm:gap-2 border-b-2 transition-colors ${p===s.id?"border-orange-500 text-orange-600 bg-orange-50/50":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(s.icon,{className:"w-5 h-5 flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium whitespace-nowrap",children:s.shortLabel||s.label}),s.count!==void 0&&s.count>0&&e.jsx("span",{className:"bg-orange-500 text-white text-xs px-1.5 sm:px-2 py-0.5 rounded-full flex-shrink-0",children:s.count})]},s.id))})}),e.jsxs("div",{className:"p-4 pb-20",children:[p==="shop"&&e.jsxs("div",{children:[e.jsxs("div",{className:"relative mb-4",children:[e.jsx(Ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:a==="ru"?"–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤...":"Mahsulot qidirish...",value:F,onChange:s=>Se(s.target.value),className:"w-full pl-10 pr-4 py-3 rounded-xl border border-gray-200 focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>re(null),className:`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${B?"glass-card text-gray-700 hover:bg-white/60":"bg-orange-500 text-white shadow-md"}`,children:[e.jsx("span",{className:"text-2xl mb-1",children:"üè™"}),e.jsx("span",{className:"text-xs font-medium text-center",children:a==="ru"?"–í—Å–µ":"Hammasi"})]}),we.map(s=>e.jsxs("button",{onClick:()=>re(s.id),className:`flex flex-col items-center justify-center p-3 rounded-xl transition-all ${B===s.id?"bg-orange-500 text-white shadow-md":"glass-card text-gray-700 hover:bg-white/60"}`,children:[e.jsx("span",{className:"text-2xl mb-1",children:O[s.id]||"üì¶"}),e.jsx("span",{className:"text-xs font-medium text-center line-clamp-1",children:a==="ru"?s.name_ru:s.name_uz})]},s.id))]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Be.map(s=>{const t=je(s.id),r=x.includes(s.id);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 flex items-center justify-center cursor-pointer",onClick:()=>I(s),children:[s.image_url?e.jsx("img",{src:s.image_url,alt:a==="ru"?s.name_ru:s.name_uz,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-4xl",children:O[s.category_id]||"üì¶"}),e.jsx("button",{onClick:l=>{l.stopPropagation(),X(s.id)},className:"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm",children:e.jsx(z,{className:`w-4 h-4 ${r?"fill-red-500 text-red-500":"text-gray-400"}`})}),s.is_featured&&e.jsx("div",{className:"absolute top-2 left-2 bg-orange-500 text-white text-xs px-2 py-0.5 rounded-full",children:a==="ru"?"–•–∏—Ç":"Hit"})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]",children:a==="ru"?s.name_ru:s.name_uz}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:s.unit}),e.jsx("p",{className:`text-xs mt-1 ${s.stock_quantity===0?"text-red-500":s.stock_quantity<=5?"text-amber-500":"text-green-600"}`,children:s.stock_quantity===0?a==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas":a==="ru"?`–í –Ω–∞–ª–∏—á–∏–∏: ${s.stock_quantity} ${s.unit}`:`Mavjud: ${s.stock_quantity} ${s.unit}`}),e.jsx("div",{className:"flex items-center justify-between mt-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-orange-600",children:u(s.price)}),s.old_price&&e.jsx("p",{className:"text-xs text-gray-400 line-through",children:u(s.old_price)})]})}),t>0?e.jsxs("div",{className:"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(s.id,t-1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(W,{className:"w-4 h-4 text-orange-600"})}),e.jsx("span",{className:"font-medium text-orange-600",children:t}),e.jsx("button",{onClick:()=>f(s.id,t+1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(R,{className:"w-4 h-4 text-orange-600"})})]}):e.jsxs("button",{onClick:()=>J(s.id),disabled:s.stock_quantity===0,className:`w-full mt-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1 ${s.stock_quantity===0?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-orange-500 text-white hover:bg-orange-600"}`,children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:s.stock_quantity===0?a==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas":a==="ru"?"–í –∫–æ—Ä–∑–∏–Ω—É":"Savatga"})]})]})]},s.id)})}),G.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:a==="ru"?"–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã":"Mahsulotlar topilmadi"})]}),D>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[e.jsx("button",{onClick:()=>me(s=>Math.max(1,s-1)),disabled:k===1,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[k," / ",D]}),e.jsx("button",{onClick:()=>me(s=>Math.min(D,s+1)),disabled:k===D,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"w-5 h-5"})})]})]}),p==="cart"&&e.jsx("div",{children:j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(V,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:a==="ru"?"–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞":"Savat bo'sh"}),e.jsx("button",{onClick:()=>y("shop"),className:"text-orange-600 font-medium",children:a==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-4",children:j.map(s=>{const t=P.find(r=>r.id===s.product_id);return t?e.jsxs("div",{className:"glass-card p-4 flex gap-3",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:t.image_url?e.jsx("img",{src:t.image_url,alt:"",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-2xl",children:O[t.category_id]||"üì¶"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 line-clamp-2",children:a==="ru"?t.name_ru:t.name_uz}),e.jsx("p",{className:"text-sm text-gray-500",children:t.unit}),e.jsx("p",{className:"font-bold text-orange-600 mt-1",children:u(t.price*s.quantity)})]}),e.jsxs("div",{className:"flex flex-col items-end justify-between",children:[e.jsx("button",{onClick:()=>ye(t.id),className:"p-1 text-gray-400 hover:text-red-500",children:e.jsx(Ye,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(t.id,s.quantity-1),className:"p-1 rounded bg-white shadow-sm",children:e.jsx(W,{className:"w-3 h-3"})}),e.jsx("span",{className:"w-6 text-center text-sm font-medium",children:s.quantity}),e.jsx("button",{onClick:()=>f(t.id,s.quantity+1),className:"p-1 rounded bg-white shadow-sm",children:e.jsx(R,{className:"w-3 h-3"})})]})]})]},s.id):null})}),e.jsxs("div",{className:"glass-card p-4 mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-gray-600",children:a==="ru"?"–¢–æ–≤–∞—Ä–æ–≤:":"Mahsulotlar:"}),e.jsxs("span",{className:"font-medium",children:[j.reduce((s,t)=>s+t.quantity,0)," —à—Ç"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-lg font-bold",children:[e.jsx("span",{children:a==="ru"?"–ò—Ç–æ–≥–æ:":"Jami:"}),e.jsx("span",{className:"text-orange-600",children:u(fe)})]})]}),e.jsx("button",{onClick:()=>A(!0),className:"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors",children:a==="ru"?"–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑":"Buyurtma berish"})]})}),p==="orders"&&e.jsx("div",{children:$.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:a==="ru"?"–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤":"Faol buyurtmalar yo'q"}),e.jsx("button",{onClick:()=>y("shop"),className:"text-orange-600 font-medium",children:a==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsxs("div",{className:"space-y-4",children:[Te.map(s=>{const t=He(s.status),r=Je(s.status,a),l=["new","confirmed"].includes(s.status);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gradient-to-r from-orange-500/10 to-amber-400/10 border-b border-orange-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold text-gray-900",children:[a==="ru"?"–ó–∞–∫–∞–∑":"Buyurtma"," #",s.order_number]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})})]}),e.jsx("span",{className:"font-bold text-orange-600",children:u(s.total_amount)})]})}),e.jsxs("div",{className:"px-4 pt-4 pb-2 text-center",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:r.title}),e.jsx("p",{className:"text-sm text-gray-500",children:r.subtitle})]}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute top-4 left-4 right-4 h-1 bg-gray-200 rounded-full"}),e.jsx("div",{className:"absolute top-4 left-4 h-1 bg-orange-500 rounded-full transition-all duration-500",style:{width:`calc(${Math.min(t/(Y.length-1)*100,100)}% - 32px)`}}),Y.map((n,g)=>{const Ne=t>=g,Ue=t===g,Le=n.icon;return e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 ${Ne?Ue?"bg-orange-500 text-white ring-4 ring-orange-200 shadow-lg":"bg-orange-500 text-white":"bg-gray-200 text-gray-400"}`,children:e.jsx(Le,{className:"w-4 h-4"})}),e.jsx("span",{className:`text-[10px] mt-1.5 font-medium text-center max-w-[50px] leading-tight ${Ne?"text-gray-900":"text-gray-400"}`,children:a==="ru"?n.labelRu:n.labelUz})]},n.id)})]})}),e.jsxs("div",{className:"px-4 pb-4 border-t border-gray-100 pt-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:a==="ru"?"–¢–æ–≤–∞—Ä—ã:":"Mahsulotlar:"}),e.jsx("div",{className:"space-y-2",children:(s.items||[]).map((n,g)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:n.product_image?e.jsx("img",{src:n.product_image,alt:"",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-xs",children:"üì¶"})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("span",{className:"text-sm text-gray-700 truncate block",children:n.product_name||(a==="ru"?"–¢–æ–≤–∞—Ä":"Mahsulot")})}),e.jsxs("span",{className:"text-xs text-gray-500 whitespace-nowrap",children:[n.quantity," √ó ",(n.unit_price||n.price||0).toLocaleString()," —Å—É–º"]})]},n.id||g))}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100 flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[(s.items||[]).reduce((n,g)=>n+g.quantity,0)," ",a==="ru"?"—Ç–æ–≤–∞—Ä–æ–≤":"mahsulot"]}),e.jsxs("span",{className:"text-sm font-semibold text-orange-600",children:[s.total_amount.toLocaleString()," —Å—É–º"]})]}),l&&e.jsxs("button",{onClick:()=>Pe(s.id),disabled:de===s.id,className:"mt-3 w-full py-2 px-4 bg-red-50 text-red-600 rounded-lg text-sm font-medium hover:bg-red-100 transition-colors flex items-center justify-center gap-2 disabled:opacity-50",children:[de===s.id?e.jsx("div",{className:"w-4 h-4 border-2 border-red-300 border-t-red-600 rounded-full animate-spin"}):e.jsx(Ie,{className:"w-4 h-4"}),a==="ru"?"–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑":"Bekor qilish"]})]})]},s.id)}),U>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>xe(s=>Math.max(1,s-1)),disabled:_===1,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[_," / ",U]}),e.jsx("button",{onClick:()=>xe(s=>Math.min(U,s+1)),disabled:_===U,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"w-5 h-5"})})]})]})}),p==="history"&&e.jsx("div",{children:K.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ve,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:a==="ru"?"–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤ –ø—É—Å—Ç–∞":"Buyurtmalar tarixi bo'sh"}),e.jsx("button",{onClick:()=>y("shop"),className:"text-orange-600 font-medium",children:a==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsxs("div",{className:"space-y-4",children:[$e.map(s=>{const t=s.status==="cancelled",r=s.status==="delivered";return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsx("div",{className:`p-4 border-b ${t?"bg-red-50 border-red-100":"bg-green-50 border-green-100"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"font-bold text-gray-900",children:[a==="ru"?"–ó–∞–∫–∞–∑":"Buyurtma"," #",s.order_number]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:t?a==="ru"?"–û—Ç–º–µ–Ω—ë–Ω":"Bekor qilindi":a==="ru"?"–î–æ—Å—Ç–∞–≤–ª–µ–Ω":"Yetkazildi"})]}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsx("span",{className:"font-bold text-gray-700",children:u(s.total_amount)})]})}),e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"space-y-2",children:[(s.items||[]).slice(0,3).map((l,n)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0",children:l.product_image?e.jsx("img",{src:l.product_image,alt:"",className:"w-full h-full object-cover rounded-lg"}):e.jsx("span",{className:"text-xs",children:"üì¶"})}),e.jsx("span",{className:"text-sm text-gray-700 flex-1 truncate",children:l.product_name||(a==="ru"?"–¢–æ–≤–∞—Ä":"Mahsulot")}),e.jsxs("span",{className:"text-xs text-gray-500",children:["√ó",l.quantity]})]},l.id||n)),(s.items||[]).length>3&&e.jsxs("p",{className:"text-xs text-gray-400",children:["+",(s.items||[]).length-3," ",a==="ru"?"–µ—â—ë":"yana"]})]})}),r&&!s.rating&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("button",{onClick:()=>{q(s.id),C(!0)},className:"w-full py-2 px-4 bg-orange-50 text-orange-600 rounded-lg text-sm font-medium hover:bg-orange-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx(se,{className:"w-4 h-4"}),a==="ru"?"–û—Ü–µ–Ω–∏—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É":"Yetkazishni baholash"]})}),r&&s.rating&&e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"flex items-center gap-1",children:[[1,2,3,4,5].map(l=>e.jsx(se,{className:`w-4 h-4 ${l<=(s.rating||0)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},l)),e.jsx("span",{className:"text-sm text-gray-500 ml-2",children:a==="ru"?"–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞":"Sizning bahongiz"})]})})]},s.id)}),L>1&&e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[e.jsx("button",{onClick:()=>ue(s=>Math.max(1,s-1)),disabled:S===1,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Z,{className:"w-5 h-5"})}),e.jsxs("span",{className:"text-sm text-gray-600",children:[S," / ",L]}),e.jsx("button",{onClick:()=>ue(s=>Math.min(L,s+1)),disabled:S===L,className:"p-2 rounded-lg bg-white shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(ee,{className:"w-5 h-5"})})]})]})}),p==="favorites"&&e.jsx("div",{children:x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(z,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 mb-4",children:a==="ru"?"–ò–∑–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–µ—Ç":"Sevimli mahsulotlar yo'q"}),e.jsx("button",{onClick:()=>y("shop"),className:"text-orange-600 font-medium",children:a==="ru"?"–ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–æ–∫—É–ø–∫–∞–º":"Xaridga o'tish"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:P.filter(s=>x.includes(s.id)).map(s=>{const t=je(s.id);return e.jsxs("div",{className:"glass-card overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-square bg-gray-100 flex items-center justify-center",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:a==="ru"?s.name_ru:s.name_uz,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-4xl",children:O[s.category_id]||"üì¶"}),e.jsx("button",{onClick:()=>X(s.id),className:"absolute top-2 right-2 p-1.5 rounded-full bg-white shadow-sm",children:e.jsx(z,{className:"w-4 h-4 fill-red-500 text-red-500"})})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("h3",{className:"font-medium text-sm text-gray-900 line-clamp-2 min-h-[40px]",children:a==="ru"?s.name_ru:s.name_uz}),e.jsx("p",{className:"font-bold text-orange-600 mt-2",children:u(s.price)}),t>0?e.jsxs("div",{className:"flex items-center justify-between mt-3 bg-orange-50 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f(s.id,t-1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(W,{className:"w-4 h-4 text-orange-600"})}),e.jsx("span",{className:"font-medium text-orange-600",children:t}),e.jsx("button",{onClick:()=>f(s.id,t+1),className:"p-1.5 rounded-md bg-white shadow-sm",children:e.jsx(R,{className:"w-4 h-4 text-orange-600"})})]}):e.jsxs("button",{onClick:()=>J(s.id),className:"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 transition-colors flex items-center justify-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{children:a==="ru"?"–í –∫–æ—Ä–∑–∏–Ω—É":"Savatga"})]})]})]},s.id)})})})]}),d&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end",children:e.jsxs("div",{className:"bg-white/95 backdrop-blur-md w-full rounded-t-3xl max-h-[90vh] overflow-y-auto animate-slide-up",children:[e.jsxs("div",{className:"sticky top-0 bg-white/90 backdrop-blur-md p-4 border-b flex items-center justify-between z-10",children:[e.jsx("h2",{className:"font-bold text-lg",children:a==="ru"?d.name_ru:d.name_uz}),e.jsx("button",{onClick:()=>I(null),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"aspect-square bg-gray-100 rounded-xl flex items-center justify-center mb-4",children:d.image_url?e.jsx("img",{src:d.image_url,alt:"",className:"w-full h-full object-cover rounded-xl"}):e.jsx("span",{className:"text-6xl",children:O[d.category_id]||"üì¶"})}),e.jsx("p",{className:"text-gray-600 mb-4",children:a==="ru"?d.description_ru:d.description_uz}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:u(d.price)}),d.old_price&&e.jsx("p",{className:"text-gray-400 line-through",children:u(d.old_price)})]}),e.jsx("p",{className:"text-gray-500",children:d.unit})]}),d.stock_quantity>0?e.jsx("p",{className:"text-green-600 text-sm mb-4",children:a==="ru"?"–í –Ω–∞–ª–∏—á–∏–∏":"Mavjud"}):e.jsx("p",{className:"text-red-600 text-sm mb-4",children:a==="ru"?"–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏":"Mavjud emas"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>X(d.id),className:"p-3 border rounded-xl",children:e.jsx(z,{className:`w-6 h-6 ${x.includes(d.id)?"fill-red-500 text-red-500":"text-gray-400"}`})}),e.jsxs("button",{onClick:()=>{J(d.id),I(null)},disabled:d.stock_quantity===0,className:"flex-1 py-3 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:a==="ru"?"–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É":"Savatga qo'shish"})]})]})]})]})}),qe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-2xl overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsx("h2",{className:"font-bold text-lg",children:a==="ru"?"–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞":"Buyurtmani rasmiylashtirish"}),e.jsx("button",{onClick:()=>A(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ae,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:a==="ru"?"–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏:":"Yetkazish manzili:"}),e.jsxs("p",{className:"font-medium",children:[o?.address||"–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω",", ",a==="ru"?"–∫–≤.":"xonadon"," ",o?.apartment||"-"]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-2",children:a==="ru"?"–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É:":"Buyurtmaga izoh:"}),e.jsx("textarea",{value:ie,onChange:s=>ne(s.target.value),placeholder:a==="ru"?"–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –∑–∞ 10 –º–∏–Ω—É—Ç –¥–æ –¥–æ—Å—Ç–∞–≤–∫–∏":"Masalan: yetkazishdan 10 daqiqa oldin qo'ng'iroq qiling",className:"w-full p-3 border rounded-xl resize-none",rows:3})]}),e.jsx("div",{className:"bg-orange-50 rounded-xl p-4 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-700",children:a==="ru"?"–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:":"To'lanishi kerak:"}),e.jsx("span",{className:"text-xl font-bold text-orange-600",children:u(fe)})]})}),e.jsx("button",{onClick:Oe,className:"w-full py-4 bg-orange-500 text-white rounded-xl font-medium hover:bg-orange-600 transition-colors",children:a==="ru"?"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑":"Buyurtmani tasdiqlash"})]})]})}),Re&&T&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-md overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100 bg-gradient-to-r from-orange-500 to-amber-500",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:a==="ru"?"–û—Ü–µ–Ω–∏—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É":"Yetkazishni baholang"}),e.jsx("button",{onClick:()=>{C(!1),q(null),Q(5),H("")},className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(ae,{className:"w-5 h-5 text-white"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"bg-orange-50 rounded-xl p-4 mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(te,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-500",children:a==="ru"?"–ó–∞–∫–∞–∑":"Buyurtma"}),e.jsxs("div",{className:"font-semibold text-gray-900",children:["#",m.find(s=>s.id===T)?.order_number||""]})]})]})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:a==="ru"?"–ö–∞–∫ –≤–∞–º –∫–∞—á–µ—Å—Ç–≤–æ –¥–æ—Å—Ç–∞–≤–∫–∏?":"Yetkazish sifati qanday edi?"}),e.jsx("div",{className:"flex justify-center gap-2 mb-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{onClick:()=>Q(s),className:"p-1 active:scale-90 transition-transform touch-manipulation",children:e.jsx(se,{className:`w-10 h-10 ${s<=b?"text-yellow-400 fill-yellow-400":"text-gray-300"}`})},s))}),e.jsxs("div",{className:"text-sm font-medium text-gray-700",children:[b===5&&(a==="ru"?"–û—Ç–ª–∏—á–Ω–æ!":"Ajoyib!"),b===4&&(a==="ru"?"–•–æ—Ä–æ—à–æ":"Yaxshi"),b===3&&(a==="ru"?"–ù–æ—Ä–º–∞–ª—å–Ω–æ":"O'rtacha"),b===2&&(a==="ru"?"–ü–ª–æ—Ö–æ":"Yomon"),b===1&&(a==="ru"?"–û—á–µ–Ω—å –ø–ª–æ—Ö–æ":"Juda yomon")]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a==="ru"?"–û—Ç–∑—ã–≤ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)":"Sharh (ixtiyoriy)"}),e.jsx("textarea",{value:he,onChange:s=>H(s.target.value),placeholder:a==="ru"?"–ù–∞–ø–∏—à–∏—Ç–µ –æ—Ç–∑—ã–≤ –æ –¥–æ—Å—Ç–∞–≤–∫–µ...":"Yetkazish haqida sharh yozing...",className:"w-full px-4 py-3 border border-gray-200 rounded-xl resize-none focus:ring-2 focus:ring-orange-500 focus:border-transparent",rows:3})]}),e.jsx("button",{onClick:Me,disabled:ge,className:"w-full py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white rounded-xl font-semibold hover:from-orange-600 hover:to-amber-600 transition-all disabled:opacity-50 flex items-center justify-center gap-2",children:ge?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-5 h-5"}),a==="ru"?"–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É":"Bahoni yuborish"]})})]})]})})]})}export{Ze as MarketplacePage};
//# sourceMappingURL=MarketplacePage-1769428875114-C6Ejh9WE.js.map
